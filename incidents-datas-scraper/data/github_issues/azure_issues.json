{
  "tech": "azure",
  "count": 146,
  "examples": [
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32474,
      "title": "'az webapp config access-restriction show' returns properties in snake case",
      "problem": "### Describe the bug\n\nthe command sometimes returns properties in snake case and sometimes in camel case\nI didn't figure out the pattern\n\n\n### Related command\n\naz webapp config access-restriction show\n\n### Errors\n\nthe error occurs in a client code which doesn't find the expected property in camel case \n\n### Issue script & Debug output\n\naz webapp config access-restriction show --resource-group 'sensitive' --name 'sensitive' --debug\ncli.knack.cli: Command arguments: ['webapp', 'config', 'access-restriction', 'show', '--resource-group', 'sensitive', '--name', 'sensitive', '--debug']\ncli.knack.cli: __init__ debug log:\nEnable color in terminal.\ncli.knack.cli: Event: Cli.PreExecute []\ncli.knack.cli: Event: CommandParser.OnGlobalArgumentsCreate [<function CLILogging.on_global_arguments at 0x000001C21EFDB2E0>, <function OutputProducer.on_global_arguments at 0x000001C21F37C180>, <function CLIQuery.on_global_arguments at 0x000001C21F3A1580>]\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableCreate []\ncli.azure.cli.core: Modules found from index for 'webapp': ['azure.cli.command_modules.appservice', 'azure.cli.command_modules.serviceconnector']\ncli.azure.cli.core: Loading command modules:\ncli.azure.cli.core: Name                  Load Time    Groups  Commands\ncli.azure.cli.core: appservice                0.358        80       278\ncli.azure.cli.core: serviceconnector          0.022        20       331\ncli.azure.cli.core: Total (2)                 0.380       100       609\ncli.azure.cli.core: These extensions are not installed and will be skipped: ['azext_ai_examples', 'azext_next']\ncli.azure.cli.core: Loading extensions:\ncli.azure.cli.core: Name                  Load Time    Groups  Commands  Directory\ncli.azure.cli.core: Total (0)                 0.000         0         0\ncli.azure.cli.core: Loaded 98 groups, 609 commands.\ncli.azure.cli.core: Found a match in the command table.\ncli.azure.cli.core: Raw command  : webapp config access-restriction show\ncli.azure.cli.core: Command table: webapp config access-restriction show\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableTruncate [<function AzCliLogging.init_command_file_logging at 0x000001C2216971A0>]\ncli.azure.cli.core.azlogging: metadata file logging enabled - writing logs to 'C:\\Users\\sensitive\\.azure\\commands\\2025-11-28.16-12-16.webapp_config_access-restriction_show.25768.log'.\naz_command_data_logger: command args: webapp config access-restriction show --resource-group {} --name {} --debug\ncli.knack.cli: Event: CommandInvoker.OnPreArgumentLoad [<function register_global_subscription_argument.<locals>.add_subscription_parameter at 0x000001C2216BBA60>]   \ncli.knack.cli: Event: CommandInvoker.OnPostArgumentLoad []\ncli.knack.cli: Event: CommandInvoker.OnPostCommandTableCreate [<function register_ids_argument.<locals>.add_ids_arguments at 0x000001C22170E2A0>, <function register_cache_arguments.<locals>.add_cache_arguments at 0x000001C22170E3E0>, <function register_upcoming_breaking_change_info.<locals>.update_breaking_change_info at 0x000001C22170E480>]\ncli.knack.cli: Event: CommandInvoker.OnCommandTableLoaded []\ncli.knack.cli: Event: CommandInvoker.OnPreParseArgs []\ncli.knack.cli: Event: CommandInvoker.OnPostParseArgs [<function OutputProducer.handle_output_argument at 0x000001C21F37C220>, <function CLIQuery.handle_query_parameter at 0x000001C21F3A1620>, <function register_ids_argument.<locals>.parse_ids_arguments at 0x000001C22170E340>]\ncli.azure.cli.core.commands.client_factory: Getting management service client client_type=WebSiteManagementClient\ncli.azure.cli.core.auth.persistence: build_persistence: location='C:\\\\Users\\\\sensitive\\\\.azure\\\\msal_token_cache.bin', encrypt=True\ncli.azure.cli.core.auth.binary_cache: load: C:\\Users\\sensitive\\.azure\\msal_http_cache.bin\nurllib3.util.retry: Converted retries value: 1 -> Retry(total=1, connect=None, read=None, redirect=None, status=None)\nmsal.authority: Initializing with Entra authority: https://login.microsoftonline.com/sensitive\nmsal.authority: openid_config(\"https://login.microsoftonline.com/sensitive/v2.0/.well-known/openid-configuration\") = {'token_endpoint': 'https://login.microsoftonline.com/sensitive/oauth2/v2.0/token', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'private_key_jwt', 'client_secret_basic', 'self_signed_tls_client_auth'], 'jwks_uri': 'https://login.microsoftonline.com/sensitive/discovery/v2.0/keys', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['pairwise'], 'id_token_signing_alg_values_supported': ['RS256'], 'response_types_supported': ['code', 'id_token', 'code id_token', 'id_token token'], 'scopes_supported': ['openid', 'profile', 'email', 'offline_access'], 'issuer': 'https://login.microsoftonline.com/sensitive/v2.0', 'request_uri_parameter_supported': False, 'userinfo_endpoint': 'https://graph.microsoft.com/oidc/userinfo', 'authorization_endpoint': 'https://login.microsoftonline.com/sensitive/oauth2/v2.0/authorize', 'device_authorization_endpoint': 'https://login.microsoftonline.com/sensitive/oauth2/v2.0/devicecode', 'http_logout_supported': True, 'frontchannel_logout_supported': True, 'end_session_endpoint': 'https://login.microsoftonline.com/sensitive/oauth2/v2.0/logout', 'claims_supported': ['sub', 'iss', 'cloud_instance_name', 'cloud_instance_host_name', 'cloud_graph_host_name', 'msgraph_host', 'aud', 'exp', 'iat', 'auth_time', 'acr', 'nonce', 'preferred_username', 'name', 'tid', 'ver', 'at_hash', 'c_hash', 'email'], 'kerberos_endpoint': 'https://login.microsoftonline.com/sensitive/kerberos', 'mtls_endpoint_aliases': {'token_endpoint': 'https://mtlsauth.microsoft.com/sensitive/oauth2/v2.0/token'}, 'tls_client_certificate_bound_access_tokens': True, 'tenant_region_scope': 'EU', 'cloud_instance_name': 'microsoftonline.com', 'cloud_graph_host_name': 'graph.windows.net', 'msgraph_host': 'graph.microsoft.com', 'rbac_url': 'https://pas.windows.net'}\nmsal.application: Broker enabled? True\ncli.azure.cli.core.auth.credential_adaptor: CredentialAdaptor.get_token_info: scopes=('https://management.core.windows.net//.default',), options={}\ncli.azure.cli.core.auth.msal_credentials: UserCredential.acquire_token: scopes=['https://management.core.windows.net//.default'], claims_challenge=None, kwargs={}    \nmsal.application: Cache hit an AT\nmsal.telemetry: Generate or reuse correlation_id: sensitive\ncli.azure.cli.core.sdk.policies: Request URL: 'https://management.azure.com/subscriptions/sensitive/resourceGroups/sensitive/providers/Microsoft.Web/sites/sensitive/config/web?api-version=2024-11-01'\ncli.azure.cli.core.sdk.policies: Request method: 'GET'\ncli.azure.cli.core.sdk.policies: Request headers:\ncli.azure.cli.core.sdk.policies:     'Accept': 'application/json'\ncli.azure.cli.core.sdk.policies:     'x-ms-client-request-id': '9fba31b8-cc6c-11f0-b0cc-b3ce651aee6f'\ncli.azure.cli.core.sdk.policies:     'CommandName': 'webapp config access-restriction show'\ncli.azure.cli.core.sdk.policies:     'ParameterSetName': '--resource-group --name --debug'\ncli.azure.cli.core.sdk.policies:     'User-Agent': 'AZURECLI/2.76.0 (MSI) azsdk-python-core/1.35.0 Python/3.12.10 (Windows-11-10.0.22631-SP0)'\ncli.azure.cli.core.sdk.policies:     'Authorization': '*****'\ncli.azure.cli.core.sdk.policies: Request body:\ncli.azure.cli.core.sdk.policies: This request has no body\nurllib3.connectionpool: Starting new HTTPS connection (1): management.azure.com:443\nurllib3.connectionpool: https://management.azure.com:443 \"GET /subscriptions/sensitive/resourceGroups/sensitive/providers/Microsoft.Web/sites/sensitive/config/web?api-version=2024-11-01 HTTP/1.1\" 200 4440\ncli.azure.cli.core.sdk.policies: Response status: 200\ncli.azure.cli.core.sdk.policies: Response headers:\ncli.azure.cli.core.sdk.policies:     'Cache-Control': 'no-cache'\ncli.azure.cli.core.sdk.policies:     'Pragma': 'no-cache'\ncli.azure.cli.core.sdk.policies:     'Content-Length': '4440'\ncli.azure.cli.core.sdk.policies:     'Content-Type': 'application/json'\ncli.azure.cli.core.sdk.policies:     'Expires': '-1'\ncli.azure.cli.core.sdk.policies:     'Strict-Transport-Security': 'max-age=31536000; includeSubDomains'\ncli.azure.cli.core.sdk.policies:     'x-ms-request-id': 'guid'\ncli.azure.cli.core.sdk.policies:     'X-AspNet-Version': '4.0.30319'\ncli.azure.cli.core.sdk.policies:     'X-Powered-By': 'ASP.NET'\ncli.azure.cli.core.sdk.policies:     'x-ms-operation-identifier': 'tenantId=sensitive,objectId=guid/germanywestcentral/guid'\ncli.azure.cli.core.sdk.policies:     'x-ms-ratelimit-remaining-subscription-reads': '249'\ncli.azure.cli.core.sdk.policies:     'x-ms-ratelimit-remaining-subscription-global-reads': '3749'\ncli.azure.cli.core.sdk.policies:     'x-ms-correlation-request-id': 'guid'\ncli.azure.cli.core.sdk.policies:     'x-ms-routing-request-id': 'GERMANYWESTCENTRAL:20251128T151216Z:guid'\ncli.azure.cli.core.sdk.policies:     'X-Content-Type-Options': 'nosniff'\ncli.azure.cli.core.sdk.policies:     'X-Cache': 'CONFIG_NOCACHE'\ncli.azure.cli.core.sdk.policies:     'X-MSEdge-Ref': 'Ref A: 76232903A59A42219B569D93193CA3A0 Ref B: FRA261071510060 Ref C: 2025-11-28T15:12:15Z'\ncli.azure.cli.core.sdk.policies:     'Date': 'Fri, 28 Nov 2025 15:12:15 GMT'\ncli.azure.cli.core.sdk.policies: Response content:\ncli.azure.cli.core.sdk.policies: {\"id\":\"/subscriptions/sensitive/resourceGroups/sensitive/providers/Microsoft.Web/sites/sensitive/config/web\",\"name\":\"sensitive\",\"type\":\"Microsoft.Web/sites/config\",\"location\":\"West Europe\",\"properties\":{\"numberOfWorkers\":1,\"defaultDocuments\":[\"Default.htm\",\"Default.html\",\"Default.asp\",\"index.htm\",\"index.html\",\"iisstart.htm\",\"default.aspx\",\"index.php\",\"hostingstart.html\"],\"netFrameworkVersion\":\"v4.0\",\"phpVersion\":\"\",\"pythonVersion\":\"\",\"nodeVersion\":\"\",\"powerShellVersion\":\"\",\"linuxFxVersion\":\"DOTNETCORE|9.0\",\"windowsFxVersion\":null,\"sandboxType\":null,\"windowsConfiguredStacks\":[],\"requestTracingEnabled\":false,\"remoteDebuggingEnabled\":false,\"remoteDebuggingVersion\":null,\"httpLoggingEnabled\":false,\"azureMonitorLogCategories\":[\"\"],\"acrUseManagedIdentityCreds\":false,\"acrUserManagedIdentityID\":null,\"logsDirectorySizeLimit\":35,\"detailedErrorLoggingEnabled\":false,\"publishingUsername\":\"REDACTED\",\"publishingPassword\":null,\"appSettings\":null,\"metadata\":null,\"connectionStrings\":null,\"machineKey\":null,\"handlerMappings\":null,\"documentRoot\":null,\"scmType\":\"None\",\"use32BitWorkerProcess\":true,\"webSocketsEnabled\":false,\"alwaysOn\":true,\"javaVersion\":null,\"javaContainer\":null,\"javaContainerVersion\":null,\"appCommandLine\":\"\",\"managedPipelineMode\":\"Integrated\",\"virtualApplications\":[{\"virtualPath\":\"/\",\"physicalPath\":\"site\\\\wwwroot\",\"preloadEnabled\":true,\"virtualDirectories\":null}],\"winAuthAdminState\":null,\"winAuthTenantState\":null,\"customAppPoolIdentityAdminState\":false,\"customAppPoolIdentityTenantState\":false,\"runtimeADUser\":null,\"runtimeADUserPassword\":null,\"loadBalancing\":\"LeastRequests\",\"routingRules\":[],\"experiments\":{\"rampUpRules\":[]},\"limits\":null,\"autoHealEnabled\":false,\"autoHealRules\":null,\"tracingOptions\":null,\"vnetName\":\"sensitive_CustomSubnet\",\"vnetRouteAllEnabled\":false,\"vnetPrivatePortsCount\":0,\"publicNetworkAccess\":null,\"siteAuthEnabled\":false,\"siteAuthSettings\":{\"enabled\":null,\"unauthenticatedClientAction\":null,\"tokenStoreEnabled\":null,\"allowedExternalRedirectUrls\":null,\"defaultProvider\":null,\"clientId\":null,\"clientSecret\":null,\"clientSecretSettingName\":null,\"clientSecretCertificateThumbprint\":null,\"issuer\":null,\"allowedAudiences\":null,\"additionalLoginParams\":null,\"isAadAutoProvisioned\":false,\"aadClaimsAuthorization\":null,\"googleClientId\":null,\"googleClientSecret\":null,\"googleClientSecretSettingName\":null,\"googleOAuthScopes\":null,\"facebookAppId\":null,\"facebookAppSecret\":null,\"facebookAppSecretSettingName\":null,\"facebookOAuthScopes\":null,\"gitHubClientId\":null,\"gitHubClientSecret\":null,\"gitHubClientSecretSettingName\":null,\"gitHubOAuthScopes\":null,\"twitterConsumerKey\":null,\"twitterConsumerSecret\":null,\"twitterConsumerSecretSettingName\":null,\"microsoftAccountClientId\":null,\"microsoftAccountClientSecret\":null,\"microsoftAccountClientSecretSettingName\":null,\"microsoftAccountOAuthScopes\":null,\"configVersion\":null},\"cors\":null,\"push\":null,\"apiDefinition\":null,\"apiManagementConfig\":null,\"autoSwapSlotName\":null,\"localMySqlEnabled\":false,\"managedServiceIdentityId\":null,\"xManagedServiceIdentityId\":28440,\"keyVaultReferenceIdentity\":null,\"ipSecurityRestrictions\":[{\"ipAddress\":\"sensitive\",\"action\":\"Allow\",\"tag\":\"Default\",\"priority\":100,\"name\":\"sensitive\",\"description\":\"sensitive\"},{\"ipAddress\":\"Any\",\"action\":\"Deny\",\"priority\":2147483647,\"name\":\"Deny all\",\"description\":\"Deny all access\"}],\"ipSecurityRestrictionsDefaultAction\":null,\"scmIpSecurityRestrictions\":[{\"ipAddress\":\"Any\",\"action\":\"Allow\",\"priority\":2147483647,\"name\":\"Allow all\",\"description\":\"Allow all access\"}],\"scmIpSecurityRestrictionsDefaultAction\":null,\"scmIpSecurityRestrictionsUseMain\":false,\"http20Enabled\":false,\"minTlsVersion\":\"1.2\",\"minTlsCipherSuite\":null,\"scmMinTlsCipherSuite\":null,\"supportedTlsCipherSuites\":null,\"scmSupportedTlsCipherSuites\":null,\"scmMinTlsVersion\":\"1.2\",\"ftpsState\":\"FtpsOnly\",\"preWarmedInstanceCount\":0,\"functionAppScaleLimit\":null,\"elasticWebAppScaleLimit\":0,\"healthCheckPath\":null,\"fileChangeAuditEnabled\":false,\"functionsRuntimeScaleMonitoringEnabled\":false,\"websiteTimeZone\":null,\"minimumElasticInstanceCount\":0,\"azureStorageAccounts\":{},\"http20ProxyFlag\":0,\"sitePort\":null,\"antivirusScanEnabled\":false,\"storageType\":\"StorageVolume\",\"sitePrivateLinkHostEnabled\":false,\"clusteringEnabled\":false,\"webJobsEnabled\":false}}\ncli.knack.cli: Event: CommandInvoker.OnTransformResult [<function _resource_group_transform at 0x000001C2216BB7E0>, <function _x509_from_base64_to_hex_transform at 0x000001C2216BB880>]\ncli.knack.cli: Event: CommandInvoker.OnFilterResult []\n{\n  \"ipSecurityRestrictions\": [\n    {\n      \"action\": \"Allow\",\n      \"additional_properties\": {},\n      \"description\": \"sensitive\",\n      \"headers\": null,\n      \"ip_address\": \"sensitive\",\n      \"name\": \"sensitive\",\n      \"priority\": 100,\n      \"subnet_mask\": null,\n      \"subnet_traffic_tag\": null,\n      \"tag\": \"Default\",\n      \"vnet_subnet_resource_id\": null,\n      \"vnet_traffic_tag\": null\n    },\n    {\n      \"action\": \"Deny\",\n      \"additional_properties\": {},\n      \"description\": \"Deny all access\",\n      \"headers\": null,\n      \"ip_address\": \"Any\",\n      \"name\": \"Deny all\",\n      \"priority\": 2147483647,\n      \"subnet_mask\": null,\n      \"subnet_traffic_tag\": null,\n      \"tag\": null,\n      \"vnet_subnet_resource_id\": null,\n      \"vnet_traffic_tag\": null\n    }\n  ],\n  \"ipSecurityRestrictionsDefaultAction\": null,\n  \"scmIpSecurityRestrictions\": [\n    {\n      \"action\": \"Allow\",\n      \"additional_properties\": {},\n      \"description\": \"Allow all access\",\n      \"headers\": null,\n      \"ip_address\": \"Any\",\n      \"name\": \"Allow all\",\n      \"priority\": 2147483647,\n      \"subnet_mask\": null,\n      \"subnet_traffic_tag\": null,\n      \"tag\": null,\n      \"vnet_subnet_resource_id\": null,\n      \"vnet_traffic_tag\": null\n    }\n  ],\n  \"scmIpSecurityRestrictionsDefaultAction\": null,\n  \"scmIpSecurityRestrictionsUseMain\": false\n}\ncli.knack.cli: Event: Cli.SuccessfulExecute []\ncli.knack.cli: Event: Cli.PostExecute [<function AzCliLogging.deinit_cmd_metadata_logging at 0x000001C221697420>]\n\n### Expected behavior\n\nthe output must have properties consistently named in camel case\n{\n  \"ipSecurityRestrictions\": [\n    {\n      \"action\": \"Allow\",\n      \"additionalProperties\": {},\n      \"description\": \"sensitive\",\n      \"headers\": null,\n      \"ipAddress\": \"sensitive\",\n      \"name\": \"sensitive\",\n      \"priority\": 100,\n      \"subnetMask\": null,\n      \"subnetTrafficTag\": null,\n      \"tag\": \"Default\",\n      \"vnetSubnetResource_id\": null,\n      \"\n\n### Environment Summary\n#### Local\nazure-cli                         2.76.0 *\n\ncore                              2.76.0 *\ntelemetry                          1.1.0\n\nExtensions:\nazure-devops                       1.0.2\n\nDependencies:\nmsal                            1.33.0b1\nazure-mgmt-resource               23.3.0\n\nPython location 'C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\python.exe'\nConfig directory 'C:\\Users\\sensitive\\.azure'\nExtensions directory 'C:\\Users\\sensitive\\.azure\\cliextensions'\n\nPython (Windows) 3.12.10 (tags/v3.12.10:0cc8128, Apr  8 2025, 12:21:36) [MSC v.1943 64 bit (AMD64)]\n\n#### Cloud \n{\n  \"azure-cli\": \"2.79.0\",\n  \"azure-cli-core\": \"2.79.0\",\n  \"azure-cli-telemetry\": \"1.1.0\",\n  \"extensions\": {\n    \"azure-devops\": \"1.0.2\"\n  }\n}\n\nImage: ubuntu-latest\nCurrent image version: '20251112.124.1'\nCurrent agent version: '4.261.0'\n\n### Additional context\n\nThere are multiple Azure DevOps pipeline runs executed on the same day with the same version of build agent image and az cli.\nSome of them fail because 'ipAddreess' property is not on the target rule\nSome of them succeed when the 'ipAddress' property is found on the target rule\n\n\nI didn't figure out the pattern.\n\nThe issue is reproduced locally as I consistently get snake cased properties in ipSecurityRestrictions and scmIpSecurityRestrictions objects\n\n",
      "solution": "the issue was reproduced after upgrading Az CLI to the latest version:\nazure-cli                         2.80.0\n\ncore                              2.80.0\ntelemetry                          1.1.0\n\nExtensions:\nazure-devops                       1.0.2\n\nDependencies:\nmsal                            1.34.0b1\nazure-mgmt-resource               23.3.0\n",
      "labels": [
        "bug",
        "Web Apps",
        "Service Attention",
        "customer-reported",
        "Auto-Assign",
        "app-service-general",
        "Auto-Resolve"
      ],
      "created_at": "2025-11-28T15:29:51Z",
      "closed_at": "2026-02-02T00:12:27Z",
      "url": "https://github.com/Azure/azure-cli/issues/32474",
      "comments_count": 7
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32083,
      "title": "2.77.0 raises error: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: Missing Authority Key Identifier (_ssl.c:1032)",
      "problem": "### Describe the bug\n\nAfter trying to log back in with `az login` az cli is receiving a certificate problem. With Context it is known the company uses its own CA/IA issued, which has been correctly set and been working previously. The error has been noticed today.\n\nPreviously the CA/IA have been imported into a `ca bundle` and referenced by environment variable `REQUEST_CA_BUNDLE` which has been working fine.\n\nWith the more recent version. 2.77.0 appears to be ignoring the set environment variable. Not confirmed. Requests have been receiving the error `CERTIFICATE_VERIFY_FAILED` `Missing Authority Key Identifier`.\n\nDebugging\n- The bundle has been checked against any new certificates the org may have issued. \n- The environment variable is correctly set and seen when printing and via `gci`\n\n\n\nWorkaround:\nProbably not the best idea but setting `$env:AZURE_CLI_DISABLE_CONNECTION_VERIFICATION=1` works.\n  \n\n### Related command\n\naz login\n\n### Errors\n\n`CERTIFICATE_VERIFY_FAILED`\n`Missing Authority Key Identifier`\n\n### Issue script & Debug output\n\n-\n\n### Expected behavior\n\nLogin to work correctly.\n\n### Environment Summary\n\nEnvironment:\n- Windows 10/11 affected\n- Powershell \n- az cli 2.77.0 as above\n\n### Additional context\n\n_No response_",
      "solution": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #20921\n- #23886\n- #13032\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nInstall `pip-system-certs` to make Azure CLI use the Windows system certificates. Run the following command in PowerShell:\n\n```batchfile\n\"C:\\Program Files (x86)\\Microsoft SDKs\\Azure\\CLI2\\python.exe\" -m pip install pip-system-certs\n```\nIf you have the new 64-bit installer, use:\n\n```batchfile\n\"C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\python.exe\" -m pip install pip-system-certs\n```\nThis will install a hook that tells certifi, and thus requests, to use the Windows system certificates.\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/20921#issuecomment-1190714888\n- https://github.com/azure/azure-cli/issues/20921#issuecomment-1198374794\n- https://github.com/azure/azure-cli/issues/20921#issuecomment-1231591338\n### Solution 2:\nEnsure the `REQUESTS_CA_BUNDLE` environment variable is correctly set to point to your CA bundle. For example:\n\n```powershell\n$Env:REQUESTS_CA_BUNDLE = \"C:\\path\\to\\your\\ca-bundle.pem\"\n```\nMake sure the CA bundle includes all necessary certificates, and verify that the certificate chain is complete.\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/20921#issuecomment-1154652531\n- https://github.com/azure/azure-cli/issues/20921#issuecomment-1715172362\n### Solution 3:\nManually add your organization's custom CA certificate to the `cacert.pem` file used by Azure CLI. Locate the `cacert.pem` file in the Azure CLI installation directory (e.g., `C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\Lib\\site-packages\\certifi\\`) and append your CA certificate to it. This ensures that Azure CLI recognizes your custom CA.\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/20921#issuecomment-1716564858\n- https://github.com/azure/azure-cli/issues/13032#issuecomment-705071981\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_\n\n---\n\nYou may also try directly using Python to isolate the problem:\n\n```\npython -c \"import requests; print(requests.get('https://login.microsoftonline.com/').status_code)\"\n```\n\n---\n\n> [@jiasli](https://github.com/jiasli) [@tamaw](https://github.com/tamaw) please consider re-opening this issue. It's affecting many - see all the duplicate issues linked to this one. Compatible/valid cert rollout for managed proxy takes time (we'd need 3 more weeks up to a month). Assumption is that it's feasible option to revert Python dependency [bump](https://github.com/Homebrew/homebrew-core/pull/235822) back to 3.12 for a month or so.\n> \n> Managing azure-cli via Homebrew is the only [officially](https://learn.microsoft.com/en-us/cli/azure/install-azure-cli-macos?view=azure-cli-latest) supported option on Mac OS, and Homebrew doesn't support pinning version, or rolling back, so would need a new release which makes use of Python 3.12 instead of 3.13\n\n@stevo-f3, we are impacted by this issue too. As a workaround for MacOS, I've created this bunch of commands to rollback to version 2.76.\n\n```\nbrew uninstall azure-cli\n\nexport HOMEBREW_NO_INSTALL_FROM_API=1\n\nbrew tap-new local/tap\nmkdir /opt/homebrew/Library/Taps/local/homebrew-tap/Formula/a/\ncurl -o $(brew --repository)/Library/Taps/local/homebrew-tap/Formula/a/azure-cli.rb https://raw.githubusercontent.com/Homebrew/homebrew-core/f4ee7509477925c3fc0ceccfb76d64782e5a7076/Formula/a/azure-cli.rb\n\nbrew install local/tap/azure-cli\n```\n\nExplanation:\n\n1. Uninstall the current az cli version.\n2. Activate the flag `HOMEBREW_NO_INSTALL_FROM_API` which allows to install formulas from a local tap, reference: https://docs.brew.sh/FAQ#can-i-edit-formulae-myself\n3. Creating a local tap (brew definition, and tap folder).\n4. Downloading the formula of `azure cli` version 2.76 from the official repository and the specific commit. Reference: https://raw.githubusercontent.com/Homebrew/homebrew-core/f4ee7509477925c3fc0ceccfb76d64782e5a7076/Formula/a/azure-cli.rb\n5. Installing the old version, which comes with Python 3.12.\n\nThe main drawback is that you won't get updates from `azure cli` formula until you uninstall it. So, when you have your CA cert \"fixed\", then you have to uninstall it (and also clean up the local tap, etc...).\n\nI hope this help!",
      "labels": [
        "Account",
        "question",
        "customer-reported",
        "common issue",
        "Auto-Assign",
        "Azure CLI Team",
        "Similar-Issue",
        "Possible-Solution"
      ],
      "created_at": "2025-09-09T05:27:57Z",
      "closed_at": "2025-09-11T01:58:17Z",
      "url": "https://github.com/Azure/azure-cli/issues/32083",
      "comments_count": 11
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 31864,
      "title": "docker images with vulnerabilties",
      "problem": "### Describe the bug\n\nHi Team,\nWe\u2019ve observed that our ACR Docker images are under compliance review and need to be cleaned and rebuilt. Previously, we were using the base image mcr.microsoft.com/cbl-mariner/base/python:3.9, but we\u2019ve now noted that this image will reach End of Life (EOL) on July 31, 2025.\n\nAs part of the remediation, I\u2019ve updated the base image to mcr.microsoft.com/azurelinux/base/python:3.12. However, after rebuilding, vulnerabilities are still being reported. \n\nPlease refer the latest docker image with tag \"vfix\"\n\nRef: [Vulnerability Management](https://dataexplorer.azure.com/dashboards/48834d42-391b-479d-a0fd-b748d939626b?p-_Filter_StartDt=2025-07-08T09-00-27Z&p-_Filter_EndDt=2025-07-08T19-34-06Z&p-_Filter_Division=all&p-_Filter_Organization=all&p-_Filter_ServiceGroup=all&p-_Filter_TeamGroup=all&p-_Filter_Service=all&p-_Filter_RemediationOwner=v-ca2412ef-15d7-4f2e-b215-edcbe7ee940d&p-_Filter_Actions=v-ReplaceVulnerableRegistryReference&p-_Filter_ScanToolNames=v-ContainerImageScan&p-_Filter_AssetType=all&p-_Filter_VulnerabilityId=all&p-_Filter_SLA=v-Past+SLA&p-_Filter_CustomGroupingLink=v-&p-_Filter_SubscriptionId=all&p-_Filter_Environment=all&p-_Filter_Cloud=all&p-_Filter_ResourceGroup=all&p-_Filter_Registry=all&p-_Filter_Image=all&p-_Filter_Digest=all&p-_Filter_ExcludeAction=v-None#692cdf78-4515-49cf-be27-09305d28ad8d)\n[Exploring Security for Kubernetes Connect Service](https://vnext.s360.msftcloudes.com/blades/security?blade=AssignedTo:All~KPI:527fb616-07aa-8198-6419-50d04ef1c2f3~SLA:2~Forums:All~Program:68556099-a3e2-472e-8da0-e1d1b000eda4;65a010a5-1e3d-4777-bb89-f149470a507d~waves:All~Tab:Summary~_loc:Security&peopleBasedNodes=jianyan_team;nizlati_team&tile=S360_ServiceId:ca2412ef-15d7-4f2e-b215-edcbe7ee940d~_loc:__key__Security__527fb616-07aa-8198-6419-50d04ef1c2f3&global=4:ca2412ef-15d7-4f2e-b215-edcbe7ee940d)\nhttps://mcr.microsoft.com/en-us/artifact/mar/azurelinux/base/python/about\n\n### Related command\n\nWe are building docker images with ADO pipeline.\n\nSample docker file\nFROM mcr.microsoft.com/azurelinux/base/python:3.12\nRUN tdnf makecache && tdnf update -y && tdnf install -y tar ca-certificates jq\nRUN tdnf install azure-cli -y\nRUN /usr/bin/curl -LO https://storage.googleapis.com/kubernetes-release/release/$(curl -s https://storage.googleapis.com/kubernetes-release/release/latest.txt)/bin/linux/amd64/kubectl \\\n    && chmod +x ./kubectl  \\\n    &&  mv ./kubectl /usr/local/bin/kubectl\n\nCOPY ./arc_agent_cleanup/requirements.txt ./\nRUN --mount=type=secret,id=ado_pat,target=/run/secrets/ado_pat \\\n    token=$(cat /run/secrets/ado_pat) && \\\n    index_url=\"https://ArcValidationPackages:$token@pkgs.dev.azure.com/ArcValidationProgram/ArcValidationProgram/_packaging/ArcValidationPackages/pypi/simple/\" && \\\n    mkdir -p ~/.config/pip && \\\n    echo \"[global]\" > ~/.config/pip/pip.conf && \\\n    echo \"index-url = $index_url\" >> ~/.config/pip/pip.conf && \\\n    echo \"extra-index-url = $index_url\" >> ~/.config/pip/pip.conf && \\\n    echo \"trusted-host = pkgs.dev.azure.com\" >> ~/.config/pip/pip.conf && \\\n    cat ~/.config/pip/pip.conf && \\\n    pip install --upgrade -r requirements.txt\n# Manually download and install Helm\nRUN curl -sSL https://get.helm.sh/helm-v3.17.4-linux-amd64.tar.gz -o helm.tar.gz && \\\n    tar -xzf helm.tar.gz && \\\n    mv linux-amd64/helm /usr/local/bin/helm && \\\n    rm -rf linux-amd64 helm.tar.gz\n\n# Verify Helm installation\nRUN helm version\n# RUN curl https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3 | bash \\\n#     && helm version\n\nARG SONOBUOY_VERSION\n\nRUN curl -L https://github.com/vmware-tanzu/sonobuoy/releases/download/v${SONOBUOY_VERSION}/sonobuoy_${SONOBUOY_VERSION}_linux_amd64.tar.gz --output /bin/sonobuoy.tar.gz\n\nRUN [\"tar\", \"-xzf\", \"/bin/sonobuoy.tar.gz\", \"-C\", \"/bin/\"]\n\nCOPY ./arc_agent_cleanup/arc_agent_cleanup.sh /\nCOPY ./arc_agent_cleanup/cleanup.py /\nCOPY ./common/results_utility.py /\nCOPY ./common/constants.py /\nCOPY ./common/kubernetes_namespace_utility.py /\nCOPY ./common/helm_utility.py /\nCOPY ./common/kubernetes_pod_utility.py  /\nCOPY ./common/connected_cluster_utility.py /\nCOPY ./common/arm_rest_utility.py /\nCOPY ./common/setup_failure_handler.py /\n\nRUN [\"chmod\", \"+x\", \"/arc_agent_cleanup.sh\"]\n\nENTRYPOINT [\"./arc_agent_cleanup.sh\"]\n\n####\nFROM mcr.microsoft.com/azurelinux/base/python:3.12\nRUN tdnf makecache && tdnf update -y && tdnf install -y tar && tdnf install -y gawk && tdnf install -y util-linux\nRUN tdnf install gnupg ca-certificates curl wget jq -y\nRUN tdnf install azure-cli -y\nRUN /usr/bin/curl -LO https://storage.googleapis.com/kubernetes-release/release/$(curl -s https://storage.googleapis.com/kubernetes-release/release/latest.txt)/bin/linux/amd64/kubectl \\\n    && chmod +x ./kubectl  \\\n    &&  mv ./kubectl /usr/local/bin/kubectl\n##\nCOPY ./ds_connect_core/requirements.txt ./\nRUN --mount=type=secret,id=ado_pat,target=/run/secrets/ado_pat \\\n    token=$(cat /run/secrets/ado_pat) && \\\n    index_url=\"https://ArcValidationPackages:$token@pkgs.dev.azure.com/ArcValidationProgram/ArcValidationProgram/_packaging/ArcValidationPackages/pypi/simple/\" && \\\n    mkdir -p ~/.config/pip && \\\n    echo \"[global]\" > ~/.config/pip/pip.conf && \\\n    echo \"index-url = $index_url\" >> ~/.config/pip/pip.conf && \\\n    echo \"extra-index-url = $index_url\" >> ~/.config/pip/pip.conf && \\\n    echo \"trusted-host = pkgs.dev.azure.com\" >> ~/.config/pip/pip.conf && \\\n    cat ~/.config/pip/pip.conf && \\\n    pip install --upgrade -r requirements.txt\n\n#RUN az upgrade --yes\nRUN az extension add --upgrade --name connectedk8s --yes --debug\nRUN az extension add --upgrade --name k8s-configuration --yes --debug\nRUN az extension add --upgrade --name k8s-extension --yes --debug\nRUN az extension add --upgrade --name customlocation --yes --debug\nRUN az extension add --upgrade --name arcdata --yes --debug\nRUN tdnf update -y\nARG SONOBUOY_VERSION\nRUN curl -L https://github.com/vmware-tanzu/sonobuoy/releases/download/v${SONOBUOY_VERSION}/sonobuoy_${SONOBUOY_VERSION}_linux_amd64.tar.gz --output /bin/sonobuoy.tar.gz\nRUN [\"tar\", \"-xzf\", \"/bin/sonobuoy.tar.gz\", \"-C\", \"/bin/\"]\nCOPY [\"./ds_connect_core/arc_ds_connect_conformance.sh\", \"./ds_connect_core/ds_pre_cleanup.sh\", \"./ds_connect_core/ds_setup_failure_handler.py\", \"./\"]\nCOPY [\"./ds_connect_core/pytest.ini\", \"./ds_connect_core/conftest.py\", \"./common\", \"/conformancetests/\"]\nCOPY [\"./ds_connect_core/pytest.ini\", \"./ds_connect_core/conftest.py\", \"./common\", \"/conformancetests-indirect/\"]\n## Ds direct tests\nCOPY [\"./ds_connect_core/ds_connect_constants.py\", \"./ds_connect_core/test_check_namespace_existence.py\", \"./ds_connect_core/test_check_pod_existence.py\", \"./ds_connect_core/test_check_pv_existence.py\", \"./ds_connect_core/test_ds_direct_cleanup.py\", \"./ds_connect_core/test_check_kubernetes_extension_arm.py\", \"/ds_connect_core/test_check_datacontroller_arm.py\", \"./ds_connect_core/test_check_customlocation_arm.py\", \"./ds_connect_core/test_check_connected_cluster_arm.py\", \"./ds_connect_core/test_check_azure_arc_namespace_existence.py\", \"./ds_connect_core/test_data_controller_ready.py\", \"./ds_connect_core/test_create_sql_mi.py\", \"/conformancetests/\"]\n## To do will add these below tests once postgres sql is ready from az cli\n#COPY ./ds_connect_core/test_create_postgressql.py /conformancetests/\n#COPY ./ds_connect_core/test_scale_out_postgressql.py /conformancetests/\n## DS indirect tests\nCOPY [\"./ds_core/test_check_namespace_existence.py\", \"./ds_core/test_check_pod_existence.py\", \"./ds_core/test_check_pv_existence.py\", \"./ds_core/test_create_sql_mi.py\", \"./ds_core/test_data_controller_ready.py\", \"./ds_core/test_create_postgressql.py\", \"./ds_core/test_scale_out_postgressql.py\", \"./ds_core/test_ds_indirect_cleanup.py\", \"/conformancetests-indirect/\"]\n\nRUN [\"chmod\", \"+x\", \"ds_pre_cleanup.sh\"]\nRUN [\"chmod\", \"+x\", \"arc_ds_connect_conformance.sh\"]\nRUN sed -i -e 's/\\r$//' arc_ds_connect_conformance.sh\nRUN sed -i -e 's/\\r$//' ds_pre_cleanup.sh\nRUN rm -rf  ~/.config/pip/pip.conf\nENTRYPOINT [\"/arc_ds_connect_conformance.sh\"]\n\n### Errors\n\nvulnerability flags from service 360\n\nhttps://vnext.s360.msftcloudes.com/blades/security?blade=AssignedTo:All~KPI:527fb616-07aa-8198-6419-50d04ef1c2f3~SLA:2~Forums:All~Program:68556099-a3e2-472e-8da0-e1d1b000eda4;65a010a5-1e3d-4777-bb89-f149470a507d~waves:All~Tab:Summary~_loc:Security&peopleBasedNodes=jianyan_team;nizlati_team&global=4:ca2412ef-15d7-4f2e-b215-edcbe7ee940d\n\nhttps://dataexplorer.azure.com/dashboards/48834d42-391b-479d-a0fd-b748d939626b?p-_Filter_StartDt=365days&p-_Filter_EndDt=now&p-_Filter_Division=all&p-_Filter_Organization=all&p-_Filter_ServiceGroup=all&p-_Filter_TeamGroup=all&p-_Filter_Service=all&p-_Filter_RemediationOwner=v-ca2412ef-15d7-4f2e-b215-edcbe7ee940d&p-_Filter_Actions=v-ReplaceVulnerableRegistryReference&p-_Filter_ScanToolNames=v-ContainerImageScan&p-_Filter_AssetType=all&p-_Filter_VulnerabilityId=all&p-_Filter_SLA=v-Past+SLA&p-_Filter_CustomGroupingLink=v-&p-_Filter_SubscriptionId=all&p-_Filter_Environment=all&p-_Filter_Cloud=all&p-_Filter_ResourceGroup=all&p-_Filter_Registry=all&p-_Filter_Image=all&p-_Filter_Digest=all&p-_Filter_ExcludeAction=v-None#692cdf78-4515-49cf-be27-09305d28ad8d\n\n### Issue script & Debug output\n\nplease find the attached document for issue and observations.\n\n[vulnerbs-issue.docx](https://github.com/user-attachments/files/21392461/vulnerbs-issue.docx)\n\n### Expected behavior\n\nvulnerability free.\n\n### Environment Summary\n\nroot [ / ]# az -v\nazure-cli                         2.75.0\n\ncore                              2.75.0\ntelemetry                          1.1.0\n\nExtensions:\narcdata                           1.5.24\n\nDependencies:\nmsal                            1.33.0b1\nazure-mgmt-resource               23.3.0\n\nPython location '/usr/bin/python3.12'\nConfig directory '/root/.azure'\nExtensions directory '/root/.azure/cliextensions'\n\nPython (Linux) 3.12.9 (main, Jun 12 2025, 19:38:44) [GCC 13.2.0]\n\nLegal docs and information: aka.ms/AzureCliLegal\n\n\nYour CLI is up-to-date.\n\n### Additional context\n\nPlease guide and suggest us.",
      "solution": "For requests CVE, it's been fixed in https://github.com/Azure/azure-cli/pull/31708. Please wait for next release.\n\nFor jinja2 CVE, it's from arcdata extension, please report to https://github.com/Azure/azure-cli-extensions\n\n---\n\n> For requests CVE, it's been fixed in [#31708](https://github.com/Azure/azure-cli/pull/31708). Please wait for next release.\n> \n> For jinja2 CVE, it's from arcdata extension, please report to https://github.com/Azure/azure-cli-extensions\n\nthanks for the update. May I know the next release date or ETA.\n",
      "labels": [
        "bug",
        "Upgrade",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2025-07-23T17:25:48Z",
      "closed_at": "2026-01-31T12:33:08Z",
      "url": "https://github.com/Azure/azure-cli/issues/31864",
      "comments_count": 4
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 31926,
      "title": "Microsoft.App/managedEnvironments/PrivateEndpointConnectionsApproval/action error",
      "problem": "### Describe the bug\n\nI've created a Least Privilege environment, all was going well until I added the Action below.\n\nCommand (Windows bash, I also tried \"pwsh -c '...'\" as that sometimes helps...)\n``` bash\naz role definition create --role-definition role.json\n```\n\njson file\n``` json\n{\n  \"Name\": \"...\",\n  \"Description\": \"...\",\n  \"AssignableScopes\": [\"/subscriptions/.../resourceGroups/...\"],\n  \"Actions\": [\n    \"Microsoft.App/managedEnvironments/PrivateEndpointConnectionsApproval/action\",\n    ....\n  ]\n}\n```\n\nError message\n```\n(InvalidActionOrNotAction) 'Microsoft.App/managedEnvironments/PrivateEndpointConnectionsApproval/action' does not match any of the actions supported by the providers.\nCode: InvalidActionOrNotAction\nMessage: 'Microsoft.App/managedEnvironments/PrivateEndpointConnectionsApproval/action' does not match any of the actions supported by the providers.\n```\n\n### Related command\n\naz role definition create --role-definition role.json\n\n{\n  \"Name\": \"...\",\n  \"Description\": \"...\",\n  \"AssignableScopes\": [\"/subscriptions/.../resourceGroups/...\"],\n  \"Actions\": [\n    \"Microsoft.App/managedEnvironments/PrivateEndpointConnectionsApproval/action\",\n    ....\n  ]\n}\n\n### Errors\n\n(InvalidActionOrNotAction) 'Microsoft.App/managedEnvironments/PrivateEndpointConnectionsApproval/action' does not match any of the actions supported by the providers.\nCode: InvalidActionOrNotAction\nMessage: 'Microsoft.App/managedEnvironments/PrivateEndpointConnectionsApproval/action' does not match any of the actions supported by the providers.\n\n### Issue script & Debug output\n\nN\\A\n\n### Expected behavior\n\nShould give the definition Microsoft.App/managedEnvironments/PrivateEndpointConnectionsApproval/action permissions.\n\n### Environment Summary\n\nazure-cli                         2.76.0\n\ncore                              2.76.0\ntelemetry                          1.1.0\n\nExtensions:\ncontainerapp                     1.2.0b3\nlog-analytics                    1.0.0b1\n\nDependencies:\nmsal                            1.33.0b1\nazure-mgmt-resource               23.3.0\n\nPython location 'C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\python.exe'\nConfig directory 'C:\\Users\\x\\.azure'\nExtensions directory 'C:\\Users\\x\\.azure\\cliextensions'\n\nPython (Windows) 3.12.10 (tags/v3.12.10:0cc8128, Apr  8 2025, 12:21:36) [MSC v.1943 64 bit (AMD64)]\n\n### Additional context\n\n_No response_",
      "solution": "@uncledru yes, we are fixing the issue in backend.",
      "labels": [
        "question",
        "RBAC",
        "customer-reported",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2025-08-07T10:46:10Z",
      "closed_at": "2026-01-31T12:31:39Z",
      "url": "https://github.com/Azure/azure-cli/issues/31926",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 31964,
      "title": "az role definition list not working in VS Code (ver 2.76)",
      "problem": "### Describe the bug\n\nWhen running the cli command \"az role definition list\" from the prompt, i am receiving the following error information.  I have verified that I am logged in correctly and also that the PowerShell command similar to this this works okay.\n\n\n\n### Related command\n\naz role definition list\n\n### Errors\n\nPS C:\\Dev\\Visual Studio 2022\\AzureBicep> az role definition list\n(InvalidApiVersionParameter) The api-version '2022-05-01-preview' is invalid. The supported versions are '2025-04-01,2025-03-01,2024-10-01-preview,2024-11-01,2024-08-01,2024-07-01,2024-06-01-preview,2024-03-01,2023-07-01,2023-07-01-preview,2023-03-01-preview,2022-12-01,2022-11-01-preview,2022-09-01,2022-06-01,2022-05-01,2022-03-01-preview,2022-01-01,2021-04-01,2021-01-01,2020-10-01,2020-09-01,2020-08-01,2020-07-01,2020-06-01,2020-05-01,2020-01-01,2019-11-01,2019-10-01,2019-09-01,2019-08-01,2019-07-01,2019-06-01,2019-05-10,2019-05-01,2019-03-01,2018-11-01,2018-09-01,2018-08-01,2018-07-01,2018-06-01,2018-05-01,2018-02-01,2018-01-01,2017-12-01,2017-08-01,2017-06-01,2017-05-10,2017-05-01,2017-03-01,2016-09-01,2016-07-01,2016-06-01,2016-02-01,2015-11-01,2015-01-01,2014-04-01-preview,2014-04-01,2014-01-01,2013-03-01,2014-02-26,2014-04'.\nCode: InvalidApiVersionParameter\nMessage: The api-version '2022-05-01-preview' is invalid. The supported versions are '2025-04-01,2025-03-01,2024-10-01-preview,2024-11-01,2024-08-01,2024-07-01,2024-06-01-preview,2024-03-01,2023-07-01,2023-07-01-preview,2023-03-01-preview,2022-12-01,2022-11-01-preview,2022-09-01,2022-06-01,2022-05-01,2022-03-01-preview,2022-01-01,2021-04-01,2021-01-01,2020-10-01,2020-09-01,2020-08-01,2020-07-01,2020-06-01,2020-05-01,2020-01-01,2019-11-01,2019-10-01,2019-09-01,2019-08-01,2019-07-01,2019-06-01,2019-05-10,2019-05-01,2019-03-01,2018-11-01,2018-09-01,2018-08-01,2018-07-01,2018-06-01,2018-05-01,2018-02-01,2018-01-01,2017-12-01,2017-08-01,2017-06-01,2017-05-10,2017-05-01,2017-03-01,2016-09-01,2016-07-01,2016-06-01,2016-02-01,2015-11-01,2015-01-01,2014-04-01-preview,2014-04-01,2014-01-01,2013-03-01,2014-02-26,2014-04'.\nPS C:\\Dev\\Visual Studio 2022\\AzureBicep>\n\n### Issue script & Debug output\n\nPS C:\\Dev\\Visual Studio 2022\\AzureBicep> az role definition list --debug\ncli.knack.cli: Command arguments: ['role', 'definition', 'list', '--debug']\ncli.knack.cli: __init__ debug log:\nEnable color in terminal.\ncli.knack.cli: Event: Cli.PreExecute []\ncli.knack.cli: Event: CommandParser.OnGlobalArgumentsCreate [<function CLILogging.on_global_arguments at 0x00000237A001F2E0>, <function OutputProducer.on_global_arguments at 0x00000237A03BC180>, <function CLIQuery.on_global_arguments at 0x00000237A03E5580>]\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableCreate []\ncli.azure.cli.core: Modules found from index for 'role': ['azure.cli.command_modules.role']cli.azure.cli.core: Loading command modules:\ncli.azure.cli.core: Name                  Load Time    Groups  Commands\ncli.azure.cli.core: role                      0.010        17        62\ncli.azure.cli.core: Total (1)                 0.010        17        62\ncli.azure.cli.core: Loaded 17 groups, 62 commands.\ncli.azure.cli.core: Found a match in the command table.\ncli.azure.cli.core: Raw command  : role definition list\ncli.azure.cli.core: Command table: role definition list\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableTruncate [<function AzCliLogging.init_command_file_logging at 0x00000237A27EB1A0>]\ncli.azure.cli.core.azlogging: metadata file logging enabled - writing logs to 'C:\\Users\\OR0096420\\.azure\\commands\\2025-08-19.08-04-35.role_definition_list.23576.log'.\naz_command_data_logger: command args: role definition list --debug\ncli.knack.cli: Event: CommandInvoker.OnPreArgumentLoad [<function register_global_subscription_argument.<locals>.add_subscription_parameter at 0x00000237A284A340>]\ncli.knack.commands: Configured default '@{resourceGroup=; location=; storageName=; storageSKU=; storageKind=; keyVaultName=; keyVaultSku=; keyVaultAdmins=; planName=; planSKU=; logName=; netEnvironment=; appList=; appTsr=; dataFactoryName=; sqlServerName=; sqlAdministratorLogin=; sqlAdministratorTemp=; sqlADPrincipalType=; sqlADLogin=; sqlADSid=; sqlADLogin2=; sqlADSid2=; sqlAuditRetention=; sqlADLogin3=; sqlADLoginAdf=; dbList=; dbOptions=}.resourceGroup.value' for arg resource_group_name\ncli.knack.cli: Event: CommandInvoker.OnPostArgumentLoad []\ncli.knack.cli: Event: CommandInvoker.OnPostCommandTableCreate [<function register_ids_argument.<locals>.add_ids_arguments at 0x00000237A284A3E0>, <function register_cache_arguments.<locals>.add_cache_arguments at 0x00000237A284A520>, <function register_upcoming_breaking_change_info.<locals>.update_breaking_change_info at 0x00000237A284A5C0>]\ncli.knack.cli: Event: CommandInvoker.OnCommandTableLoaded []\ncli.knack.cli: Event: CommandInvoker.OnPreParseArgs []\ncli.knack.cli: Event: CommandInvoker.OnPostParseArgs [<function OutputProducer.handle_output_argument at 0x00000237A03BC220>, <function CLIQuery.handle_query_parameter at 0x00000237A03E5620>, <function register_ids_argument.<locals>.parse_ids_arguments at 0x00000237A284A480>]\ncli.azure.cli.core.commands.client_factory: Getting management service client client_type=AuthorizationManagementClient\ncli.azure.cli.core.auth.persistence: build_persistence: location='C:\\\\Users\\\\OR0096420\\\\.azure\\\\msal_token_cache.bin', encrypt=True\ncli.azure.cli.core.auth.binary_cache: load: C:\\Users\\OR0096420\\.azure\\msal_http_cache.bin\nurllib3.util.retry: Converted retries value: 1 -> Retry(total=1, connect=None, read=None, redirect=None, status=None)\nmsal.authority: Initializing with Entra authority: https://login.microsoftonline.com/658e63e8-8d39-499c-8f48-13adc9452f4c\nmsal.authority: openid_config(\"https://login.microsoftonline.com/658e63e8-8d39-499c-8f48-13adc9452f4c/v2.0/.well-known/openid-configuration\") = {'token_endpoint': 'https://login.microsoftonline.com/658e63e8-8d39-499c-8f48-13adc9452f4c/oauth2/v2.0/token', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'private_key_jwt', 'client_secret_basic'], 'jwks_uri': 'https://login.microsoftonline.com/658e63e8-8d39-499c-8f48-13adc9452f4c/discovery/v2.0/keys', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['pairwise'], 'id_token_signing_alg_values_supported': ['RS256'], 'response_types_supported': ['code', 'id_token', 'code id_token', 'id_token token'], 'scopes_supported': ['openid', 'profile', 'email', 'offline_access'], 'issuer': 'https://login.microsoftonline.com/658e63e8-8d39-499c-8f48-13adc9452f4c/v2.0', 'request_uri_parameter_supported': False, 'userinfo_endpoint': 'https://graph.microsoft.com/oidc/userinfo', 'authorization_endpoint': 'https://login.microsoftonline.com/658e63e8-8d39-499c-8f48-13adc9452f4c/oauth2/v2.0/authorize', 'device_authorization_endpoint': 'https://login.microsoftonline.com/658e63e8-8d39-499c-8f48-13adc9452f4c/oauth2/v2.0/devicecode', 'http_logout_supported': True, 'frontchannel_logout_supported': True, 'end_session_endpoint': 'https://login.microsoftonline.com/658e63e8-8d39-499c-8f48-13adc9452f4c/oauth2/v2.0/logout', 'claims_supported': ['sub', 'iss', 'cloud_instance_name', 'cloud_instance_host_name', 'cloud_graph_host_name', 'msgraph_host', 'aud', 'exp', 'iat', 'auth_time', 'acr', 'nonce', 'preferred_username', 'name', 'tid', 'ver', 'at_hash', 'c_hash', 'email'], 'kerberos_endpoint': 'https://login.microsoftonline.com/658e63e8-8d39-499c-8f48-13adc9452f4c/kerberos', 'tenant_region_scope': 'NA', 'tenant_region_sub_scope': 'GCC', 'cloud_instance_name': 'microsoftonline.com', 'cloud_graph_host_name': 'graph.windows.net', 'msgraph_host': 'graph.microsoft.com', 'rbac_url': 'https://pas.windows.net'}\nmsal.application: Broker enabled? True\ncli.azure.cli.core.auth.credential_adaptor: CredentialAdaptor.get_token_info: scopes=('https://management.core.windows.net//.default',), options={}\ncli.azure.cli.core.auth.msal_credentials: UserCredential.acquire_token: scopes=['https://management.core.windows.net//.default'], claims_challenge=None, kwargs={}\nmsal.application: Cache hit an AT\nmsal.telemetry: Generate or reuse correlation_id: 6e4fd5f0-7278-48ac-8dc0-d069464c21cc     \ncli.azure.cli.core.sdk.policies: Request URL: 'https://management.azure.com/subscriptions/0dabaa0c-6aa7-4546-bb53-58efa390b365/resourceGroups/providers/Microsoft.Authorization/roleDefinitions?api-version=2022-05-01-preview'\ncli.azure.cli.core.sdk.policies: Request method: 'GET'\ncli.azure.cli.core.sdk.policies: Request headers:\ncli.azure.cli.core.sdk.policies:     'Accept': 'application/json'\ncli.azure.cli.core.sdk.policies:     'x-ms-client-request-id': 'd1a73701-7d0d-11f0-bf33-44e51789af66'\ncli.azure.cli.core.sdk.policies:     'CommandName': 'role definition list'\ncli.azure.cli.core.sdk.policies:     'ParameterSetName': '--debug'\ncli.azure.cli.core.sdk.policies:     'User-Agent': 'AZURECLI/2.76.0 (MSI) azsdk-python-core/1.35.0 Python/3.12.10 (Windows-10-10.0.19045-SP0)'\ncli.azure.cli.core.sdk.policies:     'Authorization': '*****'\ncli.azure.cli.core.sdk.policies: Request body:\ncli.azure.cli.core.sdk.policies: This request has no body\nurllib3.connectionpool: Starting new HTTPS connection (1): management.azure.com:443        \nurllib3.connectionpool: https://management.azure.com:443 \"GET /subscriptions/0dabaa0c-6aa7-4546-bb53-58efa390b365/resourceGroups/providers/Microsoft.Authorization/roleDefinitions?api-version=2022-05-01-preview HTTP/1.1\" 400 873\ncli.azure.cli.core.sdk.policies: Response status: 400\ncli.azure.cli.core.sdk.policies: Response headers:\ncli.azure.cli.core.sdk.policies:     'Cache-Control': 'no-cache'\ncli.azure.cli.core.sdk.policies:     'Pragma': 'no-cache'\ncli.azure.cli.core.sdk.policies:     'Content-Length': '873'\ncli.azure.cli.core.sdk.policies:     'Content-Type': 'application/json; charset=utf-8'     \ncli.azure.cli.core.sdk.policies:     'Expires': '-1'\ncli.azure.cli.core.sdk.policies:     'x-ms-failure-cause': 'gateway'\ncli.azure.cli.core.sdk.policies:     'x-ms-request-id': '9f10b3ab-22ae-4bef-aff9-d625b7f2cfc2'\ncli.azure.cli.core.sdk.policies:     'x-ms-correlation-request-id': '9f10b3ab-22ae-4bef-aff9-d625b7f2cfc2'\ncli.azure.cli.core.sdk.policies:     'x-ms-routing-request-id': 'WESTUS2:20250819T150436Z:9f10b3ab-22ae-4bef-aff9-d625b7f2cfc2'\ncli.azure.cli.core.sdk.policies:     'Strict-Transport-Security': 'max-age=31536000; includeSubDomains'\ncli.azure.cli.core.sdk.policies:     'X-Content-Type-Options': 'nosniff'\ncli.azure.cli.core.sdk.policies:     'X-Cache': 'CONFIG_NOCACHE'\ncli.azure.cli.core.sdk.policies:     'X-MSEdge-Ref': 'Ref A: CA855A72B4C54B5BBE0C5580F4D0944E Ref B: CO6AA3150219039 Ref C: 2025-08-19T15:04:36Z'\ncli.azure.cli.core.sdk.policies:     'Date': 'Tue, 19 Aug 2025 15:04:36 GMT'\ncli.azure.cli.core.sdk.policies: Response content:\ncli.azure.cli.core.sdk.policies: {\"error\":{\"code\":\"InvalidApiVersionParameter\",\"message\":\"The api-version '2022-05-01-preview' is invalid. The supported versions are '2025-04-01,2025-03-01,2024-10-01-preview,2024-11-01,2024-08-01,2024-07-01,2024-06-01-preview,2024-03-01,2023-07-01,2023-07-01-preview,2023-03-01-preview,2022-12-01,2022-11-01-preview,2022-09-01,2022-06-01,2022-05-01,2022-03-01-preview,2022-01-01,2021-04-01,2021-01-01,2020-10-01,2020-09-01,2020-08-01,2020-07-01,2020-06-01,2020-05-01,2020-01-01,2019-11-01,2019-10-01,2019-09-01,2019-08-01,2019-07-01,2019-06-01,2019-05-10,2019-05-01,2019-03-01,2018-11-01,2018-09-01,2018-08-01,2018-07-01,2018-06-01,2018-05-01,2018-02-01,2018-01-01,2017-12-01,2017-08-01,2017-06-01,2017-05-10,2017-05-01,2017-03-01,2016-09-01,2016-07-01,2016-06-01,2016-02-01,2015-11-01,2015-01-01,2014-04-01-preview,2014-04-01,2014-01-01,2013-03-01,2014-02-26,2014-04'.\"}}    \ncli.azure.cli.core.azclierror: Traceback (most recent call last):\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\knack/cli.py\", line 233, in invoke\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 666, in execute\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 734, in _run_jobs_serially\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 703, in _run_job\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 336, in __call__\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/command_operation.py\", line 120, in handler\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/command_modules/role/custom.py\", line 64, in list_role_definitions\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/command_modules/role/custom.py\", line 155, in _search_role_definitions\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/core/paging.py\", line 136, in __next__\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/core/paging.py\", line 82, in __next__\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/mgmt/authorization/v2022_05_01_preview/operations/_role_definitions_operations.py\", line 554, in get_next\nazure.core.exceptions.HttpResponseError: (InvalidApiVersionParameter) The api-version '2022-05-01-preview' is invalid. The supported versions are '2025-04-01,2025-03-01,2024-10-01-preview,2024-11-01,2024-08-01,2024-07-01,2024-06-01-preview,2024-03-01,2023-07-01,2023-07-01-preview,2023-03-01-preview,2022-12-01,2022-11-01-preview,2022-09-01,2022-06-01,2022-05-01,2022-03-01-preview,2022-01-01,2021-04-01,2021-01-01,2020-10-01,2020-09-01,2020-08-01,2020-07-01,2020-06-01,2020-05-01,2020-01-01,2019-11-01,2019-10-01,2019-09-01,2019-08-01,2019-07-01,2019-06-01,2019-05-10,2019-05-01,2019-03-01,2018-11-01,2018-09-01,2018-08-01,2018-07-01,2018-06-01,2018-05-01,2018-02-01,2018-01-01,2017-12-01,2017-08-01,2017-06-01,2017-05-10,2017-05-01,2017-03-01,2016-09-01,2016-07-01,2016-06-01,2016-02-01,2015-11-01,2015-01-01,2014-04-01-preview,2014-04-01,2014-01-01,2013-03-01,2014-02-26,2014-04'.\nCode: InvalidApiVersionParameter\nMessage: The api-version '2022-05-01-preview' is invalid. The supported versions are '2025-04-01,2025-03-01,2024-10-01-preview,2024-11-01,2024-08-01,2024-07-01,2024-06-01-preview,2024-03-01,2023-07-01,2023-07-01-preview,2023-03-01-preview,2022-12-01,2022-11-01-preview,2022-09-01,2022-06-01,2022-05-01,2022-03-01-preview,2022-01-01,2021-04-01,2021-01-01,2020-10-01,2020-09-01,2020-08-01,2020-07-01,2020-06-01,2020-05-01,2020-01-01,2019-11-01,2019-10-01,2019-09-01,2019-08-01,2019-07-01,2019-06-01,2019-05-10,2019-05-01,2019-03-01,2018-11-01,2018-09-01,2018-08-01,2018-07-01,2018-06-01,2018-05-01,2018-02-01,2018-01-01,2017-12-01,2017-08-01,2017-06-01,2017-05-10,2017-05-01,2017-03-01,2016-09-01,2016-07-01,2016-06-01,2016-02-01,2015-11-01,2015-01-01,2014-04-01-preview,2014-04-01,2014-01-01,2013-03-01,2014-02-26,2014-04'.\n\ncli.azure.cli.core.azclierror: (InvalidApiVersionParameter) The api-version '2022-05-01-preview' is invalid. The supported versions are '2025-04-01,2025-03-01,2024-10-01-preview,2024-11-01,2024-08-01,2024-07-01,2024-06-01-preview,2024-03-01,2023-07-01,2023-07-01-preview,2023-03-01-preview,2022-12-01,2022-11-01-preview,2022-09-01,2022-06-01,2022-05-01,2022-03-01-preview,2022-01-01,2021-04-01,2021-01-01,2020-10-01,2020-09-01,2020-08-01,2020-07-01,2020-06-01,2020-05-01,2020-01-01,2019-11-01,2019-10-01,2019-09-01,2019-08-01,2019-07-01,2019-06-01,2019-05-10,2019-05-01,2019-03-01,2018-11-01,2018-09-01,2018-08-01,2018-07-01,2018-06-01,2018-05-01,2018-02-01,2018-01-01,2017-12-01,2017-08-01,2017-06-01,2017-05-10,2017-05-01,2017-03-01,2016-09-01,2016-07-01,2016-06-01,2016-02-01,2015-11-01,2015-01-01,2014-04-01-preview,2014-04-01,2014-01-01,2013-03-01,2014-02-26,2014-04'.\nCode: InvalidApiVersionParameter\nMessage: The api-version '2022-05-01-preview' is invalid. The supported versions are '2025-04-01,2025-03-01,2024-10-01-preview,2024-11-01,2024-08-01,2024-07-01,2024-06-01-preview,2024-03-01,2023-07-01,2023-07-01-preview,2023-03-01-preview,2022-12-01,2022-11-01-preview,2022-09-01,2022-06-01,2022-05-01,2022-03-01-preview,2022-01-01,2021-04-01,2021-01-01,2020-10-01,2020-09-01,2020-08-01,2020-07-01,2020-06-01,2020-05-01,2020-01-01,2019-11-01,2019-10-01,2019-09-01,2019-08-01,2019-07-01,2019-06-01,2019-05-10,2019-05-01,2019-03-01,2018-11-01,2018-09-01,2018-08-01,2018-07-01,2018-06-01,2018-05-01,2018-02-01,2018-01-01,2017-12-01,2017-08-01,2017-06-01,2017-05-10,2017-05-01,2017-03-01,2016-09-01,2016-07-01,2016-06-01,2016-02-01,2015-11-01,2015-01-01,2014-04-01-preview,2014-04-01,2014-01-01,2013-03-01,2014-02-26,2014-04'.\naz_command_data_logger: (InvalidApiVersionParameter) The api-version '2022-05-01-preview' is invalid. The supported versions are '2025-04-01,2025-03-01,2024-10-01-preview,2024-11-01,2024-08-01,2024-07-01,2024-06-01-preview,2024-03-01,2023-07-01,2023-07-01-preview,2023-03-01-preview,2022-12-01,2022-11-01-preview,2022-09-01,2022-06-01,2022-05-01,2022-03-01-preview,2022-01-01,2021-04-01,2021-01-01,2020-10-01,2020-09-01,2020-08-01,2020-07-01,2020-06-01,2020-05-01,2020-01-01,2019-11-01,2019-10-01,2019-09-01,2019-08-01,2019-07-01,2019-06-01,2019-05-10,2019-05-01,2019-03-01,2018-11-01,2018-09-01,2018-08-01,2018-07-01,2018-06-01,2018-05-01,2018-02-01,2018-01-01,2017-12-01,2017-08-01,2017-06-01,2017-05-10,2017-05-01,2017-03-01,2016-09-01,2016-07-01,2016-06-01,2016-02-01,2015-11-01,2015-01-01,2014-04-01-preview,2014-04-01,2014-01-01,2013-03-01,2014-02-26,2014-04'.\nCode: InvalidApiVersionParameter\nMessage: The api-version '2022-05-01-preview' is invalid. The supported versions are '2025-04-01,2025-03-01,2024-10-01-preview,2024-11-01,2024-08-01,2024-07-01,2024-06-01-preview,2024-03-01,2023-07-01,2023-07-01-preview,2023-03-01-preview,2022-12-01,2022-11-01-preview,2022-09-01,2022-06-01,2022-05-01,2022-03-01-preview,2022-01-01,2021-04-01,2021-01-01,2020-10-01,2020-09-01,2020-08-01,2020-07-01,2020-06-01,2020-05-01,2020-01-01,2019-11-01,2019-10-01,2019-09-01,2019-08-01,2019-07-01,2019-06-01,2019-05-10,2019-05-01,2019-03-01,2018-11-01,2018-09-01,2018-08-01,2018-07-01,2018-06-01,2018-05-01,2018-02-01,2018-01-01,2017-12-01,2017-08-01,2017-06-01,2017-05-10,2017-05-01,2017-03-01,2016-09-01,2016-07-01,2016-06-01,2016-02-01,2015-11-01,2015-01-01,2014-04-01-preview,2014-04-01,2014-01-01,2013-03-01,2014-02-26,2014-04'.\ncli.knack.cli: Event: Cli.PostExecute [<function AzCliLogging.deinit_cmd_metadata_logging at 0x00000237A27EB420>]\naz_command_data_logger: exit code: 1\ncli.__main__: Command ran in 2.375 seconds (init: 0.789, invoke: 1.587)\ntelemetry.main: Begin splitting cli events and extra events, total events: 1\ntelemetry.client: Accumulated 0 events. Flush the clients.\ntelemetry.main: Finish splitting cli events and extra events, cli events: 1\ntelemetry.save: Save telemetry record of length 5547 in cache file under C:\\Users\\OR0096420\\.azure\\telemetry\\20250819080437074\ntelemetry.main: Begin creating telemetry upload process.\ntelemetry.process: Creating upload process: \"C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\python.exe C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\Lib\\site-packages\\azure\\cli\\telemetry\\__init__.pyc C:\\Users\\OR0096420\\.azure C:\\Users\\OR0096420\\.azure\\telemetry\\20250819080437074\"telemetry.process: Return from creating process 26312\ntelemetry.main: Finish creating telemetry upload process.\n\n### Expected behavior\n\nExpected a list of azure roles similar to PowerShell equivalent Get-AzRoleDefinition\n\n### Environment Summary\n\nPS C:\\Dev\\Visual Studio 2022\\AzureBicep> az version\n{\n  \"azure-cli\": \"2.76.0\",\n  \"azure-cli-core\": \"2.76.0\",\n  \"azure-cli-telemetry\": \"1.1.0\",\n  \"extensions\": {}\n}\n\n### Additional context\n\n_No response_",
      "solution": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #27239\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\nFor a temporary workaround, please specify `--resource-group` manually.\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/27239#issuecomment-1694903070\n- https://github.com/azure/azure-cli/issues/27239#issuecomment-1694926030\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
      "labels": [
        "question",
        "RBAC",
        "customer-reported",
        "Auto-Assign",
        "Azure CLI Team",
        "Similar-Issue",
        "Possible-Solution",
        "OKR Candidate"
      ],
      "created_at": "2025-08-19T15:07:24Z",
      "closed_at": "2026-01-31T12:30:17Z",
      "url": "https://github.com/Azure/azure-cli/issues/31964",
      "comments_count": 4
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32035,
      "title": "cant start az interactive",
      "problem": "### Describe the bug\n\nI cant start interactive session the other day it worked fine i uninstall/installed azure cli \n\n\n\n### Related command\n\naz interactive \n\n### Errors\n\nAn error occurred. Pip failed with status code 3221225477. Use --debug for more information.\n\n### Issue script & Debug output\n\ncli.azure.cli.core.azclierror: An error occurred. Pip failed with status code 3221225477. Use --debug for more information.\naz_command_data_logger: An error occurred. Pip failed with status code 3221225477. Use --debug for more information.\n\n### Expected behavior\n\ni just want interactive to work so i can practice \n\n### Environment Summary\n\n{\n  \"azure-cli\": \"2.76.0\",\n  \"azure-cli-core\": \"2.76.0\",\n  \"azure-cli-telemetry\": \"1.1.0\",\n  \"extensions\": {}\n}\n\n### Additional context\n\n_No response_",
      "solution": "Hi @VigelandzoonR, could you please run `az interactive --debug` and share the output? That\u2019ll help us better understand the issue.\n\n---\n\nSorry for the late reply. Please try the following workaround https://github.com/Azure/azure-cli/issues/30700#issuecomment-2608434206",
      "labels": [
        "Interactive",
        "question",
        "customer-reported",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2025-09-01T18:56:48Z",
      "closed_at": "2026-01-31T12:28:50Z",
      "url": "https://github.com/Azure/azure-cli/issues/32035",
      "comments_count": 7
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 31618,
      "title": "Az cli login with Bring Your Own AccessToken",
      "problem": "### Preconditions\n\n- [x] No need to upgrade Python SDK or the Python SDK is ready.\n\n### Related command\n\naz login --access-token <token>\naz group list\n\n### Resource Provider\n\nN/A\n\n### Description of Feature or Work Requested\n\nWe would like to be able to login az cli with an access token. All the subsequent ARM calls use this access token.\n\nThe caller ensures the token is not expired and issued for ARM operations.\n\n### Minimum API Version Required\n\nN/A\n\n### Swagger PR link / SDK link\n\nN/A\n\n### Request Example\n\n_No response_\n\n### Target Date\n\n2025-06-16\n\n### PM Contact\n\nmingxuli\n\n### Engineer Contact\n\nzhenqxu\n\n### Additional context\n\n_No response_",
      "solution": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #16459\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nEnhancement Proposal: \n1. `az login` should support either:\n   - `--access-token` argument which accepts an access token with permission:\n     ```\n     az login --access-token <access_token>\n     ```\n   - both `--access-token` (may not have permission) and `--subscription` which explicitly specifies the default subscription:\n     ```\n     az login --access-token <access_token> --subscription <subscription_id>\n     ```\n\n2. Each `az` command should support a global argument `--access-token` which can be used together with `--subscription` to invoke ARM request:\n   ```\n   az group list --access-token <access_token> --subscription <subscription_id>\n   ```\n\n3. Consume an environment variable `AZURE_CLI_ACCESS_TOKEN` so that all commands can use the same access token:\n   ```\n   export AZURE_CLI_ACCESS_TOKEN=<access_token>\n   az group list\n   ```\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/16459#issuecomment-756557470\n- https://github.com/azure/azure-cli/issues/16459#issuecomment-760649041\n- https://github.com/azure/azure-cli/issues/16459#issuecomment-871238465\n- https://github.com/azure/azure-cli/issues/16459#issuecomment-1078558013\n- https://github.com/azure/azure-cli/issues/16459#issuecomment-2073864349\n### Solution 2:\nLimitations:\n1. The access token usually expires after 1 hour. Users will have to log in again after it expires.\n2. The access token has a specific audience claim (`aud`), which means it can only be used on one resource. For example, if an ARM's access token is provided, Storage or Key Vault data-plane commands will fail as the audience doesn't match the resource.\n3. Directly manipulating access tokens is risky and can lead to credential leak.\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/16459#issuecomment-2073864349\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
      "labels": [
        "Account",
        "feature-request",
        "Auto-Assign",
        "Azure CLI Team",
        "Similar-Issue",
        "Possible-Solution",
        "OKR Candidate"
      ],
      "created_at": "2025-06-09T12:49:35Z",
      "closed_at": "2026-01-31T12:28:02Z",
      "url": "https://github.com/Azure/azure-cli/issues/31618",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 31514,
      "title": "Allow subscription selector to use advanced filter from the Azure portal",
      "problem": "**Related command**\n<!--- Please provide the related command with az {command} if you can, so that we can quickly route to the related team for help. --->\n`az login` / `az login --use-device-code`\n\n**Is your feature request related to a problem? Please describe.**\n<!--- A clear and concise description of what the problem is. Ex. I'm always frustrated when [...] --->\nIn the past I have disabled the subscription selector feature during CLI logins because I have too many available subscriptions, some completely irrelevant to my internal team. I don't believe I have control over access to these subscriptions. In the Azure portal, I can create and use an advanced filter to view certain subscriptions that are relevant. \n\n<img width=\"309\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/7ebe0e1e-8910-44a2-ad48-b5d0fcf1069c\" />\n\nI like the concept of the subscription selector, but there would be much less friction as a user if the CLI respected the active filter from the portal. Below is a view of my current subscription selector, where none of the subscriptions in view are relevant to my team or organization.\n\n<img width=\"1434\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/c7374008-248e-4f0a-9cca-b0c0d1225c2c\" />\n\n**Describe the solution you'd like**\n<!--- A clear and concise description of what you want to happen. --->\nThe `az login` command would utilize the active subscription filter that a user has set in the portal, and only display subscriptions matching the filter.\n\n**Describe alternatives you've considered**\n<!--- A clear and concise description of any alternative solutions or features you've considered. --->\nAn alternative could be adding a new `az configure` option alongside `core.login_experience_v2`. One option could be a boolean `core.use_portal_filter` or `core.advanced_subscription_filter`. Another option could be a string `core.default_subscriptions` or something along those lines that accepts a string of comma-separated subscription IDs.\n\n**Additional context**\n<!--- Add any other context or screenshots about the feature request here. --->\n",
      "solution": "Filtering the subscription list requires **dynamically updating the terminal content**. This is a difficult task as there is no reliable library to do this. The [`interactive`](https://github.com/Azure/azure-cli-extensions/tree/main/src/interactive) Azure CLI extension uses [`prompt_toolkit`](https://python-prompt-toolkit.readthedocs.io/en/master/) library for this job, but we have noticed different issues in different operation systems and terminals.\n\n> In the Azure portal, I can create and use an advanced filter to view certain subscriptions that are relevant.\n\nThis is because Azure Portal is a GUI tool. Using GUI to do this is easier and reasonable.\n\n> Below is a view of my current subscription selector, where none of the subscriptions in view are relevant to my team or organization.\n\nYou must have permissions to these subscriptions through RBAC, possibly inherited from groups you are in. It is not possible for Azure CLI to show subscriptions you cannot access.\n\n> One option could be a boolean `core.use_portal_filter`\n\nAzure Portal has its own server backend. Azure CLI as a pure client application cannot interact with Azure Portal's server backend.\n\n> `core.advanced_subscription_filter`\n\nThis is a possible solution, but we need to define the syntax of the subscription filter.\n\n> Another option could be a string `core.default_subscriptions` or something along those lines that accepts a string of comma-separated subscription IDs.\n\nThere can be only one default subscription. You may change the default subscription by `az account set`, so this `core.default_subscriptions` option is not really necessary.\n\n\n",
      "labels": [
        "Account",
        "feature-request",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2025-05-20T18:34:10Z",
      "closed_at": "2026-01-31T12:27:35Z",
      "url": "https://github.com/Azure/azure-cli/issues/31514",
      "comments_count": 2
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32721,
      "title": "az login stuckk",
      "problem": "### Describe the bug\n\nthis bug is getting me crazy \n\naz login --tenant <tenant> --debug\n\n\ni login by selecting my account and the command stopps at \n\nurllib3.connectionpool: Starting new HTTPS connection (1): login.microsoftonline.com:443\n\nand nothing else happens, what is happening? it suppose to redirect me to select subscription and more but now nothign else happens \n\n\n### Related command\n\naz login --tenant <tenant> --debug\n\n\n### Errors\n\nurllib3.connectionpool: Starting new HTTPS connection (1): login.microsoftonline.com:443\n\nstuck on that \nlast comand and nothign else happens \n\n### Issue script & Debug output\n\ni login by selecting my account and the command stopps at \n\nurllib3.connectionpool: Starting new HTTPS connection (1): login.microsoftonline.com:443\n\n\n### Expected behavior\n\nafter az ogin it should prompt me subscirption like it used \n\n### Environment Summary\n\n az version\n{\n  \"azure-cli\": \"2.82.0\",\n  \"azure-cli-core\": \"2.82.0\",\n  \"azure-cli-telemetry\": \"1.1.0\",\n  \"extensions\": {}\n}\n\n$ python\nPython 3.13.9 (tags/v3.13.9:8183fa5, Oct 14 2025, 14:09:13) [MSC v.1944 64 bit (AMD64)] on win32\n\npython location\n\nC:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\python.exe\n\n\n### Additional context\n\n_No response_",
      "solution": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #28548\n- #26786\n- #32447\n- #9852\n- #27796\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nDisabling IPv6 can resolve the issue. For example, on Ubuntu, you can disable IPv6 by following the steps outlined in this Stack Overflow post: https://stackoverflow.com/questions/57992691/pip-hangs-on-starting-new-https-connection. Users have reported that disabling IPv6 resolved the issue for them.\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/28548#issuecomment-2057585901\n- https://github.com/azure/azure-cli/issues/28548#issuecomment-2061601687\n- https://github.com/azure/azure-cli/issues/28548#issuecomment-2062259711\n- https://github.com/azure/azure-cli/issues/28548#issuecomment-2104598093\n- https://github.com/azure/azure-cli/issues/28548#issuecomment-2433637021\n- https://github.com/azure/azure-cli/issues/28548#issuecomment-2452595233\n- https://github.com/azure/azure-cli/issues/28548#issuecomment-2504957855\n- https://github.com/azure/azure-cli/issues/28548#issuecomment-2585671327\n### Solution 2:\nChanging the DNS server can also fix the issue. Reliable DNS servers like Cloudflare (1.1.1.1) or Google (8.8.8.8) have been reported to work. You can test this by running the following commands:\n```sh\nnslookup login.microsoftonline.com 1.1.1.1 # Cloudflare\nnslookup login.microsoftonline.com 8.8.8.8 # Google\nnslookup login.microsoftonline.com # Leave empty to use try DNS server (Comes from ISP -> Router -> Your device)\n```\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/28548#issuecomment-2888533126\n- https://github.com/azure/azure-cli/issues/28548#issuecomment-2888537505\n- https://github.com/azure/azure-cli/issues/28548#issuecomment-2888538856\n- https://github.com/azure/azure-cli/issues/28548#issuecomment-2960286004\n### Solution 3:\nFor Windows users, adjusting IPv6 prefix policies can help. Run the following commands in the command prompt:\n```cmd\nnetsh interface ipv6 show prefixpolicies\nnetsh interface ipv6 set prefixpolicy ::ffff:0:0/96 100 4\nnetsh interface ipv6 set prefix ::/96 60 3\nnetsh interface ipv6 reset\n```\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/28548#issuecomment-3185467068\n- https://github.com/azure/azure-cli/issues/28548#issuecomment-3715888851\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
      "labels": [
        "Account",
        "question",
        "customer-reported",
        "Auto-Assign",
        "Azure CLI Team",
        "Similar-Issue",
        "Possible-Solution",
        "Login"
      ],
      "created_at": "2026-01-30T04:51:56Z",
      "closed_at": "2026-01-30T05:09:57Z",
      "url": "https://github.com/Azure/azure-cli/issues/32721",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 29997,
      "title": "Management mode missing when updating managed app definition",
      "problem": "### Describe the bug\n\nI'm being unable to update a service catalog managed application definition with Azure CLI.\r\n\r\nThis is the command:\r\n\r\n```powershell\r\naz managedapp definition update --authorizations \"4aa80ae7-d586-49ad-9d05-968633f49551:8e3af657-a8ff-443c-a75c-2fe8c4bcb635\" --description \"This is a test\" --display-name \"Alnus Ama - Edit\" --lock-level \"ReadOnly\" --name \"alnusama\" --resource-group \"alnus-ama\" --package-file-uri \"https://alnusamaassets.blob.core.windows.net/appcontainer/app.zip\"\r\n```\r\n\r\nCommand execution fails as it's trying to override the application managed mode \"Managed\" with \"\\<null\\>\", as can be seen in the error details below.\n\n### Related command\n\naz managedapp definition update\n\n### Errors\n\n(ApplicationDefinitionApplicationManagementPolicyLockConflict) Modifying application management policy on existing application definition is not allowed, current application management mode is 'Managed' while request contains different mode '<null>'.\r\nCode: ApplicationDefinitionApplicationManagementPolicyLockConflict\r\nMessage: Modifying application management policy on existing application definition is not allowed, current application management mode is 'Managed' while request contains different mode '<null>'.\n\n### Issue script & Debug output\n\nhttps://pastebin.com/YrG7FDcp\n\n### Expected behavior\n\nCommand should keep application managed mode to \"Managed\".\n\n### Environment Summary\n\nazure-cli                         2.64.0\r\n\r\ncore                              2.64.0\r\ntelemetry                          1.1.0\r\n\r\nDependencies:\r\nmsal                              1.30.0\r\nazure-mgmt-resource               23.1.1\n\n### Additional context\n\nThis is the template export of the service catalog managed application definition, where it can be seen the managed policy mode \"Managed\":\r\n\r\n```json\r\n{\r\n    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n    \"contentVersion\": \"1.0.0.0\",\r\n    \"parameters\": {\r\n        \"applicationDefinitions_alnusama_name\": {\r\n            \"defaultValue\": \"alnusama\",\r\n            \"type\": \"String\"\r\n        }\r\n    },\r\n    \"variables\": {},\r\n    \"resources\": [\r\n        {\r\n            \"type\": \"Microsoft.Solutions/applicationDefinitions\",\r\n            \"apiVersion\": \"2021-07-01\",\r\n            \"name\": \"[parameters('applicationDefinitions_alnusama_name')]\",\r\n            \"location\": \"eastus\",\r\n            \"properties\": {\r\n                \"notificationPolicy\": {\r\n                    \"notificationEndpoints\": [\r\n                        {\r\n                            \"uri\": \"[concat('https://', parameters('applicationDefinitions_alnusama_name'), 'api.azurewebsites.net/api/webhook-listener')]\"\r\n                        }\r\n                    ]\r\n                },\r\n                \"lockingPolicy\": {\r\n                    \"allowedActions\": []\r\n                },\r\n                \"deploymentPolicy\": {\r\n                    \"deploymentMode\": \"Incremental\"\r\n                },\r\n                \"authorizations\": [\r\n                    {\r\n                        \"principalId\": \"4aa80ae7-d586-49ad-9d05-968633f49551\",\r\n                        \"roleDefinitionId\": \"8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"\r\n                    }\r\n                ],\r\n                \"isEnabled\": true,\r\n                \"lockLevel\": \"ReadOnly\",\r\n                \"managementPolicy\": {\r\n                    \"mode\": \"Managed\"\r\n                },\r\n                \"displayName\": \"Alnus AMA\",\r\n                \"description\": \"This is a test\",\r\n                \"artifacts\": [\r\n                    {\r\n                        \"name\": \"ApplicationResourceTemplate\",\r\n                        \"type\": \"Template\",\r\n                        \"uri\": \"https://amastorageprodus.blob.core.windows.net/applicationdefinitions/B635C_A68CB0E1B28449E19051F8D5C6485A3D_47D8F6796620BD259E01A435529751799D80ABE931737514FE95C217762B8122/aa2935f96d3c49539ce587380c771656/applicationResourceTemplate.json\"\r\n                    },\r\n                    {\r\n                        \"name\": \"CreateUiDefinition\",\r\n                        \"type\": \"Custom\",\r\n                        \"uri\": \"[concat('https://management.azure.com/subscriptions/a68cb0e1-b284-49e1-9051-f8d5c6485a3d/resourceGroups/alnus-ama/providers/Microsoft.Solutions/applicationDefinitions/', parameters('applicationDefinitions_alnusama_name'), '/applicationArtifacts/CreateUiDefinition?api-version=2017-09-01')]\"\r\n                    },\r\n                    {\r\n                        \"name\": \"MainTemplateParameters\",\r\n                        \"type\": \"Custom\",\r\n                        \"uri\": \"[concat('https://management.azure.com/subscriptions/a68cb0e1-b284-49e1-9051-f8d5c6485a3d/resourceGroups/alnus-ama/providers/Microsoft.Solutions/applicationDefinitions/', parameters('applicationDefinitions_alnusama_name'), '/applicationArtifacts/MainTemplateParameters?api-version=2017-09-01')]\"\r\n                    }\r\n                ]\r\n            }\r\n        }\r\n    ]\r\n}\r\n```",
      "solution": "BTW, related issue didn't help me solve the problem (#27976).",
      "labels": [
        "question",
        "ARM",
        "customer-reported",
        "Auto-Assign",
        "Azure CLI Team",
        "Similar-Issue",
        "OKR Candidate"
      ],
      "created_at": "2024-09-27T15:50:18Z",
      "closed_at": "2026-01-28T08:16:39Z",
      "url": "https://github.com/Azure/azure-cli/issues/29997",
      "comments_count": 4
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 30129,
      "title": "Azure CLI takes ages to download which become a huge problem for labs with that requirement",
      "problem": "### Describe the bug\n\nEven with an excellent connection, downloading the Azure CLI takes a very long time. It has always taken some time but I don't remember it to be so much time, it became a huge problem. The package is not that big but it takes for ever to be downloaded.\n\nIt's a problem because : \n- people get frustrated and give up installing the azure cli\n- for Microsoft Learn labs, internal workshops in companies or hands on a lab at conferences where Azure CLI is a prerequisite, it is nearly impossible to do the lab with such an download time\n\n### Related command\n\naz upgrade\n\n### Errors\n\nNo error, just a very low speed .\n\n### Issue script & Debug output\n\nN/A\n\n### Expected behavior\n\nI would expect the download speed rate to be \n\n### Environment Summary\n\nazure-cli                         2.65.0\n\ncore                              2.65.0\ntelemetry                          1.1.0\n\nExtensions:\ninit                               0.1.0\ninteractive                        0.5.3\nnext                               0.1.2\n\nDependencies:\nmsal                              1.31.0\nazure-mgmt-resource               23.1.1\n\nPython location 'C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\python.exe'\nExtensions directory 'C:\\Users\\*******\\.azure\\cliextensions'\n\nPython (Windows) 3.11.8 (tags/v3.11.8:db85d51, Feb  6 2024, 22:03:32) [MSC v.1937 64 bit (AMD64)]\n\n### Additional context\n\nI was installing 2.65.0 version",
      "solution": "Same as https://github.com/Azure/azure-cli/issues/19447\n\nAs a workaround, download from GitHub is much faster: https://github.com/Azure/azure-cli/releases",
      "labels": [
        "question",
        "customer-reported",
        "Upgrade",
        "Auto-Assign",
        "Azure CLI Team",
        "Auto-Resolve",
        "OKR Candidate"
      ],
      "created_at": "2024-10-18T13:16:12Z",
      "closed_at": "2026-01-28T08:14:50Z",
      "url": "https://github.com/Azure/azure-cli/issues/30129",
      "comments_count": 4
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 30617,
      "title": "WAM not working for Dogfood: AADSTS50011",
      "problem": "### Describe the bug\n\nI have created an Azure PPE tenant and I am able to login to Azure Dogfood portal(https://df.onecloud.azure-test.net/) with it. I am also able to login to Visual ARM with same tenant and call APIs etc. But when trying to login using az cli, I am getting below error. I have followed this document to setup az cli: https://armwiki.azurewebsites.net/rp_onboarding/testing/dogfood.html#azcli\n\n\n\n\n\n### Related command\n\n`az login`\n\n### Errors\n\n![Image](https://github.com/user-attachments/assets/46df0f8e-117b-4f77-891f-6add66aa32a2)\n\n### Issue script & Debug output\n\nCommand ran: `az login`\nError: Mentioned above\n\n### Expected behavior\n\naz login works successfully for dogfood\n\n### Environment Summary\n\nazure-cli                         2.67.0\n\ncore                              2.67.0\ntelemetry                          1.1.0\n\nExtensions:\nk8s-extension                      1.6.2\n\nDependencies:\nmsal                              1.31.0\nazure-mgmt-resource               23.1.1\n\nPython location 'C:\\Program Files (x86)\\Microsoft SDKs\\Azure\\CLI2\\python.exe'\nExtensions directory 'C:\\Users\\shivamkumar\\.azure\\cliextensions'\n\nPython (Windows) 3.12.7 (tags/v3.12.7:0b05ead, Oct  1 2024, 02:44:45) [MSC v.1941 32 bit (Intel)]\n\n### Additional context\n\n_No response_",
      "solution": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #13389\n------------\n\nPossible solution (Extracted from existing issue, might be incorrect; please verify carefully)\n\nCheck if there are any special settings in your environment that might be causing the issue, such as an incorrect endpoint. The endpoint in the log should not be `api-dogfood.resources.windows-int.net`. Please verify your environment settings.\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/13389#issuecomment-668464989\n\n---\n\nThe error is because `ms-appx-web://Microsoft.AAD.BrokerPlugin/04b07795-8ddb-461a-bbee-02f9e1bf7b46` is not registered as one of Azure CLI's redirect URIs in Dogfood/PPE environment.\n\n**Workaround**\nFor now, you may follow https://learn.microsoft.com/en-us/cli/azure/authenticate-azure-cli-interactively#sign-in-with-web-account-manager-wam-on-windows to turn off WAM.\n ",
      "labels": [
        "Account",
        "question",
        "customer-reported",
        "Auto-Assign",
        "Azure CLI Team",
        "Similar-Issue",
        "Possible-Solution",
        "OKR Candidate"
      ],
      "created_at": "2025-01-07T03:40:16Z",
      "closed_at": "2026-01-28T08:06:49Z",
      "url": "https://github.com/Azure/azure-cli/issues/30617",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 30632,
      "title": "Not able to az login: interaction_required: AADSTS5000224: We are sorry, this resource is not available.",
      "problem": "### Describe the bug\n\nSeeing the below error when i try to ```az login``` through my command prompt\n\n```\nAuthentication failed\ninteraction_required: AADSTS5000224: We are sorry, this resource is not available. If you are seeing this message by mistake, please contact Microsoft support. Trace ID: 50f2eece-db23-4d15-8ea7-9a6d5c592500 Correlation ID: 476ed242-8beb-410e-8224-b7354baf1e9f Timestamp: 2025-01-08 19:00:10Z. ($error_uri)\n\nYou can log an issue at [Azure CLI GitHub Repository](https://github.com/azure/azure-cli/issues) and we will assist you in resolving it.```\n\nI was able to access it previously properly.\n\n### Related command\n\naz login\n\n### Errors\n\n Trace ID: 50f2eece-db23-4d15-8ea7-9a6d5c592500 Correlation ID: 476ed242-8beb-410e-8224-b7354baf1e9f Timestamp: 2025-01-08 19:00:10Z\n\n### Issue script & Debug output\n\nAuthentication failed\ninteraction_required: AADSTS5000224: We are sorry, this resource is not available. If you are seeing this message by mistake, please contact Microsoft support. Trace ID: 50f2eece-db23-4d15-8ea7-9a6d5c592500 Correlation ID: 476ed242-8beb-410e-8224-b7354baf1e9f Timestamp: 2025-01-08 19:00:10Z. ($error_uri)\n\n### Expected behavior\n\nAble to auth and select appropriate subscription.\n\n### Environment Summary\n\n{\n  \"azure-cli\": \"2.40.0\",\n  \"azure-cli-core\": \"2.40.0\",\n  \"azure-cli-telemetry\": \"1.0.8\",\n  \"extensions\": {}\n}\n\n### Additional context\n\nAlways ready to hop on call if necessary to resolve the issue.",
      "solution": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #29082\n------------\n\nPossible solution (Extracted from existing issue, might be incorrect; please verify carefully)\n\nCould you try running `az login` with `--tenant {tenant_id}` and see if it still fails?\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/29082#issuecomment-2574656794",
      "labels": [
        "Account",
        "question",
        "Auto-Assign",
        "Azure CLI Team",
        "Auto-Resolve",
        "Similar-Issue",
        "Possible-Solution",
        "OKR Candidate"
      ],
      "created_at": "2025-01-09T16:31:11Z",
      "closed_at": "2026-01-28T08:06:31Z",
      "url": "https://github.com/Azure/azure-cli/issues/30632",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 30651,
      "title": "az login fails with `NativeCommandError` in Powershell ISE",
      "problem": "### Describe the bug\n\nwhen i try to do az login through my command it is showing like this az : WARNING: Select the account you want to log in with. For more information on login with Azure CLI, see https://go.microsoft.com/fwlink/?linkid=2271136\nAt line:29 char:1\n+ az login\n+ ~~~~~~~~\n    + CategoryInfo          : NotSpecified: (WARNING: Select...?linkid=2271136:String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError\n but when i do az login it is working i am using powershell ise\n\n### Related command\n\nthis is my powershell script #------------------------------------------------------------USER INPUT PART-------------------------------------------------------------------------------------------\n \n$ErrorActionPreference = \"Stop\"\n \n# Taking necessary credentials from User\ndo {\n    $tenantId = Read-Host 'Enter the Tenant Id'\n    if (!$tenantId) {\n        Write-Verbose -Message \"Tenant Id is Mandatory, Please input Tenant Id\" -Verbose\n    }\n} while (!$tenantId)\n \ndo {\n    $subscriptionId = Read-Host 'Enter the Subscription Id'\n    if (!$subscriptionId) {\n        Write-Verbose -Message \"SubscriptionId is Mandatory, Please input Subscription Id\" -Verbose\n    }\n} while (!$subscriptionId)\n \ndo {\n    $resourceGroupName = Read-Host 'Enter the Managed Resource Group Name'\n    if (!$resourceGroupName) {\n        Write-Verbose -Message \"Managed Resource Group Name is Mandatory, Please input Resource Group Name\" -Verbose\n    }\n} while (!$resourceGroupName)\n \necho 'Login to Azure with your azure login Id and password'\n \naz login\nConnect-AzAccount -Subscription $subscriptionId -Tenant $tenantId\naz account set --subscription $subscriptionId\n \n# Fetch All AKS Clusters in the Resource Group\n$clusters = Get-AzResource -ResourceGroupName $resourceGroupName -ResourceType \"Microsoft.ContainerService/managedClusters\"\n \nif (!$clusters) {\n    Write-Error \"No AKS clusters found in resource group $resourceGroupName\"\n    exit\n}\n \n# Loop Through Each Cluster and Apply Operations\nforeach ($cluster in $clusters) {\n    $clusterName = $cluster.Name\n    Write-Host \"Processing Cluster: $clusterName\"\n \n    # Fetch necessary resource names\n    $mc_resourceGroupName = \"MC_\" + $resourceGroupName + \"_\" + $clusterName + \"_\" + $cluster.Location\n \n    # Get Managed Identities\n    $userManagedIdentityName = $clusterName + \"managedidentity\"\n    $mc_managedIdentityName = $clusterName + \"_AksCluster-agentpool\"\n \n    $managedIdentities = Get-AzUserAssignedIdentity -ResourceGroupName $resourceGroupName -SubscriptionId $subscriptionId\n    $userManagedIdentity = $managedIdentities | Where-Object { $_.Name -eq $userManagedIdentityName }\n    $userManagedIdentityClientId = $userManagedIdentity.ClientId\n \n    # Assign Contributor Role for Managed Identity in MC Resource Group\n    $mc_identity = Get-AzUserAssignedIdentity -ResourceGroupName $mc_resourceGroupName -Name $mc_managedIdentityName\n    $mc_objectId = $mc_identity.PrincipalId\n \n    az role assignment create --role \"Contributor\" --assignee-object-id $mc_objectId --assignee-principal-type \"ServicePrincipal\" --scope \"/subscriptions/$subscriptionId/resourceGroups/$mc_resourceGroupName\"\n \n    # Assign Contributor Role for Managed Identity in AKS Cluster\n    $userManagedIdentityObjectId = $userManagedIdentity.PrincipalId\n    az role assignment create --role \"Contributor\" --assignee-object-id $userManagedIdentityObjectId --assignee-principal-type \"ServicePrincipal\" --scope \"/subscriptions/$subscriptionId/resourceGroups/$resourceGroupName/providers/Microsoft.ContainerService/managedClusters/$clusterName\"\n \n    # Assign Contributor Role for Service Principal in AKS Cluster\n    $appId = ($cluster.Properties | Where-Object { $_.Name -eq \"clientId\" }).Value\n    $servicePrincipal = Get-AzADServicePrincipal -ApplicationId $appId\n    $servicePrincipalObjectId = $servicePrincipal.Id\n \n    az role assignment create --role \"Contributor\" --assignee-object-id $servicePrincipalObjectId --assignee-principal-type \"ServicePrincipal\" --scope \"/subscriptions/$subscriptionId/resourceGroups/$resourceGroupName/providers/Microsoft.ContainerService/managedClusters/$clusterName\"\n \n    # Update VMSS with User-Assigned Managed Identity\n    $vmss = Get-AzVmss -ResourceGroupName $mc_resourceGroupName\n    $vmssName = $vmss.Name\n \n    Update-AzVmss -ResourceGroupName $mc_resourceGroupName -Name $vmssName -IdentityType UserAssigned -IdentityID $userManagedIdentity.Id\n \n    # Kubernetes YAML Deployment for Each Cluster\n    az aks get-credentials --resource-group $resourceGroupName --name $clusterName\n \n    # Kubernetes Managed Identity Definition\n    $definitionYaml = @\"\napiVersion: \"aadpodidentity.k8s.io/v1\"\nkind: AzureIdentity\nmetadata:\n  name: $userManagedIdentityName\nspec:\n  type: 0\n  resourceID: /subscriptions/$subscriptionId/resourcegroups/$resourceGroupName/providers/Microsoft.ManagedIdentity/userAssignedIdentities/$userManagedIdentityName\n  clientID: $userManagedIdentityClientId\n\"@\n \n    $bindingYaml = @\"\napiVersion: \"aadpodidentity.k8s.io/v1\"\nkind: AzureIdentityBinding\nmetadata:\n  name: ${userManagedIdentityName}-binding\nspec:\n  azureIdentity: $userManagedIdentityName\n  selector: $userManagedIdentityName\n\"@\n \n    kubectl apply -f https://raw.githubusercontent.com/Azure/aad-pod-identity/v1.8.14/deploy/infra/deployment-rbac.yaml\n    $definitionYaml | kubectl.exe apply -f -\n    $bindingYaml | kubectl.exe apply -f -\n \n    # Custom Deployment for Each Cluster\n    $deploymentYaml = @\"\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: plt-deployment-$clusterName\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: my-value\n  template:\n    metadata:\n      labels:\n        app: my-value\n        aadpodidbinding: $userManagedIdentityName\n    spec:\n      containers:\n      - name: my-app-container\n        image: powerbiload.azurecr.io/internaltestjob:latest\n        env:\n          - name: SQLSERVER\n            value: \"${serverName}.database.windows.net\"\n          - name: DATABASE\n            value: $databaseName\n          - name: MANAGEDIDENTITY\n            value: $userManagedIdentityName\n          - name: NODECOUNT\n            value: \"$kubeNodeCount\"\n          - name: SUBSCRIPTIONID\n            value: $subscriptionId\n          - name: RESOURCEGROUP\n            value: $resourceGroupName\n          - name: CLUSTERNAME\n            value: $clusterName\n\"@\n    $deploymentYaml | kubectl.exe apply -f -\n \n    Write-Host \"Cluster $clusterName processing completed.\"\n}\n \nWrite-Host \"All clusters have been processed.\"\n\n### Errors\n\naz : WARNING: Select the account you want to log in with. For more information on login with Azure CLI, see https://go.microsoft.com/fwlink/?linkid=2271136\nAt line:29 char:1\n+ az login\n+ ~~~~~~~~\n    + CategoryInfo          : NotSpecified: (WARNING: Select...?linkid=2271136:String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError\n \n\n### Issue script & Debug output\n\nit should login my account\n\n### Expected behavior\n\nit should login after selecting the account\n\n### Environment Summary\n\n![Image](https://github.com/user-attachments/assets/47cd52e4-3bde-4c25-81a8-1908d33eb0af)\n\n### Additional context\n\n_No response_",
      "solution": "(Removing AKS tag as the issue appears to be related to `az login` as opposed to any issue with `az aks`)\n\n@jatin318 checking in on the issue status to see if it should remain open - is this issue still occurring for you?",
      "labels": [
        "Account",
        "question",
        "RBAC",
        "ARM",
        "customer-reported",
        "needs-team-triage",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2025-01-14T05:17:38Z",
      "closed_at": "2026-01-28T08:04:06Z",
      "url": "https://github.com/Azure/azure-cli/issues/30651",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 23642,
      "title": "AZ LOGIN Concurrency",
      "problem": "> ### `az feedback` auto-generates most of the information requested below, as of CLI version 2.0.62\r\n\r\n**Related command**\r\n<!--- Please provide the related command with az {command} if you can, so that we can quickly route to the related team for help. --->\r\naz login \r\n\r\n**Describe the bug**\r\n<!--- A clear and concise description of what the bug is. --->\r\nConcurrently calling az login from a bash script that deploys multiple resources throws log in error.\r\n\r\n**To Reproduce**\r\n<!--- Steps to reproduce the behavior. --->\r\nHere is a sample script that checks for login:\r\nCall the following code multiple times for different deployments\r\n\r\n# Login to Azure\r\ncheckResult=$(az account show)\r\nenvironmentName=$(echo $checkResult | jq -r .environmentName)\r\n\r\n# If environmentName is empty, login\r\nif [[ -z \"$environmentName\" ]] \r\nthen\r\naz login --service-principal -u \"$ARM_CLIENT_ID\" -p \"$ARM_CLIENT_SECRET\" --tenant \"$ARM_TENANT_ID\" >> /dev/null\r\naz account set --subscription \"$ARM_SUBSCRIPTION_ID\"\r\nfi\r\n\r\n**Expected behavior**\r\n<!--- A clear and concise description of what you expected to happen. --->\r\nThread safe calls to az login from multiple threads?\r\n\r\n**Environment summary**\r\n<!--- Install Method (e.g. pip, interactive script, apt-get, Docker, MSI, edge build) / CLI version (`az --version`) / OS version / Shell Type (e.g. bash, cmd.exe, Bash on Windows)  --->\r\nBash script running on container (Ububtu:Xenial)\r\nCLI version v2.34.1 (March 3, 2022)\r\nCustomer is deploying multiple function apps using Terraform\r\n\r\n**Additional context**\r\n<!--- Add any other context about the problem here. --->\r\nMore than happy to share logs, sample code, deployment details if needed.",
      "solution": "Hi,\n\nThanks for triaging the issue. Would you please help us understand the next steps? We can send you the data / logs. Customer is willing to share  Terraform code and walk through it on short notice. It's a blocker for them and any help is appreciated!\n\nThanks,\nPrakash\n\nGet Outlook for iOS<https://aka.ms/o0ukef>\n________________________________\nFrom: Prakash Patel ***@***.***>\nSent: Tuesday, August 23, 2022 9:14:00 PM\nTo: Azure/azure-cli ***@***.***>; Azure/azure-cli ***@***.***>; Shamra Gibson ***@***.***>; Ashley Grant ***@***.***>\nCc: Author ***@***.***>\nSubject: Re: [Azure/azure-cli] AZ LOGIN Concurrency (Issue #23642)\n\nThanks! Adding account team for awareness.\n\nThanks,\nPrakash\n\nGet Outlook for iOS<https://aka.ms/o0ukef>\n________________________________\nFrom: Yong Zhang ***@***.***>\nSent: Tuesday, August 23, 2022 7:49:36 PM\nTo: Azure/azure-cli ***@***.***>\nCc: Prakash Patel ***@***.***>; Author ***@***.***>\nSubject: Re: [Azure/azure-cli] AZ LOGIN Concurrency (Issue #23642)\n\n\n@jiasli<https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fjiasli&data=05%7C01%7Cprakash.patel%40microsoft.com%7Cdecc23176ced4b57020e08da856a8510%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C637968989792883252%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=5qumv268kcX%2BHjYUqPAlhmjpaE02P9uwxFMa%2Fm4pzHo%3D&reserved=0> for awareness\n\n\u2014\nReply to this email directly, view it on GitHub<https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2FAzure%2Fazure-cli%2Fissues%2F23642%23issuecomment-1225036848&data=05%7C01%7Cprakash.patel%40microsoft.com%7Cdecc23176ced4b57020e08da856a8510%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C637968989792883252%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=0GK7neljZAmXljpMbWJCruAD0YSO5zqRD7%2BNyzmWykw%3D&reserved=0>, or unsubscribe<https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fnotifications%2Funsubscribe-auth%2FANCS6FECU3H47DN2HLUCXE3V2VWSBANCNFSM57L7TSAA&data=05%7C01%7Cprakash.patel%40microsoft.com%7Cdecc23176ced4b57020e08da856a8510%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C637968989792883252%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=TCkzOzatT%2F7LpnRMRmTl313zaxZtcp3WqthrLR54mcg%3D&reserved=0>.\nYou are receiving this because you authored the thread.Message ID: ***@***.***>\n\n\n---\n\n@jiasli We have code that is supposed to check if the token is already there...\r\n\r\n`# Login to Azure\r\ncheckResult=$(az account show)\r\nenvironmentName=$(echo $checkResult | jq -r .environmentName)\r\n\r\n# If environmentName is empty, login\r\nif [[ -z \"$environmentName\" ]] \r\nthen\r\naz login --service-principal -u \"$ARM_CLIENT_ID\" -p \"$ARM_CLIENT_SECRET\" --tenant \"$ARM_TENANT_ID\" >> /dev/null\r\naz account set --subscription \"$ARM_SUBSCRIPTION_ID\"\r\nfi`\r\n\r\nBut it still fails roughly 50% of the time. And I don't believe the AZURE_CONFIG_DIR solution will work as they are the same login on the same machine. If az cli allowed us to specify the config dir for each thread somehow, maybe. ",
      "labels": [
        "Account",
        "Installation",
        "feature-request",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2022-08-23T15:39:34Z",
      "closed_at": "2026-01-27T14:07:07Z",
      "url": "https://github.com/Azure/azure-cli/issues/23642",
      "comments_count": 13
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32657,
      "title": "az storage command not work properly",
      "problem": "### Describe the bug\n\nFailed to az blob delete policy and create file share.  Had issue with most of storage account releated commands.\n\n### Related command\n\naz storage blob service-properties delete-policy update --account-name $app_storage_account --enable true --days-retained 7 --account-key $app_account_key\n\nAlso for az storage share create --name $share --account-name $app_storage_account --account-key $app_account_key \n\n### Errors\n\nThe specified resource does not exist.\nRequestId:62e2d98d-d01e-002c-1b03-87397c000000\nTime:2026-01-16T16:13:46.6566053Z\nErrorCode:ResourceNotFound\n\n### Issue script & Debug output\n\n[debug.txt](https://github.com/user-attachments/files/24676255/debug.txt)\n\n### Expected behavior\n\nit should delete policy and proceed further\n\n### Environment Summary\n\n\nazure-cli                         2.82.0\n\ncore                              2.82.0\ntelemetry                          1.1.0\n\nDependencies:\nmsal                            1.34.0b1\nazure-mgmt-resource               23.3.0\n\nPython location 'C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\python.exe'\nConfig directory 'C:\\Users\\vummidi\\.azure'\nExtensions directory 'C:\\Users\\vummidi\\.azure\\cliextensions'\n\nPython (Windows) 3.13.9 (tags/v3.13.9:8183fa5, Oct 14 2025, 14:09:13) [MSC v.1944 64 bit (AMD64)]\n\nLegal docs and information: aka.ms/AzureCliLegal\n\n\nYour CLI is up-to-date.\n\n### Additional context\n\n_No response_",
      "solution": "It seems problem resolved. now it work. It seems issue from azure environment.\n\n---\n\nNo idea what was the issue. We are using shell script git lab. which delete the storage account wait for some time and recreated it for function app deployment.We are following this for more than one year. For recent one week, we are frequently getting this issue, when recreate new resource it wont work. But same script works for few hour.  No idea is there any traffic. Also I am westeruope region.\n \"targetSwapSlot\": null,\n  \"trafficManagerHostNames\": null,\n  \"type\": \"Microsoft.Web/sites\",\n  \"usageState\": \"Normal\",\n  \"virtualNetworkSubnetId\": null,\n  \"workloadProfileName\": null\n}\nERROR: The specified resource does not exist.\nRequestId:0eaa475d-301a-004f-7839-8d01db000000\nTime:2026-01-24T13:55:38.5956041Z\nErrorCode:ResourceNotFound\n\nToday also same issue. This is for new function app creation.\n      # delete current function apps\n      - az functionapp delete --name $app_name --resource-group $rg || echo \"Function app $app_name does not exist, skipping delete\"\n      - sleep 20\n      # delete app service plan\n      - az appservice plan delete --name $service_plan_name --resource-group $rg --yes || echo \"App Service Plan $service_plan_name does not exist, skipping delete..\"\n      - sleep 20\n      # enable dynamic installation without prompting\n      - az config set extension.use_dynamic_install=yes_without_prompt\n      # delete app-insights (for monitoring, performance etc.)\n      - az monitor app-insights component delete --app $app_name --resource-group $rg || echo \"App Insights for $app_name does not exist, skipping delete\"\n      - sleep 60\n      # delete dedicated storage account for azure function apps\n      - az storage account delete --name $app_account --resource-group $rg --yes\n      - sleep 120",
      "labels": [
        "Storage",
        "question",
        "customer-reported",
        "Auto-Assign",
        "Azure CLI Team",
        "Similar-Issue",
        "OKR Candidate"
      ],
      "created_at": "2026-01-16T16:37:41Z",
      "closed_at": "2026-01-17T00:25:26Z",
      "url": "https://github.com/Azure/azure-cli/issues/32657",
      "comments_count": 7
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 31797,
      "title": "Az cli error 'No module named 'msrestazure''",
      "problem": "### Describe the bug\n\nWhen running the following command, az cli errors off with the traceback: No module named 'msrestazure'\n\n`az aks list -o table`\n\n### Related command\n\naz aks list -o table\n\n### Errors\n\nThe command failed with an unexpected error. Here is the traceback:\nNo module named 'msrestazure'\nTraceback (most recent call last):\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/knack/cli.py\", line 233, in invoke\n    cmd_result = self.invocation.execute(args)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/commands/__init__.py\", line 564, in execute\n    self.commands_loader.load_arguments(command)\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/__init__.py\", line 552, in load_arguments\n    self.command_table[command].load_arguments()  # this loads the arguments via reflection\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/commands/__init__.py\", line 321, in load_arguments\n    super().load_arguments()\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/knack/commands.py\", line 104, in load_arguments\n    cmd_args = self.arguments_loader()\n               ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/commands/command_operation.py\", line 124, in arguments_loader\n    op = self.get_op_handler(self.op_path)\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/commands/command_operation.py\", line 59, in get_op_handler\n    handler = import_module(mod_to_import)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/importlib/__init__.py\", line 90, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<frozen importlib._bootstrap>\", line 1387, in _gcd_import\n  File \"<frozen importlib._bootstrap>\", line 1360, in _find_and_load\n  File \"<frozen importlib._bootstrap>\", line 1331, in _find_and_load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 935, in _load_unlocked\n  File \"<frozen importlib._bootstrap_external>\", line 999, in exec_module\n  File \"<frozen importlib._bootstrap>\", line 488, in _call_with_frames_removed\n  File \"/Users/USERNAME/.azure/cliextensions/aks-preview/azext_aks_preview/custom.py\", line 61, in <module>\n    from azext_aks_preview._podidentity import (\n  File \"/Users/USERNAME/.azure/cliextensions/aks-preview/azext_aks_preview/_podidentity.py\", line 16, in <module>\n    from azext_aks_preview._roleassignments import add_role_assignment\n  File \"/Users/USERNAME/.azure/cliextensions/aks-preview/azext_aks_preview/_roleassignments.py\", line 18, in <module>\n    from msrestazure.azure_exceptions import CloudError\nModuleNotFoundError: No module named 'msrestazure'\n\n### Issue script & Debug output\n\ncli.knack.cli: Command arguments: ['aks', 'list', '-o', 'table', '--debug']\ncli.knack.cli: __init__ debug log:\nEnable color in terminal.\ncli.knack.cli: Event: Cli.PreExecute []\ncli.knack.cli: Event: CommandParser.OnGlobalArgumentsCreate [<function CLILogging.on_global_arguments at 0x102d4b2e0>, <function OutputProducer.on_global_arguments at 0x1030b8360>, <function CLIQuery.on_global_arguments at 0x1030d9b20>]\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableCreate []\ncli.azure.cli.core: Modules found from index for 'aks': ['azext_aks_preview', 'azure.cli.command_modules.acs', 'azure.cli.command_modules.serviceconnector']\ncli.azure.cli.core: Loading command modules:\ncli.azure.cli.core: Name                  Load Time    Groups  Commands\ncli.azure.cli.core: acs                       0.065        15        79\ncli.azure.cli.core: serviceconnector          0.053        20       331\ncli.azure.cli.core: Total (2)                 0.118        35       410\ncli.azure.cli.core: These extensions are not installed and will be skipped: ['azext_ai_examples', 'azext_next']\ncli.azure.cli.core: Loading extensions:\ncli.azure.cli.core: Name                  Load Time    Groups  Commands  Directory\ncli.knack.cli: Event: CommandLoader.OnLoadCommandTable []\ncli.azure.cli.core: aks-preview               0.005        18        91  /Users/USERNAME/.azure/cliextensions/aks-preview\ncli.azure.cli.core: Total (1)                 0.005        18        91  \ncli.azure.cli.core: Loaded 39 groups, 434 commands.\ncli.azure.cli.core: Found a match in the command table.\ncli.azure.cli.core: Raw command  : aks list\ncli.azure.cli.core: Command table: aks list\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableTruncate [<function AzCliLogging.init_command_file_logging at 0x104507ba0>]\ncli.azure.cli.core.azlogging: metadata file logging enabled - writing logs to '/Users/USERNAME/.azure/commands/2025-07-11.21-39-24.aks_list.99203.log'.\naz_command_data_logger: command args: aks list -o {} --debug\ncli.knack.cli: Event: CommandInvoker.OnPreArgumentLoad [<function register_global_subscription_argument.<locals>.add_subscription_parameter at 0x1045587c0>]\ncli.azure.cli.core.azclierror: Traceback (most recent call last):\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/knack/cli.py\", line 233, in invoke\n    cmd_result = self.invocation.execute(args)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/commands/__init__.py\", line 564, in execute\n    self.commands_loader.load_arguments(command)\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/__init__.py\", line 552, in load_arguments\n    self.command_table[command].load_arguments()  # this loads the arguments via reflection\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/commands/__init__.py\", line 321, in load_arguments\n    super().load_arguments()\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/knack/commands.py\", line 104, in load_arguments\n    cmd_args = self.arguments_loader()\n               ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/commands/command_operation.py\", line 124, in arguments_loader\n    op = self.get_op_handler(self.op_path)\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/commands/command_operation.py\", line 59, in get_op_handler\n    handler = import_module(mod_to_import)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/importlib/__init__.py\", line 90, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<frozen importlib._bootstrap>\", line 1387, in _gcd_import\n  File \"<frozen importlib._bootstrap>\", line 1360, in _find_and_load\n  File \"<frozen importlib._bootstrap>\", line 1331, in _find_and_load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 935, in _load_unlocked\n  File \"<frozen importlib._bootstrap_external>\", line 999, in exec_module\n  File \"<frozen importlib._bootstrap>\", line 488, in _call_with_frames_removed\n  File \"/Users/USERNAME/.azure/cliextensions/aks-preview/azext_aks_preview/custom.py\", line 61, in <module>\n    from azext_aks_preview._podidentity import (\n  File \"/Users/USERNAME/.azure/cliextensions/aks-preview/azext_aks_preview/_podidentity.py\", line 16, in <module>\n    from azext_aks_preview._roleassignments import add_role_assignment\n  File \"/Users/USERNAME/.azure/cliextensions/aks-preview/azext_aks_preview/_roleassignments.py\", line 18, in <module>\n    from msrestazure.azure_exceptions import CloudError\nModuleNotFoundError: No module named 'msrestazure'\n\ncli.azure.cli.core.azclierror: The command failed with an unexpected error. Here is the traceback:\naz_command_data_logger: The command failed with an unexpected error. Here is the traceback:\ncli.azure.cli.core.azclierror: No module named 'msrestazure'\nTraceback (most recent call last):\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/knack/cli.py\", line 233, in invoke\n    cmd_result = self.invocation.execute(args)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/commands/__init__.py\", line 564, in execute\n    self.commands_loader.load_arguments(command)\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/__init__.py\", line 552, in load_arguments\n    self.command_table[command].load_arguments()  # this loads the arguments via reflection\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/commands/__init__.py\", line 321, in load_arguments\n    super().load_arguments()\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/knack/commands.py\", line 104, in load_arguments\n    cmd_args = self.arguments_loader()\n               ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/commands/command_operation.py\", line 124, in arguments_loader\n    op = self.get_op_handler(self.op_path)\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/commands/command_operation.py\", line 59, in get_op_handler\n    handler = import_module(mod_to_import)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/importlib/__init__.py\", line 90, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<frozen importlib._bootstrap>\", line 1387, in _gcd_import\n  File \"<frozen importlib._bootstrap>\", line 1360, in _find_and_load\n  File \"<frozen importlib._bootstrap>\", line 1331, in _find_and_load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 935, in _load_unlocked\n  File \"<frozen importlib._bootstrap_external>\", line 999, in exec_module\n  File \"<frozen importlib._bootstrap>\", line 488, in _call_with_frames_removed\n  File \"/Users/USERNAME/.azure/cliextensions/aks-preview/azext_aks_preview/custom.py\", line 61, in <module>\n    from azext_aks_preview._podidentity import (\n  File \"/Users/USERNAME/.azure/cliextensions/aks-preview/azext_aks_preview/_podidentity.py\", line 16, in <module>\n    from azext_aks_preview._roleassignments import add_role_assignment\n  File \"/Users/USERNAME/.azure/cliextensions/aks-preview/azext_aks_preview/_roleassignments.py\", line 18, in <module>\n    from msrestazure.azure_exceptions import CloudError\nModuleNotFoundError: No module named 'msrestazure'\naz_command_data_logger: No module named 'msrestazure'\nTraceback (most recent call last):\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/knack/cli.py\", line 233, in invoke\n    cmd_result = self.invocation.execute(args)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/commands/__init__.py\", line 564, in execute\n    self.commands_loader.load_arguments(command)\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/__init__.py\", line 552, in load_arguments\n    self.command_table[command].load_arguments()  # this loads the arguments via reflection\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/commands/__init__.py\", line 321, in load_arguments\n    super().load_arguments()\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/knack/commands.py\", line 104, in load_arguments\n    cmd_args = self.arguments_loader()\n               ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/commands/command_operation.py\", line 124, in arguments_loader\n    op = self.get_op_handler(self.op_path)\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/core/commands/command_operation.py\", line 59, in get_op_handler\n    handler = import_module(mod_to_import)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/importlib/__init__.py\", line 90, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<frozen importlib._bootstrap>\", line 1387, in _gcd_import\n  File \"<frozen importlib._bootstrap>\", line 1360, in _find_and_load\n  File \"<frozen importlib._bootstrap>\", line 1331, in _find_and_load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 935, in _load_unlocked\n  File \"<frozen importlib._bootstrap_external>\", line 999, in exec_module\n  File \"<frozen importlib._bootstrap>\", line 488, in _call_with_frames_removed\n  File \"/Users/USERNAME/.azure/cliextensions/aks-preview/azext_aks_preview/custom.py\", line 61, in <module>\n    from azext_aks_preview._podidentity import (\n  File \"/Users/USERNAME/.azure/cliextensions/aks-preview/azext_aks_preview/_podidentity.py\", line 16, in <module>\n    from azext_aks_preview._roleassignments import add_role_assignment\n  File \"/Users/USERNAME/.azure/cliextensions/aks-preview/azext_aks_preview/_roleassignments.py\", line 18, in <module>\n    from msrestazure.azure_exceptions import CloudError\nModuleNotFoundError: No module named 'msrestazure'\nTo check existing issues, please visit: https://github.com/Azure/azure-cli/issues\ncli.knack.cli: Event: Cli.PostExecute [<function AzCliLogging.deinit_cmd_metadata_logging at 0x104507e20>]\naz_command_data_logger: exit code: 1\ncli.__main__: Command ran in 0.474 seconds (init: 0.162, invoke: 0.312)\ntelemetry.main: Begin splitting cli events and extra events, total events: 1\ntelemetry.client: Accumulated 0 events. Flush the clients.\ntelemetry.main: Finish splitting cli events and extra events, cli events: 1\ntelemetry.save: Save telemetry record of length 7983 in cache file under /Users/USERNAME/.azure/telemetry/20250711213924752\ntelemetry.main: Begin creating telemetry upload process.\ntelemetry.process: Creating upload process: \"/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/bin/python /opt/homebrew/Cellar/azure-cli/2.75.0/libexec/lib/python3.12/site-packages/azure/cli/telemetry/__init__.py /Users/USERNAME/.azure /Users/USERNAME/.azure/telemetry/20250711213924752\"\ntelemetry.process: Return from creating process 99208\ntelemetry.main: Finish creating telemetry upload process.\n\n### Expected behavior\n\nWhen running the command, it is expected that the output would be a list of all the in-scoped aks clusters.\n\n### Environment Summary\n\nazure-cli                         2.75.0\n\ncore                              2.75.0\ntelemetry                          1.1.0\n\nExtensions:\naccount                            0.2.5\naks-preview                      1.0.0b1\nazure-devops                       1.0.0\nmanagementpartner                  0.1.3\npartnercenter                      0.2.4\nresource-graph                     2.1.0\nssh                                2.0.2\n\nDependencies:\nmsal                            1.33.0b1\nazure-mgmt-resource               23.3.0\n\nPython location '/opt/homebrew/Cellar/azure-cli/2.75.0/libexec/bin/python'\nConfig directory '/Users/USERNAME/.azure'\nExtensions directory '/Users/USERNAME/.azure/cliextensions'\n\nPython (Darwin) 3.12.11 (main, Jun  3 2025, 15:41:47) [Clang 17.0.0 (clang-1700.0.13.3)]\n\n### Additional context\n\nThis error began after upgrading to this version of az cli with brew",
      "solution": "This was a blocker on all my devices included hosted ci/cd pipelines. WIndows, Linux and MacOS systems with arm64 and amd64 architecture (i only used the mac to post here).\n\nTrying to upgrade the extension errored with the cli stating that it was already at the highest level (lies.com).\n\nReinstalling the cli did not fix the issue. Neither did reinstalling the extension.\n\nApparently there are breaking changes and no proper cli help text. Only thing that worked for me was using dynamic install and it was needed for some pipeline workflows (the entire aks sub-command errored like this)\n\n---\n\nClosing this issue since updating the az cli / updating the ssh extension / @julianm-lrj's workaround seem to fix it. If folks are still getting this issue on fresh installs of the latest az version, please reopen / tag me. Thank you!\n\n---\n\n> Updating ssh extension to 2.06 seems to fix it for me\n> \n> https://github.com/Azure/azure-cli-extensions/blob/main/src/ssh/HISTORY.md\n\nRunning `az extension update --name ssh` fixed it for me",
      "labels": [
        "bug",
        "Service Attention",
        "AKS",
        "customer-reported",
        "Auto-Assign"
      ],
      "created_at": "2025-07-12T02:04:36Z",
      "closed_at": "2025-09-08T20:40:53Z",
      "url": "https://github.com/Azure/azure-cli/issues/31797",
      "comments_count": 13
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 30075,
      "title": "Missing `--ssh-access disabled` in `az aks update`",
      "problem": "### Describe the bug\n\nIn the official document, there is a statement to disable ssh by default for new nodepools:\n![Image](https://github.com/user-attachments/assets/7665c4f7-f48c-4f99-af6c-921aec4bdea7)\nSrc: https://learn.microsoft.com/en-us/azure/aks/manage-ssh-node-access#disable-ssh-on-an-existing-cluster\n\nBut it is missing in the `az-cli` in current version. Can you confirm is it document bug or `az-cli` issue?\n\n\n\n### Related command\n\n`az aks update --ssh-access disabled`\n\n### Errors\n\n```bash\naz aks update -n ${aks} -g ${rG} --ssh-access disabled \nunrecognized arguments: --ssh-access disabled\n```\n\n### Issue script & Debug output\n\n```bash\naz aks update -n ${aks} -g ${rG} --ssh-access disabled --debug\ncli.knack.cli: Command arguments: ['aks', 'update', '-n', 'aks', '-g', 'aks', '--ssh-access', 'disabled', '--debug']\ncli.knack.cli: __init__ debug log:\nEnable color in terminal.\ncli.knack.cli: Event: Cli.PreExecute []\ncli.knack.cli: Event: CommandParser.OnGlobalArgumentsCreate [<function CLILogging.on_global_arguments at 0x7fa0fc7c91f0>, <function OutputProducer.on_global_arguments at 0x7fa0fc68ab80>, <function CLIQuery.on_global_arguments at 0x7fa0fc624160>]\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableCreate []\ncli.azure.cli.core: Modules found from index for 'aks': ['azext_aks_preview', 'azure.cli.command_modules.acs', 'azure.cli.command_modules.serviceconnector']\ncli.azure.cli.core: Loading command modules:\ncli.azure.cli.core: Name                  Load Time    Groups  Commands\ncli.azure.cli.core: acs                       0.049        14        77\ncli.azure.cli.core: serviceconnector          0.104        20       309\ncli.azure.cli.core: Total (2)                 0.153        34       386\ncli.azure.cli.core: These extensions are not installed and will be skipped: ['azext_next']\ncli.azure.cli.core: Loading extensions:\ncli.azure.cli.core: Name                  Load Time    Groups  Commands  Directory\ncli.azure.cli.core: ai-examples               0.142         1         1  /usr/lib/python3.9/site-packages/azure-cli-extensions/ai-examples\ncli.knack.cli: Event: CommandLoader.OnLoadCommandTable []\ncli.azure.cli.core: aks-preview               0.008        21        95  /home/joey/.azure/cliextensions/aks-preview\ncli.azure.cli.core: Total (2)                 0.150        22        96  \ncli.azure.cli.core: Loaded 43 groups, 416 commands.\ncli.azure.cli.core: Found a match in the command table.\ncli.azure.cli.core: Raw command  : aks update\ncli.azure.cli.core: Command table: aks update\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableTruncate [<function AzCliLogging.init_command_file_logging at 0x7fa0fba81790>]\ncli.azure.cli.core.azlogging: metadata file logging enabled - writing logs to '/home/joey/.azure/commands/2024-10-14.03-27-32.aks_update.2677.log'.\naz_command_data_logger: command args: aks update -n {} -g {} --ssh-access {} --debug\ncli.knack.cli: Event: CommandInvoker.OnPreArgumentLoad [<function register_global_subscription_argument.<locals>.add_subscription_parameter at 0x7fa0fbaab4c0>]\ncli.knack.cli: Event: CommandLoader.OnLoadArguments []\ncli.knack.cli: Event: CommandInvoker.OnPostArgumentLoad []\ncli.knack.cli: Event: CommandInvoker.OnPostCommandTableCreate [<function register_ids_argument.<locals>.add_ids_arguments at 0x7fa0fba504c0>, <function register_cache_arguments.<locals>.add_cache_arguments at 0x7fa0fba6e3a0>, <function register_upcoming_breaking_change_info.<locals>.update_breaking_change_info at 0x7fa0fba6e430>]\ncli.knack.cli: Event: CommandInvoker.OnCommandTableLoaded []\ncli.knack.cli: Event: CommandInvoker.OnPreParseArgs []\ncli.azure.cli.core.command_recommender: \"--ssh-access\" is an invalid parameter for command \"aks update\".\nurllib3.connectionpool: Starting new HTTPS connection (1): app.aladdin.microsoft.com:443\nurllib3.connectionpool: https://app.aladdin.microsoft.com:443 \"GET /api/v1.0/suggestions?query=%7B%22command%22%3A+%22aks+update%22%2C+%22parameters%22%3A+%22%22%7D&clientType=AzureCli&context=%7B%22versionNumber%22%3A+%222.65.0%22%2C+%22errorType%22%3A+%22UnrecognizedArguments%22%2C+%22correlationId%22%3A+%22092007db-171a-4b54-aa67-e0581b935e30%22%2C+%22subscriptionId%22%3A+%2250c2e135-4f3e-4840-ae8c-610d7b5dc9f7%22%2C+%22eventId%22%3A+%221953ad55-7561-4f9d-ae6b-1b31a0544310%22%7D HTTP/1.1\" 200 None\ncli.azure.cli.core.command_recommender: \"--ssh-access\" is an invalid parameter for command \"aks update\".\ncli.azure.cli.core.azclierror: NoneType: None\n\ncli.azure.cli.core.azclierror: unrecognized arguments: --ssh-access disabled\naz_command_data_logger: unrecognized arguments: --ssh-access disabled\n```\n\n### Expected behavior\n\nThe argument should exists, or fix the document instead.\n\n### Environment Summary\n\n```text\nazure-cli                         2.65.0\n\ncore                              2.65.0\ntelemetry                          1.1.0\n\nExtensions:\nai-examples                        0.2.5\naks-preview                      9.0.0b6\nml                                2.30.1\nssh                                2.0.5\n\nDependencies:\nmsal                              1.31.0\nazure-mgmt-resource               23.1.1\n\nPython location '/usr/bin/python3.9'\nExtensions directory '/home/joey/.azure/cliextensions'\nExtensions system directory '/usr/lib/python3.9/site-packages/azure-cli-extensions'\n\nPython (Linux) 3.9.19 (main, Aug 23 2024, 00:07:48) \n[GCC 11.2.0]\n\nLegal docs and information: aka.ms/AzureCliLegal\n\n\nYour CLI is up-to-date.\n```\n\n### Additional context\n\n_No response_",
      "solution": "From [the AKS Preview History notes](https://github.com/Azure/azure-cli-extensions/blob/main/src/aks-preview/HISTORY.rst#900b1), it says:\n\"[BREAKING CHANGE]: Remove support for `az aks update --ssh-access` command to avoid misleading. To update existing cluster's SSH access, please use `az aks nodepool update --ssh-access` to update node pool's SSH access one by one.\"\n\nSo it appears the [Microsoft Learn documentation](https://learn.microsoft.com/en-us/azure/aks/manage-ssh-node-access#disable-ssh-on-an-existing-cluster) is outdated. I will update the docs. Is this an acceptable solution to use `az aks nodepool update --ssh-access` instead?\n\n@davidbarrowsatasos From [the docs](https://learn.microsoft.com/en-us/cli/azure/aks?view=azure-cli-latest#az-aks-create(aks-preview)), `--ssh-access` for `az aks create` is only available today in the `aks-preview` CLI extension. For awareness, it also says: \"Configure SSH setting for the first system pool in this cluster. Use \"disabled\" to disable SSH access, \"localuser\" to enable SSH access using private key. Note, this configuration will not take effect for later created new node pools, please use option az aks nodepool add --ssh-access to configure SSH access for new node pools.\"\n\n---\n\n@mbifeld  thanks for your response, and thanks for updating the docs.  It's been awhile since I looked at this, and can't speak for anyone else on this chat, but for me yes that sounds like an acceptable solution.  Cheers",
      "labels": [
        "bug",
        "Service Attention",
        "AKS",
        "customer-reported",
        "Auto-Assign"
      ],
      "created_at": "2024-10-14T03:30:26Z",
      "closed_at": "2026-01-20T15:56:01Z",
      "url": "https://github.com/Azure/azure-cli/issues/30075",
      "comments_count": 8
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 26414,
      "title": "az aks get-credentials does not work with kind",
      "problem": "**Related command**\r\n\r\n`az aks get-credentials`  \r\n\r\n\r\n**Describe the bug**\r\n\r\nThe `az aks get-credentials` command incorrectly expects that the local kube config file must have a `clusters` key in order to be valid.\r\n\r\nThis kube config will work with the az command:\r\n\r\n```yaml\r\napiVersion: v1\r\nkind: Config\r\nclusters: []\r\npreferences: {}\r\n```\r\nwhile this will not:\r\n\r\n```yaml\r\napiVersion: v1\r\nkind: Config\r\npreferences: {}\r\n```\r\n\r\nand produces error message: \r\n\r\n```text\r\nERROR: No such key 'clusters' in existing config, please confirm whether it is a valid config file. May back up this config file, delete it and retry the command.\r\n```\r\n\r\nOther tools in the Kubernetes ecosystem do not behave like this when parsing the kube config file. This is specifically a problem in CI pipelines for example together with [`kind`](https://kind.sigs.k8s.io/). See reproduction below.\r\n\r\n**To Reproduce**\r\n\r\n1. `rm -r -f ~/.kube/config` (This removes local kube config and thereby simulates that we start out fresh, just like a CI pipeline would do.)\r\n1. `kind create cluster`\r\n1. `kind delete cluster`\r\n1.  `az aks get-credentials .....`  results in error:\r\n\r\n\r\n```text\r\nERROR: No such key 'clusters' in existing config, please confirm whether it is a valid config file. \r\nMay back up this config file, delete it and retry the command.\r\n```\r\n\r\n**Expected behavior**\r\n\r\nThat `az aks get-credentials .....` would parse the kube config file _similarly_ to other tools in the Kubernetes ecosystem, in particular those from the Kubernetes project itself (cough: kind). \r\n\r\n\r\n**Current workaround**\r\n\r\nIn a CI pipeline you'll need to completely remove the kube config file (`rm -r -f ~/.kube/config`) after having used `kind` (or any other tool which may manipulate the kube config file). This will make the `az aks get-credentials` command work.\r\n",
      "solution": "I got this error when I had an almost empty `~/.kube/config` file (I assume `kind` created it) when I tried to run  `az aks get-credentials --resource-group myResourceGroup --name myAKSCluster`. Deleting the file and rerunning the `az` command solved it.\n\n---\n\nI've found this:  https://kubernetes.io/docs/reference/config-api/kubeconfig.v1/\r\n\r\nThis indicates that the `clusters` property is indeed mandatory. So having a kubeconfig file without it would constitute an invalid kubeconfig file. If this is correctly understood it means that it is [Kind](https://kind.sigs.k8s.io/) which is doing something wrong and the problem should probably be reported in the [their issue tracker](https://github.com/kubernetes-sigs/kind/issues).\r\n\n\n---\n\nFor anyone in need. Here's a workaround that works with yq v4.44.3:\n```bash\nyq eval '.clusters = .clusters // [] | .users = .users // [] | .contexts = .contexts // []' -i ~/.kube/config\n```",
      "labels": [
        "Service Attention",
        "AKS",
        "customer-reported",
        "Auto-Assign"
      ],
      "created_at": "2023-05-11T15:01:26Z",
      "closed_at": "2026-01-20T15:52:54Z",
      "url": "https://github.com/Azure/azure-cli/issues/26414",
      "comments_count": 6
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 29948,
      "title": "az aks install-cli:  [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate",
      "problem": "### Describe the bug\r\nTrying to use az connectedk8s cmd which internally uses `az aks install-cli --install-location <path_to_kubectl.exe>` to install kubectl.exe file. The cmd fails with the below error.\r\n\r\n\r\n\r\n### Related command\r\n\r\naz aks install-cli --install-location <path_to_kubectl.exe> --debug\r\n\r\n### Errors\r\n\r\nssl.SSLCertVerificationError: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1006)\r\n\r\n### Issue script & Debug output\r\n\r\ncli.azure.cli.core.azclierror: The command failed with an unexpected error. Here is the traceback:\r\naz_command_data_logger: The command failed with an unexpected error. Here is the traceback:\r\ncli.azure.cli.core.azclierror: <urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1006)>\r\nTraceback (most recent call last):\r\n  File \"urllib\\request.py\", line 1348, in do_open\r\n  File \"http\\client.py\", line 1298, in request\r\n  File \"http\\client.py\", line 1344, in _send_request\r\n  File \"http\\client.py\", line 1293, in endheaders\r\n  File \"http\\client.py\", line 1052, in _send_output\r\n  File \"http\\client.py\", line 990, in send\r\n  File \"http\\client.py\", line 1470, in connect\r\n  File \"ssl.py\", line 517, in wrap_socket\r\n  File \"ssl.py\", line 1104, in _create\r\n  File \"ssl.py\", line 1382, in do_handshake\r\nssl.SSLCertVerificationError: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1006)\r\n\r\n### Expected behavior\r\n\r\nIt should be able to download the kubectl file.\r\n\r\n### Environment Summary\r\n\r\nazure-cli                         2.63.0 *\r\n\r\ncore                              2.63.0 *\r\ntelemetry                          1.1.0\r\n\r\n### Additional context\r\n\r\n_No response_",
      "solution": "the issue repro's on Azure VM with following specs:\r\nStandard D8s v3 (8 vcpus , 32 GiB memory)\r\nSecurity Type: Standard\r\n![image](https://github.com/user-attachments/assets/c1c4eb68-cb9b-4077-b40d-bea2e04d2312)\r\n\n\n---\n\nthe following workaround helped resolve the issue;\r\n1. install python\r\n2. pip install pip-system-certs\n\n---\n\nClosing as resolved based on the above comment. Please reopen / tag me if this issue is still present. Thank you.",
      "labels": [
        "bug",
        "Service Attention",
        "AKS",
        "Auto-Assign",
        "Auto-Resolve",
        "Similar-Issue"
      ],
      "created_at": "2024-09-21T00:30:37Z",
      "closed_at": "2026-01-20T15:50:24Z",
      "url": "https://github.com/Azure/azure-cli/issues/29948",
      "comments_count": 8
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 25319,
      "title": "az aks update --enable-vpa/disable-vpa",
      "problem": "<!--- \ud83d\uded1 Please check existing issues first before continuing: https://github.com/Azure/azure-cli/issues --->\r\n\r\n> ### `az feedback` auto-generates most of the information requested below, as of CLI version 2.0.62\r\n\r\n**Related command**\r\n<!--- Please provide the related command with az {command} if you can, so that we can quickly route to the related team for help. --->\r\nEnd users are testing if they need VPA and they installing then removing it, after a while they want to add it again and error occurs\r\n**Commands executed**\r\n```\r\naz aks update -g \"<rg_name>\" -n \"<aks_name>\" --disable-vpa\r\n```\r\nor\r\n```\r\naz aks update -g \"<rg_name>\" -n \"<aks_name>\" --enable-vpa\r\n```\r\n\r\n**Error msg**\r\n<!--- A clear and concise description of what the bug is. --->\r\n```\r\n(NotAllAgentPoolOrchestratorVersionSpecifiedAndUnchanged) Using managed cluster api, all Agent pools' OrchestratorVersion must be all specified or all unspecified. If all specified, they must be stay unchanged or the same with control plane. For agent pool specific change, please use per agent pool operations: https://aka.ms/agent-pool-rest-api\r\nCode: NotAllAgentPoolOrchestratorVersionSpecifiedAndUnchanged\r\nMessage: Using managed cluster api, all Agent pools' OrchestratorVersion must be all specified or all unspecified. If all specified, they must be stay unchanged or the same with control plane. For agent pool specific change, please use per agent pool operations: https://aka.ms/agent-pool-rest-api\r\n```\r\n**To Reproduce**\r\nJust run back and forth above commands and error will occur\r\n\r\n**Expected behavior**\r\nError shouldnt occur\r\n\r\n**Environment summary**\r\n1.24.6 AKS, West Europe\r\n\r\n**Additional context**\r\n<!--- Add any other context about the problem here. --->\r\n",
      "solution": "Thanks for the feedback! We are routing this to the appropriate team for follow-up. cc @Azure/aks-pm.\n<details>\n<summary>Issue Details</summary>\n<hr />\n\n<!--- \ud83d\uded1 Please check existing issues first before continuing: https://github.com/Azure/azure-cli/issues --->\r\n\r\n> ### `az feedback` auto-generates most of the information requested below, as of CLI version 2.0.62\r\n\r\n**Related command**\r\n<!--- Please provide the related command with az {command} if you can, so that we can quickly route to the related team for help. --->\r\nEnd users are testing if they need VPA and they installing then removing it, after a while they want to add it again and error occurs\r\n**Commands executed**\r\n```\r\naz aks update -g \"<rg_name>\" -n \"<aks_name>\" --disable-vpa\r\n```\r\nor\r\n```\r\naz aks update -g \"<rg_name>\" -n \"<aks_name>\" --enable-vpa\r\n```\r\n\r\n**Error msg**\r\n<!--- A clear and concise description of what the bug is. --->\r\n```\r\n(NotAllAgentPoolOrchestratorVersionSpecifiedAndUnchanged) Using managed cluster api, all Agent pools' OrchestratorVersion must be all specified or all unspecified. If all specified, they must be stay unchanged or the same with control plane. For agent pool specific change, please use per agent pool operations: https://aka.ms/agent-pool-rest-api\r\nCode: NotAllAgentPoolOrchestratorVersionSpecifiedAndUnchanged\r\nMessage: Using managed cluster api, all Agent pools' OrchestratorVersion must be all specified or all unspecified. If all specified, they must be stay unchanged or the same with control plane. For agent pool specific change, please use per agent pool operations: https://aka.ms/agent-pool-rest-api\r\n```\r\n**To Reproduce**\r\nJust run back and forth above commands and error will occur\r\n\r\n**Expected behavior**\r\nError shouldnt occur\r\n\r\n**Environment summary**\r\n1.24.6 AKS, West Europe\r\n\r\n**Additional context**\r\n<!--- Add any other context about the problem here. --->\r\n\n\n<table>\n  <tr>\n    <th align=\"left\">Author:</th>\n    <td>ovie91</td>\n  </tr>\n  <tr>\n    <th align=\"left\">Assignees:</th>\n    <td>-</td>\n  </tr>\n  <tr>\n    <th align=\"left\">Labels:</th>\n    <td>\n\n`bug`, `Service Attention`, `AKS`, `customer-reported`, `Auto-Assign`\n\n</td>\n  </tr>\n  <tr>\n    <th align=\"left\">Milestone:</th>\n    <td>-</td>\n  </tr>\n</table>\n</details>",
      "labels": [
        "bug",
        "Service Attention",
        "AKS",
        "customer-reported",
        "Auto-Assign"
      ],
      "created_at": "2023-02-01T10:09:54Z",
      "closed_at": "2026-01-20T15:49:35Z",
      "url": "https://github.com/Azure/azure-cli/issues/25319",
      "comments_count": 7
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 23165,
      "title": "aks command invoke: evalsymlink failure on '/command-files/https:/github.com/",
      "problem": "> ### `az feedback` auto-generates most of the information requested below, as of CLI version 2.0.62\r\n\r\n**Related command**\r\n<!--- Please provide the related command with az {command} if you can, so that we can quickly route to the related team for help. --->\r\n az aks command invoke --resource-group <> --name <> --command \"kubectl kustomize .\" --file \r\n\r\n**Describe the bug**\r\nWhen trying to deploy aks periscope via aks command invoke, I am seeing the following error\r\nError: rawResources failed to read Resources: Load from path https://github.com/azure/aks-periscope//deployment/base?ref=v0.9 failed: evalsymlink failure on '/command-files/https:/github.com/azure/aks-periscope/deployment/base?ref=v0.9' : lstat /command-files/https:: no such file or directory\r\n\r\n\r\n**To Reproduce**\r\n<!--- Steps to reproduce the behavior. --->\r\nIf we run this command on any aks cluster\r\n az aks command invoke --resource-group <> --name <> --command \"kubectl kustomize .\" --file \r\n\r\nwe will be able to reproduce\r\nkustomization.YAML\r\n\r\nresources:\r\n- https://github.com/azure/aks-periscope//deployment/base?ref=v0.9\r\n\r\nimages:\r\n- name: periscope-linux\r\n  newName: mcr.microsoft.com/aks/periscope\r\n  newTag: 0.0.9\r\n- name: periscope-windows\r\n  newName: mcr.microsoft.com/aks/periscope-win\r\n  newTag: 0.0.9\r\n\r\nsecretGenerator:\r\n- name: azureblob-secret\r\n  behavior: replace\r\n  literals:\r\n  - AZURE_BLOB_ACCOUNT_NAME=<>\r\n  - AZURE_BLOB_CONTAINER_NAME=<>\r\n  - AZURE_BLOB_SAS_KEY=?<>\r\n\r\n**Expected behavior**\r\n<!--- A clear and concise description of what you expected to happen. --->\r\nCOmmand should have been successful\r\n\r\n\r\n\r\n**Environment summary**\r\n<!--- Install Method (e.g. pip, interactive script, apt-get, Docker, MSI, edge build) / CLI version (`az --version`) / OS version / Shell Type (e.g. bash, cmd.exe, Bash on Windows)  --->\r\n\r\n**Additional context**\r\n<!--- Add any other context about the problem here. --->\r\n",
      "solution": "Thanks for the feedback! We are routing this to the appropriate team for follow-up. cc @Azure/aks-pm.\n<details>\n<summary>Issue Details</summary>\n<hr />\n\n> ### `az feedback` auto-generates most of the information requested below, as of CLI version 2.0.62\r\n\r\n**Related command**\r\n<!--- Please provide the related command with az {command} if you can, so that we can quickly route to the related team for help. --->\r\n az aks command invoke --resource-group <> --name <> --command \"kubectl kustomize .\" --file \r\n\r\n**Describe the bug**\r\nWhen trying to deploy aks periscope via aks command invoke, I am seeing the following error\r\nError: rawResources failed to read Resources: Load from path https://github.com/azure/aks-periscope//deployment/base?ref=v0.9 failed: evalsymlink failure on '/command-files/https:/github.com/azure/aks-periscope/deployment/base?ref=v0.9' : lstat /command-files/https:: no such file or directory\r\n\r\n\r\n**To Reproduce**\r\n<!--- Steps to reproduce the behavior. --->\r\nIf we run this command on any aks cluster\r\n az aks command invoke --resource-group <> --name <> --command \"kubectl kustomize .\" --file \r\n\r\nwe will be able to reproduce\r\nkustomization.YAML\r\n\r\nresources:\r\n- https://github.com/azure/aks-periscope//deployment/base?ref=v0.9\r\n\r\nimages:\r\n- name: periscope-linux\r\n  newName: mcr.microsoft.com/aks/periscope\r\n  newTag: 0.0.9\r\n- name: periscope-windows\r\n  newName: mcr.microsoft.com/aks/periscope-win\r\n  newTag: 0.0.9\r\n\r\nsecretGenerator:\r\n- name: azureblob-secret\r\n  behavior: replace\r\n  literals:\r\n  - AZURE_BLOB_ACCOUNT_NAME=<>\r\n  - AZURE_BLOB_CONTAINER_NAME=<>\r\n  - AZURE_BLOB_SAS_KEY=?<>\r\n\r\n**Expected behavior**\r\n<!--- A clear and concise description of what you expected to happen. --->\r\nCOmmand should have been successful\r\n\r\n\r\n\r\n**Environment summary**\r\n<!--- Install Method (e.g. pip, interactive script, apt-get, Docker, MSI, edge build) / CLI version (`az --version`) / OS version / Shell Type (e.g. bash, cmd.exe, Bash on Windows)  --->\r\n\r\n**Additional context**\r\n<!--- Add any other context about the problem here. --->\r\n\n\n<table>\n  <tr>\n    <th align=\"left\">Author:</th>\n    <td>bhandariakshay1601</td>\n  </tr>\n  <tr>\n    <th align=\"left\">Assignees:</th>\n    <td>-</td>\n  </tr>\n  <tr>\n    <th align=\"left\">Labels:</th>\n    <td>\n\n`Service Attention`, `AKS`, `customer-reported`, `Installation`, `Auto-Assign`\n\n</td>\n  </tr>\n  <tr>\n    <th align=\"left\">Milestone:</th>\n    <td>Backlog</td>\n  </tr>\n</table>\n</details>",
      "labels": [
        "Service Attention",
        "AKS",
        "customer-reported",
        "Installation",
        "Auto-Assign"
      ],
      "created_at": "2022-07-11T05:58:19Z",
      "closed_at": "2026-01-20T15:47:43Z",
      "url": "https://github.com/Azure/azure-cli/issues/23165",
      "comments_count": 6
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 16505,
      "title": "AKS command update not working with --api-server-authorized-ip-ranges parameter set to \"\"",
      "problem": "> ### `az feedback` auto-generates most of the information requested below, as of CLI version 2.0.62\r\n\r\n**Describe the bug**\r\nCurrently, the parameter for removing authorized ip ranges for the Kubernetes API Server in the AZ CLI does not work. The public and CLI documentation state to set the parameter --api-server-authorized-ip-ranges to \"\" and that will set the authorizedIpRanges field to null. Performing this just causes a bad syntax error to occur. The only way to get around this is to directly set the parameter to \"\" using an = sign\r\n\r\n**To Reproduce**\r\n1. Create or already have an AKS cluster with API Server Authorized IP Ranges set\r\n2. Try to remove these ranges using the documented syntax below. The following error should occur:\r\n\r\n\r\n**Expected behavior**\r\n\r\nDocumented way that fails -> az aks update -g rgName -n clusterName --api-server-authorized-ip-ranges \"\"\r\n\r\nWay that succeeds -> az aks update -g rgName -n clsuterName --api-server-authorized-ip-ranges=\"\"\r\n\r\n**Environment summary**\r\nRunning from Windows PowerShell with the following CLI version:\r\n\r\n{\r\n  \"azure-cli\": \"2.17.1\",\r\n  \"azure-cli-core\": \"2.17.1\",\r\n  \"azure-cli-telemetry\": \"1.0.6\",\r\n  \"extensions\": {\r\n    \"alertsmanagement\": \"0.1.0\",\r\n    \"azure-devops\": \"0.18.0\",\r\n    \"azure-iot\": \"0.10.8\",\r\n    \"costmanagement\": \"0.1.0\",\r\n    \"interactive\": \"0.4.4\",\r\n    \"resource-graph\": \"1.1.0\"\r\n  }\r\n}\r\n\r\n\r\n\r\n",
      "solution": "> This issue should be looked into by AKS service team.\r\n\r\nGot it, would it be possible to assign the issue to the team directly?",
      "labels": [
        "Service Attention",
        "AKS"
      ],
      "created_at": "2021-01-12T19:08:26Z",
      "closed_at": "2026-01-20T15:29:32Z",
      "url": "https://github.com/Azure/azure-cli/issues/16505",
      "comments_count": 8
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32670,
      "title": "trying to get Entra ID registration, getting Azure CLI permission error",
      "problem": "### Describe the bug\n\nDescribe the bug\nAADSTS650057: Invalid resource. The client has requested access to a resource which is not listed in the requested permissions in the client's application registration. Client app ID: 04b07795-8ddb-461a-bbee-02f9e1bf7b46(Microsoft Azure CLI). Resource value from request: api://74cc6976-7a58-4bcc-b197-6edc8fb2d4ba. Resource app ID: 74cc6976-7a58-4bcc-b197-6edc8fb2d4ba. List of valid resources from app registration: . Trace ID: 7463f5ce-fc3f-426c-b1e1-310d567b3a01 Correlation ID: fed05e23-dfeb-49b7-ae9b-4872ea919796 Timestamp: 2025-12-26 19:51:49Z\n\nRelated command\naz login --tenant \"[ID]\" --scope \"[api]\"\n\nErrors\nAADSTS650057: Invalid resource. The client has requested access to a resource which is not listed in the requested permissions in the client's application registration. Client app ID: 04b07795-8ddb-461a-bbee-02f9e1bf7b46(Microsoft Azure CLI). Resource value from request: api://74cc6976-7a58-4bcc-b197-6edc8fb2d4ba. Resource app ID: 74cc6976-7a58-4bcc-b197-6edc8fb2d4ba. List of valid resources from app registration: . Trace ID: 7463f5ce-fc3f-426c-b1e1-310d567b3a01 Correlation ID: fed05e23-dfeb-49b7-ae9b-4872ea919796 Timestamp: 2025-12-26 19:51:49Z\n\nIssue script & Debug output\n?\n\nExpected behavior\nget the device enrolled\n\nEnvironment Summary\nazure-cli 2.81.0\n\ncore 2.81.0\ntelemetry 1.1.0\n\nExtensions:\nlog-analytics 1.0.0b1\n\nDependencies:\nmsal 1.34.0b1\nazure-mgmt-resource 23.3.0\n\nPython location '/opt/homebrew/Cellar/azure-cli/2.81.0/libexec/bin/python'\nConfig directory '/Users/mcc0nnell/.azure'\nExtensions directory '/Users/mcc0nnell/.azure/cliextensions'\n\nPython (Darwin) 3.13.11 (main, Dec 5 2025, 16:06:33) [Clang 17.0.0 (clang-1700.4.4.1)]\n\nLegal docs and information: aka.ms/AzureCliLegal\n\nYour CLI is up-to-date.\n\nAdditional context\nNo response\n\n### Related command\n\n~\n\n### Errors\n\n~\n\n### Issue script & Debug output\n\n~\n\n### Expected behavior\n\n~\n\n### Environment Summary\n\n~\n\n### Additional context\n\n_No response_",
      "solution": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #32579\n- #26609\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n`74cc6976-7a58-4bcc-b197-6edc8fb2d4ba` doesn't seem to be a Microsoft application. It is not supported to use Azure CLI's client ID `04b07795-8ddb-461a-bbee-02f9e1bf7b46` to call third-party applications.\n\nYou need to register your own client application to get a token for `api://74cc6976-7a58-4bcc-b197-6edc8fb2d4ba`.\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/32579#issuecomment-3709343602\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
      "labels": [
        "Account",
        "question",
        "Auto-Assign",
        "Azure CLI Team",
        "Auto-Resolve",
        "Similar-Issue",
        "Possible-Solution",
        "Login"
      ],
      "created_at": "2026-01-19T06:39:20Z",
      "closed_at": "2026-01-19T06:41:49Z",
      "url": "https://github.com/Azure/azure-cli/issues/32670",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32543,
      "title": "az storage file list undocumented action change in 2.79",
      "problem": "### Describe the bug\n\nIn Az CLI version 2.78 and below, running \"az storage file list\" only called the action: \"Microsoft.Storage/storageAccounts/fileServices/fileShares/files/read\", which is the allowed DataActions of the following Azure RBAC roles:\n\nStorage File Data Privileged Contributor: https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles/storage#storage-file-data-privileged-contributor\nStorage File Data Privileged Reader: https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles/storage#storage-file-data-privileged-reader\n\nHowever, with Az CLI version 2.79 and up, a new call was added: \"Microsoft.Storage/storageAccounts/fileServices/shares/read\", which is not included in the before mentioned RBAC roles.  This causes a breaking change where the RBAC role no longer has enough permissions to perform the same task.\n\n\n\n\n\n### Related command\n\naz storage file list\n\n### Errors\n\nERROR: \nYou do not have the required permissions needed to perform this operation.\nDepending on your operation, you may need to be assigned one of the following roles:\n    \"Storage Blob Data Owner\"\n    \"Storage Blob Data Contributor\"\n    \"Storage Blob Data Reader\"\n    \"Storage Queue Data Contributor\"\n    \"Storage Queue Data Reader\"\n    \"Storage Table Data Contributor\"\n    \"Storage Table Data Reader\"\n\nIf you want to use the old authentication method and allow querying for the right account key, please use the \"--auth-mode\" parameter and \"key\" value.\n\n\n### Issue script & Debug output\n\n- task: AzureCLI@2\n        displayName: 'Validate Deployment'\n        inputs:\n          azureSubscription: _serviceprincipal_\n          scriptType: 'pscore'\n          scriptLocation: 'inlineScript'\n          inlineScript: |\n\n            # List files in target directory\n            $files = az storage file list `\n              --account-name _storageaccountname_ `\n              --share-name _sharename_ `\n              --path _directoryname`_\n              --auth-mode login `\n              --backup-intent `\n              --exclude-extended-info `\n              --output json | ConvertFrom-Json\n\n            $files.name\n\n\n\nDiagnostic Log with Az CLI 2.78:\n<img width=\"637\" height=\"239\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/0927b384-9922-4d13-9d3f-840951c3b657\" />\n\n\nDiagnostic Log with Az CLI 2.79+:\n<img width=\"554\" height=\"251\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/d1900cc1-aea2-4624-9a66-be6d6a60a0b4\" />\n\n### Expected behavior\n\nA list of files from the script\n\n### Environment Summary\n\nWorking version:\n\n```\n/usr/bin/az version\n{\n  \"azure-cli\": \"2.78.0\",\n  \"azure-cli-core\": \"2.78.0\",\n  \"azure-cli-telemetry\": \"1.1.0\",\n  \"extensions\": {\n    \"azure-devops\": \"1.0.2\"\n  }\n}\n```\n\nNot-working version: \n\n```\n/usr/bin/az version\n{\n  \"azure-cli\": \"2.79.0\",\n  \"azure-cli-core\": \"2.79.0\",\n  \"azure-cli-telemetry\": \"1.1.0\",\n  \"extensions\": {\n    \"azure-devops\": \"1.0.2\"\n  }\n}\n```\n\n### Additional context\n\n_No response_",
      "solution": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #32503\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nCan you try adding the builtin Reader role to the service principal? It should work afterwards.\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/32503#issuecomment-3624984504\n### Solution 2:\nBased on the current implementation, listing files is done through the Share level while https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles/storage#storage-file-data-privileged-contributor only works on the list/directory level. Will see if SDK allows this change.\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/32503#issuecomment-3635646431\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_\n\n---\n\n> Hi [@SysAdminforCoffee](https://github.com/SysAdminforCoffee),\n> \n> 2.79.0 is not the latest Azure CLI(2.81.0).\n> \n> If you haven't already attempted to do so, please upgrade to the latest Azure CLI version by following https://learn.microsoft.com/en-us/cli/azure/update-azure-cli.\n\nIssue still exists in 2.81, however the issue started in 2.79\n\n\n\n\n> Here are some similar issues that might help you. Please check if they can solve your problem.\n> \n> * [az storage file list not working properly with OAuth since version 2.79\u00a0#32503](https://github.com/Azure/azure-cli/issues/32503)\n> \n> **Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n> \n> ### Solution 1:\n> Can you try adding the builtin Reader role to the service principal? It should work afterwards.\n> \n> **Reference**:\n> \n> * [az storage file list not working properly with OAuth since version 2.79\u00a0#32503 (comment)](https://github.com/Azure/azure-cli/issues/32503#issuecomment-3624984504)\n> \n> ### Solution 2:\n> Based on the current implementation, listing files is done through the Share level while https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles/storage#storage-file-data-privileged-contributor only works on the list/directory level. Will see if SDK allows this change.\n> \n> **Reference**:\n> \n> * [az storage file list not working properly with OAuth since version 2.79\u00a0#32503 (comment)](https://github.com/Azure/azure-cli/issues/32503#issuecomment-3635646431)\n> \n> _Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_\n\nThis issue does not affect other \"az storage file\" commands such as \"upload\".  The same Service Principal can do \"az storage file upload\" without issue in 2.81.",
      "labels": [
        "Storage",
        "Breaking Change",
        "question",
        "customer-reported",
        "Auto-Assign",
        "Azure CLI Team",
        "Auto-Resolve",
        "Similar-Issue",
        "Possible-Solution"
      ],
      "created_at": "2025-12-15T14:55:33Z",
      "closed_at": "2026-01-19T03:33:03Z",
      "url": "https://github.com/Azure/azure-cli/issues/32543",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32045,
      "title": "Azure CLI 2.77.0 is broken: ImportError: DLL load failed while importing win32file: The specified module could not be found.",
      "problem": "### Describe the bug\n\nI have just installed Azure CLI version 2.77.0 and if I then run 'az upgrade' or 'az version' I get the error shown below.\n\n\n\n### Related command\n\n'az upgrade' or 'az version'\n\n### Errors\n\nTraceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/__main__.py\", line 13, in <module>\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/telemetry.py\", line 19, in <module>\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/telemetry/__init__.py\", line 9, in <module>\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\portalocker/__init__.py\", line 4, in <module>\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\portalocker/portalocker.py\", line 11, in <module>\nImportError: DLL load failed while importing win32file: The specified module could not be found.\n\n### Issue script & Debug output\n\nTraceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/__main__.py\", line 13, in <module>\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/telemetry.py\", line 19, in <module>\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/telemetry/__init__.py\", line 9, in <module>\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\portalocker/__init__.py\", line 4, in <module>\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\portalocker/portalocker.py\", line 11, in <module>\nImportError: DLL load failed while importing win32file: The specified module could not be found.\n\n### Expected behavior\n\nThe command 'az version' should show me the current installed version, not an error.\n\n### Environment Summary\n\naz --version isn't working right now. See below for disappointing details.\n\n### Additional context\n\n_No response_",
      "solution": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #17986\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nI was able to solve it by reinstalling `pywin32` with a terminal \"Run as Administrator\":\n\n```\n& \"C:\\Program Files (x86)\\Microsoft SDKs\\Azure\\CLI2\\python.exe\" -m pip install pywin32==228 --force-reinstall\n```\n\nThough the root cause remains unknown...\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/17986#issuecomment-834372349\n- https://github.com/azure/azure-cli/issues/17986#issuecomment-834454489\n- https://github.com/azure/azure-cli/issues/17986#issuecomment-3198589072\n### Solution 2:\nAs a fresh installation works fine, it's very likely some remnants of the old installation are interfering with the latest version. Another solution worth trying is to:\n\n1. Go to **Control Panel > Uninstall a program**, uninstall **Microsoft Azure CLI**.\n2. Delete `C:\\Program Files (x86)\\Microsoft SDKs\\Azure\\CLI2`.\n3. Reinstall Azure CLI from scratch.\n\nPlease kindly let us know if it solves the issue.\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/17986#issuecomment-834607007\n- https://github.com/azure/azure-cli/issues/17986#issuecomment-834760580\n- https://github.com/azure/azure-cli/issues/17986#issuecomment-836643857\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_\n\n---\n\nI've just rolled back to 2.76.0 and it is working fine. The issue is clearly with version 2.77.0\n\n---\n\nTried Solution 1:\n\nPS C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2> .\\python.exe -m pip install pywin32==228 --force-reinstall\nERROR: Could not find a version that satisfies the requirement pywin32==228 (from versions: 307, 308, 309, 310, 311)\nERROR: No matching distribution found for pywin32==228\n\nHad to change the path to the x64 directory as the solution provided the path to x86\n\nNot keen on trying Solution 2 as all extensions also needs to be reinstalled.\n\nUPDATE:\n\nPS C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2> .\\python.exe -m pip install pywin32==311 --force-reinstall worked for me",
      "labels": [
        "bug",
        "Core",
        "common issue",
        "Azure CLI Team"
      ],
      "created_at": "2025-09-02T15:52:49Z",
      "closed_at": "2026-01-05T03:10:51Z",
      "url": "https://github.com/Azure/azure-cli/issues/32045",
      "comments_count": 30
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 23131,
      "title": "Command parameter '--hsm-name'  does not work for Azure Managed Hsm CLI in dogfood environment",
      "problem": "> ### `az feedback` auto-generates most of the information requested below, as of CLI version 2.0.62\r\n\r\n**Related command**\r\naz keyvault security-domain download --hsm-name hsmname  --sd-wrapping-keys cert_0.cer  cert_1.cer  cert_2.cer  --sd-quorum 2 --security-domain-file filename.json\r\n<!--- Please provide the related command with az {command} if you can, so that we can quickly route to the related team for help. --->\r\n\r\n**Describe the bug**\r\nAbove command fails with below error, even though it does exist.\r\n\"Max retries exceeded attempting to connect to vault. The vault may not exists or you need to flush your DNS cache and try again later.\"\r\n<!--- A clear and concise description of what the bug is. --->\r\n\r\n**To Reproduce**\r\nCreate a new MHSM resource and run above command\r\n<!--- Steps to reproduce the behavior. --->\r\n\r\n**Expected behavior**\r\nCommand should execute successfully\r\n<!--- A clear and concise description of what you expected to happen. --->\r\n\r\n**Environment summary**\r\nAzure Dogfood environment\r\n<!--- Install Method (e.g. pip, interactive script, apt-get, Docker, MSI, edge build) / CLI version (`az --version`) / OS version / Shell Type (e.g. bash, cmd.exe, Bash on Windows)  --->\r\n\r\n**Additional context**\r\nIt seems that DNS suffix for MHSM in dogfood (managedhsm-int.azure-int.net) is not recognized by CLI.\r\n<!--- Add any other context about the problem here. --->\r\n",
      "solution": "Hi @riteshchitlangia1, You need to register dogfood Cloud and switch to it, or else all requests will target AzureCloud.\r\n\r\nCommand to register dogfood cloud:\r\n```\r\naz  cloud register --name AzureDFCloud --cloud-config @cloud_DF.json\r\n```\r\nAn example for cloud_DF.json:\r\n```\r\n{\r\n  \"endpoints\": {\r\n    \"activeDirectory\": \"https://login.windows-ppe.net\",\r\n    \"activeDirectoryGraphResourceId\": \"https://graph.ppe.windows.net/\",\r\n    \"activeDirectoryResourceId\": \"https://management.core.windows.net/\",\r\n    \"microsoftGraphResourceId\": \"https://graph.microsoft-ppe.com/\",\r\n    \"gallery\": \"https://df.gallery.azure-test.net/\",\r\n    \"management\": \"https://management-preview.core.windows-int.net/\",\r\n    \"resourceManager\": \"https://api-dogfood.resources.windows-int.net/\"\r\n  },\r\n  \"name\": \"AzureDFCloud\",\r\n  \"suffixes\": {\r\n    \"keyvaultDns\": \".vault-int.azure-int.net\",\r\n    \"mhsmDns\": \".managedhsm-int.azure-int.net\"\r\n  }\r\n}\r\n```\r\n\r\nCommand to switch cloud:\r\n```\r\naz cloud set --name AzureDFCloud\r\n```",
      "labels": [
        "KeyVault",
        "Installation",
        "Customer Usage",
        "feature-request",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2022-07-06T19:21:36Z",
      "closed_at": "2026-01-13T13:45:36Z",
      "url": "https://github.com/Azure/azure-cli/issues/23131",
      "comments_count": 7
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32621,
      "title": "az login --use-device-code fails",
      "problem": "### Describe the bug\n\nI tried logging in in using `az login --use-device-code`\n\nI get an error message saying \"AADSTS900561: The endpoint only accepts POST requests. Received a GET request.\"\n\n\nCopied from login errors:\nError Code: 53003\nRequest Id: 25ab1408-9854-4204-be22-719af9910400\nCorrelation Id: 148787df-c02d-4cbe-947e-481164f67f03\nTimestamp: 2026-01-09T00:38:22.547Z\nApp name: Microsoft Azure CLI\nApp id: 04b07795-8ddb-461a-bbee-02f9e1bf7b46\nIP address: 20.236.10.66\nDevice identifier: 46941ad3-56a6-4c67-9e8e-a45227c6baba\nDevice platform: Windows 10\nDevice state: Compliant\n\n<img width=\"716\" height=\"594\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/22062692-5b62-4c86-b7bf-a9f070dccd62\" />\n<img width=\"1058\" height=\"1072\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/ae44f5e0-6edc-401b-b206-d587be93e7e0\" />\n<img width=\"1221\" height=\"1537\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/f39194f3-9ef1-4d1f-999f-c87b280fea0c\" />\n\n### Related command\n\naz login --use-device-code\n\n### Errors\n\nError Code: 53003\nRequest Id: 25ab1408-9854-4204-be22-719af9910400\nCorrelation Id: 148787df-c02d-4cbe-947e-481164f67f03\nTimestamp: 2026-01-09T00:38:22.547Z\nApp name: Microsoft Azure CLI\nApp id: 04b07795-8ddb-461a-bbee-02f9e1bf7b46\nIP address: 20.236.10.66\nDevice identifier: 46941ad3-56a6-4c67-9e8e-a45227c6baba\nDevice platform: Windows 10\nDevice state: Compliant\n\n### Issue script & Debug output\n\nPS D:\\r2\\temp> az login --use-device-code --debug\ncli.knack.cli: Command arguments: ['login', '--use-device-code', '--debug']\ncli.knack.cli: __init__ debug log:\nEnable color in terminal.\ncli.knack.cli: Event: Cli.PreExecute []\ncli.knack.cli: Event: CommandParser.OnGlobalArgumentsCreate [<function CLILogging.on_global_arguments at 0x0000022881AA45E0>, <function OutputProducer.on_global_arguments at 0x00000228820399E0>, <function CLIQuery.on_global_arguments at 0x000002288208B920>]\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableCreate []\ncli.azure.cli.core: Modules found from index for 'login': ['azure.cli.command_modules.profile']\ncli.azure.cli.core: Loading command modules:\ncli.azure.cli.core: Name                  Load Time    Groups  Commands\ncli.azure.cli.core: profile                   0.011         2         8\ncli.azure.cli.core: Total (1)                 0.011         2         8\ncli.azure.cli.core: These extensions are not installed and will be skipped: ['azext_ai_examples', 'azext_next']\ncli.azure.cli.core: Loading extensions:\ncli.azure.cli.core: Name                  Load Time    Groups  Commands  Directory\ncli.azure.cli.core: Total (0)                 0.000         0         0\ncli.azure.cli.core: Loaded 2 groups, 8 commands.\ncli.azure.cli.core: Found a match in the command table.\ncli.azure.cli.core: Raw command  : login\ncli.azure.cli.core: Command table: login\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableTruncate [<function AzCliLogging.init_command_file_logging at 0x000002288407D1C0>]\ncli.azure.cli.core.azlogging: metadata file logging enabled - writing logs to 'C:\\Users\\paaggarwal\\.azure\\commands\\2026-01-08.16-48-05.login.50204.log'.\naz_command_data_logger: command args: login --use-device-code --debug\ncli.knack.cli: Event: CommandInvoker.OnPreArgumentLoad [<function register_global_subscription_argument.<locals>.add_subscription_parameter at 0x00000228848BE700>]       \ncli.knack.cli: Event: CommandInvoker.OnPostArgumentLoad []\ncli.knack.cli: Event: CommandInvoker.OnPostCommandTableCreate [<function register_ids_argument.<locals>.add_ids_arguments at 0x0000022884934A40>, <function register_cache_arguments.<locals>.add_cache_arguments at 0x0000022884934C20>, <function register_upcoming_breaking_change_info.<locals>.update_breaking_change_info at 0x0000022884934CC0>]\ncli.knack.cli: Event: CommandInvoker.OnCommandTableLoaded []\ncli.knack.cli: Event: CommandInvoker.OnPreParseArgs []\ncli.knack.cli: Event: CommandInvoker.OnPostParseArgs [<function OutputProducer.handle_output_argument at 0x0000022882039A80>, <function CLIQuery.handle_query_parameter at 0x000002288208B9C0>, <function register_ids_argument.<locals>.parse_ids_arguments at 0x0000022884934AE0>]\ncli.azure.cli.core.auth.persistence: build_persistence: location='C:\\\\Users\\\\paaggarwal\\\\.azure\\\\msal_token_cache.bin', encrypt=True\ncli.azure.cli.core.auth.binary_cache: load: C:\\Users\\paaggarwal\\.azure\\msal_http_cache.bin\nurllib3.util.retry: Converted retries value: 1 -> Retry(total=1, connect=None, read=None, redirect=None, status=None)\nmsal.authority: Initializing with Entra authority: https://login.microsoftonline.com/organizations\nmsal.authority: openid_config(\"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration\") = {'token_endpoint': 'https://login.microsoftonline.com/organizations/oauth2/v2.0/token', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'private_key_jwt', 'client_secret_basic', 'self_signed_tls_client_auth'], 'jwks_uri': 'https://login.microsoftonline.com/organizations/discovery/v2.0/keys', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['pairwise'], 'id_token_signing_alg_values_supported': ['RS256'], 'response_types_supported': ['code', 'id_token', 'code id_token', 'id_token token'], 'scopes_supported': ['openid', 'profile', 'email', 'offline_access'], 'issuer': 'https://login.microsoftonline.com/{tenantid}/v2.0', 'request_uri_parameter_supported': False, 'userinfo_endpoint': 'https://graph.microsoft.com/oidc/userinfo', 'authorization_endpoint': 'https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize', 'device_authorization_endpoint': 'https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode', 'http_logout_supported': True, 'frontchannel_logout_supported': True, 'end_session_endpoint': 'https://login.microsoftonline.com/organizations/oauth2/v2.0/logout', 'claims_supported': ['sub', 'iss', 'cloud_instance_name', 'cloud_instance_host_name', 'cloud_graph_host_name', 'msgraph_host', 'aud', 'exp', 'iat', 'auth_time', 'acr', 'nonce', 'preferred_username', 'name', 'tid', 'ver', 'at_hash', 'c_hash', 'email'], 'kerberos_endpoint': 'https://login.microsoftonline.com/organizations/kerberos', 'mtls_endpoint_aliases': {'token_endpoint': 'https://mtlsauth.microsoft.com/organizations/oauth2/v2.0/token'}, 'tls_client_certificate_bound_access_tokens': True, 'tenant_region_scope': None, 'cloud_instance_name': 'microsoftonline.com', 'cloud_graph_host_name': 'graph.windows.net', 'msgraph_host': 'graph.microsoft.com', 'rbac_url': 'https://pas.windows.net'}\nmsal.application: Broker enabled? True\nurllib3.connectionpool: Starting new HTTPS connection (1): login.microsoftonline.com:443\nurllib3.connectionpool: https://login.microsoftonline.com:443 \"POST /organizations/oauth2/v2.0/devicecode HTTP/1.1\" 200 501\nTo sign in, use a web browser to open the page https://microsoft.com/devicelogin and enter the code AW26RGGEE to authenticate.\nmsal.telemetry: Generate or reuse correlation_id: dc86f532-115e-49b2-99af-ffabd5f32b51\nurllib3.connectionpool: https://login.microsoftonline.com:443 \"POST /organizations/oauth2/v2.0/token HTTP/1.1\" 400 501\nurllib3.connectionpool: https://login.microsoftonline.com:443 \"POST /organizations/oauth2/v2.0/token HTTP/1.1\" 400 501\nurllib3.connectionpool: https://login.microsoftonline.com:443 \"POST /organizations/oauth2/v2.0/token HTTP/1.1\" 400 501\nurllib3.connectionpool: https://login.microsoftonline.com:443 \"POST /organizations/oauth2/v2.0/token HTTP/1.1\" 400 501\nurllib3.connectionpool: https://login.microsoftonline.com:443 \"POST /organizations/oauth2/v2.0/token HTTP/1.1\" 400 501\nurllib3.connectionpool: https://login.microsoftonline.com:443 \"POST /organizations/oauth2/v2.0/token HTTP/1.1\" 400 501\nurllib3.connectionpool: https://login.microsoftonline.com:443 \"POST /organizations/oauth2/v2.0/token HTTP/1.1\" 400 501\nurllib3.connectionpool: https://login.microsoftonline.com:443 \"POST /organizations/oauth2/v2.0/token HTTP/1.1\" 400 501\nurllib3.connectionpool: https://login.microsoftonline.com:443 \"POST /organizations/oauth2/v2.0/token HTTP/1.1\" 400 501\nurllib3.connectionpool: https://login.microsoftonline.com:443 \"POST /organizations/oauth2/v2.0/token HTTP/1.1\" 400 501\nurllib3.connectionpool: https://login.microsoftonline.com:443 \"POST /organizations/oauth2/v2.0/token HTTP/1.1\" 400 501\nurllib3.connectionpool: https://login.microsoftonline.com:443 \"POST /organizations/oauth2/v2.0/token HTTP/1.1\" 400 501\nurllib3.connectionpool: https://login.microsoftonline.com:443 \"POST /organizations/oauth2/v2.0/token HTTP/1.1\" 400 501\nurllib3.connectionpool: https://login.microsoftonline.com:443 \"POST /organizations/oauth2/v2.0/token HTTP/1.1\" 400 501\n\n### Expected behavior\n\nlogin should succeed\n\n### Environment Summary\n\nPS D:\\r2\\temp> az --version\nazure-cli                         2.77.0 *\n\ncore                              2.77.0 *\ntelemetry                          1.1.0\n\nExtensions:\nazure-devops                       1.0.2\n\nDependencies:\nmsal                            1.34.0b1\nazure-mgmt-resource               23.3.0\n\nPython location 'C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\python.exe'\nConfig directory 'C:\\Users\\paaggarwal\\.azure'\nExtensions directory 'C:\\Users\\paaggarwal\\.azure\\cliextensions'\n\nPython (Windows) 3.13.7 (tags/v3.13.7:bcee1c3, Aug 14 2025, 14:15:11) [MSC v.1944 64 bit (AMD64)]\n\nLegal docs and information: aka.ms/AzureCliLegal\n\n\n### Additional context\n\n_No response_",
      "solution": "I was able to reproduce this error and suspect the error message to be misleading.\n\nPlease note that Microsoft tenant forbids device code flow and if your environment requires an exception, please refer to [Device Code Flow (DCF) Restrictions](https://eng.ms/docs/microsoft-security/ciso-organization/iamprotect/enterprise-iam/productivity-environment/tsgs/devicecodeflowdcfrestrictions) .\n\nI\u2019ll close this issue as it appears to be a duplicate. If you encounter any problems after obtaining the exception, feel free to reach out and reopen the issue.",
      "labels": [
        "Account",
        "question",
        "Auto-Assign",
        "Azure CLI Team",
        "Auto-Resolve",
        "Login"
      ],
      "created_at": "2026-01-09T00:52:34Z",
      "closed_at": "2026-01-13T04:41:45Z",
      "url": "https://github.com/Azure/azure-cli/issues/32621",
      "comments_count": 6
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 29808,
      "title": "[Force deallocate] [CLI] To be part of regular deallocate operation in CLI",
      "problem": "### Preconditions\n\n- [X] No need to upgrade Python SDK or the Python SDK is ready.\n\n### Related command\n\n_No response_\n\n### Resource Provider\n\nmicrosoft.compute/virtual machines\n\n### Description of Feature or Work Requested\n\nASK: deallocate VM is a operation that is most commonly used when VMs is not accessible due to any kind of failure. Deallocate depends on underlying layers to be available to be successful.  \r\nWith force deallocate customers will be able to deallocate their VM even during an outage. The ask is to provide force detach as one of the option along with regular deallocate.\r\n\r\nDesing doc - https://microsoft.sharepoint.com/:w:/t/AzureIDC/AzureIDC_CRP/EX86dDdGWgdBsgo_yI6PuaEB3XGcDh-7Tm8rJT1NrQcqyA?e=3XnT5j\r\n\r\nAPI: The development of the API is under progress with public preview planned in Nov 2024. GA in 2025 Q1.\n\n### Minimum API Version Required\n\nNA\n\n### Swagger PR link / SDK link\n\nWill share the swagger once API is deployed. \n\n### Request Example\n\n_No response_\n\n### Target Date\n\n2024-10-05\n\n### PM Contact\n\naarthiv@microsoft.com\n\n### Engineer Contact\n\nasverma@microsoft.com\n\n### Additional context\n\n_No response_",
      "solution": "![Image](https://github.com/user-attachments/assets/00a4ff4f-e014-4c4c-9b4d-d1ea23c0d996)\n\n@Aarthi-Vijaya-raghavan It is currently estimated that the CLI team can complete this feature request by the end of June or early July. I think you need to fill in these necessary information before we can make a more accurate assessment\n\n\n\n---\n\nLooping @***@***.***> and @***@***.***> for awareness.\r\nWe will reach out to you once we have the API swagger in place.\r\n\r\n\r\n________________________________\r\nFrom: Xing Zhou\r\nSent: Monday, February 17, 2025 9:30 AM\r\nTo: Azure/azure-cli\r\nCc: Aarthi Vijayaraghavan; Mention\r\nSubject: Re: [Azure/azure-cli] [Force deallocate] [CLI] To be part of regular deallocate operation in CLI (Issue #29808)\r\n\r\n[zhoxing-ms]zhoxing-ms left a comment (Azure/azure-cli#29808)<https://github.com/Azure/azure-cli/issues/29808#issuecomment-2661913935>\r\n\r\nimage.png (view on web)<https://github.com/user-attachments/assets/00a4ff4f-e014-4c4c-9b4d-d1ea23c0d996>\r\n\r\n@Aarthi-Vijaya-raghavan<https://github.com/Aarthi-Vijaya-raghavan> It is currently estimated that the CLI team can complete this feature request by the end of June or early July. I think you need to fill in these necessary information before we can make a more accurate assessment\r\n\r\n\u2014\r\nReply to this email directly, view it on GitHub<https://github.com/Azure/azure-cli/issues/29808#issuecomment-2661913935>, or unsubscribe<https://github.com/notifications/unsubscribe-auth/BBMOBQSCIYZ3N2HO2WVNJOL2QFNGHAVCNFSM6AAAAABNKEQNFGVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDMNRRHEYTGOJTGU>.\r\nYou are receiving this because you were mentioned.\r\n",
      "labels": [
        "Compute",
        "customer-reported",
        "feature-request",
        "Azure CLI Team"
      ],
      "created_at": "2024-08-29T10:45:23Z",
      "closed_at": "2026-01-13T01:00:56Z",
      "url": "https://github.com/Azure/azure-cli/issues/29808",
      "comments_count": 8
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 29828,
      "title": "Bicep stopped working on azure-cli:latest Docker image (2.64.0)",
      "problem": "### Describe the bug\n\nWe're using Bicep to deploy our Azure resources. That worked fine up to Azure CLI 2.63.0 Docker image, but since today with 2.64.0 it fails. Please note we're using `azure-cli:latest`, so we expected some of our own stuff to break when moving from Alpine to CBL Mariner 2.0. However, we did not expect Bicep to break.\n\n### Related command\n\n`az deployment sub create --subscription $SUBSCRIPTION_ID --name $NAME --location \"North Europe\" --template-file ./main.bicep`\n\n### Errors\n\n```\r\nERROR: Process terminated. Couldn't find a valid ICU package installed on the system. Please install libicu (or icu-libs) using your package manager and try again. Alternatively you can set the configuration flag System.Globalization.Invariant to true if you want to run with no globalization support. Please see https://aka.ms/dotnet-missing-libicu for more information.\r\n   at System.Environment.FailFast(System.String)\r\n   at System.Globalization.GlobalizationMode+Settings..cctor()\r\n   at System.Globalization.GlobalizationMode+Settings.get_Invariant()\r\n   at System.Globalization.GlobalizationMode.get_Invariant()\r\n   at System.Globalization.CultureData.CreateCultureWithInvariantData()\r\n   at System.Globalization.CultureData.get_Invariant()\r\n   at System.Globalization.CultureInfo..cctor()\r\n   at System.Globalization.CultureInfo.get_InvariantCulture()\r\n   at System.Globalization.NumberFormatInfo.get_InvariantInfo()\r\n   at System.Reflection.AssemblyNameParser.ParseVersion(System.String)\r\n   at System.Reflection.AssemblyNameParser.Parse()\r\n   at System.Reflection.AssemblyNameParser.Parse(System.String)\r\n   at System.Reflection.AssemblyName..ctor(System.String)\r\n   at System.Reflection.TypeNameParser.ResolveAssembly(System.String)\r\n   at System.Reflection.TypeNameParser.GetType(System.String, System.ReadOnlySpan`1<System.String>, System.String)\r\n   at System.Reflection.TypeNameParser+NamespaceTypeName.ResolveType(System.Reflection.TypeNameParser ByRef, System.String)\r\n   at System.Reflection.TypeNameParser.Parse()\r\n   at System.Reflection.TypeNameParser.GetTypeReferencedByCustomAttribute(System.String, System.Reflection.RuntimeModule)\r\n   at System.Reflection.CustomAttributeTypedArgument.ResolveType(System.Reflection.RuntimeModule, System.String)\r\n   at System.Reflection.CustomAttributeTypedArgument..ctor(System.Reflection.RuntimeModule, System.Reflection.CustomAttributeEncodedArgument)\r\n   at System.Reflection.RuntimeCustomAttributeData.get_ConstructorArguments()\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetDynamicallyAccessedMemberTypes(System.Type)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.ValidateTrimmingAnnotations(System.Type, System.Type[], System.Type, System.Type[])\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.Populate()\r\n   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory..ctor(System.Collections.Generic.ICollection`1<Microsoft.Extensions.DependencyInjection.ServiceDescriptor>)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(System.Collections.Generic.ICollection`1<Microsoft.Extensions.DependencyInjection.ServiceDescriptor>, Microsoft.Extensions.DependencyInjection.ServiceProviderOptions)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceCollectionContainerBuilderExtensions.BuildServiceProvider(Microsoft.Extensions.DependencyInjection.IServiceCollection, Microsoft.Extensions.DependencyInjection.ServiceProviderOptions)\r\n   at Microsoft.Extensions.DependencyInjection.ServiceCollectionContainerBuilderExtensions.BuildServiceProvider(Microsoft.Extensions.DependencyInjection.IServiceCollection)\r\n   at Microsoft.Extensions.Logging.LoggerFactory.Create(System.Action`1<Microsoft.Extensions.Logging.ILoggingBuilder>)\r\n   at Bicep.Cli.Program.CreateLoggerFactory(Bicep.Cli.IOContext)\r\n   at Bicep.Cli.Program.ConfigureServices(Bicep.Cli.IOContext)\r\n   at Bicep.Cli.Program..ctor(Bicep.Cli.IOContext, System.Action`1<Microsoft.Extensions.DependencyInjection.IServiceCollection>)\r\n   at Bicep.Cli.Program+<>c__DisplayClass3_0+<<Main>b__0>d.MoveNext()\r\n   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[[Bicep.Cli.Program+<>c__DisplayClass3_0+<<Main>b__0>d, bicep, Version=0.29.0.0, Culture=neutral, PublicKeyToken=null]](<<Main>b__0>d ByRef)\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].Start[[Bicep.Cli.Program+<>c__DisplayClass3_0+<<Main>b__0>d, bicep, Version=0.29.0.0, Culture=neutral, PublicKeyToken=null]](<<Main>b__0>d ByRef)\r\n   at Bicep.Cli.Program+<>c__DisplayClass3_0.<Main>b__0(System.Threading.CancellationToken)\r\n   at Bicep.Cli.Program+<RunWithCancellationAsync>d__6.MoveNext()\r\n   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[[Bicep.Cli.Program+<RunWithCancellationAsync>d__6, bicep, Version=0.29.0.0, Culture=neutral, PublicKeyToken=null]](<RunWithCancellationAsync>d__6 ByRef)\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].Start[[Bicep.Cli.Program+<RunWithCancellationAsync>d__6, bicep, Version=0.29.0.0, Culture=neutral, PublicKeyToken=null]](<RunWithCancellationAsync>d__6 ByRef)\r\n   at Bicep.Cli.Program.RunWithCancellationAsync(System.Func`2<System.Threading.CancellationToken,System.Threading.Tasks.Task`1<Int32>>)\r\n   at Bicep.Cli.Program+<Main>d__3.MoveNext()\r\n   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[[Bicep.Cli.Program+<Main>d__3, bicep, Version=0.29.0.0, Culture=neutral, PublicKeyToken=null]](<Main>d__3 ByRef)\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].Start[[Bicep.Cli.Program+<Main>d__3, bicep, Version=0.29.0.0, Culture=neutral, PublicKeyToken=null]](<Main>d__3 ByRef)\r\n   at Bicep.Cli.Program.Main(System.String[])\r\n   at Bicep.Cli.Program.<Main>(System.String[])\r\n```\n\n### Issue script & Debug output\n\nNot related to Python part of `az`, but the Bicep extension.\n\n### Expected behavior\n\nSuccessful deployment. AFAIK, .NET sets globalization invariant mode in their Alpine images, but obviously this is not set in the azure-cli images based on cbl-mariner-2.0 and affects Bicep.\n\n### Environment Summary\n\n```\r\nazure-cli                         2.64.0\r\n\r\ncore                              2.64.0\r\ntelemetry                          1.1.0\r\n\r\nDependencies:\r\nmsal                              1.30.0\r\nazure-mgmt-resource               23.1.1\r\n\r\nPython location '/usr/bin/python3.9'\r\nExtensions directory '/root/.azure/cliextensions'\r\n\r\nPython (Linux) 3.9.19 (main, Aug 23 2024, 00:07:48)\r\n[GCC 11.2.0]\r\n\r\nLegal docs and information: aka.ms/AzureCliLegal\r\n\r\n\r\nYour CLI is up-to-date.\r\n```\n\n### Additional context\n\n_No response_",
      "solution": "**Workaround**: For now, please use the `2.63.0` tag.\n\n---\n\nI can confirm manually installing `icu` or `libicu` package also solves the issue.\r\n\r\n```\r\ntdnf install --assumeyes icu\r\n```\r\n\r\n`tdnf` shows the `icu` package takes 33.29M installed size and this will increase the docker image size:\r\n\r\n```\r\n# tdnf install icu\r\nLoaded plugin: tdnfrepogpgcheck\r\n\r\nInstalling:\r\nicu                      x86_64             68.2.0.9-1.cm2           mariner-official-base  33.29M            13.24M\r\n\r\nTotal installed size:  33.29M\r\nTotal download size:  13.24M\r\n```\r\n\r\nThis will make https://github.com/Azure/azure-cli/issues/7387 worse.\r\n\r\nI am considering if `icu` can be dynamically installed when installing the bicep executable. \r\n\r\nThe Alpine-based image installs `icu-libs` in the build process: \r\n\r\nhttps://github.com/Azure/azure-cli/blob/413d13a851d827029a348c412e8c037f0f2e5d5a/alpine.dockerfile#L37\r\n\n\n---\n\n@pamelafox agreed, I was just looking to get more info on the problem. Having AzureCLI set this env var on the container feels like a viable longer-term solution.\r\n\r\nEDIT: I think #29897 should address this.",
      "labels": [
        "bug",
        "Service Attention",
        "customer-reported",
        "Auto-Assign",
        "Packaging/Mariner",
        "Azure Deployments"
      ],
      "created_at": "2024-09-03T10:23:11Z",
      "closed_at": "2026-01-12T11:24:01Z",
      "url": "https://github.com/Azure/azure-cli/issues/29828",
      "comments_count": 16
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32458,
      "title": "Azure Cli restore AKS form backup",
      "problem": "### Describe the bug\nBased on chatgpt, Azure CLI bug inside the dataprotection extension \u2014 NOT my script problem.\n\nURL link: https://learn.microsoft.com/en-us/azure/backup/azure-kubernetes-service-cluster-restore-using-cli#prepare-the-restore-request\n\nAfter run command but stuck in \naz dataprotection backup-instance restore initialize-for-data-recovery\n\nexample command\n>az dataprotection backup-instance restore initialize-for-data-recovery \\\n > --datasource-type AzureKubernetesService \\\n >--restore-location $region \\\n > --source-datastore VaultStore \\\n > --recovery-point-id $recoverypointid \\\n > --restore-configuration restoreconfig.json \\\n > --target-resource-id $targetresourceid \n\n\n\n\n\nThe command failed with an unexpected error. Here is the traceback:\ncannot access local variable 'container_list_present' where it is not associated with a value\nTraceback (most recent call last):\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\knack/cli.py\", line 233, in invoke\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 666, in execute\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 734, in _run_jobs_serially\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 726, in _run_job\n  File \"C:\\Users\\yukleong.chow\\.azure\\cliextensions\\dataprotection\\azext_dataprotection\\manual\\_exception_handler.py\", line 13, in exception_handler\n    raise ex\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 703, in _run_job\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 336, in __call__\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/command_operation.py\", line 120, in handler\n  File \"C:\\Users\\yukleong.chow\\.azure\\cliextensions\\dataprotection\\azext_dataprotection\\manual\\custom.py\", line 1005, in restore_initialize_for_data_recovery\n    restore_request[\"restore_target_info\"][\"restore_criteria\"] = helper.get_resource_criteria_list(datasource_type, restore_configuration,\n                                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                                                                                   None, None, None, None, None)\n                                                                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\yukleong.chow\\.azure\\cliextensions\\dataprotection\\azext_dataprotection\\manual\\helpers.py\", line 562, in get_resource_criteria_list\n    if container_list_present:\n       ^^^^^^^^^^^^^^^^^^^^^^\nUnboundLocalError: cannot access local variable 'container_list_present' where it is not associated with a value\n\n\nany solution ,already latest version for  az extension update --name dataprotection\n\n### Related command\n\nPS C:\\Windows\\system32> az dataprotection backup-instance restore initialize-for-data-recovery `\n>>     --datasource-type AzureKubernetesService `\n>>     --restore-location $region `\n>>     --source-datastore VaultStore `\n>>     --recovery-point-id $recoverypointid `\n>>     --restore-configuration restoreconfig.json `\n>>     --target-resource-id $targetresourceid associated with a value\n\n### Errors\n\nThe command failed with an unexpected error. Here is the traceback:\ncannot access local variable 'container_list_present' where it is not associated with a value\nTraceback (most recent call last):\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\knack/cli.py\", line 233, in invoke\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 666, in execute\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 734, in _run_jobs_serially\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 726, in _run_job\n  File \"C:\\Users\\yukleong.chow\\.azure\\cliextensions\\dataprotection\\azext_dataprotection\\manual\\_exception_handler.py\", line 13, in exception_handler\n    raise ex\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 703, in _run_job\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 336, in __call__\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/command_operation.py\", line 120, in handler\n  File \"C:\\Users\\yukleong.chow\\.azure\\cliextensions\\dataprotection\\azext_dataprotection\\manual\\custom.py\", line 1005, in restore_initialize_for_data_recovery\n    restore_request[\"restore_target_info\"][\"restore_criteria\"] = helper.get_resource_criteria_list(datasource_type, restore_configuration,\n                                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n                                                                                                   None, None, None, None, None)\n                                                                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\yukleong.chow\\.azure\\cliextensions\\dataprotection\\azext_dataprotection\\manual\\helpers.py\", line 562, in get_resource_criteria_list\n    if container_list_present:\n       ^^^^^^^^^^^^^^^^^^^^^^\nUnboundLocalError: cannot access local variable 'container_list_present' where it is not associated with a value\n\n### Issue script & Debug output\n\n-\n\n### Expected behavior\n\nexpected successful\n\n### Environment Summary\n\nazure version 2.80.0\naz extension update --name dataprotection\n### Additional context\n\n_No response_",
      "solution": "Hi @infrontleong, we fixed this issue with this release: https://github.com/Azure/azure-cli-extensions/pull/9448",
      "labels": [
        "bug",
        "Service Attention",
        "customer-reported",
        "Data Protection"
      ],
      "created_at": "2025-11-25T07:29:26Z",
      "closed_at": "2026-01-12T09:14:12Z",
      "url": "https://github.com/Azure/azure-cli/issues/32458",
      "comments_count": 2
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32465,
      "title": "Azure CLI restore AKS have bug/issue (az dataprotection backup-instance restore initialize-for-data-recovery)",
      "problem": "### Describe the bug\n\nURL link : https://learn.microsoft.com/en-us/azure/backup/azure-kubernetes-service-cluster-restore-using-cli#prepare-the-restore-request\n\nCommand **az dataprotection backup-instance restore initialize-for-data-recovery** \n\n I am using azure cli latest version and run az extension add --name dataprotection, \n\n- look like the container_list_present Python bug\n\n- CLI cannot run the restore because of an internal bug in the Azure Data Protection extension\n\nDuring Prepare the restore request have issue\n\n1. After run this command , **successfully**, \n\n\naz dataprotection backup-instance initialize-restoreconfig --datasource-type AzureKubernetesService >restoreconfig.json\n\n\n\n2) run this, **failed**\naz dataprotection backup-instance restore initialize-for-data-recovery --datasource-type AzureKubernetesService --restore-location $region --source-datastore OperationalStore --recovery-point-id $recoverypointid --restore-configuration restoreconfig.json --target-resource-id /subscriptions/$subscriptionId/resourceGroups/$aksclusterresourcegroup/providers/Microsoft.ContainerService/managedClusters/$targetakscluster \n>restorerequestobject.json\n\n\n\n**_Error code_**\n\nERROR: The command failed with an unexpected error. Here is the traceback:\nERROR: cannot access local variable 'container_list_present' where it is not associated with a value\nTraceback (most recent call last):\n  File \"/usr/lib64/az/lib/python3.12/site-packages/knack/cli.py\", line 233, in invoke\n    cmd_result = self.invocation.execute(args)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib64/az/lib/python3.12/site-packages/azure/cli/core/commands/__init__.py\", line 666, in execute\n    raise ex\n  File \"/usr/lib64/az/lib/python3.12/site-packages/azure/cli/core/commands/__init__.py\", line 734, in _run_jobs_serially\n    results.append(self._run_job(expanded_arg, cmd_copy))\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib64/az/lib/python3.12/site-packages/azure/cli/core/commands/__init__.py\", line 726, in _run_job\n    return cmd_copy.exception_handler(ex)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/chow/.azure/cliextensions/dataprotection/azext_dataprotection/manual/_exception_handler.py\", line 13, in exception_handler\n    raise ex\n  File \"/usr/lib64/az/lib/python3.12/site-packages/azure/cli/core/commands/__init__.py\", line 703, in _run_job\n    result = cmd_copy(params)\n             ^^^^^^^^^^^^^^^^\n  File \"/usr/lib64/az/lib/python3.12/site-packages/azure/cli/core/commands/__init__.py\", line 336, in __call__\n    return self.handler(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib64/az/lib/python3.12/site-packages/azure/cli/core/commands/command_operation.py\", line 120, in handler\n    return op(**command_args)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/chow/.azure/cliextensions/dataprotection/azext_dataprotection/manual/custom.py\", line 1119, in restore_initialize_for_item_recovery\n    restore_request[\"restore_target_info\"][\"restore_criteria\"] = helper.get_resource_criteria_list(datasource_type, restore_configuration,\n                                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/chow/.azure/cliextensions/dataprotection/azext_dataprotection/manual/helpers.py\", line 562, in get_resource_criteria_list\n    if container_list_present:\n       ^^^^^^^^^^^^^^^^^^^^^^\nUnboundLocalError: cannot access local variable 'container_list_present' where it is not associated with a value\nTo check existing issues, please visit: https://github.com/Azure/azure-cli/issues\n\n### Related command\n\naz dataprotection backup-instance restore initialize-for-data-recovery \\\n  --datasource-type AzureKubernetesService \\\n  --restore-location $region \\\n  --source-datastore OperationalStore \\\n  --recovery-point-id $recoverypointid \\\n  --restore-configuration restoreconfig.json \\\n  --target-resource-id $targetresourceid\n\n### Errors\n\n-\n\n### Issue script & Debug output\n\nThe command failed with an unexpected error. Here is the traceback:\ncannot access local variable 'container_list_present' where it is not associated with a value\nTraceback (most recent call last):\n  File \"/usr/lib64/az/lib/python3.12/site-packages/knack/cli.py\", line 233, in invoke\n    cmd_result = self.invocation.execute(args)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib64/az/lib/python3.12/site-packages/azure/cli/core/commands/__init__.py\", line 666, in execute\n    raise ex\n  File \"/usr/lib64/az/lib/python3.12/site-packages/azure/cli/core/commands/__init__.py\", line 734, in _run_jobs_serially\n    results.append(self._run_job(expanded_arg, cmd_copy))\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib64/az/lib/python3.12/site-packages/azure/cli/core/commands/__init__.py\", line 726, in _run_job\n    return cmd_copy.exception_handler(ex)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/chow/.azure/cliextensions/dataprotection/azext_dataprotection/manual/_exception_handler.py\", line 13, in exception_handler\n    raise ex\n  File \"/usr/lib64/az/lib/python3.12/site-packages/azure/cli/core/commands/__init__.py\", line 703, in _run_job\n    result = cmd_copy(params)\n             ^^^^^^^^^^^^^^^^\n  File \"/usr/lib64/az/lib/python3.12/site-packages/azure/cli/core/commands/__init__.py\", line 336, in __call__\n    return self.handler(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib64/az/lib/python3.12/site-packages/azure/cli/core/commands/command_operation.py\", line 120, in handler\n    return op(**command_args)\n           ^^^^^^^^^^^^^^^^^^\n  File \"/home/chow/.azure/cliextensions/dataprotection/azext_dataprotection/manual/custom.py\", line 1005, in restore_initialize_for_data_recovery\n    restore_request[\"restore_target_info\"][\"restore_criteria\"] = helper.get_resource_criteria_list(datasource_type, restore_configuration,\n                                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/chow/.azure/cliextensions/dataprotection/azext_dataprotection/manual/helpers.py\", line 562, in get_resource_criteria_list\n    if container_list_present:\n       ^^^^^^^^^^^^^^^^^^^^^^\nUnboundLocalError: cannot access local variable 'container_list_present' where it is not associated with a value\n\n### Expected behavior\n\n - \n\n### Environment Summary\n\nazure cli latest version\naz extension add --name dataprotection\n\n\n### Additional context\n\nAnyone facing same issues",
      "solution": "Hi @infrontleong, we fixed this issue with this release: https://github.com/Azure/azure-cli-extensions/pull/9448",
      "labels": [
        "bug",
        "Service Attention",
        "customer-reported",
        "Data Protection",
        "Similar-Issue"
      ],
      "created_at": "2025-11-26T06:33:18Z",
      "closed_at": "2026-01-12T09:14:04Z",
      "url": "https://github.com/Azure/azure-cli/issues/32465",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32503,
      "title": "az storage file list not working properly with OAuth since version 2.79",
      "problem": "### Describe the bug\n\nSince Azure CLI version 2.79, the az storage file list command no longer works correctly when using OAuth authentication. This issue appeared in the same release that introduced fixes related to az storage file list, which may indicate a regression. Meanwhile, az storage file upload and az storage file download continue to function without any issues. Rolling back to version 2.78 resolves the problem, confirming that the behavior is specific to 2.79 and above. Upgrading to version 2.81 does not fix the issue either.\n\n### Related command\n\naz storage file list --account-name **[STORAGE_ACCOUNT_NAME]** --share-name **[FILESHARE_NAME]** --path **[FOLDER_NAME]** --enable-file-backup-request-intent --auth-mode login\n\n### Errors\n\nYou do not have the required permissions needed to perform this operation.\nDepending on your operation, you may need to be assigned one of the following roles:\n    \"Storage Blob Data Owner\"\n    \"Storage Blob Data Contributor\"\n    \"Storage Blob Data Reader\"\n    \"Storage Queue Data Contributor\"\n    \"Storage Queue Data Reader\"\n    \"Storage Table Data Contributor\"\n    \"Storage Table Data Reader\"\n \nIf you want to use the old authentication method and allow querying for the right account key, please use the \"--auth-mode\" parameter and \"key\" value.\n\n### Issue script & Debug output\n\n/ \n\n### Expected behavior\n\nThe az storage file list command should work correctly with OAuth authentication, just like az storage file upload and az storage file download. Listing files should succeed without error in Azure CLI 2.79+ and behave the same way it does under version 2.78.\n\nThe command should not fail due to role validation errors unrelated to File Share access. The Service Principal used already has the proper role assigned : Storage File Data Privileged Contributor so file listing should be allowed without requiring any additional, unrelated permissions.\n\n### Environment Summary\n\nazure-cli 2.81.0\npython 3.12\n\n### Additional context\n\n_No response_",
      "solution": "Hello,\n\nI am using a **Storage Account (StorageV2 (general purpose v2))** with a **FileShare** with a file named _test.txt_.\n\nI reproduced the issue and I have the same error with az CLI versions 2.81.0, 2.80.0 and 2.79.0 when trying to list files :\n\n### Environment Summary\n\nPython 3.12.12\naz CLI installed via pip\n\n### Login\n\n`az login --service-principal --username \"xxx\" --tenant \"xxx\" --password \"xxx\"`\n\n### 2.81.0\n\n```\naz version\n{\n  \"azure-cli\": \"2.81.0\",\n  \"azure-cli-core\": \"2.81.0\",\n  \"azure-cli-telemetry\": \"1.1.0\",\n  \"extensions\": {}\n}\n\naz storage file list \\\n  --account-name \"xxx\" \\\n  --share-name \"xxx\" \\\n  --path \"xxx\" \\\n  --exclude-dir \\\n  --enable-file-backup-request-intent \\\n  --auth-mode login \\\n  | jq -r '.[].name'\n  \nYou do not have the required permissions needed to perform this operation.\nDepending on your operation, you may need to be assigned one of the following roles:\n    \"Storage Blob Data Owner\"\n    \"Storage Blob Data Contributor\"\n    \"Storage Blob Data Reader\"\n    \"Storage Queue Data Contributor\"\n    \"Storage Queue Data Reader\"\n    \"Storage Table Data Contributor\"\n    \"Storage Table Data Reader\"\n\nIf you want to use the old authentication method and allow querying for the right account key, please use the \"--auth-mode\" parameter and \"key\" value.\n```\n\n\n### 2.80.0\n\n```\naz version\n{\n  \"azure-cli\": \"2.80.0\",\n  \"azure-cli-core\": \"2.80.0\",\n  \"azure-cli-telemetry\": \"1.1.0\",\n  \"extensions\": {}\n}\n```\n\nSame error.\n\n### 2.79.0\n\n```\naz version\n{\n  \"azure-cli\": \"2.79.0\",\n  \"azure-cli-core\": \"2.79.0\",\n  \"azure-cli-telemetry\": \"1.1.0\",\n  \"extensions\": {}\n}\n```\n\nSame error.\n\n### 2.78.0\n\n```\naz version\n{\n  \"azure-cli\": \"2.78.0\",\n  \"azure-cli-core\": \"2.78.0\",\n  \"azure-cli-telemetry\": \"1.1.0\",\n  \"extensions\": {}\n}\n```\n\nWorking!\n\n```\naz storage file list \\\n  --account-name \"xxx\" \\\n  --share-name \"xxx\" \\\n  --path \"xxx\" \\\n  --exclude-dir \\\n  --enable-file-backup-request-intent \\\n  --auth-mode login \\\n  | jq -r '.[].name'\ntest.txt\n```\n\n### Download / Upload / Delete\n\nI do not have any issue while downloading, uploading nor deleting files using any of the above az CLI versions.\n\nRegards,\n\nROS.\n\n---\n\nHello,\n\nI tried adding the builtin Reader role to the Service Principal as you said and it worked using the 2.81.0 version.\n\nIt does fix the issue but why doesn't the Storage File Data Privileged Contributor role give read access for that matter ?\n\nUsing only Storage File Data Privileged Contributor role worked flawlessly in 2.78.0 (and earlier versions) and no longer works since 2.79.0.\n\nUsing two roles per FileShare may cause some issues in our Azure Environment because we seem to have role assignments quota per subscription and some of them are close to the max.\n\nThank you for your response.\n\nRegards,\n\nROS.",
      "labels": [
        "Storage",
        "question",
        "customer-reported",
        "Auto-Assign",
        "Azure CLI Team",
        "Similar-Issue"
      ],
      "created_at": "2025-12-05T09:08:48Z",
      "closed_at": "2026-01-12T06:12:29Z",
      "url": "https://github.com/Azure/azure-cli/issues/32503",
      "comments_count": 9
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32124,
      "title": "VM/VMSS support add-proxy-agent-extension parameter",
      "problem": "**Preconditions**\nNeed Python SDK release 2025-04-01. ETA: 09/30\n\n**Related command**\n<!--- Please provide the related command with az {command} if you can, so that we can quickly route to the related team for help. --->\n\nAdd a new parameter --add-proxy-agent-extension for vm/vmss create/update:\nSingle VM:\n```\naz vm create --add-proxy-agent-extension\naz vm update --add-proxy-agent-extension {false, true}\n```\n\n```\naz vmss create --add-proxy-agent-extension\naz vmss update --add-proxy-agent-extension {false, true}\n```\n\n**Resource Provider**\nMicrosoft.Compute\n\n**Is your feature request related to a problem? Please describe.**\n<!--- A clear and concise description of what the problem is. Ex. I'm always frustrated when [...] --->\n\n**Describe the solution you'd like**\n<!--- A clear and concise description of what you want to happen. --->\nHow to test:\nPlease test with a linux image:\n```\nset resourceGroupName=\"huiya-eastus2euap\"\nset locationName=\"WestUS2\"\nset vmName=\"vm2\"\nset adminPassword=\"your password\"\naz login\naz vm create -g %resourceGroupName% --location %locationName% --image Canonical:0001-com-ubuntu-server-jammy:22_04-lts:latest --size Standard_D2s_v5 --admin-username test_admin --admin-password %adminPassword% --enable-proxy-agent --add-proxy-agent-extension --name %vmName%\n```\nWithout setting add-proxy-agent-extension, the creation will fail with: :[{\"code\":\"OSProvisioningInternalError\",\"message\":\"OS Provisioning failed for VM 'vm2' due to an internal error.\"}]\nwith setting add-proxy-agent-extension, the creation will success.\n\n**Swagger PR link / SDK link**\nhttps://github.com/Azure/azure-rest-api-specs/pull/36669\n\n**Describe alternatives you've considered**\n<!--- A clear and concise description of any alternative solutions or features you've considered. --->\n\n**Additional context**\n<!--- Add any other context or screenshots about the feature request here. --->",
      "solution": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #27729\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nHi, this new feature appears in the `2023-09-01` version, but the current Comte python SDK does not have this version. Could you please fix the swagger PR to generate python SDK and release new SDK as soon?\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/27729#issuecomment-1807636673\n### Solution 2:\nChecked with SDK team, the python SDK to support 2023-09-01 will be released in the third week of December. So, we need to adjust the ETA to be early Jan 2024 - I'll double check with the feature's PM, most likely we are fine.\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/27729#issuecomment-1817238516\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
      "labels": [
        "Compute",
        "feature-request",
        "Auto-Assign",
        "Azure CLI Team",
        "Similar-Issue",
        "Possible-Solution"
      ],
      "created_at": "2025-09-15T21:31:22Z",
      "closed_at": "2026-01-08T06:36:25Z",
      "url": "https://github.com/Azure/azure-cli/issues/32124",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32609,
      "title": "Linux install script fails",
      "problem": "### Describe the bug\n\nThe \"Install script (any)\" documented [here](https://learn.microsoft.com/en-us/cli/azure/install-azure-cli-linux?view=azure-cli-latest&pivots=script) fails on my CachyOS (based on Arch linux) system.\n\n### Related command\n\n`curl -L https://aka.ms/InstallAzureCli | bash`\n\n### Errors\n\n```shellsession\nERROR: The executable /home/redacteduser/lib/azure-cli/bin/python3 is not functioning\nERROR: It thinks sys.prefix is '/usr' (should be '/home/redacteduser/lib/azure-cli')\nERROR: virtualenv is not compatible with this system or executable\n```\n\n### Issue script & Debug output\n\n```shellsession\n[redacteduser@redactedhost ~]$ curl -L https://aka.ms/InstallAzureCli | bash\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0   0     0   0     0     0     0  --:--:-- --:--:-- --:--:--     0\n100  1405 100  1405   0     0  3948     0  --:--:-- --:--:-- --:--:--  3948\nDownloading Azure CLI install script from https://azurecliprod.blob.core.windows.net/install.py to /tmp/azure_cli_install_tmp_xJV0xW.\n######################################################################## 100.0%\n/tmp/azure_cli_install_tmp_xJV0xW: OK\nRunning install script.\n-- Verifying Python version.\n-- Python version 3.13.11 okay.\n-- Verifying native dependencies.\n-- Unable to verify native dependencies. dist=cachyos linux, version=None. Continuing...\n\n===> In what directory would you like to place the install? (leave blank to use '/home/redacteduser/lib/azure-cli'):\n-- Creating directory '/home/redacteduser/lib/azure-cli'.\n-- We will install at '/home/redacteduser/lib/azure-cli'.\n\n===> In what directory would you like to place the 'az' executable? (leave blank to use '/home/redacteduser/bin'):\n-- The executable will be in '/home/redacteduser/bin'.\n-- Downloading virtualenv package from https://pypi.python.org/packages/source/v/virtualenv/virtualenv-16.7.11.tar.gz.\n-- Downloaded virtualenv package to /tmp/tmpfceocy83/virtualenv-16.7.11.tar.gz.\n-- Checksum of /tmp/tmpfceocy83/virtualenv-16.7.11.tar.gz OK.\n-- Extracting '/tmp/tmpfceocy83/virtualenv-16.7.11.tar.gz' to '/tmp/tmpfceocy83'.\n/tmp/azure_cli_install_tmp_xJV0xW:139: DeprecationWarning: Python 3.14 will, by default, filter extracted tar archives and reject files or modify their metadata. Use the filter argument to control this behavior.\n  package_tar.extractall(path=tmp_dir)\n-- Executing: ['/usr/bin/python3', 'virtualenv.py', '--python', '/usr/bin/python3', '/home/redacteduser/lib/azure-cli']\nAlready using interpreter /usr/bin/python3\nUsing base prefix '/usr'\nNew python executable in /home/redacteduser/lib/azure-cli/bin/python3\nAlso creating executable in /home/redacteduser/lib/azure-cli/bin/python\nERROR: The executable /home/redacteduser/lib/azure-cli/bin/python3 is not functioning\nERROR: It thinks sys.prefix is '/usr' (should be '/home/redacteduser/lib/azure-cli')\nERROR: virtualenv is not compatible with this system or executable\nTraceback (most recent call last):\n  File \"/tmp/azure_cli_install_tmp_xJV0xW\", line 415, in <module>\n    main()\n    ~~~~^^\n  File \"/tmp/azure_cli_install_tmp_xJV0xW\", line 399, in main\n    create_virtualenv(tmp_dir, install_dir)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^\n  File \"/tmp/azure_cli_install_tmp_xJV0xW\", line 144, in create_virtualenv\n    exec_command(cmd, cwd=working_dir)\n    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^\n  File \"/tmp/azure_cli_install_tmp_xJV0xW\", line 105, in exec_command\n    subprocess.check_call(command_list, cwd=cwd, env=env)\n    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.13/subprocess.py\", line 419, in check_call\n    raise CalledProcessError(retcode, cmd)\nsubprocess.CalledProcessError: Command '['/usr/bin/python3', 'virtualenv.py', '--python', '/usr/bin/python3', '/home/redacteduser/lib/azure-cli']' returned non-zero exit status 100.\n```\n\n### Expected behavior\n\nInstall script succeeds\n\n### Environment Summary\n\nNot applicable - if I could get the version of the azure CLI, I wouldn't be opening this issue.\n\n### Additional context\n\n_No response_",
      "solution": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #27775\n- #27529\n- #23215\n- #27218\n- #20047\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nThis script is not maintained for a long time, please follow this guide to install azure-cli with pip: https://github.com/Azure/azure-cli/issues/20476\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/27775#issuecomment-1797150469\n- https://github.com/azure/azure-cli/issues/23215#issuecomment-1186954631\n- https://github.com/azure/azure-cli/issues/27218#issuecomment-1687577865\n### Solution 2:\nThe way described in #20476 works in manjaro 6.1.60-1\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/27529#issuecomment-1805876322\n### Solution 3:\nIndeed, pip seems to work.\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/27218#issuecomment-1687603925\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
      "labels": [
        "bug",
        "customer-reported",
        "Installation",
        "Azure CLI Team",
        "Similar-Issue",
        "Possible-Solution"
      ],
      "created_at": "2026-01-06T18:09:45Z",
      "closed_at": "2026-01-08T02:35:50Z",
      "url": "https://github.com/Azure/azure-cli/issues/32609",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32383,
      "title": "Cannot disable soft delete for Azure site recovery vault in CLI version 2.75~2.78",
      "problem": "### Describe the bug\nWe cannot disable soft delete for Azure site recovery vault in CLI version 2.75~2.78.  But we can disable soft delete for Azure Site Recovery vault in CLI 2.73   \nWe suppose there is a bug in 2.75 - 2.78.  \n\nWe use the same vault for test. Vault Name is asrtest.\n\n<img width=\"1369\" height=\"555\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/2d8c01d4-880a-4108-9c8a-13b48afd6ddc\" />\n\n### Related command\n\naz backup vault backup-properties set --name <VaultName> --resource-group <ResourceGroup> --soft-delete-feature-state Disable\n\n### Errors\n\n<img width=\"1918\" height=\"181\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/7fb17a3c-759c-4753-9936-15a8600cb55f\" />\n\ncli.azure.cli.core.azclierror: (BMSUserErrorDisablingSoftDeleteStateNotAllowed) Disabling soft delete or enhanced security state is not allowed for this vault. Please contact Microsoft Support if this is not expected.\nCode: BMSUserErrorDisablingSoftDeleteStateNotAllowed\nMessage: Disabling soft delete or enhanced security state is not allowed for this vault. Please contact Microsoft Support if this is not expected.\naz_command_data_logger: (BMSUserErrorDisablingSoftDeleteStateNotAllowed) Disabling soft delete or enhanced security state is not allowed for this vault. Please contact Microsoft Support if this is not expected.\nCode: BMSUserErrorDisablingSoftDeleteStateNotAllowed\nMessage: Disabling soft delete or enhanced security state is not allowed for this vault. Please contact Microsoft Support if this is not expected.\n\n\n### Issue script & Debug output\n\n**az backup vault backup-properties set --name asrtest --resource-group asrtest --soft-delete-feature-state Disable --debug**\ncli.knack.cli: Command arguments: ['backup', 'vault', 'backup-properties', 'set', '--name', 'asrtest', '--resource-group', 'asrtest', '--soft-delete-feature-state', 'Disable', '--debug']\ncli.knack.cli: __init__ debug log:\nEnable color in terminal.\nEnable VT mode.\ncli.knack.cli: Event: Cli.PreExecute []\ncli.knack.cli: Event: CommandParser.OnGlobalArgumentsCreate [<function CLILogging.on_global_arguments at 0x00000283EC6B45E0>, <function OutputProducer.on_global_arguments at 0x00000283ECC419E0>, <function CLIQuery.on_global_arguments at 0x00000283ECC9F920>]\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableCreate []\ncli.azure.cli.core: Modules found from index for 'backup': ['azure.cli.command_modules.backup']\ncli.azure.cli.core: Loading command modules:\ncli.azure.cli.core: Name                  Load Time    Groups  Commands\ncli.azure.cli.core: backup                    0.009        16        61\ncli.azure.cli.core: Total (1)                 0.009        16        61\ncli.azure.cli.core: Loaded 16 groups, 61 commands.\ncli.azure.cli.core: Found a match in the command table.\ncli.azure.cli.core: Raw command  : backup vault backup-properties set\ncli.azure.cli.core: Command table: backup vault backup-properties set\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableTruncate [<function AzCliLogging.init_command_file_logging at 0x00000283EF3811C0>]\ncli.azure.cli.core.azlogging: metadata file logging enabled - writing logs to 'C:\\Users\\cao.yipeng\\.azure\\commands\\2025-11-05.15-01-20.backup_vault_backup-properties_set.23728.log'.\naz_command_data_logger: command args: backup vault backup-properties set --name {} --resource-group {} --soft-delete-feature-state {} --debug\ncli.knack.cli: Event: CommandInvoker.OnPreArgumentLoad [<function register_global_subscription_argument.<locals>.add_subscription_parameter at 0x00000283EF3BE700>]\ncli.knack.cli: Event: CommandInvoker.OnPostArgumentLoad []\ncli.knack.cli: Event: CommandInvoker.OnPostCommandTableCreate [<function register_ids_argument.<locals>.add_ids_arguments at 0x00000283EF3E8A40>, <function register_cache_arguments.<locals>.add_cache_arguments at 0x00000283EF3E8C20>, <function register_upcoming_breaking_change_info.<locals>.update_breaking_change_info at 0x00000283EF3E8CC0>]\ncli.knack.cli: Event: CommandInvoker.OnCommandTableLoaded []\ncli.knack.cli: Event: CommandInvoker.OnPreParseArgs []\ncli.knack.cli: Event: CommandInvoker.OnPostParseArgs [<function OutputProducer.handle_output_argument at 0x00000283ECC41A80>, <function CLIQuery.handle_query_parameter at 0x00000283ECC9F9C0>, <function register_ids_argument.<locals>.parse_ids_arguments at 0x00000283EF3E8AE0>]\ncli.azure.cli.core.commands.client_factory: Getting management service client client_type=RecoveryServicesBackupClient\ncli.azure.cli.core.auth.persistence: build_persistence: location='C:\\\\Users\\\\cao.yipeng\\\\.azure\\\\msal_token_cache.bin', encrypt=True\ncli.azure.cli.core.auth.binary_cache: load: C:\\Users\\cao.yipeng\\.azure\\msal_http_cache.bin\nurllib3.util.retry: Converted retries value: 1 -> Retry(total=1, connect=None, read=None, redirect=None, status=None)\nmsal.authority: Initializing with Entra authority: https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b\nmsal.authority: openid_config(\"https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/v2.0/.well-known/openid-configuration\") = {'token_endpoint': 'https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/oauth2/v2.0/token', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'private_key_jwt', 'client_secret_basic'], 'jwks_uri': 'https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/discovery/v2.0/keys', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['pairwise'], 'id_token_signing_alg_values_supported': ['RS256'], 'code_challenge_methods_supported': ['plain', 'S256'], 'response_types_supported': ['code', 'id_token', 'code id_token', 'id_token token'], 'scopes_supported': ['openid', 'profile', 'email', 'offline_access'], 'issuer': 'https://login.partner.microsoftonline.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/v2.0', 'request_uri_parameter_supported': False, 'userinfo_endpoint': 'https://microsoftgraph.chinacloudapi.cn/oidc/userinfo', 'authorization_endpoint': 'https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/oauth2/v2.0/authorize', 'device_authorization_endpoint': 'https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/oauth2/v2.0/devicecode', 'http_logout_supported': True, 'frontchannel_logout_supported': True, 'end_session_endpoint': 'https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/oauth2/v2.0/logout', 'claims_supported': ['sub', 'iss', 'cloud_instance_name', 'cloud_instance_host_name', 'cloud_graph_host_name', 'msgraph_host', 'aud', 'exp', 'iat', 'auth_time', 'acr', 'nonce', 'preferred_username', 'name', 'tid', 'ver', 'at_hash', 'c_hash', 'email'], 'kerberos_endpoint': 'https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/kerberos', 'tenant_region_scope': 'AS', 'cloud_instance_name': 'partner.microsoftonline.cn', 'cloud_graph_host_name': 'graph.chinacloudapi.cn', 'msgraph_host': 'microsoftgraph.chinacloudapi.cn', 'rbac_url': 'https://pas.chinacloudapi.cn'}\nmsal.application: Broker enabled? True\ncli.azure.cli.command_modules.backup.custom: --backup-storage-redundancy, --cross-region-restore-flag, --classic-alerts and --azure-monitor-alerts-for-job-failures parameters will be ignored if provided.\ncli.azure.cli.core.commands.client_factory: Getting management service client client_type=RecoveryServicesBackupClient\nurllib3.util.retry: Converted retries value: 1 -> Retry(total=1, connect=None, read=None, redirect=None, status=None)\nmsal.authority: Initializing with Entra authority: https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b\nmsal.authority: openid_config(\"https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/v2.0/.well-known/openid-configuration\") = {'token_endpoint': 'https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/oauth2/v2.0/token', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'private_key_jwt', 'client_secret_basic'], 'jwks_uri': 'https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/discovery/v2.0/keys', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['pairwise'], 'id_token_signing_alg_values_supported': ['RS256'], 'code_challenge_methods_supported': ['plain', 'S256'], 'response_types_supported': ['code', 'id_token', 'code id_token', 'id_token token'], 'scopes_supported': ['openid', 'profile', 'email', 'offline_access'], 'issuer': 'https://login.partner.microsoftonline.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/v2.0', 'request_uri_parameter_supported': False, 'userinfo_endpoint': 'https://microsoftgraph.chinacloudapi.cn/oidc/userinfo', 'authorization_endpoint': 'https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/oauth2/v2.0/authorize', 'device_authorization_endpoint': 'https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/oauth2/v2.0/devicecode', 'http_logout_supported': True, 'frontchannel_logout_supported': True, 'end_session_endpoint': 'https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/oauth2/v2.0/logout', 'claims_supported': ['sub', 'iss', 'cloud_instance_name', 'cloud_instance_host_name', 'cloud_graph_host_name', 'msgraph_host', 'aud', 'exp', 'iat', 'auth_time', 'acr', 'nonce', 'preferred_username', 'name', 'tid', 'ver', 'at_hash', 'c_hash', 'email'], 'kerberos_endpoint': 'https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/kerberos', 'tenant_region_scope': 'AS', 'cloud_instance_name': 'partner.microsoftonline.cn', 'cloud_graph_host_name': 'graph.chinacloudapi.cn', 'msgraph_host': 'microsoftgraph.chinacloudapi.cn', 'rbac_url': 'https://pas.chinacloudapi.cn'}\nmsal.application: Broker enabled? True\ncli.azure.cli.core.auth.credential_adaptor: CredentialAdaptor.get_token_info: scopes=('https://management.core.chinacloudapi.cn//.default',), options={}\ncli.azure.cli.core.auth.msal_credentials: UserCredential.acquire_token: scopes=['https://management.core.chinacloudapi.cn//.default'], claims_challenge=None, kwargs={}\nmsal.application: Cache hit an AT\nmsal.telemetry: Generate or reuse correlation_id: 379f280c-fa8a-4a27-97c9-c52ff634a2bc\ncli.azure.cli.core.sdk.policies: Request URL: 'https://management.chinacloudapi.cn/subscriptions/fe456b35-63d2-4b94-a30a-cf03b5433907/resourceGroups/asrtest/providers/Microsoft.RecoveryServices/vaults/asrtest/backupconfig/vaultconfig?api-version=2025-02-01'\ncli.azure.cli.core.sdk.policies: Request method: 'GET'\ncli.azure.cli.core.sdk.policies: Request headers:\ncli.azure.cli.core.sdk.policies:     'Accept': 'application/json'\ncli.azure.cli.core.sdk.policies:     'x-ms-client-request-id': '3b69f1af-ba15-11f0-9733-70b5e87265cf'\ncli.azure.cli.core.sdk.policies:     'CommandName': 'backup vault backup-properties set'\ncli.azure.cli.core.sdk.policies:     'ParameterSetName': '--name --resource-group --soft-delete-feature-state --debug'\ncli.azure.cli.core.sdk.policies:     'User-Agent': 'AZURECLI/2.78.0 (MSI) azsdk-python-core/1.35.0 Python/3.13.7 (Windows-11-10.0.26100-SP0)'\ncli.azure.cli.core.sdk.policies:     'Authorization': '*****'\ncli.azure.cli.core.sdk.policies: Request body:\ncli.azure.cli.core.sdk.policies: This request has no body\nurllib3.connectionpool: Starting new HTTPS connection (1): management.chinacloudapi.cn:443\nurllib3.connectionpool: https://management.chinacloudapi.cn:443 \"GET /subscriptions/fe456b35-63d2-4b94-a30a-cf03b5433907/resourceGroups/asrtest/providers/Microsoft.RecoveryServices/vaults/asrtest/backupconfig/vaultconfig?api-version=2025-02-01 HTTP/1.1\" 200 399\ncli.azure.cli.core.sdk.policies: Response status: 200\ncli.azure.cli.core.sdk.policies: Response headers:\ncli.azure.cli.core.sdk.policies:     'Cache-Control': 'no-cache'\ncli.azure.cli.core.sdk.policies:     'Pragma': 'no-cache'\ncli.azure.cli.core.sdk.policies:     'Content-Length': '399'\ncli.azure.cli.core.sdk.policies:     'Content-Type': 'application/json; charset=utf-8'\ncli.azure.cli.core.sdk.policies:     'Expires': '-1'\ncli.azure.cli.core.sdk.policies:     'X-Content-Type-Options': 'nosniff'\ncli.azure.cli.core.sdk.policies:     'x-ms-request-id': '2a4297e6-351b-44bf-a72b-e584fe6aeebc'\ncli.azure.cli.core.sdk.policies:     'x-ms-client-request-id': '3b69f1af-ba15-11f0-9733-70b5e87265cf'\ncli.azure.cli.core.sdk.policies:     'Server': 'Kestrel'\ncli.azure.cli.core.sdk.policies:     'x-ms-operation-identifier': 'tenantId=b388b808-0ec9-4a09-a414-a7cbbd8b7e9b,objectId=f7cf74bb-023b-426f-a4d9-814fe3069d40/chinanorth2/d45fde4a-7006-4b89-9194-77b1b96e9f4f'\ncli.azure.cli.core.sdk.policies:     'x-ms-ratelimit-remaining-subscription-resource-requests': '249'\ncli.azure.cli.core.sdk.policies:     'x-ms-correlation-request-id': '2a4297e6-351b-44bf-a72b-e584fe6aeebc'\ncli.azure.cli.core.sdk.policies:     'x-ms-routing-request-id': 'CHINANORTH2:20251105T070121Z:2a4297e6-351b-44bf-a72b-e584fe6aeebc'\ncli.azure.cli.core.sdk.policies:     'Strict-Transport-Security': 'max-age=31536000; includeSubDomains'\ncli.azure.cli.core.sdk.policies:     'Date': 'Wed, 05 Nov 2025 07:01:21 GMT'\ncli.azure.cli.core.sdk.policies: Response content:\ncli.azure.cli.core.sdk.policies: {\"id\":\"/subscriptions/fe456b35-63d2-4b94-a30a-cf03b5433907/resourceGroups/asrtest/providers/Microsoft.RecoveryServices/vaults/asrtest/backupconfig/vaultconfig\",\"name\":\"vaultconfig\",\"type\":\"Microsoft.RecoveryServices/vaults/backupconfig\",\"properties\":{\"enhancedSecurityState\":\"Disabled\",\"softDeleteFeatureState\":\"Enabled\",\"softDeleteRetentionPeriodInDays\":14,\"isSoftDeleteFeatureStateEditable\":true}}\ncli.azure.cli.core.commands.client_factory: Getting management service client client_type=RecoveryServicesBackupClient\nurllib3.util.retry: Converted retries value: 1 -> Retry(total=1, connect=None, read=None, redirect=None, status=None)\nmsal.authority: Initializing with Entra authority: https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b\nmsal.authority: openid_config(\"https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/v2.0/.well-known/openid-configuration\") = {'token_endpoint': 'https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/oauth2/v2.0/token', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'private_key_jwt', 'client_secret_basic'], 'jwks_uri': 'https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/discovery/v2.0/keys', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['pairwise'], 'id_token_signing_alg_values_supported': ['RS256'], 'code_challenge_methods_supported': ['plain', 'S256'], 'response_types_supported': ['code', 'id_token', 'code id_token', 'id_token token'], 'scopes_supported': ['openid', 'profile', 'email', 'offline_access'], 'issuer': 'https://login.partner.microsoftonline.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/v2.0', 'request_uri_parameter_supported': False, 'userinfo_endpoint': 'https://microsoftgraph.chinacloudapi.cn/oidc/userinfo', 'authorization_endpoint': 'https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/oauth2/v2.0/authorize', 'device_authorization_endpoint': 'https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/oauth2/v2.0/devicecode', 'http_logout_supported': True, 'frontchannel_logout_supported': True, 'end_session_endpoint': 'https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/oauth2/v2.0/logout', 'claims_supported': ['sub', 'iss', 'cloud_instance_name', 'cloud_instance_host_name', 'cloud_graph_host_name', 'msgraph_host', 'aud', 'exp', 'iat', 'auth_time', 'acr', 'nonce', 'preferred_username', 'name', 'tid', 'ver', 'at_hash', 'c_hash', 'email'], 'kerberos_endpoint': 'https://login.chinacloudapi.cn/b388b808-0ec9-4a09-a414-a7cbbd8b7e9b/kerberos', 'tenant_region_scope': 'AS', 'cloud_instance_name': 'partner.microsoftonline.cn', 'cloud_graph_host_name': 'graph.chinacloudapi.cn', 'msgraph_host': 'microsoftgraph.chinacloudapi.cn', 'rbac_url': 'https://pas.chinacloudapi.cn'}\nmsal.application: Broker enabled? True\ncli.azure.cli.core.auth.credential_adaptor: CredentialAdaptor.get_token_info: scopes=('https://management.core.chinacloudapi.cn//.default',), options={}\ncli.azure.cli.core.auth.msal_credentials: UserCredential.acquire_token: scopes=['https://management.core.chinacloudapi.cn//.default'], claims_challenge=None, kwargs={}\nmsal.application: Cache hit an AT\nmsal.telemetry: Generate or reuse correlation_id: 35db4ca4-e909-4300-85c9-89f47a69a9c6\ncli.azure.cli.core.sdk.policies: Request URL: 'https://management.chinacloudapi.cn/subscriptions/fe456b35-63d2-4b94-a30a-cf03b5433907/resourceGroups/asrtest/providers/Microsoft.RecoveryServices/vaults/asrtest/backupResourceGuardProxies?api-version=2025-02-01'\ncli.azure.cli.core.sdk.policies: Request method: 'GET'\ncli.azure.cli.core.sdk.policies: Request headers:\ncli.azure.cli.core.sdk.policies:     'Accept': 'application/json'\ncli.azure.cli.core.sdk.policies:     'x-ms-client-request-id': '3b69f1af-ba15-11f0-9733-70b5e87265cf'\ncli.azure.cli.core.sdk.policies:     'CommandName': 'backup vault backup-properties set'\ncli.azure.cli.core.sdk.policies:     'ParameterSetName': '--name --resource-group --soft-delete-feature-state --debug'\ncli.azure.cli.core.sdk.policies:     'User-Agent': 'AZURECLI/2.78.0 (MSI) azsdk-python-core/1.35.0 Python/3.13.7 (Windows-11-10.0.26100-SP0)'\ncli.azure.cli.core.sdk.policies:     'Authorization': '*****'\ncli.azure.cli.core.sdk.policies: Request body:\ncli.azure.cli.core.sdk.policies: This request has no body\nurllib3.connectionpool: Starting new HTTPS connection (1): management.chinacloudapi.cn:443\nurllib3.connectionpool: https://management.chinacloudapi.cn:443 \"GET /subscriptions/fe456b35-63d2-4b94-a30a-cf03b5433907/resourceGroups/asrtest/providers/Microsoft.RecoveryServices/vaults/asrtest/backupResourceGuardProxies?api-version=2025-02-01 HTTP/1.1\" 200 12\ncli.azure.cli.core.sdk.policies: Response status: 200\ncli.azure.cli.core.sdk.policies: Response headers:\ncli.azure.cli.core.sdk.policies:     'Cache-Control': 'no-cache'\ncli.azure.cli.core.sdk.policies:     'Pragma': 'no-cache'\ncli.azure.cli.core.sdk.policies:     'Content-Length': '12'\ncli.azure.cli.core.sdk.policies:     'Content-Type': 'application/json; charset=utf-8'\ncli.azure.cli.core.sdk.policies:     'Expires': '-1'\ncli.azure.cli.core.sdk.policies:     'X-Content-Type-Options': 'nosniff'\ncli.azure.cli.core.sdk.policies:     'x-ms-request-id': 'c29b9a3f-9294-4367-80a9-a9feac912e71'\ncli.azure.cli.core.sdk.policies:     'x-ms-client-request-id': '3b69f1af-ba15-11f0-9733-70b5e87265cf'\ncli.azure.cli.core.sdk.policies:     'Server': 'Kestrel'\ncli.azure.cli.core.sdk.policies:     'x-ms-operation-identifier': 'tenantId=b388b808-0ec9-4a09-a414-a7cbbd8b7e9b,objectId=f7cf74bb-023b-426f-a4d9-814fe3069d40/chinanorth2/8c068cfa-4671-4352-a3a1-a0e4533b294b'\ncli.azure.cli.core.sdk.policies:     'x-ms-ratelimit-remaining-subscription-reads': '249'\ncli.azure.cli.core.sdk.policies:     'x-ms-ratelimit-remaining-subscription-global-reads': '3749'\ncli.azure.cli.core.sdk.policies:     'x-ms-correlation-request-id': 'c29b9a3f-9294-4367-80a9-a9feac912e71'\ncli.azure.cli.core.sdk.policies:     'x-ms-routing-request-id': 'CHINANORTH2:20251105T070121Z:c29b9a3f-9294-4367-80a9-a9feac912e71'\ncli.azure.cli.core.sdk.policies:     'Strict-Transport-Security': 'max-age=31536000; includeSubDomains'\ncli.azure.cli.core.sdk.policies:     'Date': 'Wed, 05 Nov 2025 07:01:20 GMT'\ncli.azure.cli.core.sdk.policies: Response content:\ncli.azure.cli.core.sdk.policies: {\"value\":[]}\ncli.azure.cli.core.sdk.policies: Request URL: 'https://management.chinacloudapi.cn/subscriptions/fe456b35-63d2-4b94-a30a-cf03b5433907/resourceGroups/asrtest/providers/Microsoft.RecoveryServices/vaults/asrtest/backupconfig/vaultconfig?api-version=2025-02-01'\ncli.azure.cli.core.sdk.policies: Request method: 'PATCH'\ncli.azure.cli.core.sdk.policies: Request headers:\ncli.azure.cli.core.sdk.policies:     'Content-Type': 'application/json'\ncli.azure.cli.core.sdk.policies:     'Content-Length': '130'\ncli.azure.cli.core.sdk.policies:     'Accept': 'application/json'\ncli.azure.cli.core.sdk.policies:     'x-ms-client-request-id': '3b69f1af-ba15-11f0-9733-70b5e87265cf'\ncli.azure.cli.core.sdk.policies:     'CommandName': 'backup vault backup-properties set'\ncli.azure.cli.core.sdk.policies:     'ParameterSetName': '--name --resource-group --soft-delete-feature-state --debug'\ncli.azure.cli.core.sdk.policies:     'User-Agent': 'AZURECLI/2.78.0 (MSI) azsdk-python-core/1.35.0 Python/3.13.7 (Windows-11-10.0.26100-SP0)'\ncli.azure.cli.core.sdk.policies:     'Authorization': '*****'\ncli.azure.cli.core.sdk.policies: Request body:\ncli.azure.cli.core.sdk.policies: {\"properties\": {\"enhancedSecurityState\": \"Disabled\", \"softDeleteFeatureState\": \"Disabled\", \"softDeleteRetentionPeriodInDays\": 14}}\nurllib3.connectionpool: https://management.chinacloudapi.cn:443 \"PATCH /subscriptions/fe456b35-63d2-4b94-a30a-cf03b5433907/resourceGroups/asrtest/providers/Microsoft.RecoveryServices/vaults/asrtest/backupconfig/vaultconfig?api-version=2025-02-01 HTTP/1.1\" 400 217\ncli.azure.cli.core.sdk.policies: Response status: 400\ncli.azure.cli.core.sdk.policies: Response headers:\ncli.azure.cli.core.sdk.policies:     'Cache-Control': 'no-cache'\ncli.azure.cli.core.sdk.policies:     'Pragma': 'no-cache'\ncli.azure.cli.core.sdk.policies:     'Content-Length': '217'\ncli.azure.cli.core.sdk.policies:     'Content-Type': 'application/json'\ncli.azure.cli.core.sdk.policies:     'Expires': '-1'\ncli.azure.cli.core.sdk.policies:     'x-ms-operation-identifier': 'tenantId=b388b808-0ec9-4a09-a414-a7cbbd8b7e9b,objectId=f7cf74bb-023b-426f-a4d9-814fe3069d40/chinanorth2/6d070d24-1b28-4486-be0f-439f1fb2ccd0'\ncli.azure.cli.core.sdk.policies:     'X-Content-Type-Options': 'nosniff'\ncli.azure.cli.core.sdk.policies:     'x-ms-request-id': '65b41ccf-01f7-49db-a23d-5fea7b3ed0fb'\ncli.azure.cli.core.sdk.policies:     'x-ms-client-request-id': '3b69f1af-ba15-11f0-9733-70b5e87265cf'\ncli.azure.cli.core.sdk.policies:     'Server': 'Kestrel'\ncli.azure.cli.core.sdk.policies:     'x-ms-ratelimit-remaining-subscription-writes': '199'\ncli.azure.cli.core.sdk.policies:     'x-ms-ratelimit-remaining-subscription-global-writes': '2999'\ncli.azure.cli.core.sdk.policies:     'x-ms-correlation-request-id': '65b41ccf-01f7-49db-a23d-5fea7b3ed0fb'\ncli.azure.cli.core.sdk.policies:     'x-ms-routing-request-id': 'CHINANORTH2:20251105T070121Z:65b41ccf-01f7-49db-a23d-5fea7b3ed0fb'\ncli.azure.cli.core.sdk.policies:     'Strict-Transport-Security': 'max-age=31536000; includeSubDomains'\ncli.azure.cli.core.sdk.policies:     'Date': 'Wed, 05 Nov 2025 07:01:21 GMT'\ncli.azure.cli.core.sdk.policies: Response content:\ncli.azure.cli.core.sdk.policies: {\"error\":{\"code\":\"BMSUserErrorDisablingSoftDeleteStateNotAllowed\",\"message\":\"Disabling soft delete or enhanced security state is not allowed for this vault. Please contact Microsoft Support if this is not expected.\"}}\ncli.azure.cli.core.azclierror: Traceback (most recent call last):\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 703, in _run_job\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 336, in __call__\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/command_operation.py\", line 120, in handler\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/command_modules/backup/custom.py\", line 703, in set_backup_properties\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/core/tracing/decorator.py\", line 119, in wrapper_use_tracer\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/mgmt/recoveryservicesbackup/activestamp/operations/_backup_resource_vault_configs_operations.py\", line 367, in update\nazure.core.exceptions.HttpResponseError: (BMSUserErrorDisablingSoftDeleteStateNotAllowed) Disabling soft delete or enhanced security state is not allowed for this vault. Please contact Microsoft Support if this is not expected.\nCode: BMSUserErrorDisablingSoftDeleteStateNotAllowed\nMessage: Disabling soft delete or enhanced security state is not allowed for this vault. Please contact Microsoft Support if this is not expected.\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\knack/cli.py\", line 233, in invoke\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 666, in execute\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 734, in _run_jobs_serially\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 726, in _run_job\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-**packages\\azure/cli/command_modules/backup/_exception_handler.py\", line 10, in backup_exception_handler\nazure.core.exceptions.HttpResponseError: (BMSUserErrorDisablingSoftDeleteStateNotAllowed) Disabling soft delete or enhanced security state is not allowed for this vault. Please contact Microsoft Support if this is not expected.\nCode: BMSUserErrorDisablingSoftDeleteStateNotAllowed\nMessage: Disabling soft delete or enhanced security state is not allowed for this vault. Please contact Microsoft Support if this is not expected.**\n\ncli.azure.cli.core.azclierror: (BMSUserErrorDisablingSoftDeleteStateNotAllowed) Disabling soft delete or enhanced security state is not allowed for this vault. Please contact Microsoft Support if this is not expected.\nCode: BMSUserErrorDisablingSoftDeleteStateNotAllowed\nMessage: Disabling soft delete or enhanced security state is not allowed for this vault. Please contact Microsoft Support if this is not expected.\naz_command_data_logger: (BMSUserErrorDisablingSoftDeleteStateNotAllowed) Disabling soft delete or enhanced security state is not allowed for this vault. Please contact Microsoft Support if this is not expected.\nCode: BMSUserErrorDisablingSoftDeleteStateNotAllowed\nMessage: Disabling soft delete or enhanced security state is not allowed for this vault. Please contact Microsoft Support if this is not expected.\ncli.knack.cli: Event: Cli.PostExecute [<function AzCliLogging.deinit_cmd_metadata_logging at 0x00000283EF381440>]\naz_command_data_logger: exit code: 1\ncli.__main__: Command ran in 2.149 seconds (init: 0.371, invoke: 1.779)\ntelemetry.main: Begin splitting cli events and extra events, total events: 1\ntelemetry.client: Accumulated 0 events. Flush the clients.\ntelemetry.main: Finish splitting cli events and extra events, cli events: 1\ntelemetry.save: Save telemetry record of length 4311 in cache file under C:\\Users\\cao.yipeng\\.azure\\telemetry\\20251105150122107\ntelemetry.main: Begin creating telemetry upload process.\ntelemetry.process: Creating upload process: \"C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\python.exe C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\Lib\\site-packages\\azure\\cli\\telemetry\\__init__.pyc C:\\Users\\cao.yipeng\\.azure C:\\Users\\cao.yipeng\\.azure\\telemetry\\20251105150122107\"\ntelemetry.process: Return from creating process 48584\ntelemetry.main: Finish creating telemetry upload process.\n\n\n### Expected behavior\n\nfrom debug info, we see CLi 2.73 is using Azure API  api-version=2024-04-01, But CLI 2.78 uses Azure API api-version=2025-02-01.  We do not know if there is a change in Azure API or a bug in CLI 2.78. If there is bug, please help fix it .\n\n### Environment Summary\n\nCLI version 2.78\n\n### Additional context\n\n_No response_",
      "solution": "This is not a bug, it is by design: https://learn.microsoft.com/en-us/azure/backup/secure-by-default?tabs=preview. As a workaround for certain scenarios, it is subsequently now possible to soft-delete vaults which have soft-deleted items still present within them, with no billing impact.",
      "labels": [
        "bug",
        "Service Attention",
        "Recovery Services Backup",
        "customer-reported",
        "Auto-Assign"
      ],
      "created_at": "2025-11-05T07:18:20Z",
      "closed_at": "2026-01-07T10:38:23Z",
      "url": "https://github.com/Azure/azure-cli/issues/32383",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32527,
      "title": "Not able to az login",
      "problem": "### Describe the bug\n\nI'm using az login to develop features and functionalities in my software. When I was using version 2.61, it worked fine. Recently, I updated to the latest version, and now I can no longer log in.\n\n### Related command\n\naz login\n\n### Errors\n\nNo specific error message appears; the screen just stays in an infinite loading state and never completes the login.\n\n### Issue script & Debug output\n\ncli.knack.cli: Command arguments: ['login','--service-principal','-u', '********-****-****-****-************','-p=********','--tenant', '********-****-****-****-************','--debug']\ncli.knack.cli: __init__ debug log:\nEnable color in terminal.\ncli.knack.cli: Event: Cli.PreExecute []\ncli.knack.cli: Event: CommandParser.OnGlobalArgumentsCreate [<function CLILogging.on_global_arguments at 0x104804c20>, <function OutputProducer.on_global_arguments at 0x104a4aca0>, <function CLIQuery.on_global_arguments at 0x104a91080>]\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableCreate []\ncli.azure.cli.core: Modules found from index for 'login': ['azure.cli.command_modules.profile']\ncli.azure.cli.core: Loading command modules:\ncli.azure.cli.core: Name                  Load Time    Groups  Commands\ncli.azure.cli.core: profile                   0.002         2         8\ncli.azure.cli.core: Total (1)                 0.002         2         8\ncli.azure.cli.core: Loaded 2 groups, 8 commands.\ncli.azure.cli.core: Found a match in the command table.\ncli.azure.cli.core: Raw command  : login\ncli.azure.cli.core: Command table: login\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableTruncate [<function AzCliLogging.init_command_file_logging at 0x105eeef20>]\ncli.azure.cli.core.azlogging: metadata file logging enabled - writing logs to '/Users/luanlopes/.azure/commands/2025-12-11.10-26-11.login.49262.log'.\naz_command_data_logger: command args: login --service-principal -u {} -p={} --tenant {} --debug\ncli.knack.cli: Event: CommandInvoker.OnPreArgumentLoad [<function register_global_subscription_argument.<locals>.add_subscription_parameter at 0x105f3c860>]\ncli.knack.cli: Event: CommandInvoker.OnPostArgumentLoad []\ncli.knack.cli: Event: CommandInvoker.OnPostCommandTableCreate [<function register_ids_argument.<locals>.add_ids_arguments at 0x105f3eb60>, <function register_cache_arguments.<locals>.add_cache_arguments at 0x105f3ed40>, <function register_upcoming_breaking_change_info.<locals>.update_breaking_change_info at 0x105f3ede0>]\ncli.knack.cli: Event: CommandInvoker.OnCommandTableLoaded []\ncli.knack.cli: Event: CommandInvoker.OnPreParseArgs []\ncli.knack.cli: Event: CommandInvoker.OnPostParseArgs [<function OutputProducer.handle_output_argument at 0x104a4ad40>, <function CLIQuery.handle_query_parameter at 0x104a91120>, <function register_ids_argument.<locals>.parse_ids_arguments at 0x105f3ec00>]\ncli.azure.cli.core.auth.persistence: build_persistence: location='/Users/luanlopes/.azure/msal_token_cache.json', encrypt=False\ncli.azure.cli.core.auth.binary_cache: load: /Users/luanlopes/.azure/msal_http_cache.bin\ncli.azure.cli.core.auth.binary_cache: /Users/luanlopes/.azure/msal_http_cache.bin not found. Using a fresh one.\nurllib3.util.retry: Converted retries value: 1 -> Retry(total=1, connect=None, read=None, redirect=None, status=None)\nmsal.authority: Initializing with Entra authority: https://login.microsoftonline.com/b7aeabfe-1230-4a9a-8e68-32f70e6e9e60\nurllib3.connectionpool: Starting new HTTPS connection (1): login.microsoftonline.com:443\n\n### Expected behavior\n\nAllows successful login\n\n### Environment Summary\n\nazure-cli                         2.81.0\n\ncore                              2.81.0\ntelemetry                          1.1.0\n\nDependencies:\nmsal                            1.34.0b1\nazure-mgmt-resource               23.3.0\n\nPython location '/opt/homebrew/Cellar/azure-cli/2.81.0/libexec/bin/python'\nConfig directory '/Users/luanlopes/.azure'\nExtensions directory '/Users/luanlopes/.azure/cliextensions'\n\nPython (Darwin) 3.13.11 (main, Dec  5 2025, 16:06:33) [Clang 17.0.0 (clang-1700.4.4.1)]\n\n### Additional context\n\n<img width=\"1862\" height=\"1114\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/db3ffb9a-5da8-40ba-9b21-810bc14db4a0\" />",
      "solution": "@sawtoothHman I managed to solve the problem, basically, i had some broken packages after a general update everything back to work! Thanks ",
      "labels": [
        "Account",
        "question",
        "customer-reported",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2025-12-11T13:28:15Z",
      "closed_at": "2026-01-05T23:27:26Z",
      "url": "https://github.com/Azure/azure-cli/issues/32527",
      "comments_count": 8
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 25854,
      "title": "Regression in az aks create version 2.46.0 when the role assignment already exists ",
      "problem": "**Related command**\r\n<!--- Please provide the related command with az {command} if you can, so that we can quickly route to the related team for help. ---\r\n \r\naz aks create --resource-group JMeterClientPpe --name JMeterClusterPpe --node-count 25 --generate-ssh-keys --service-principal *** --client-secret *** --attach-acr /subscriptions/a479cf0a-5674-4e05-8746-225aa3d19b76/resourceGroups/scale-testing/providers/Microsoft.ContainerRegistry/registries/DigitalTwinsACR --location uksouth --load-balancer-managed-outbound-ip-count 25 --load-balancer-sku standard --enable-addons monitoring --vm-set-type AvailabilitySet --node-vm-size Standard_D4s_v3 --network-plugin azure --vnet-subnet-id /subscriptions/c493073e-2460-45ba-a403-f3e0df1e9fef/resourceGroups/JMeterClientPpe/providers/Microsoft.Network/virtualNetworks/JMeterClusterPpe-vnet/subnets/JMeterClusterPpe-subnet --docker-bridge-address 172.17.0.1/16 --dns-service-ip 10.0.0.10 --service-cidr 10.0.0.0/16\r\n\r\n**Describe the bug**\r\nThe assignment already exists. This was not a problem in previous version 2.45.0 but now the command fails after \"AAD role propagation\" with a message like\r\n\"Could not create a role assignment for ACR. Are you an Owner on this subscription?\"\r\nFrom the azure portal I can see the resource is asked several times for creating the role assignment, but it returns RoleAssignmentExists as it always did. More likely the conflict is now treated as an error\r\n\r\n**To Reproduce**\r\nCreate the assignment and run the command\r\n\r\n**Expected behavior**\r\nIf the assignment exists, the tool should accept that and go on; basically the previous behavior is expected.\r\n\r\n**Environment summary**\r\nIt is executed from an ADO AZ CLI task. The nodes got an upgrade from 2.45.0 to 2.46.0. Nothing changed to the scripts, only AZ CLI version and the ADO release start failing after the upgrade. To mitigate, we need to remove the assignment before running `az aks create`\r\n\r\n**Additional context**\r\n<!--- Add any other context about the problem here. --->\r\n",
      "solution": "Thanks for the feedback! We are routing this to the appropriate team for follow-up. cc @Azure/aks-pm.\n<details>\n<summary>Issue Details</summary>\n<hr />\n\n**Related command**\r\n<!--- Please provide the related command with az {command} if you can, so that we can quickly route to the related team for help. ---\r\n \r\naz aks create --resource-group JMeterClientPpe --name JMeterClusterPpe --node-count 25 --generate-ssh-keys --service-principal *** --client-secret *** --attach-acr /subscriptions/a479cf0a-5674-4e05-8746-225aa3d19b76/resourceGroups/scale-testing/providers/Microsoft.ContainerRegistry/registries/DigitalTwinsACR --location uksouth --load-balancer-managed-outbound-ip-count 25 --load-balancer-sku standard --enable-addons monitoring --vm-set-type AvailabilitySet --node-vm-size Standard_D4s_v3 --network-plugin azure --vnet-subnet-id /subscriptions/c493073e-2460-45ba-a403-f3e0df1e9fef/resourceGroups/JMeterClientPpe/providers/Microsoft.Network/virtualNetworks/JMeterClusterPpe-vnet/subnets/JMeterClusterPpe-subnet --docker-bridge-address 172.17.0.1/16 --dns-service-ip 10.0.0.10 --service-cidr 10.0.0.0/16\r\n\r\n**Describe the bug**\r\nThe assignment already exists. This was not a problem in previous version 2.45.0 but now the command fails after \"AAD role propagation\" with a message like\r\n\"Could not create a role assignment for ACR. Are you an Owner on this subscription?\"\r\nFrom the azure portal I can see the resource is asked several times for creating the role assignment, but it returns RoleAssignmentExists as it always did. More likely the conflict is now treated as an error\r\n\r\n**To Reproduce**\r\nCreate the assignment and run the command\r\n\r\n**Expected behavior**\r\nIf the assignment exists, the tool should accept that and go on; basically the previous behavior is expected.\r\n\r\n**Environment summary**\r\nIt is executed from an ADO AZ CLI task. The nodes got an upgrade from 2.45.0 to 2.46.0. Nothing changed to the scripts, only AZ CLI version and the ADO release start failing after the upgrade. To mitigate, we need to remove the assignment before running `az aks create`\r\n\r\n**Additional context**\r\n<!--- Add any other context about the problem here. --->\r\n\n\n<table>\n  <tr>\n    <th align=\"left\">Author:</th>\n    <td>jaslawinMs</td>\n  </tr>\n  <tr>\n    <th align=\"left\">Assignees:</th>\n    <td>-</td>\n  </tr>\n  <tr>\n    <th align=\"left\">Labels:</th>\n    <td>\n\n`Service Attention`, `AKS`, `needs-team-attention`, `Auto-Assign`\n\n</td>\n  </tr>\n  <tr>\n    <th align=\"left\">Milestone:</th>\n    <td>Backlog</td>\n  </tr>\n</table>\n</details>\n\n---\n\n> Any workarounds for this?\r\n\r\nJust use previous version until a new one is fixed. For Github actions with ubuntu runners, the following works:\r\n\r\n```yaml\r\nname: \"az-cli\"\r\ndescription: \"install azure cli\"\r\n\r\ninputs:\r\n  AZ_VERSION:\r\n    description: \"Version of azure cli to use\"\r\n    required: false\r\n\r\nruns:\r\n  using: composite\r\n  steps:\r\n    - shell: bash\r\n      run: |\r\n        sudo apt-get update\r\n        sudo apt-get -y install ca-certificates curl apt-transport-https lsb-release gnupg\r\n        sudo mkdir -p /etc/apt/keyrings\r\n        curl -sLS https://packages.microsoft.com/keys/microsoft.asc |\r\n            gpg --dearmor |\r\n            sudo tee /etc/apt/keyrings/microsoft.gpg > /dev/null\r\n        sudo chmod go+r /etc/apt/keyrings/microsoft.gpg\r\n        AZ_REPO=$(lsb_release -cs)\r\n        echo \"deb [arch=`dpkg --print-architecture` signed-by=/etc/apt/keyrings/microsoft.gpg] https://packages.microsoft.com/repos/azure-cli/ $AZ_REPO main\" |\r\n            sudo tee /etc/apt/sources.list.d/azure-cli.list\r\n        sudo apt-get update\r\n        sudo apt-get -y --allow-downgrades install azure-cli=${{ inputs.AZ_VERSION }}-1~$(lsb_release -cs)\r\n```\r\n\r\nFor the rest of the world, [refer to the documentation](https://learn.microsoft.com/en-us/cli/azure/install-azure-cli)",
      "labels": [
        "Service Attention",
        "AKS",
        "needs-team-attention",
        "Auto-Assign"
      ],
      "created_at": "2023-03-16T23:17:53Z",
      "closed_at": "2026-01-05T17:49:25Z",
      "url": "https://github.com/Azure/azure-cli/issues/25854",
      "comments_count": 10
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 23470,
      "title": "Telemetry stuck at 1.0.6 despite upgrade --all true",
      "problem": "## Describe the bug\r\n\r\n**Command Name**\r\n`az upgrade`\r\n\r\n**Errors:**\r\n```\r\nPrompted that I have \"1 updates available\" which transpires is the telemetry component as it is stuck at 1.0.6 and despite upgrading CLI via az upgrade --all true and trying a full repair of the CLI still the update is not triggered.\r\n\r\nAs an extra piece of feedback 1 update**s** is not grammatically correct, should read 1 update available.\r\n```\r\n\r\n## To Reproduce:\r\nSteps to reproduce the behavior. Note that argument values have been redacted, as they may contain sensitive information.\r\n\r\n- _Put any pre-requisite steps here..._\r\n- `az upgrade --all true`\r\n\r\n## Expected Behavior\r\n\r\nUpdate core CLI, associated components and extensions as applicable.\r\n\r\n## Environment Summary\r\n```\r\nWindows-10-10.0.25179-SP0\r\nPython 3.10.5\r\nInstaller: MSI\r\n\r\nazure-cli 2.39.0\r\n\r\nExtensions:\r\nappservice-kube 0.1.7\r\nconnectedk8s 1.2.11\r\ncustomlocation 0.1.3\r\nk8s-extension 1.2.6\r\nlogicapp 0.1.2\r\n\r\nDependencies:\r\nmsal 1.18.0b1\r\nazure-mgmt-resource 21.1.0b1\r\n```\r\n## Additional Context\r\n\r\n<!--Please don't remove this:-->\r\n<!--auto-generated-->\r\n\r\n",
      "solution": "This is because this line is not updated in Azure CLI 2.39.0:\r\n\r\nhttps://github.com/Azure/azure-cli/blob/815fd96ccd3aa181c13ab2999fbe4b40e6b6fe7e/src/azure-cli-telemetry/azure/cli/telemetry/__init__.py#L13\r\n\r\nIt was changed by #23530 to\r\n\r\nhttps://github.com/Azure/azure-cli/blob/5c12e9946f9e449763ccc9a12023298d4ba9c94e/src/azure-cli-telemetry/azure/cli/telemetry/__init__.py#L13\r\n\r\nNext version 2.40.0 will have it fixed.\r\n",
      "labels": [
        "feature-request",
        "Upgrade",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2022-08-08T23:44:54Z",
      "closed_at": "2026-01-05T08:53:24Z",
      "url": "https://github.com/Azure/azure-cli/issues/23470",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 23533,
      "title": "Documentation for \"--web-redirect-uris\" is incorrect",
      "problem": "\r\nThe documentation for supplying --web-redirect-uris states \"Space-separated values.\". This appears to be incorrect and actually required comma separated values.\r\n\r\n\r\n---\r\n#### Document Details\r\n\r\n\u26a0 *Do not edit this section. It is required for docs.microsoft.com \u279f GitHub issue linking.*\r\n\r\n* ID: 921aa920-c25f-5227-aabb-49116da38fa7\r\n* Version Independent ID: 9b5a53ad-edf8-4d89-f8e6-cde01b7866f6\r\n* Content: [az ad app](https://docs.microsoft.com/en-us/cli/azure/ad/app?view=azure-cli-latest)\r\n* Content Source: [latest/docs-ref-autogen/ad/app.yml](https://github.com/MicrosoftDocs/azure-docs-cli/blob/main/latest/docs-ref-autogen/ad/app.yml)\r\n* Service: **active-directory**\r\n* GitHub Login: @rloutlaw\r\n* Microsoft Alias: **routlaw**",
      "solution": "@Jasonlhy, the error \"The command is too long\" is from PowerShell when invoking `C:\\Program Files (x86)\\Microsoft SDKs\\Azure\\CLI2\\wbin\\az.cmd`, because\r\n\r\n> The maximum length of the string that you can use at the command prompt is 8191 characters.\r\n> -- https://learn.microsoft.com/en-us/troubleshoot/windows-client/shell-experience/command-line-string-limitation\r\n\r\nYou get the same error when you run `cmd.exe \"https://xxxyyzzz-abcde-efgh.azurewebsites.net/.auth/login/aad/callback\" \"https://xxxyyzzz-abcde-efgh.azurewebsites.net/.auth/login/aad/callback\" \"https://xxxyyzzz-abcde-efgh.azurewebsites.net/.auth/login/aad/callback\" \"https://xxxyyzzz-abcde-efgh.azurewebsites.net/.auth/login/aad/callback\"...`\r\n\r\nAs a workaround, you may save the payload of [Create application](https://learn.microsoft.com/en-us/graph/api/application-post-applications?view=graph-rest-1.0&tabs=http) or [Update application](https://learn.microsoft.com/en-us/graph/api/application-update?view=graph-rest-1.0&tabs=http) in a local file and use `az rest` with `--body @app.json` to call these REST APIs directly. Examples can be found at #22580.\r\n\r\nPreviously I made a proposal in #23490 to support `--parameters` so that you can specify the payload of `az ad app update` (or even `az ad app create`) by yourself, but unfortunately that PR has not been planned or approved.\r\n\r\n",
      "labels": [
        "Documentation",
        "question",
        "Graph",
        "customer-reported",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2022-08-15T14:26:01Z",
      "closed_at": "2026-01-05T08:52:23Z",
      "url": "https://github.com/Azure/azure-cli/issues/23533",
      "comments_count": 10
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 23740,
      "title": "az cli logs sensitive info in --DEBUG mode",
      "problem": "**Related command**\r\n<!--- Please provide the related command with az {command} if you can, so that we can quickly route to the related team for help. ---> az cli logs sensitive info in --DEBUG mode\r\n\r\n\r\n\r\n**Is your feature request related to a problem? Please describe.**\r\n<!--- A clear and concise description of what the problem is. Ex. I'm always frustrated when [...] --->\r\n\r\nRun \"az ml data create --debug --file some_dataset.yaml\" with your default workspace and resourcegroup. \r\nCheck the debug output. It contains something like this:\r\n\r\nazure.core.pipeline.policies._universal: {\r\n\"secretsType\": \"AccountKey\",\r\n\"key\": \"2ww2c/dCC42vx************<masked here for bug filing>********\"\r\n}\r\n\r\n**Describe the solution you'd like**\r\n<!--- A clear and concise description of what you want to happen. --->\r\nNo secrets are getting exposed from any of the az commands when executing in DEBUG mode.\r\n\r\n",
      "solution": "Sorry, there was a typo in the description of the issue. This is not a new extension, but we are using ML extension.\r\n\r\naz ml data create --name mytestdata01 --file ./src/azure-ai-ml/tests/test_configs/dataset/data_local_path.yaml --version 1 --debug\r\n\r\nazure.core.pipeline.policies._universal: Request URL: 'https://management.azure.com/subscriptions/REDACTED/resourceGroups/REDACTED/providers/Microsoft.MachineLearningServices/workspaces/REDACTED/datastores/workspaceblobstore/listSecrets?api-version=2022-05-01'\r\nRequest method: 'POST'\r\nRequest headers:\r\n    'Accept': 'application/json'\r\n    'x-ms-client-request-id': 'REDACTED'\r\n    'User-Agent': 'azureml-cli-v2/0.0.139 azure-ai-ml/0.0.139 azsdk-python-mgmt-machinelearningservices/0.1.0 Python/3.7.10 (Windows-10-10.0.22621-SP0)'\r\n    'Authorization': 'Bearer REDACTED'\r\nRequest body:\r\nThis request has no body\r\nurllib3.connectionpool: https://management.azure.com:443 \"POST /subscriptions/REDACTED/resourceGroups/REDACTED/providers/Microsoft.MachineLearningServices/workspaces/REDACTED/datastores/workspaceblobstore/listSecrets?api-version=2022-05-01 HTTP/1.1\" 200 None\r\nazure.core.pipeline.policies._universal: Response status: '200'\r\nResponse headers:\r\n    'Cache-Control': 'no-cache'\r\n    'Pragma': 'no-cache'\r\n    'Transfer-Encoding': 'chunked'\r\n    'Content-Type': 'application/json; charset=utf-8'\r\n    'Content-Encoding': 'gzip'\r\n    'Expires': '-1'\r\n    'Vary': 'Accept-Encoding'\r\n    'x-ms-ratelimit-remaining-subscription-writes': '1199'\r\n    'Request-Context': 'appId=cid-v1:REDACTED'\r\n    'x-ms-response-type': 'standard'\r\n    'Strict-Transport-Security': 'max-age=31536000; includeSubDomains'\r\n    'X-Content-Type-Options': 'nosniff'\r\n    'x-aml-cluster': 'vienna-eastus-01'\r\n    'x-request-time': '0.242'\r\n    'Server-Timing': 'traceparent;desc=\"00-REDACTED\"'\r\n    'x-ms-request-id': 'c070a7b6-e748-452a-8083-930ce858f8f7'\r\n    'x-ms-correlation-request-id': 'REDACTED'\r\n    'x-ms-routing-request-id': 'WESTUS:20220926T162712Z:REDACTED'\r\n    'Date': 'Mon, 26 Sep 2022 16:27:11 GMT'\r\nResponse content:\r\n{\r\n  \"secretsType\": \"AccountKey\",\r\n  \"key\": \"REDACTEDKEY==\"\r\n}\n\n---\n\nI'd recommend adding a `--debug-no-secrets` switch. The business justification is that we will be submitting bug reports for Azure CLI and the issue template requires us to paste full debug output.",
      "labels": [
        "Core",
        "feature-request",
        "common issue",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2022-08-31T18:40:49Z",
      "closed_at": "2026-01-05T08:49:10Z",
      "url": "https://github.com/Azure/azure-cli/issues/23740",
      "comments_count": 6
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 23918,
      "title": "--subnet does not work in VS code/Gitbash",
      "problem": "\r\nHi.\r\n\r\nThere seems to be some kind of general bug somewhere in either VS code, gitbash or the az module.\r\nWherever resourceid for subnet is used the cli command will fail if it is run in VS code\r\n\r\nThe documentation states that --subnet is name or resource id...\r\nWhen it comes to running this in CloudShell, it is correct, but in VS code it fails.\r\nI have now tested with a storage account and a VM and same thing.\r\n\r\nThis is what happens:\r\nSUBNET_ID=$(az network vnet subnet show --resource-group $VNET_RESOURCE_GROUP --name $SUBNET1 --vnet-name $VNET --query id -o tsv)\r\naz storage account create \\\r\n>     --name $STORAGEACCOUNT_NAME \\\r\n>     --resource-group $SYNAPSE_RESOURCE_GROUP \\\r\n>     --location $REGION \\\r\n>     --sku Standard_LRS \\\r\n>     --kind StorageV2 \\\r\n>     --enable-hierarchical-namespace \\\r\n>     --min-tls-version TLS1_2 \\\r\n>     --subnet $SUBNET_ID\r\n\u2190[91mincorrect usage: [--subnet ID | --subnet NAME --vnet-name NAME]\u2190[0m\r\n\r\nAnd as I said, the same always works fine i CloudShell\r\n(It is not the ID get that is the problem, that works. It makes no difference if I type or paste it in as a string)\r\n\r\nThanks\r\n// Thomas Odell Balkest\u00e5hl\r\n\r\n---\r\n#### Dokumentinformation\r\n\r\n\u26a0 *Redigera inte det h\u00e4r avsnittet. Det kr\u00e4vs f\u00f6r docs.microsoft.com \u279f l\u00e4nkning till GitHub-problem.*\r\n\r\n* ID: 92115d19-d7a0-93a8-bf2b-5126d1cddcd0\r\n* Version Independent ID: a657f09b-e1ac-12a2-4b9c-7aaa1f0e3f5c\r\n* Content: [az storage account](https://docs.microsoft.com/sv-se/cli/azure/storage/account?view=azure-cli-latest)\r\n* Content Source: [latest/docs-ref-autogen/storage/account.yml](https://github.com/MicrosoftDocs/azure-docs-cli/blob/main/latest/docs-ref-autogen/storage/account.yml)\r\n* Service: **storage**\r\n* GitHub Login: @rloutlaw\r\n* Microsoft Alias: **routlaw**",
      "solution": "Hi.\r\nThis was it: POSIX-to-Windows path conversion will kick in\r\nAdding MSYS_NO_PATHCONV=1 before the command solved it, BIG thanks.\r\n\r\nHow do I set it permamently? \r\n\r\nThanks\r\n// THomas",
      "labels": [
        "Storage",
        "Network",
        "question",
        "customer-reported",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2022-09-16T12:49:34Z",
      "closed_at": "2026-01-05T08:46:06Z",
      "url": "https://github.com/Azure/azure-cli/issues/23918",
      "comments_count": 4
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 23954,
      "title": "az login --identity throw error __init__() got an unexpected keyword argument 'user_agent'",
      "problem": "### **This is autogenerated. Please review and update as needed.**\r\n\r\n## Describe the bug\r\n\r\n**Command Name**\r\n`az login`\r\n\r\n**Errors:**\r\n```\r\nThe command failed with an unexpected error. Here is the traceback:\r\n__init__() got an unexpected keyword argument 'user_agent'\r\nTraceback (most recent call last):\r\n  File \"/usr/lib64/az/lib/python3.6/site-packages/knack/cli.py\", line 231, in invoke\r\n    cmd_result = self.invocation.execute(args)\r\n  File \"/usr/lib64/az/lib/python3.6/site-packages/azure/cli/core/commands/__init__.py\", line 658, in execute\r\n    raise ex\r\n  File \"/usr/lib64/az/lib/python3.6/site-packages/azure/cli/core/commands/__init__.py\", line 721, in _run_jobs_serially\r\n    results.append(self._run_job(expanded_arg, cmd_copy))\r\n  File \"/usr/lib64/az/lib/python3.6/site-packages/azure/cli/core/commands/__init__.py\", line 692, in _run_job\r\n    result = cmd_copy(params)\r\n  File \"/usr/lib64/az/lib/python3.6/site-packages/azure/cli/core/commands/__init__.py\", line 328, in __call__\r\n    return self.handler(*args, **kwargs)\r\n  File \"/usr/lib64/az/lib/python3.6/site-packages/azure/cli/core/commands/command_operation.py\", line 121, in handler\r\n    return op(**command_args)\r\n  File \"/usr/lib64/az/lib/python3.6/site-packages/azure/cli/command_modules/profile/custom.py\", line 122, in login\r\n    return profile.login_with_managed_identity(username, allow_no_subscriptions)\r\n  File \"/usr/lib64/az/lib/python3.6/site-packages/azure/cli/core/_profile.py\", line 244, in login_with_managed_identity\r\n    subscriptions = subscription_finder.find_using_specific_tenant(tenant, msi_creds)\r\n  File \"/usr/lib64/az/lib/python3.6/site-packages/azure/cli/core/_profile.py\", line 796, in find_using_specific_tenant\r\n    client = self._create_subscription_client(credential)\r\n  File \"/usr/lib64/az/lib/python3.6/site-packages/azure/cli/core/_profile.py\", line 820, in _create_subscription_client\r\n    **client_kwargs)\r\nTypeError: __init__() got an unexpected keyword argument 'user_agent'\r\n\r\n```\r\n\r\n## To Reproduce:\r\nSteps to reproduce the behavior. Note that argument values have been redacted, as they may contain sensitive information.\r\n\r\n- _Put any pre-requisite steps here..._\r\n- `az login -i`\r\n\r\n## Expected Behavior\r\n\r\n## Environment Summary\r\n```\r\nLinux-4.18.0-193.65.2.el8_2.x86_64-x86_64-with-redhat-8.2-Ootpa, Red Hat Enterprise Linux 8.2 (Ootpa)\r\nPython 3.6.8\r\nInstaller: RPM\r\n\r\nazure-cli 2.37.0\r\n```\r\n## Additional Context\r\n\r\n<!--Please don't remove this:-->\r\n<!--auto-generated-->\r\n\r\n",
      "solution": "Here is a previous analysis on the error `TypeError: __init__() got an unexpected keyword argument 'user_agent'`: https://github.com/Azure/azure-cli/issues/18626#issuecomment-876982958\r\n\r\nSomehow your `SubscriptionClient` is from Track 1 SDK.\r\n\r\nPerhaps you may also try this command to see where `SubscriptionClient` is imported from:\r\n\r\n```\r\n$ PYTHONPATH=/usr/lib64/az/lib/python3.6/site-packages/ /usr/bin/python3.6 -c \"import azure.mgmt.resource.subscriptions; print(azure.mgmt.resource.subscriptions.__file__)\"\r\n/usr/lib64/az/lib/python3.6/site-packages/azure/mgmt/resource/subscriptions/__init__.py\r\n```\r\n\r\nThe latest Azure CLI is 2.40.0. For latest Azure CLI, the command should be\r\n\r\n```\r\n$ PYTHONPATH=/usr/lib64/az/lib/python3.9/site-packages/ /usr/bin/python3.9 -c \"import azure.mgmt.resource.subscriptions; print(azure.mgmt.resource.subscriptions.__file__)\"\r\n/usr/lib64/az/lib/python3.9/site-packages/azure/mgmt/resource/subscriptions/__init__.py\r\n```\n\n---\n\nHello, I redo the installation on another system following the [official methods for Red Hat ](https://learn.microsoft.com/en-us/cli/azure/install-azure-cli-linux?pivots=dnf).  and I still have the same issue.\r\nDo you have a solution / workaround to solve that issue ?",
      "labels": [
        "Account",
        "question",
        "customer-reported",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2022-09-20T16:12:29Z",
      "closed_at": "2026-01-05T08:44:48Z",
      "url": "https://github.com/Azure/azure-cli/issues/23954",
      "comments_count": 15
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32594,
      "title": "[Reference feedback]: Container app create fails with python error",
      "problem": "### Type of issue\n\nCode doesn't work\n\n### Reference command name\n\n`az containerapp compose create`\n\n### Feedback\n\nI am running the following command to try and use my existing docker-compose to build a container app:\n\n```bash\nexport LOCATION=eastus2\nexport RESOURCE_GROUP=rg-my-project\nexport ENV_NAME=env-my-project\n\naz group create --name $RESOURCE_GROUP --location $LOCATION &&\n\naz containerapp env create \\\n    --name $ENV_NAME \\\n    --resource-group $RESOURCE_GROUP \\\n    --location $LOCATION &&\n\naz containerapp compose create -g $RESOURCE_GROUP \\\n    --environment $ENV_NAME\n```\n\nAnd my docker-compose looks something like this (I have removed sensitive data specific to my project):\n\n```yaml\nname: my-project\nservices:\n\n  # A dependency service that I pull from a container registry\n  dependency-project:\n    restart: always\n    build:\n      context: ./stable\n      tags:\n        - \"someurl.com/dependency-project:stable\"\n    image: someurl.com/dependency-project:stable\n    env_file:\n      - .env\n    ports:\n      - \"127.0.0.1:4001:4003\"\n      - \"127.0.0.1:4002:4004\"\n      - \"127.0.0.1:5900:5900\"\n\n  # My locally-built service\n  my-project-service:\n    build: .\n    env_file:\n      - .env\n    stdin_open: true\n    tty: true\n    ports:\n      - \"127.0.0.1:5001:5001\"\n    volumes:\n      # This ties the container to the host timezone\n      - /etc/localtime:/etc/localtime:ro\n      - /etc/timezone:/etc/timezone:ro\n      # Logging direcotory\n      - ./logs:/app/logs\n```\n\nI receive the following output:\n\n```\nThese container and host configuration elements from the docker-compose file are not supported in Azure Container Apps. For more information about supported configuration, please see https://aka.ms/containerapp/compose/configuration\n     services/strategy/stdin_open\n     services/strategy/tty\nThese volume mount elements from the docker-compose file are not supported in Azure Container Apps. For more information about supported storage configuration, please see https://aka.ms/containerapp/compose/volumes\n     services/strategy/volumes\nThe command failed with an unexpected error. Here is the traceback:\n'NoneType' object is not iterable\nTraceback (most recent call last):\n  File \"/usr/local/Cellar/azure-cli/2.81.0/libexec/lib/python3.13/site-packages/knack/cli.py\", line 233, in invoke\n    cmd_result = self.invocation.execute(args)\n  File \"/usr/local/Cellar/azure-cli/2.81.0/libexec/lib/python3.13/site-packages/azure/cli/core/commands/__init__.py\", line 666, in execute\n    raise ex\n  File \"/usr/local/Cellar/azure-cli/2.81.0/libexec/lib/python3.13/site-packages/azure/cli/core/commands/__init__.py\", line 734, in _run_jobs_serially\n    results.append(self._run_job(expanded_arg, cmd_copy))\n                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/Cellar/azure-cli/2.81.0/libexec/lib/python3.13/site-packages/azure/cli/core/commands/__init__.py\", line 703, in _run_job\n    result = cmd_copy(params)\n  File \"/usr/local/Cellar/azure-cli/2.81.0/libexec/lib/python3.13/site-packages/azure/cli/core/commands/__init__.py\", line 336, in __call__\n    return self.handler(*args, **kwargs)\n           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^\n  File \"/usr/local/Cellar/azure-cli/2.81.0/libexec/lib/python3.13/site-packages/azure/cli/core/commands/command_operation.py\", line 120, in handler\n    return op(**command_args)\n  File \"/Users/jrochester/.azure/cliextensions/containerapp/azext_containerapp/custom.py\", line 1617, in create_containerapps_from_compose\n    environment = resolve_environment_from_service(service)\n  File \"/usr/local/Cellar/azure-cli/2.81.0/libexec/lib/python3.13/site-packages/azure/cli/command_modules/containerapp/_compose_utils.py\", line 217, in resolve_environment_from_service\n    env_vars = service.resolve_environment_hierarchy()\n  File \"/usr/local/Cellar/azure-cli/2.81.0/libexec/lib/python3.13/site-packages/pycomposefile/service/service.py\", line 141, in resolve_environment_hierarchy\n    env_file.update(self.environment)\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^\nTypeError: 'NoneType' object is not iterable\nTo check existing issues, please visit: https://github.com/Azure/azure-cli/issues\n```\n\n\n\n### Page URL\n\nhttps://learn.microsoft.com/en-us/cli/azure/containerapp/compose?view=azure-cli-latest#az-containerapp-compose-create\n\n### Content source URL\n\nhttps://github.com/MicrosoftDocs/azure-docs-cli/blob/main/docs-ref-autogen/Latest-version/latest/containerapp/compose.yml\n\n### Author\n\n@mikefrobbins\n\n### Document Id\n\nd10250cd-c6ca-a9a6-d6e8-b93f81b94ff1",
      "solution": "Hi @jackroc97 \n\nThis error is cause by code in `pycomposefile`, it assume when `env_file` exist, `environment` should exist. Otherwise it throws error `TypeError: 'NoneType' object is not iterable`\n\n<img width=\"478\" height=\"181\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/4b17034d-0d20-4b41-9dfe-f74d8f994f01\" />\n\nPlease try the workaround (I have try this, and it works fine):\n add one line `environment: {}` above the `env_file`, it can help to skip the issue. The docker-compose will be:\n\n```\nname: my-project\nservices:\n\n  # A dependency service that I pull from a container registry\n  dependency-project:\n    restart: always\n    build:\n      context: ./stable\n      tags:\n        - \"someurl.com/dependency-project:stable\"\n    image: someurl.com/dependency-project:stable\n    environment: {}\n    env_file:\n      - .env\n    ports:\n      - \"127.0.0.1:4001:4003\"\n      - \"127.0.0.1:4002:4004\"\n      - \"127.0.0.1:5900:5900\"\n\n  # My locally-built service\n  my-project-service:\n    build: .\n    environment: {}\n    env_file:\n      - .env\n    stdin_open: true\n    tty: true\n    ports:\n      - \"127.0.0.1:5001:5001\"\n    volumes:\n      # This ties the container to the host timezone\n      - /etc/localtime:/etc/localtime:ro\n      - /etc/timezone:/etc/timezone:ro\n      # Logging direcotory\n      - ./logs:/app/logs\n```\n\nWe will try fix this issue in Azure-cli side to avoid the issue too.\n\nThanks.",
      "labels": [
        "Service Attention",
        "question",
        "customer-reported",
        "Auto-Assign",
        "ContainerApp"
      ],
      "created_at": "2026-01-01T22:00:51Z",
      "closed_at": "2026-01-05T07:01:53Z",
      "url": "https://github.com/Azure/azure-cli/issues/32594",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32595,
      "title": "No module named 'decorator' error when running \"az webapp list\"",
      "problem": "Already authenticated with \"az login\" (as Global Administrator).  Executed command in Ubuntu terminal:\n\naz webapp list \\\n>   --resource-group rg-company_name-prod-01 \\\n>   --output table\n\n\n### **This is autogenerated. Please review and update as needed.**\n\n## Describe the bug\n\n**Command Name**\n`az webapp list`\n\n**Errors:**\n```\nNo module named 'decorator'\nTraceback (most recent call last):\npython3/dist-packages/fabric/connection.py, ln 5, in <module>\n    from invoke.vendor.six import StringIO\nModuleNotFoundError: No module named 'invoke.vendor.six'\n\n...\n\npython3/dist-packages/fabric/connection.py, ln 10, in <module>\n    from decorator import decorator\nModuleNotFoundError: No module named 'decorator'\n```\n\n## To Reproduce:\nSteps to reproduce the behavior. Note that argument values have been redacted, as they may contain sensitive information.\n\n- _Put any pre-requisite steps here..._\n- `az webapp list --resource-group {} --output {}`\n\n## Expected Behavior\n\n## Environment Summary\n```\nLinux-5.15.0-139-generic-x86_64-with-glibc2.29\nPython 3.8.10\nShell: bash\n\nazure-cli 2.0.81\n\nExtensions:\nazure-devops 0.17.0\n\n```\n## Additional Context\n\n<!--Please don't remove this:-->\n<!--auto-generated-->\n\n",
      "solution": "Hi @SilverDecks,\n\nThis is not the official Azure CLI published by Microsoft.\n\nHow to tell if the installed Azure CLI is unofficial:\n- https://github.com/Azure/azure-cli/issues/19640#issuecomment-1133875268\n- https://github.com/Azure/azure-cli/issues/19640#issuecomment-1148202854\n\nPlease follow  https://learn.microsoft.com/en-us/cli/azure/install-azure-cli-linux to install Microsoft official Azure CLI.\n\nIf you feel that further discussion is needed, please add a comment with the text `/clibot unresolve` to reopen the issue.\n\n\n---\n\nHere are some similar issues that might help you. Please check if they can solve your problem.\n- #14028\n- #13343\n- #15204\n- #21979\n- #21110\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\n### Solution 1:\nI got around this by adding the `decorator` package to my system python3 site-packages. I ran this:\n```\nsudo /usr/bin/pip3 install --system decorator\n```\nShould this be required? Is the Linux installation of `az` not fully installing all its needed dependencies?\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/13343#issuecomment-624367680\n### Solution 2:\nNot specific to web apps but something to do with the packages installed during core install.\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/13343#issuecomment-635133296\n### Solution 3:\nWas 2.0.81 which came with Ubuntu and which is advised against. After removal and installing the latest version, everything worked like a charm \ud83d\udc4d\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/21979#issuecomment-1091734757\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
      "labels": [
        "Web Apps",
        "Service Attention",
        "question",
        "customer-reported",
        "Auto-Assign",
        "app-service-general",
        "Auto-Resolve",
        "Similar-Issue",
        "Possible-Solution"
      ],
      "created_at": "2026-01-02T00:38:26Z",
      "closed_at": "2026-01-02T00:38:32Z",
      "url": "https://github.com/Azure/azure-cli/issues/32595",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 25107,
      "title": "Improve autocompletion performance",
      "problem": "## Description\nOriginal issue: https://github.com/Azure/azure-cli/issues/9157\nCLI's autocompletion is not as fast as other tools, I create this issue to track the progress.\nIf you find any command's completion is slow, please report it here and attach the output of `{your_command} --debug` and `az -v`.\n\n## TODO\n- [x] https://github.com/Azure/azure-cli/pull/25145\n- [x] https://github.com/Azure/azure-cli/pull/24765\n- [ ] https://github.com/Azure/azure-cli/issues/25106\n- [ ] Improve module init speed such as acs, network\n- [ ] Improve aaz module logic, it does not need to import lots of packages when read params.\n- [ ] Improve speed of `az s<tab>`. Don't need to load all modules, read from `commandindex.json`\n\n## Result\nHere is the data after applying disable aladdin in 2.45 and enhance module loading in 2.49:\n\n\n\u00a0 | az   account | az   storage | az   keyvault | az   vm | az   aks\n-- | -- | -- | -- | -- | --\nBefore (s) | 0.646 | 0.720 | 0.695 | 0.730 | 0.696\nDisable aladdin   (s) | 0.337 | 0.426 | 0.352 | 0.552 | 0.597\nEnhance loading (s) | 0.268 | 0.340 | 0.285 | 0.532 | 0.503\nPercentage (%) | 41.5 | 47.2 | 41.0 | 72.9 | 72.3\n\n\n\u00a0 | az   account s | az   storage s | az   keyvault   s | az   vm   s | az   aks   s\n-- | -- | -- | -- | -- | --\nBefore (s) | 2.553 | 2.483 | 2.450 | 2.541 | 2.519\nDisable aladdin   (s) | 2.364 | 2.353 | 2.398 | 2.355 | 2.376\nEnhance loading (s) | 0.269 | 0.301 | 0.282 | 0.422 | 0.280\nPercentage (%) | 10.5 | 12.1 | 11.5 | 16.6 | 11.1\n\n",
      "solution": "@BradAF Thank for the report, it should be fixed by #24765",
      "labels": [
        "Core",
        "feature-request",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2023-01-12T08:34:59Z",
      "closed_at": "2025-12-04T08:31:52Z",
      "url": "https://github.com/Azure/azure-cli/issues/25107",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 32573,
      "title": "I keep getting \"You dont have acess to this\" message when I try az login",
      "problem": "### Describe the bug\n\nI keep getting \"You dont have acess to this\" message when I try az login\n\n<img width=\"730\" height=\"678\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/68b12e63-7664-4ae6-b8bd-b9541753df4e\" />\n\n<img width=\"1221\" height=\"1032\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/4a76df3b-4062-49c1-8928-c7e8dfcbae50\" />\n\n### Related command\n\naz login that got baked into our FW build scripts.\n\n### Errors\n\nI kept receiving \"You dont have access to this\" screen\n\n### Issue script & Debug output\n\n<img width=\"1385\" height=\"770\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/eab449f1-9b58-4b14-bc65-8cdde6504093\" />\n\nThen I get onto  https://microsoft.com/devicelogin then copied and pasted that code, I got \"You dont have access to this\" screen\n\n### Expected behavior\n\nSecurity should authenticate me\n\n### Environment Summary\n\n\n(.venv) paulinguyen@CPC-pauli-TA89K:~/Braga$ az --version\nazure-cli                         2.81.0\n\ncore                              2.81.0\ntelemetry                          1.1.0\n\nExtensions:\nazure-devops                       1.0.2\n\nDependencies:\nmsal                            1.34.0b1\nazure-mgmt-resource               23.3.0\n\nPython location 'C:\\Program Files (x86)\\Microsoft SDKs\\Azure\\CLI2\\python.exe'\nConfig directory 'C:\\Users\\paulinguyen\\.azure'\nExtensions directory 'C:\\Users\\paulinguyen\\.azure\\cliextensions'\n\nPython (Windows) 3.13.9 (tags/v3.13.9:8183fa5, Oct 14 2025, 14:00:05) [MSC v.1944 32 bit (Intel)]\n\nLegal docs and information: aka.ms/AzureCliLegal\n\n\nYour CLI is up-to-date.\n\n### Additional context\n\nNo, please message me. I can provide more information.",
      "solution": "Here are some similar issues that might help you. Please check if they can solve your problem.\n- #32544\n------------\n\n**Possible solution (Extracted from existing issue, might be incorrect; please verify carefully)**\n\nThe error message is clear. Azure CLI cannot get an access token for the tenant with silent authentication.\n\nYou need to directly log into the tenant:\n\n```\naz login --tenant TENANT_ID\n```\n\n**Reference**:\n- https://github.com/azure/azure-cli/issues/32544#issuecomment-3658987225\n\n_Powered by [issue-sentinel](https://github.com/Azure/issue-Sentinel)_",
      "labels": [
        "Account",
        "question",
        "customer-reported",
        "Auto-Assign",
        "Azure CLI Team",
        "Similar-Issue",
        "Possible-Solution",
        "Login"
      ],
      "created_at": "2025-12-23T18:35:34Z",
      "closed_at": "2025-12-24T05:17:01Z",
      "url": "https://github.com/Azure/azure-cli/issues/32573",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 27457,
      "title": "Exposing the output of `az --version` in JSON and other parsable formats.",
      "problem": "**Related command**\r\n<!--- Please provide the related command with az {command} if you can, so that we can quickly route to the related team for help. --->\r\n\r\n`az --version`\r\n\r\n**Is your feature request related to a problem? Please describe.**\r\n<!--- A clear and concise description of what the problem is. Ex. I'm always frustrated when [...] --->\r\n\r\n`az --version` outputs several valuable information apart from the current versions of installed `azure-cli` modules and extensions. This includes:\r\n1. Which code CLI modules are not up-to-date (`azure-cli` , `azure-cli-core`, `azure-cli-telemetry`).\r\n2. Path to the underlying `python` used by `az`. The mode of installation of this python.\r\n3. Path to the extensions directory.\r\n\r\nAll this information is not available in a code-parsable format. We currently need to do string parsing which can be flaky.\r\n\r\n**Describe the solution you'd like**\r\n<!--- A clear and concise description of what you want to happen. --->\r\n\r\n`az --version -o json --query '<>` can be used to query a specific property of the `az` installation. We can decide on the schema of the exposed property.\r\n\r\n**Describe alternatives you've considered**\r\n<!--- A clear and concise description of any alternative solutions or features you've considered. --->\r\n\r\nCurrently, I need to parse the string output, using regex, etc. to get the python installation location, and also to check if upgrade is available.\r\n\r\n**Additional context**\r\n<!--- Add any other context or screenshots about the feature request here. --->\r\n",
      "solution": "Hi, we're sending this friendly reminder because we haven't heard back from you in a while. We need more information about this issue to help address it. Please be sure to give us your input within the next **7 days**. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
      "labels": [
        "Core",
        "needs-author-feedback",
        "no-recent-activity",
        "feature-request",
        "Upgrade",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2023-09-25T02:50:07Z",
      "closed_at": "2025-12-24T01:40:52Z",
      "url": "https://github.com/Azure/azure-cli/issues/27457",
      "comments_count": 8
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 26963,
      "title": "az storage azcopy run-command",
      "problem": "### Describe the bug\r\n\r\nI am trying to use `azcopy` to clone a directory.\r\n\r\nhttps://learn.microsoft.com/en-us/cli/azure/storage/azcopy?view=azure-cli-latest#az-storage-azcopy-run-command\r\n\r\nI am using this approach\r\n\r\n```powershell\r\n$sasToken = az storage share generate-sas --account-name myaccount --name myshare --account-key [my-key] -o tsv\r\naz storage azcopy run-command azcopy copy \"https://myaccount.file.core.windows.net/myshare/folder/?$sasToken\" \"https://myaccount.file.core.windows.net/myshare/folder-copy?$sasToken\" --as-subdir=false --overwrite=prompt --from-to=FileFile --preserve-smb-info=true --recursive --log-level=INFO --trailing-dot=Enable\r\n```\r\n\r\nthe problem is this gives an error:\r\n\r\n```\r\nunrecognized arguments: copy https://myaccount.file.core.windows.net/myshare/folder/?sv=2022-11-02\r\n```\r\n\r\nI can't seem to pass the correct arguments to use az copy. I tried wrapping the url's in quotes .g:\r\n\r\n```\r\n$sourceUrl = \"https://myaccount.file.core.windows.net/myshare/folder/?$sasToken\"\r\n$destUrl = \"https://myaccount.file.core.windows.net/myshare/folder-copy/?$sasToken\" \r\n\r\naz storage azcopy run-command azcopy copy \"\"$sourceUrl\"\" \"\"$destUrl\"\" --as-subdir=false --overwrite=prompt --from-to=FileFile --preserve-smb-info=true --recursive --log-level=INFO --trailing-dot=Enable\r\n\r\n```\r\n\r\nsame error\r\n\r\n\r\n\r\n### Related command\r\n\r\naz storage azcopy run-command\r\n\r\n### Errors\r\n\r\nunrecognized arguments: copy https://myaccount.file.core.windows.net/myshare/folder/?sv=2022-11-02\r\n\r\n### Issue script & Debug output\r\n\r\n> az storage azcopy run-command --debug azcopy \"$sourceUrl\" \"$destUrl\" --as-subdir=false --overwrite=prompt --from-to=FileFile --preserve-smb-info=true --recursive --log-level=INFO --trailing-dot=Enable --debug    cli.knack.cli: Command arguments: ['storage', 'azcopy', 'run-command', '--debug', 'azcopy', 'https://myaccount.file.core.windows.net/myshare/alpha/?sv=2022-11-02']\r\ncli.knack.cli: __init__ debug log:\r\nEnable color in terminal.\r\ncli.knack.cli: Event: Cli.PreExecute []\r\ncli.knack.cli: Event: CommandParser.OnGlobalArgumentsCreate [<function CLILogging.on_global_arguments at 0x01A3A538>, <function OutputProducer.on_global_arguments at 0x01B3B778>, <function CLIQuery.on_global_arguments at 0x01C583D0>]\r\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableCreate []\r\ncli.azure.cli.core: Modules found from index for 'storage': ['azure.cli.command_modules.storage', 'azext_storage_preview']\r\ncli.azure.cli.core: Loading command modules:\r\ncli.azure.cli.core: Name                  Load Time    Groups  Commands\r\ncli.azure.cli.core: storage                   0.064        58       272\r\ncli.azure.cli.core: Total (1)                 0.064        58       272\r\ncli.azure.cli.core: These extensions are not installed and will be skipped: ['azext_ai_examples', 'azext_next']\r\ncli.azure.cli.core: Loading extensions:\r\ncli.azure.cli.core: Name                  Load Time    Groups  Commands  Directory\r\ncli.knack.cli: Event: CommandLoader.OnLoadCommandTable []\r\ncli.azure.cli.core: storage-preview           0.017        15        51  C:\\Users\\DarrellTunnell\\.azure\\cliextensions\\storage-preview\r\ncli.azure.cli.core: Total (1)                 0.017        15        51\r\ncli.azure.cli.core: Loaded 64 groups, 294 commands.\r\ncli.azure.cli.core: Found a match in the command table.\r\ncli.azure.cli.core: Raw command  : storage azcopy run-command\r\ncli.azure.cli.core: Command table: storage azcopy run-command\r\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableTruncate [<function AzCliLogging.init_command_file_logging at 0x03DFC580>]\r\ncli.azure.cli.core.azlogging: metadata file logging enabled - writing logs to 'C:\\Users\\DarrellTunnell\\.azure\\commands\\2023-07-21.13-27-56.storage_azcopy_run-command.29660.log'.\r\naz_command_data_logger: command args: storage azcopy run-command --debug {} {}\r\ncli.knack.cli: Event: CommandInvoker.OnPreArgumentLoad [<function register_global_subscription_argument.<locals>.add_subscription_parameter at 0x03E23580>]\r\ncli.knack.cli: Event: CommandLoader.OnLoadArguments []\r\ncli.azure.cli.core.profiles._shared: Traceback (most recent call last):\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/profiles/_shared.py\", line 659, in _get_attr\r\nAttributeError: module 'azext_storage_preview.vendored_sdks.azure_mgmt_storage.v2022_09_01.models' has no attribute 'ActiveDirectoryPropertiesAccountType'\r\n\r\ncli.knack.cli: Event: CommandInvoker.OnPostArgumentLoad []\r\ncli.knack.cli: Event: CommandInvoker.OnPostCommandTableCreate [<function register_ids_argument.<locals>.add_ids_arguments at 0x03E344A8>, <function register_cache_arguments.<locals>.add_cache_arguments at 0x03E346A0>]\r\ncli.knack.cli: Event: CommandInvoker.OnCommandTableLoaded []\r\ncli.knack.cli: Event: CommandInvoker.OnPreParseArgs []\r\nurllib3.connectionpool: Starting new HTTPS connection (1): app.aladdin.microsoft.com:443\r\nurllib3.connectionpool: https://app.aladdin.microsoft.com:443 \"GET /api/v1.0/suggestions?query=%7B%22command%22%3A+%22storage+azcopy+run-command%22%2C+%22parameters%22%3A+%22%22%7D&clientType=AzureCli&context=%7B%22versionNumber%22%3A+%222.50.0%22%2C+%22errorType%22%3A+%22UnrecognizedArguments%22%2C+%22correlationId%22%3A+%2215271d5a-600f-404d-ad2b-0e732e8ae59c%22%2C+%22subscriptionId%22%3A+%22foobar%22%2C+%22eventId%22%3A+%222114ea9c-a852-4a2c-8ddc-bbf0a25e6437%22%7D HTTP/1.1\" 200 None\r\ncli.azure.cli.core.azclierror: NoneType: None\r\n\r\ncli.azure.cli.core.azclierror: unrecognized arguments: https://myaccount.file.core.windows.net/myshare/alpha/?sv=2022-11-02\r\naz_command_data_logger: unrecognized arguments: https://myaccount.file.core.windows.net/myshare/alpha/?sv=2022-11-02\r\n\r\nExamples from AI knowledge base:\r\nhttps://aka.ms/cli_ref\r\nRead more about the command in reference docs\r\ncli.knack.cli: Event: Cli.PostExecute [<function AzCliLogging.deinit_cmd_metadata_logging at 0x03DFC6A0>]\r\naz_command_data_logger: exit code: 2\r\ncli.__main__: Command ran in 0.984 seconds (init: 0.399, invoke: 0.585)\r\ntelemetry.main: Begin splitting cli events and extra events, total events: 1\r\ntelemetry.client: Accumulated 0 events. Flush the clients.\r\ntelemetry.main: Finish splitting cli events and extra events, cli events: 1\r\ntelemetry.save: Save telemetry record of length 3552 in cache\r\ntelemetry.check: Negative: The C:\\Users\\myname\\.azure\\telemetry.txt was modified at 2023-07-21 13:19:37.207139, which in less than 600.000000 s\r\n'sr' is not recognized as an internal or external command,\r\noperable program or batch file.\r\n'sig' is not recognized as an internal or external command,\r\noperable program or batch file.\r\n'sr' is not recognized as an internal or external command,\r\noperable program or batch file.\r\n'sig' is not recognized as an internal or external command,\r\noperable program or batch file.\r\n\r\n### Expected behavior\r\n\r\nI expect to be able to run azcopy and provide arguments for source and target.\r\n\r\n### Environment Summary\r\n\r\nazure-cli                         2.50.0\r\n\r\ncore                              2.50.0\r\ntelemetry                          1.0.8\r\n\r\nExtensions:\r\nazure-devops                      0.22.0\r\nbastion                            0.2.4\r\nssh                                1.1.3\r\nstorage-preview                    0.9.0\r\n\r\nDependencies:\r\nmsal                              1.22.0\r\nazure-mgmt-resource             23.1.0b2\r\n\r\nPython location 'C:\\Program Files (x86)\\Microsoft SDKs\\Azure\\CLI2\\python.exe'\r\nExtensions directory 'C:\\Users\\myname\\.azure\\cliextensions'\r\n\r\nPython (Windows) 3.10.10 (tags/v3.10.10:aad5f6a, Feb  7 2023, 17:05:00) [MSC v.1929 32 bit (Intel)]\r\n\r\nLegal docs and information: aka.ms/AzureCliLegal\r\n\r\n\r\nYour CLI is up-to-date.\r\n\r\n### Additional context\r\n\r\nI need to create a copy of a folder on a file share, e.g:\r\n```\r\n/foo-source\r\n/foo-copy\r\n```\r\n\r\nI am doing this during an azure devops pipeline (yml) so am using an AzureCli task.\r\nNote: There is an AzCopy task but it doesn't seem to support this scenario.\r\nNote: There is an [az storage file copy start-batch](https://learn.microsoft.com/en-us/cli/azure/storage/file/copy?view=azure-cli-latest#az-storage-file-copy-start-batch) command but this can only copy files based on a pattern so for example I can copy `foo-source/*` to `/foo-copy` but then the result is  `/foo-copy/foo-source/somefile.txt` rather than  `/foo-copy/somefile.txt`. There is seemingly noo way around this.\r\nSo now I am exploring how to use `azcopy` directly during a devops build. Using the az cli makes it possible to use az copy but its unclear ow to pass these particular arguments.\r\n\r\n\r\n\r\n",
      "solution": "Yes the command runs fine directly with azcopy.exe. \r\nI can also use azure storage explorer to perform the operation and azure storage explorer actualy shows the precise AzCopy.exe command which it runs, which works and which I can run independently. \r\n>  It seems the sas token is cut short in your error. \r\n\r\nI can't share my actual sas token and storage account details, so I have to scrub output accordingly\r\n\r\n> What about use az storage copy which wraps azcopy directly.\r\n\r\n~~I cannot see any `az storage copy` command on docs site. I can see `az storage file copy` or `az storage blob copy`. In this case `az storage file copy` is no good - please see in my opening issue text the section \"Additional context\"~~\r\n\r\nI [found ](https://learn.microsoft.com/en-us/cli/azure/storage?view=azure-cli-latest#az-storage-copy) `az storage copy` - however this looks like if I want to create a copy of a folder (including contents) on the same file share, I have to first download all files, then upload them to new copy location. This seems incredibly wasteful.\r\n\r\nFor now my workaround is to mount the file share during the build and copy the folder natively. \r\n\r\n\n\n---\n\nHi, we're sending this friendly reminder because we haven't heard back from you in a while. We need more information about this issue to help address it. Please be sure to give us your input within the next **7 days**. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
      "labels": [
        "Storage",
        "customer-reported",
        "needs-author-feedback",
        "no-recent-activity",
        "feature-request",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2023-07-21T12:41:00Z",
      "closed_at": "2025-12-24T01:40:52Z",
      "url": "https://github.com/Azure/azure-cli/issues/26963",
      "comments_count": 8
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 27711,
      "title": "az storage blob upload-batch fails with NoAuthenticationInformation",
      "problem": "### Describe the bug\n\naz storage blob upload-batch command fails with below error:\r\n\r\n`ERROR: Server failed to authenticate the request. Please refer to the information in the www-authenticate header.\r\nRequestId:7f9df27e-201e-004f-4d34-08d0a9000000\r\nTime:2023-10-26T17:50:51.1501299Z\r\nErrorCode:NoAuthenticationInformation`\r\n\r\n\n\n### Related command\n\naz storage blob upload-batch\n\n### Errors\n\nD:\\a\\_work\\3\\s>az storage blob upload-batch --overwrite true -d development/2.0.1a6 -s extension/schema --account-name azuremlsdk2 \r\nWARNING: \r\nThere are no credentials provided in your command and environment, we will query for account key for your storage account.\r\nIt is recommended to provide --connection-string, --account-key or --sas-token in your command as credentials.\r\n\r\nYou also can add `--auth-mode login` in your command to use Azure Active Directory (Azure AD) for authorization if your login account is assigned required RBAC roles.\r\nFor more information about RBAC roles in storage, visit https://docs.microsoft.com/azure/storage/common/storage-auth-aad-rbac-cli.\r\n\r\nIn addition, setting the corresponding environment variables can avoid inputting credentials in your command. Please use --help to get more information about environment variable usage.\r\nWARNING: \r\nSkip querying account key due to failure: Storage account 'azuremlsdk2' not found.\r\nERROR: Server failed to authenticate the request. Please refer to the information in the www-authenticate header.\r\nRequestId:7f9df27e-201e-004f-4d34-08d0a9000000\r\nTime:2023-10-26T17:50:51.1501299Z\r\nErrorCode:NoAuthenticationInformation\r\n\n\n### Issue script & Debug output\n\n2023-10-26T17:50:34.1009398Z ##[section]Starting: Copy yaml schema to blob\r\n2023-10-26T17:50:34.1144861Z ==============================================================================\r\n2023-10-26T17:50:34.1145235Z Task         : Azure CLI\r\n2023-10-26T17:50:34.1145401Z Description  : Run Azure CLI commands against an Azure subscription in a PowerShell Core/Shell script when running on Linux agent or PowerShell/PowerShell Core/Batch script when running on Windows agent.\r\n2023-10-26T17:50:34.1146666Z Version      : 2.229.0\r\n2023-10-26T17:50:34.1146814Z Author       : Microsoft Corporation\r\n2023-10-26T17:50:34.1147030Z Help         : https://docs.microsoft.com/azure/devops/pipelines/tasks/deploy/azure-cli\r\n2023-10-26T17:50:34.1147502Z ==============================================================================\r\n2023-10-26T17:50:34.6458098Z [command]C:\\Windows\\system32\\cmd.exe /D /S /C \"\"C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\wbin\\az.cmd\" --version\"\r\n2023-10-26T17:50:35.3327343Z WARNING: You have 2 update(s) available. Consider updating your CLI installation with 'az upgrade'\r\n2023-10-26T17:50:35.3328514Z azure-cli                         2.53.0 *\r\n2023-10-26T17:50:35.3334935Z \r\n2023-10-26T17:50:35.3342879Z core                              2.53.0 *\r\n2023-10-26T17:50:35.3343947Z telemetry                          1.1.0\r\n2023-10-26T17:50:35.3344526Z \r\n2023-10-26T17:50:35.3345038Z Extensions:\r\n2023-10-26T17:50:35.3345867Z azure-devops                      0.26.0\r\n2023-10-26T17:50:35.3352175Z \r\n2023-10-26T17:50:35.3352899Z Dependencies:\r\n2023-10-26T17:50:35.3353454Z msal                            1.24.0b2\r\n2023-10-26T17:50:35.3354238Z azure-mgmt-resource             23.1.0b2\r\n2023-10-26T17:50:35.3354786Z \r\n2023-10-26T17:50:35.3361200Z Python location 'C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\python.exe'\r\n2023-10-26T17:50:35.3362657Z Extensions directory 'C:\\Program Files\\Common Files\\AzureCliExtensionDirectory'\r\n2023-10-26T17:50:35.3363454Z \r\n2023-10-26T17:50:35.3364326Z Python (Windows) 3.10.10 (tags/v3.10.10:aad5f6a, Feb  7 2023, 17:20:36) [MSC v.1929 64 bit (AMD64)]\r\n2023-10-26T17:50:35.3365351Z \r\n2023-10-26T17:50:35.3375635Z Legal docs and information: aka.ms/AzureCliLegal\r\n2023-10-26T17:50:35.3381316Z \r\n2023-10-26T17:50:35.3381814Z \r\n2023-10-26T17:50:35.3390724Z Setting AZURE_CONFIG_DIR env variable to: D:\\a\\_work\\_temp\\.azclitask\r\n2023-10-26T17:50:35.3392929Z Setting active cloud to: AzureCloud\r\n2023-10-26T17:50:35.3411703Z [command]C:\\Windows\\system32\\cmd.exe /D /S /C \"\"C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\wbin\\az.cmd\" cloud set -n AzureCloud\"\r\n2023-10-26T17:50:35.8766241Z [command]C:\\Windows\\system32\\cmd.exe /D /S /C \"\"C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\wbin\\az.cmd\" login --service-principal -u *** \"--password=***\" --tenant 72f988bf-86f1-41af-91ab-2d7cd011db47 --allow-no-subscriptions\"\r\n2023-10-26T17:50:36.8627501Z [\r\n2023-10-26T17:50:36.8646557Z   {\r\n2023-10-26T17:50:36.8647032Z     \"cloudName\": \"AzureCloud\",\r\n2023-10-26T17:50:36.8648231Z     \"homeTenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n2023-10-26T17:50:36.8649237Z     \"id\": \"589c7ae9-223e-45e3-a191-98433e0821a9\",\r\n2023-10-26T17:50:36.8655838Z     \"isDefault\": true,\r\n2023-10-26T17:50:36.8658275Z     \"managedByTenants\": [\r\n2023-10-26T17:50:36.8658868Z       {\r\n2023-10-26T17:50:36.8660438Z         \"tenantId\": \"2f4a9838-26b7-47ee-be60-ccc1fdec5953\"\r\n2023-10-26T17:50:36.8663017Z       }\r\n2023-10-26T17:50:36.8669008Z     ],\r\n2023-10-26T17:50:36.8669644Z     \"name\": \"Project Vienna INT\",\r\n2023-10-26T17:50:36.8670215Z     \"state\": \"Enabled\",\r\n2023-10-26T17:50:36.8671011Z     \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n2023-10-26T17:50:36.8671788Z     \"user\": {\r\n2023-10-26T17:50:36.8677806Z       \"name\": \"***\",\r\n2023-10-26T17:50:36.8678240Z       \"type\": \"servicePrincipal\"\r\n2023-10-26T17:50:36.8678847Z     }\r\n2023-10-26T17:50:36.8679325Z   }\r\n2023-10-26T17:50:36.8679774Z ]\r\n2023-10-26T17:50:36.8696896Z [command]C:\\Windows\\system32\\cmd.exe /D /S /C \"\"C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\wbin\\az.cmd\" account set --subscription 589c7ae9-223e-45e3-a191-98433e0821a9\"\r\n2023-10-26T17:50:37.5008318Z [command]C:\\Windows\\system32\\cmd.exe /D /S /C \"D:\\a\\_work\\_temp\\azureclitaskscript1698342634618.bat\"\r\n2023-10-26T17:50:37.5010366Z \r\n2023-10-26T17:50:37.5012289Z D:\\a\\_work\\3\\s>az storage blob upload-batch --overwrite true -d development/2.0.1a6 -s extension/schema --account-name azuremlsdk2 \r\n2023-10-26T17:50:50.4926198Z WARNING: \r\n2023-10-26T17:50:50.4927335Z There are no credentials provided in your command and environment, we will query for account key for your storage account.\r\n2023-10-26T17:50:50.4929400Z It is recommended to provide --connection-string, --account-key or --sas-token in your command as credentials.\r\n2023-10-26T17:50:50.4930426Z \r\n2023-10-26T17:50:50.4931954Z You also can add `--auth-mode login` in your command to use Azure Active Directory (Azure AD) for authorization if your login account is assigned required RBAC roles.\r\n2023-10-26T17:50:50.4934183Z For more information about RBAC roles in storage, visit https://docs.microsoft.com/azure/storage/common/storage-auth-aad-rbac-cli.\r\n2023-10-26T17:50:50.4935257Z \r\n2023-10-26T17:50:50.4936784Z In addition, setting the corresponding environment variables can avoid inputting credentials in your command. Please use --help to get more information about environment variable usage.\r\n2023-10-26T17:50:51.0778412Z WARNING: \r\n2023-10-26T17:50:51.0779584Z Skip querying account key due to failure: Storage account 'azuremlsdk2' not found.\r\n2023-10-26T17:50:51.1580535Z ERROR: Server failed to authenticate the request. Please refer to the information in the www-authenticate header.\r\n2023-10-26T17:50:51.1582273Z RequestId:7f9df27e-201e-004f-4d34-08d0a9000000\r\n2023-10-26T17:50:51.1582844Z Time:2023-10-26T17:50:51.1501299Z\r\n2023-10-26T17:50:51.1583227Z ErrorCode:NoAuthenticationInformation\r\n2023-10-26T17:50:51.3818018Z ##[error]Script failed with exit code: 1\r\n2023-10-26T17:50:51.5414000Z [command]C:\\Windows\\system32\\cmd.exe /D /S /C \"\"C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\wbin\\az.cmd\" account clear\"\r\n2023-10-26T17:50:51.9751495Z ##[section]Finishing: Copy yaml schema to blob\n\n### Expected behavior\n\naz storage blob upload-batch command should pass\n\n### Environment Summary\n\nC:\\Windows\\system32\\cmd.exe /D /S /C \"\"C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\wbin\\az.cmd\" --version\"\r\nWARNING: You have 2 update(s) available. Consider updating your CLI installation with 'az upgrade'\r\nazure-cli                         2.53.0 *\r\n\r\ncore                              2.53.0 *\r\ntelemetry                          1.1.0\r\n\r\nExtensions:\r\nazure-devops                      0.26.0\r\n\r\nDependencies:\r\nmsal                            1.24.0b2\r\nazure-mgmt-resource             23.1.0b2\r\n\r\nPython location 'C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\python.exe'\r\nExtensions directory 'C:\\Program Files\\Common Files\\AzureCliExtensionDirectory'\r\n\r\nPython (Windows) 3.10.10 (tags/v3.10.10:aad5f6a, Feb  7 2023, 17:20:36) [MSC v.1929 64 bit (AMD64)]\r\n\n\n### Additional context\n\nThis is failing in azure dev ops pipeline. ",
      "solution": "Hi @singankit\nFind similar issue https://github.com/Azure/azure-cli/issues/23821.\n|  |   |\n| --------------- | --------------- | \n| Issue title | Azure CLI: API version 2022-05-01 does not have operation group 'storage_accounts' |\n| Create time | 2022-09-08 |\n| Comment number | 12 |\n\nPossible solution:\nThe error message \"Server failed to authenticate the request. Please refer to the information in the www-authenticate header.\" is similar to the error message in issue #23821. In that issue, the solution was to specify `--auth-mode key` and provide `--account-key` together with `--account-name`. If you still have problems after adding `--account-key`, please share the debug log. \n\nAnother possible solution is to manually install the latest Azure CLI version, as it seems like some dependencies may be missing during auto upgrade. You can follow the instructions in this link to install the latest Azure CLI version: https://learn.microsoft.com/en-us/cli/azure/install-azure-cli.\n\n-----\nPlease confirm if this resolves your issue.\n\n---\n\nHi, we're sending this friendly reminder because we haven't heard back from you in a while. We need more information about this issue to help address it. Please be sure to give us your input within the next **7 days**. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
      "labels": [
        "Storage",
        "question",
        "needs-author-feedback",
        "no-recent-activity",
        "Upgrade",
        "Auto-Assign",
        "Azure CLI Team",
        "Auto-Resolve",
        "Similar-Issue",
        "Possible-Solution",
        "OKR Candidate"
      ],
      "created_at": "2023-10-27T22:03:52Z",
      "closed_at": "2025-12-20T17:29:13Z",
      "url": "https://github.com/Azure/azure-cli/issues/27711",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 27912,
      "title": "[X509] unknown error (_ssl.c:4035) after upgrading to 2.54.0",
      "problem": "### Describe the bug\n\nAfter upgrading to 2.54.0 the connection through proxy doesn't work anymore\n\n### Related command\n\naz login\n\n### Errors\n\ncli.azure.cli.core.azclierror: [X509] unknown error (_ssl.c:4035)\r\naz_command_data_logger: [X509] unknown error (_ssl.c:4035)\n\n### Issue script & Debug output\n\ncli.knack.cli: Command arguments: ['login', '--debug']\r\ncli.knack.cli: __init__ debug log:\r\nEnable color in terminal.\r\nEnable VT mode.\r\ncli.knack.cli: Event: Cli.PreExecute []\r\ncli.knack.cli: Event: CommandParser.OnGlobalArgumentsCreate [<function CLILogging.on_global_arguments at 0x000001E74074B560>, <function OutputProducer.on_global_arguments at 0x000001E7408D5C60>, <function CLIQuery.on_global_arguments at 0x000001E7409037E0>]\r\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableCreate []\r\ncli.azure.cli.core: Modules found from index for 'login': ['azure.cli.command_modules.profile']\r\ncli.azure.cli.core: Loading command modules:\r\ncli.azure.cli.core: Name                  Load Time    Groups  Commands\r\ncli.azure.cli.core: profile                   0.006         2         8\r\ncli.azure.cli.core: Total (1)                 0.006         2         8\r\ncli.azure.cli.core: These extensions are not installed and will be skipped: ['azext_ai_examples', 'azext_next']\r\ncli.azure.cli.core: Loading extensions:\r\ncli.azure.cli.core: Name                  Load Time    Groups  Commands  Directory\r\ncli.azure.cli.core: Total (0)                 0.000         0         0\r\ncli.azure.cli.core: Loaded 2 groups, 8 commands.\r\ncli.azure.cli.core: Found a match in the command table.\r\ncli.azure.cli.core: Raw command  : login\r\ncli.azure.cli.core: Command table: login\r\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableTruncate [<function AzCliLogging.init_command_file_logging at 0x000001E7437794E0>]\r\ncli.azure.cli.core.azlogging: metadata file logging enabled - writing logs to 'C:\\Users\\danielste\\.azure\\commands\\2023-11-24.09-34-31.login.21236.log'.\r\naz_command_data_logger: command args: login --debug\r\ncli.knack.cli: Event: CommandInvoker.OnPreArgumentLoad [<function register_global_subscription_argument.<locals>.add_subscription_parameter at 0x000001E7437B79C0>]\r\ncli.knack.cli: Event: CommandInvoker.OnPostArgumentLoad []\r\ncli.knack.cli: Event: CommandInvoker.OnPostCommandTableCreate [<function register_ids_argument.<locals>.add_ids_arguments at 0x000001E7437B7A60>, <function register_cache_arguments.<locals>.add_cache_arguments at 0x000001E7437B7BA0>]\r\ncli.knack.cli: Event: CommandInvoker.OnCommandTableLoaded []\r\ncli.knack.cli: Event: CommandInvoker.OnPreParseArgs []\r\ncli.knack.cli: Event: CommandInvoker.OnPostParseArgs [<function OutputProducer.handle_output_argument at 0x000001E7408D5D00>, <function CLIQuery.handle_query_parameter at 0x000001E740903880>, <function register_ids_argument.<locals>.parse_ids_arguments at 0x000001E7437B7B00>]\r\ncli.azure.cli.core.auth.persistence: build_persistence: location='C:\\\\Users\\\\danielste\\\\.azure\\\\msal_token_cache.bin', encrypt=True\r\ncli.azure.cli.core.auth.binary_cache: load: C:\\Users\\danielste\\.azure\\msal_http_cache.bin\r\nurllib3.util.retry: Converted retries value: 1 -> Retry(total=1, connect=None, read=None, redirect=None, status=None)\r\nmsal.authority: openid_config = {'token_endpoint': 'https://login.microsoftonline.com/organizations/oauth2/v2.0/token', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'private_key_jwt', 'client_secret_basic'], 'jwks_uri': 'https://login.microsoftonline.com/organizations/discovery/v2.0/keys', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['pairwise'], 'id_token_signing_alg_values_supported': ['RS256'], 'response_types_supported': ['code', 'id_token', 'code id_token', 'id_token token'], 'scopes_supported': ['openid', 'profile', 'email', 'offline_access'], 'issuer': 'https://login.microsoftonline.com/{tenantid}/v2.0', 'request_uri_parameter_supported': False, 'userinfo_endpoint': 'https://graph.microsoft.com/oidc/userinfo', 'authorization_endpoint': 'https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize', 'device_authorization_endpoint': 'https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode', 'http_logout_supported': True, 'frontchannel_logout_supported': True, 'end_session_endpoint': 'https://login.microsoftonline.com/organizations/oauth2/v2.0/logout', 'claims_supported': ['sub', 'iss', 'cloud_instance_name', 'cloud_instance_host_name', 'cloud_graph_host_name', 'msgraph_host', 'aud', 'exp', 'iat', 'auth_time', 'acr', 'nonce', 'preferred_username', 'name', 'tid', 'ver', 'at_hash', 'c_hash', 'email'], 'kerberos_endpoint': 'https://login.microsoftonline.com/organizations/kerberos', 'tenant_region_scope': None, 'cloud_instance_name': 'microsoftonline.com', 'cloud_graph_host_name': 'graph.windows.net', 'msgraph_host': 'graph.microsoft.com', 'rbac_url': 'https://pas.windows.net'}\r\nmsal.application: Broker enabled? True\r\nmsal.application: Falls back to broker._signin_interactively()\r\ncli.azure.cli.core.auth.identity: Please select the account you want to log in with.\r\nmsal.broker: [MSAL:0001]        INFO    SetCorrelationId:220    Set correlation ID: a94ee503-bcb3-46ff-a80c-fb14256d95c2msal.broker: [MSAL:0001]        INFO    ExecuteInteractiveRequest:804   The original authority is 'https://login.microsoftonline.com/organizations'\r\nmsal.broker: [MSAL:0001]        WARNING TryNormalizeRealm:2224  No HomeAccountId provided to normalize the realm\r\nmsal.broker: [MSAL:0001]        INFO    ExecuteInteractiveRequest:815   The normalized realm is ''\r\nmsal.broker: [MSAL:0001]        INFO    ModifyAndValidateAuthParameters:208     Additional query parameter added successfully. Key: '(pii)' Value: '(pii)'\r\nmsal.broker: [MSAL:0001]        INFO    ModifyAndValidateAuthParameters:208     Additional query parameter added successfully. Key: '(pii)' Value: '(pii)'\r\nmsal.broker: [MSAL:0001]        INFO    ModifyAndValidateAuthParameters:225     Authority Realm: organizations\r\nmsal.broker: [MSAL:0002]        WARNING TryReadUniversalStorage:639     Attempted to read cache with a non-normalized realm, access token and ID token reads will fail\r\nmsal.broker: [MSAL:0002]        WARNING ReadAccountById:225     Account id is empty - account not found\r\nmsal.broker: [MSAL:0002]        INFO    SetCanonicalRealm:1048  Normalize realm to: '1ac04339-8417-4387-b32c-9a9526779033'\r\nmsal.broker: [MSAL:0002]        ERROR   ErrorInternalImpl:134   Created an error: 9zj2r, StatusInternal::Unexpected, InternalEvent::None, Error Code 2148073483, Context 'Error decrypting data of size 506'\r\nmsal.broker: [MSAL:0002]        WARNING DecryptParse:964        Failed to decrypt '(pii)', overwriting\r\nmsal.broker: [MSAL:0002]        ERROR   ErrorInternalImpl:134   Created an error: 9zj2r, StatusInternal::Unexpected, InternalEvent::None, Error Code 2148073483, Context 'Error decrypting data of size 538'\r\nmsal.broker: [MSAL:0002]        WARNING DecryptParse:964        Failed to decrypt '(pii)', overwriting\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:332    Printing Telemetry for Correlation ID: a94ee503-bcb3-46ff-a80c-fb14256d95c2\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: start_time, Value: 2023-11-24T07:34:31.000Z\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: api_name, Value: SignInInteractively\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: was_request_throttled, Value: false\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: authority_type, Value: AAD\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: access_token_expiry_time, Value: 2023-11-24T08:05:10.000Z\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: msal_version, Value: 1.1.0+local\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: client_id, Value: 04b07795-8ddb-461a-bbee-02f9e1bf7b46\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: correlation_id, Value: a94ee503-bcb3-46ff-a80c-fb14256d95c2\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: stop_time, Value: 2023-11-24T07:34:37.000Z\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: msalruntime_version, Value: 0.13.12\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: original_authority, Value: https://login.microsoftonline.com/organizations\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: request_eligible_for_broker, Value: true\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: broker_app_used, Value: true\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: additional_query_parameters_count, Value: 2\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: read_token_last_error, Value: missing required parameter\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: auth_flow, Value: Broker\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: ui_event_count, Value: 1\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: wam_telemetry, Value: {\"x_ms_clitelem\":\"1,0,0,50640297.4093,\",\"ui_visible\":false,\"tenant_id\":\"1ac04339-8417-4387-b32c-9a9526779033\",\"scope\":\"https://management.core.windows.net//.default offline_access openid profile\",\"redirect_uri\":\"ms-appx-web://Microsoft.AAD.BrokerPlugin/04b07795-8ddb-461a-bbee-02f9e1bf7b46\",\"provider_id\":\"https://login.windows.net\",\"http_status\":200,\"http_event_count\":2,\"device_join\":\"haadj\",\"correlation_id\":\"{1a27815c-6f7a-47a3-9eb7-d6fc6045d4c2}\",\"client_id\":\"04b07795-8ddb-461a-bbee-02f9e1bf7b46\",\"cache_event_count\":0,\"broker_version\":\"10.0.18362.1766\",\"authority\":\"https://login.microsoftonline.com/organizations\",\"api_error_code\":0,\"account_join_on_start\":\"primary\",\"account_join_on_end\":\"primary\",\"account_id\":\"81c1e8af-bbc1-47e9-b599-3136dc13a470\",\"silent_code\":0,\"silent_bi_sub_code\":0,\"silent_message\":\"\",\"silent_mats\":{\"x_ms_clitelem\":\"1,0,0,50640297.4093,\",\"ui_visible\":false,\"tenant_id\":\"1ac04339-8417-4387-b32c-9a9526779033\",\"scope\":\"https://management.core.windows.net//.default offline_access openid profile\",\"redirect_uri\":\"ms-appx-web://Microsoft.AAD.BrokerPlugin/04b07795-8ddb-461a-bbee-02f9e1bf7b46\",\"provider_id\":\"https://login.windows.net\",\"http_status\":200,\"http_event_count\":2,\"device_join\":\"haadj\",\"correlation_id\":\"{1a27815c-6f7a-47a3-9eb7-d6fc6045d4c2}\",\"client_id\":\"04b07795-8ddb-461a-bbee-02f9e1bf7b46\",\"cache_event_count\":0,\"broker_version\":\"10.0.18362.1766\",\"authority\":\"https://login.microsoftonline.com/organizations\",\"api_error_code\":0,\"account_join_on_start\":\"primary\",\"account_join_on_end\":\"primary\",\"account_id\":\"81c1e8af-bbc1-47e9-b599-3136dc13a470\",\"silent_code\":0,\"silent_bi_sub_code\":0,\"silent_message\":\"\",\"silent_mats\":{\"x_ms_clitelem\":\"1,0,0,50640297.4093,\",\"ui_visible\":false,\"tenant_id\":\"1ac04339-8417-4387-b32c-9a9526779033\",\"scope\":\"https://management.core.windows.net//.default offline_access openid profile\",\"redirect_uri\":\"ms-appx-web://Microsoft.AAD.BrokerPlugin/04b07795-8ddb-461a-bbee-02f9e1bf7b46\",\"provider_id\":\"https://login.windows.net\",\"http_status\":200,\"http_event_count\":2,\"device_join\":\"haadj\",\"correlation_id\":\"{1a27815c-6f7a-47a3-9eb7-d6fc6045d4c2}\",\"client_id\":\"04b07795-8ddb-461a-bbee-02f9e1bf7b46\",\"cache_event_count\":0,\"broker_version\":\"10.0.18362.1766\",\"authority\":\"https://login.microsoftonline.com/organizations\",\"api_error_code\":0,\"account_join_on_start\":\"primary\",\"account_join_on_end\":\"primary\",\"account_id\":\"81c1e8af-bbc1-47e9-b599-3136dc13a470\"},\"silent_status\":0,\"is_cached\":0},\"silent_status\":0,\"is_cached\":1}\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: tenant_id, Value: 1ac04339-8417-4387-b32c-9a9526779033\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: normalized_realm, Value: 1ac04339-8417-4387-b32c-9a9526779033\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: write_token, Value: AT|ID\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: is_successful, Value: true\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: authorization_type, Value: CompleteBrokerResult\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:340    Key: request_duration, Value: 5649\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:345    Printing Execution Flow:\r\nmsal.broker: [MSAL:0002]        INFO    LogTelemetryData:353    {\"t\":\"646u1\",\"tid\":1,\"ts\":0,\"l\":2},{\"t\":\"8dqim\",\"tid\":2,\"ts\":4,\"l\":2},{\"t\":\"8dqkl\",\"tid\":1,\"ts\":6,\"l\":2,\"a\":9,\"ie\":0},{\"t\":\"54uxe\",\"tid\":1,\"ts\":10,\"l\":2},{\"t\":\"4wqm9\",\"tid\":3,\"ts\":2165,\"l\":2},{\"t\":\"8dql1\",\"tid\":3,\"ts\":2204,\"l\":2},{\"t\":\"8dqkn\",\"tid\":3,\"ts\":2204,\"l\":2,\"a\":5,\"ie\":1},{\"t\":\"8dqko\",\"tid\":3,\"ts\":2204,\"l\":2,\"a\":9,\"ie\":1},{\"t\":\"8dqkr\",\"tid\":3,\"ts\":2204,\"l\":2},{\"t\":\"8b2yn\",\"tid\":2,\"ts\":2204,\"l\":2},{\"t\":\"8dqlh\",\"tid\":2,\"ts\":2204,\"l\":2},{\"t\":\"8dqli\",\"tid\":2,\"ts\":2204,\"l\":2},{\"t\":\"8dqln\",\"tid\":2,\"ts\":2204,\"l\":2},{\"t\":\"8dqih\",\"tid\":2,\"ts\":2204,\"l\":2},{\"t\":\"7e60p\",\"tid\":2,\"ts\":2205,\"l\":2,\"a\":3,\"ie\":0},{\"t\":\"7e60q\",\"tid\":2,\"ts\":2226,\"l\":2,\"a\":3,\"ie\":1},{\"t\":\"7e60v\",\"tid\":2,\"ts\":2226,\"l\":2,\"a\":2,\"ie\":0},{\"t\":\"7e60w\",\"tid\":2,\"ts\":2227,\"l\":2,\"a\":2,\"ie\":1},{\"t\":\"7e60r\",\"tid\":2,\"ts\":2227,\"l\":2,\"a\":3,\"ie\":0},{\"t\":\"6ou2y\",\"tid\":2,\"ts\":2238,\"l\":2,\"a\":3,\"ie\":1},{\"t\":\"6xuag\",\"tid\":2,\"ts\":2238,\"l\":2},{\"t\":\"4waym\",\"tid\":2,\"ts\":2238,\"l\":2}\r\nmsal.token_cache: event={\r\n    \"_account_id\": \"81c1e8af-bbc1-47e9-b599-3136dc13a470\",\r\n    \"client_id\": \"04b07795-8ddb-461a-bbee-02f9e1bf7b46\",\r\n    \"data\": {},\r\n    \"response\": {\r\n        \"_account_id\": \"81c1e8af-bbc1-47e9-b599-3136dc13a470\",\r\n        \"_msalruntime_telemetry\": {\r\n            \"access_token_expiry_time\": \"2023-11-24T08:05:10.000Z\",\r\n            \"additional_query_parameters_count\": \"2\",\r\n            \"api_name\": \"SignInInteractively\",\r\n            \"auth_flow\": \"Broker\",\r\n            \"authority_type\": \"AAD\",\r\n            \"authorization_type\": \"CompleteBrokerResult\",\r\n            \"broker_app_used\": \"true\",\r\n            \"client_id\": \"04b07795-8ddb-461a-bbee-02f9e1bf7b46\",\r\n            \"correlation_id\": \"a94ee503-bcb3-46ff-a80c-fb14256d95c2\",\r\n            \"is_successful\": \"true\",\r\n            \"msal_version\": \"1.1.0+local\",\r\n            \"msalruntime_version\": \"0.13.12\",\r\n            \"normalized_realm\": \"1ac04339-8417-4387-b32c-9a9526779033\",\r\n            \"original_authority\": \"https://login.microsoftonline.com/organizations\",\r\n            \"read_token_last_error\": \"missing required parameter\",\r\n            \"request_duration\": \"5649\",\r\n            \"request_eligible_for_broker\": \"true\",\r\n            \"start_time\": \"2023-11-24T07:34:31.000Z\",\r\n            \"stop_time\": \"2023-11-24T07:34:37.000Z\",\r\n            \"tenant_id\": \"1ac04339-8417-4387-b32c-9a9526779033\",\r\n            \"ui_event_count\": \"1\",\r\n            \"was_request_throttled\": \"false\",\r\n            \"write_token\": \"AT|ID\"\r\n        },\r\n        \"access_token\": \"********\",\r\n        \"client_info\": \"foobar\",\r\n        \"expires_in\": 1833,\r\n        \"id_token\": \"********\",\r\n        \"id_token_claims\": \"********\",\r\n        \"scope\": \"https://management.core.windows.net//user_impersonation https://management.core.windows.net//.default\",\r\n        \"token_type\": \"Bearer\"\r\n    },\r\n    \"scope\": [\r\n        \"https://management.core.windows.net//user_impersonation\",\r\n        \"https://management.core.windows.net//.default\"\r\n    ],\r\n    \"token_endpoint\": \"https://login.microsoftonline.com/organizations/oauth2/v2.0/token\"\r\n}\r\nurllib3.util.retry: Converted retries value: 1 -> Retry(total=1, connect=None, read=None, redirect=None, status=None)\r\nmsal.authority: openid_config = {'token_endpoint': 'https://login.microsoftonline.com/organizations/oauth2/v2.0/token', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'private_key_jwt', 'client_secret_basic'], 'jwks_uri': 'https://login.microsoftonline.com/organizations/discovery/v2.0/keys', 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['pairwise'], 'id_token_signing_alg_values_supported': ['RS256'], 'response_types_supported': ['code', 'id_token', 'code id_token', 'id_token token'], 'scopes_supported': ['openid', 'profile', 'email', 'offline_access'], 'issuer': 'https://login.microsoftonline.com/{tenantid}/v2.0', 'request_uri_parameter_supported': False, 'userinfo_endpoint': 'https://graph.microsoft.com/oidc/userinfo', 'authorization_endpoint': 'https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize', 'device_authorization_endpoint': 'https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode', 'http_logout_supported': True, 'frontchannel_logout_supported': True, 'end_session_endpoint': 'https://login.microsoftonline.com/organizations/oauth2/v2.0/logout', 'claims_supported': ['sub', 'iss', 'cloud_instance_name', 'cloud_instance_host_name', 'cloud_graph_host_name', 'msgraph_host', 'aud', 'exp', 'iat', 'auth_time', 'acr', 'nonce', 'preferred_username', 'name', 'tid', 'ver', 'at_hash', 'c_hash', 'email'], 'kerberos_endpoint': 'https://login.microsoftonline.com/organizations/kerberos', 'tenant_region_scope': None, 'cloud_instance_name': 'microsoftonline.com', 'cloud_graph_host_name': 'graph.windows.net', 'msgraph_host': 'graph.microsoft.com', 'rbac_url': 'https://pas.windows.net'}\r\nmsal.application: Broker enabled? True\r\ncli.azure.cli.core._debug: Connection verification disabled by environment variable AZURE_CLI_DISABLE_CONNECTION_VERIFICATION\r\ncli.azure.cli.core.auth.msal_authentication: UserCredential.get_token: scopes=('https://management.core.windows.net//.default',), claims=None, kwargs={}\r\nmsal.application: Cache hit an AT\r\nmsal.telemetry: Generate or reuse correlation_id: 8d9b946f-d408-4234-8792-ec74f28e43ec\r\ncli.azure.cli.core.sdk.policies: Request URL: 'https://management.azure.com/tenants?api-version=2019-11-01'\r\ncli.azure.cli.core.sdk.policies: Request method: 'GET'\r\ncli.azure.cli.core.sdk.policies: Request headers:\r\ncli.azure.cli.core.sdk.policies:     'Accept': 'application/json'\r\ncli.azure.cli.core.sdk.policies:     'x-ms-client-request-id': 'e809a827-8a9b-11ee-a582-d89ef3375ec1'\r\ncli.azure.cli.core.sdk.policies:     'CommandName': 'login'\r\ncli.azure.cli.core.sdk.policies:     'ParameterSetName': '--debug'\r\ncli.azure.cli.core.sdk.policies:     'User-Agent': 'AZURECLI/2.54.0 (MSI) azsdk-python-azure-mgmt-resource/23.1.0b2 Python/3.11.5 (Windows-10-10.0.18363-SP0)'\r\ncli.azure.cli.core.sdk.policies:     'Authorization': '*****'\r\ncli.azure.cli.core.sdk.policies: Request body:\r\ncli.azure.cli.core.sdk.policies: This request has no body\r\nurllib3.connectionpool: Starting new HTTPS connection (1): management.azure.com:443\r\ncli.azure.cli.core.sdk.policies: Request URL: 'https://management.azure.com/tenants?api-version=2019-11-01'\r\ncli.azure.cli.core.sdk.policies: Request method: 'GET'\r\ncli.azure.cli.core.sdk.policies: Request headers:\r\ncli.azure.cli.core.sdk.policies:     'Accept': 'application/json'\r\ncli.azure.cli.core.sdk.policies:     'x-ms-client-request-id': 'e809a827-8a9b-11ee-a582-d89ef3375ec1'\r\ncli.azure.cli.core.sdk.policies:     'CommandName': 'login'\r\ncli.azure.cli.core.sdk.policies:     'ParameterSetName': '--debug'\r\ncli.azure.cli.core.sdk.policies:     'User-Agent': 'AZURECLI/2.54.0 (MSI) azsdk-python-azure-mgmt-resource/23.1.0b2 Python/3.11.5 (Windows-10-10.0.18363-SP0)'\r\ncli.azure.cli.core.sdk.policies:     'Authorization': '*****'\r\ncli.azure.cli.core.sdk.policies: Request body:\r\ncli.azure.cli.core.sdk.policies: This request has no body\r\nurllib3.connectionpool: Starting new HTTPS connection (2): management.azure.com:443\r\ncli.azure.cli.core.sdk.policies: Request URL: 'https://management.azure.com/tenants?api-version=2019-11-01'\r\ncli.azure.cli.core.sdk.policies: Request method: 'GET'\r\ncli.azure.cli.core.sdk.policies: Request headers:\r\ncli.azure.cli.core.sdk.policies:     'Accept': 'application/json'\r\ncli.azure.cli.core.sdk.policies:     'x-ms-client-request-id': 'e809a827-8a9b-11ee-a582-d89ef3375ec1'\r\ncli.azure.cli.core.sdk.policies:     'CommandName': 'login'\r\ncli.azure.cli.core.sdk.policies:     'ParameterSetName': '--debug'\r\ncli.azure.cli.core.sdk.policies:     'User-Agent': 'AZURECLI/2.54.0 (MSI) azsdk-python-azure-mgmt-resource/23.1.0b2 Python/3.11.5 (Windows-10-10.0.18363-SP0)'\r\ncli.azure.cli.core.sdk.policies:     'Authorization': '*****'\r\ncli.azure.cli.core.sdk.policies: Request body:\r\ncli.azure.cli.core.sdk.policies: This request has no body\r\nurllib3.connectionpool: Starting new HTTPS connection (3): management.azure.com:443\r\ncli.azure.cli.core.sdk.policies: Request URL: 'https://management.azure.com/tenants?api-version=2019-11-01'\r\ncli.azure.cli.core.sdk.policies: Request method: 'GET'\r\ncli.azure.cli.core.sdk.policies: Request headers:\r\ncli.azure.cli.core.sdk.policies:     'Accept': 'application/json'\r\ncli.azure.cli.core.sdk.policies:     'x-ms-client-request-id': 'e809a827-8a9b-11ee-a582-d89ef3375ec1'\r\ncli.azure.cli.core.sdk.policies:     'CommandName': 'login'\r\ncli.azure.cli.core.sdk.policies:     'ParameterSetName': '--debug'\r\ncli.azure.cli.core.sdk.policies:     'User-Agent': 'AZURECLI/2.54.0 (MSI) azsdk-python-azure-mgmt-resource/23.1.0b2 Python/3.11.5 (Windows-10-10.0.18363-SP0)'\r\ncli.azure.cli.core.sdk.policies:     'Authorization': '*****'\r\ncli.azure.cli.core.sdk.policies: Request body:\r\ncli.azure.cli.core.sdk.policies: This request has no body\r\nurllib3.connectionpool: Starting new HTTPS connection (4): management.azure.com:443\r\ncli.azure.cli.core.azclierror: Traceback (most recent call last):\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\knack/cli.py\", line 233, in invoke\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 663, in execute\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 726, in _run_jobs_serially\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 697, in _run_job\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 333, in __call__\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/command_operation.py\", line 121, in handler\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/command_modules/profile/custom.py\", line 139, in login\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/_profile.py\", line 176, in login\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/_profile.py\", line 740, in find_using_common_tenant\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/core/paging.py\", line 128, in __next__\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/core/paging.py\", line 76, in __next__\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/mgmt/resource/subscriptions/v2019_11_01/operations/_operations.py\", line 739, in get_next\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/core/pipeline/_base.py\", line 211, in run\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/core/pipeline/_base.py\", line 71, in send\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/core/pipeline/_base.py\", line 71, in send\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/core/pipeline/_base.py\", line 71, in send\r\n  [Previous line repeated 2 more times]\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/mgmt/core/policies/_base.py\", line 47, in send\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/core/pipeline/policies/_redirect.py\", line 158, in send\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/core/pipeline/policies/_retry.py\", line 468, in send\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/core/pipeline/policies/_retry.py\", line 446, in send\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/core/pipeline/policies/_authentication.py\", line 118, in send\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/core/pipeline/_base.py\", line 71, in send\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/core/pipeline/_base.py\", line 71, in send\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/core/pipeline/_base.py\", line 71, in send\r\n  [Previous line repeated 1 more time]\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/core/pipeline/_base.py\", line 103, in send\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/core/pipeline/transport/_requests_basic.py\", line 361, in send\r\nazure.core.exceptions.ServiceRequestError: [X509] unknown error (_ssl.c:4035)\r\n\r\ncli.azure.cli.core.azclierror: [X509] unknown error (_ssl.c:4035)\r\naz_command_data_logger: [X509] unknown error (_ssl.c:4035)\r\nCertificate verification failed. This typically happens when using Azure CLI behind a proxy that intercepts traffic with a self-signed certificate. Please add this certificate to the trusted CA bundle. More info: https://docs.microsoft.com/cli/azure/use-cli-effectively#work-behind-a-proxy.\r\ncli.knack.cli: Event: Cli.PostExecute [<function AzCliLogging.deinit_cmd_metadata_logging at 0x000001E743779760>]\r\naz_command_data_logger: exit code: 1\r\ncli.__main__: Command ran in 11.973 seconds (init: 0.655, invoke: 11.318)\r\ntelemetry.main: Begin splitting cli events and extra events, total events: 1\r\ntelemetry.client: Accumulated 0 events. Flush the clients.\r\ntelemetry.main: Finish splitting cli events and extra events, cli events: 1\r\ntelemetry.save: Save telemetry record of length 4526 in cache\r\ntelemetry.main: Begin creating telemetry upload process.\r\ntelemetry.process: Creating upload process: \"C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\python.exe C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\Lib\\site-packages\\azure\\cli\\telemetry\\__init__.pyc C:\\Users\\danielste\\.azure\"\r\ntelemetry.process: Return from creating process\r\ntelemetry.main: Finish creating telemetry upload process.\n\n### Expected behavior\n\nD:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\urllib3/connectionpool.py:1056: InsecureRequestWarning: Unverified HTTPS request is being made to host 'proxy'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/1.26.x/advanced-usage.html#ssl-warnings\r\nConnection verification disabled by environment variable AZURE_CLI_DISABLE_CONNECTION_VERIFICATION\r\nD:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\urllib3/connectionpool.py:1056: InsecureRequestWarning: Unverified HTTPS request is being made to host 'proxy'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/1.26.x/advanced-usage.html#ssl-warnings\r\n[\r\n  {\r\n    \"cloudName\": \"AzureCloud\",\r\n    \"homeTenantId\": \"1111\",\r\n    \"id\": \"1111\",\r\n    \"isDefault\": true,\r\n    \"managedByTenants\": [],\r\n    \"name\": \"Visual Studio Professional Subscription\",\r\n    \"state\": \"Enabled\",\r\n    \"tenantId\": \"1111\",\r\n    \"user\": {\r\n      \"name\": \"foo@bar.com\",\r\n      \"type\": \"user\"\r\n    }\r\n  }\r\n]\n\n### Environment Summary\n\nazure-cli                         2.54.0\r\n\r\ncore                              2.54.0\r\ntelemetry                          1.1.0\r\n\r\nExtensions:\r\nazure-devops                      0.26.0\r\ndevcenter                          3.0.0\r\n\r\nDependencies:\r\nmsal                            1.24.0b2\r\nazure-mgmt-resource             23.1.0b2\r\n\r\nPython location 'C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\python.exe'\r\nExtensions directory 'C:\\Users\\danielste\\.azure\\cliextensions'\r\n\r\nPython (Windows) 3.11.5 (tags/v3.11.5:cce6ba9, Aug 24 2023, 14:38:34) [MSC v.1936 64 bit (AMD64)]\n\n### Additional context\n\nReverting back to 2.53.0 it fixed the issue",
      "solution": "Hi, we're sending this friendly reminder because we haven't heard back from you in a while. We need more information about this issue to help address it. Please be sure to give us your input within the next **7 days**. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
      "labels": [
        "Account",
        "question",
        "AAD",
        "customer-reported",
        "needs-author-feedback",
        "no-recent-activity",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2023-11-24T07:43:37Z",
      "closed_at": "2025-12-20T17:29:12Z",
      "url": "https://github.com/Azure/azure-cli/issues/27912",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 27800,
      "title": "Unable to move blob to virtual directory with `az storage fs file move`",
      "problem": "### Describe the bug\n\nWhen attempting to move a blob file within the same container to a new virtual path, an error is returned regarding its parent directory not existing. Blobs can only be moved to the root of the container\r\n\r\nCommand toe reproduce: \r\n```az storage fs file move --file-system \"myContainer\" --path \"myfile.json\" --new-path \"myContainer/myFolder/myfile.json```\r\n\n\n### Related command\n\naz storage fs file move\n\n### Errors\n\nThe parent directory of the destination path does not exist.\r\nErrorCode:RenameDestinationParentPathNotFound\n\n### Issue script & Debug output\n\naz storage fs file move --file-system \"myContainer\" --path \"myfile.json\" --new-path \"myContainer/myFolder/myfile.json\n\n### Expected behavior\n\nFile should be moved/renamed with virtual path prefixed.\n\n### Environment Summary\n\n{\r\n  \"azure-cli\": \"2.53.1\",\r\n  \"azure-cli-core\": \"2.53.1\",\r\n  \"azure-cli-telemetry\": \"1.1.0\",\r\n  \"extensions\": {\r\n    \"aks-preview\": \"0.5.161\",\r\n    \"azure-devops\": \"0.25.0\",\r\n    \"interactive\": \"0.5.3\",\r\n    \"storage-preview\": \"0.8.3\"\r\n  }\r\n}\n\n### Additional context\n\nThe documentation for ```az storage blob move``` states that ```az storage fs file move``` should be used as the former command is deprecated however there is not parity in functionality when moving a blob from one path to another virtual directory.\r\n\r\nhttps://learn.microsoft.com/en-us/cli/azure/storage/blob?view=azure-cli-latest#az-storage-blob-move",
      "solution": "Hi, we're sending this friendly reminder because we haven't heard back from you in a while. We need more information about this issue to help address it. Please be sure to give us your input within the next **7 days**. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
      "labels": [
        "Storage",
        "question",
        "customer-reported",
        "needs-author-feedback",
        "no-recent-activity",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2023-11-08T19:08:46Z",
      "closed_at": "2025-12-20T17:29:12Z",
      "url": "https://github.com/Azure/azure-cli/issues/27800",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 27926,
      "title": "Unable to approve Private Link Hub private endpoint",
      "problem": "### Describe the bug\r\n\r\nAttempting to approve a private endpoint connection ID results in an error.\r\n\r\n### Related command\r\n\r\n`az network private-endpoint-connection approve --id /subscriptions/<subscription ID>/resourceGroups/ResourceGroup1/providers/Microsoft.Synapse/privateLinkHubs/privatelinkhub/privateEndpointConnections/privateEndpointConnection1id`\r\n\r\n### Errors\r\n\r\nResource type must be one of Microsoft.AgFoodPlatform/farmBeats, Microsoft.Automation/automationAccounts, Microsoft.Authorization/resourceManagementPrivateLinks, Microsoft.ApiManagement/service, Microsoft.AppConfiguration/configurationStores, Microsoft.Batch/batchAccounts, Microsoft.BotService/botServices, Microsoft.Cache/Redis, Microsoft.CognitiveServices/accounts, Microsoft.Compute/diskAccesses, Microsoft.ContainerRegistry/registries, Microsoft.Dashboard/grafana, Microsoft.DBforMySQL/servers, Microsoft.DBforMariaDB/servers, Microsoft.DBforPostgreSQL/servers, Microsoft.DesktopVirtualization/hostpools, Microsoft.DesktopVirtualization/workspaces, Microsoft.Devices/IotHubs, Microsoft.DeviceUpdate/accounts, Microsoft.DocumentDB/databaseAccounts, Microsoft.DigitalTwins/digitalTwinsInstances, Microsoft.EventGrid/topics, Microsoft.EventGrid/domains, Microsoft.EventHub/namespaces, Microsoft.HardwareSecurityModules/cloudHsmClusters, Microsoft.HDInsight/clusters, Microsoft.HybridCompute/privateLinkScopes, Microsoft.HealthcareApis/services, microsoft.insights/privateLinkScopes, Microsoft.KeyVault/managedHSMs, Microsoft.Keyvault/vaults, Microsoft.MachineLearningServices/workspaces, Microsoft.Media/mediaservices, Microsoft.Monitor/accounts, Microsoft.Network/applicationGateways, Microsoft.Network/privateLinkServices, Microsoft.Purview/accounts, Microsoft.PowerBI/privateLinkServicesForPowerBI, Microsoft.Search/searchServices, Microsoft.ServiceBus/namespaces, Microsoft.SignalRService/signalr, Microsoft.Sql/servers, Microsoft.Storage/storageAccounts, Microsoft.StorageSync/storageSyncServices, Microsoft.Synapse/workspaces, Microsoft.Web/sites, Microsoft.Web/hostingEnvironments, Microsoft.SignalRService/WebPubSub, Microsoft.DataFactory/factories, Microsoft.Databricks/workspaces, Microsoft.RecoveryServices/vaults, Microsoft.Kusto/clusters, Microsoft.KubernetesConfiguration/privateLinkScopes, Microsoft.OpenEnergyPlatform/energyServices, Microsoft.MachineLearningServices/registries, Microsoft.DBforMySQL/flexibleServers\r\n\r\n### Issue script & Debug output\r\n\r\n`az network private-endpoint-connection approve --id $privateEndpointId --debug`\r\ncli.knack.cli: Command arguments: ['network', 'private-endpoint-connection', 'approve', '--id', '/subscriptions/<subscription id>/resourceGroups/<resource group name>/providers/Microsoft.Synapse/privateLinkHubs/<private link hub name>/privateEndpointConnections/<private endpoint connection id>', '--debug']\r\ncli.knack.cli: __init__ debug log:\r\nEnable color in terminal.\r\ncli.knack.cli: Event: Cli.PreExecute []\r\ncli.knack.cli: Event: CommandParser.OnGlobalArgumentsCreate [<function CLILogging.on_global_arguments at 0x00000171A961F6A0>, <function OutputProducer.on_global_arguments at 0x00000171A97A5DA0>, <function CLIQuery.on_global_arguments at 0x00000171A97D3920>]\r\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableCreate []\r\ncli.azure.cli.core: Modules found from index for 'network': ['azure.cli.command_modules.network', 'azure.cli.command_modules.privatedns']\r\ncli.azure.cli.core: Loading command modules:\r\ncli.azure.cli.core: Name                  Load Time    Groups  Commands\r\ncli.azure.cli.core: network                   0.525       115       453\r\ncli.azure.cli.core: privatedns                0.029        14        60\r\ncli.azure.cli.core: Total (2)                 0.554       129       513\r\ncli.azure.cli.core: Loaded 128 groups, 513 commands.\r\ncli.azure.cli.core: Found a match in the command table.\r\ncli.azure.cli.core: Raw command  : network private-endpoint-connection approve\r\ncli.azure.cli.core: Command table: network private-endpoint-connection approve\r\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableTruncate [<function AzCliLogging.init_command_file_logging at 0x00000171AC6F9620>]\r\ncli.azure.cli.core.azlogging: metadata file logging enabled - writing logs to 'C:\\Users\\dareist\\.azure\\commands\\2023-11-27.13-06-05.network_private-endpoint-connection_approve.36344.log'.\r\naz_command_data_logger: command args: network private-endpoint-connection approve --id {} --debug\r\ncli.knack.cli: Event: CommandInvoker.OnPreArgumentLoad [<function register_global_subscription_argument.<locals>.add_subscription_parameter at 0x00000171AC735940>]\r\ncli.knack.cli: Event: CommandInvoker.OnPostArgumentLoad []\r\ncli.knack.cli: Event: CommandInvoker.OnPostCommandTableCreate [<function register_ids_argument.<locals>.add_ids_arguments at 0x00000171AC737A60>, <function register_cache_arguments.<locals>.add_cache_arguments at 0x00000171AC737BA0>]\r\ncli.knack.cli: Event: CommandInvoker.OnCommandTableLoaded []\r\ncli.knack.cli: Event: CommandInvoker.OnPreParseArgs []\r\ncli.knack.cli: Event: CommandInvoker.OnPostParseArgs [<function OutputProducer.handle_output_argument at 0x00000171A97A5E40>, <function CLIQuery.handle_query_parameter at 0x00000171A97D39C0>, <function register_ids_argument.<locals>.parse_ids_arguments at 0x00000171AC737B00>]\r\ncli.azure.cli.core.azclierror: Traceback (most recent call last):\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\knack/cli.py\", line 233, in invoke\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 663, in execute\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 726, in _run_jobs_serially\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 697, in _run_job\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/__init__.py\", line 333, in __call__\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/core/commands/command_operation.py\", line 121, in handler\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/command_modules/network/private_link_resource_and_endpoint_connections/custom.py\", line 130, in approve_private_endpoint_connection\r\n  File \"D:\\a\\_work\\1\\s\\build_scripts\\windows\\artifacts\\cli\\Lib\\site-packages\\azure/cli/command_modules/network/private_link_resource_and_endpoint_connections/custom.py\", line 119, in _get_client\r\nknack.util.CLIError: Resource type must be one of Microsoft.AgFoodPlatform/farmBeats, Microsoft.Automation/automationAccounts, Microsoft.Authorization/resourceManagementPrivateLinks, Microsoft.ApiManagement/service, Microsoft.AppConfiguration/configurationStores, Microsoft.Batch/batchAccounts, Microsoft.BotService/botServices, Microsoft.Cache/Redis, Microsoft.CognitiveServices/accounts, Microsoft.Compute/diskAccesses, Microsoft.ContainerRegistry/registries, Microsoft.Dashboard/grafana, Microsoft.DBforMySQL/servers, Microsoft.DBforMariaDB/servers, Microsoft.DBforPostgreSQL/servers, Microsoft.DBforPostgreSQL/serverGroupsv2, Microsoft.DesktopVirtualization/hostpools, Microsoft.DesktopVirtualization/workspaces, Microsoft.Devices/IotHubs, Microsoft.DeviceUpdate/accounts, Microsoft.DocumentDB/databaseAccounts, Microsoft.DigitalTwins/digitalTwinsInstances, Microsoft.ElasticSan/elasticSans, Microsoft.EventGrid/topics, Microsoft.EventGrid/domains, Microsoft.EventGrid/partnerNamespaces, Microsoft.EventGrid/namespaces, Microsoft.EventHub/namespaces, Microsoft.HardwareSecurityModules/cloudHsmClusters, Microsoft.HDInsight/clusters, Microsoft.HybridCompute/privateLinkScopes, Microsoft.HealthcareApis/services, microsoft.insights/privateLinkScopes, Microsoft.KeyVault/managedHSMs, Microsoft.Keyvault/vaults, Microsoft.MachineLearningServices/workspaces, Microsoft.Media/mediaservices, Microsoft.Monitor/accounts, Microsoft.Network/applicationGateways, Microsoft.Network/privateLinkServices, Microsoft.Purview/accounts, Microsoft.PowerBI/privateLinkServicesForPowerBI, Microsoft.Search/searchServices, Microsoft.ServiceBus/namespaces, Microsoft.SignalRService/signalr, Microsoft.Sql/servers, Microsoft.Storage/storageAccounts, Microsoft.StorageSync/storageSyncServices, Microsoft.Synapse/workspaces, Microsoft.Web/sites, Microsoft.Web/hostingEnvironments, Microsoft.SignalRService/WebPubSub, Microsoft.DataFactory/factories, Microsoft.Databricks/workspaces, Microsoft.RecoveryServices/vaults, Microsoft.Kusto/clusters, Microsoft.KubernetesConfiguration/privateLinkScopes, Microsoft.OpenEnergyPlatform/energyServices, Microsoft.MachineLearningServices/registries, Microsoft.DBforMySQL/flexibleServers, Microsoft.DocumentDB/mongoClusters\r\n\r\ncli.azure.cli.core.azclierror: Resource type must be one of Microsoft.AgFoodPlatform/farmBeats, Microsoft.Automation/automationAccounts, Microsoft.Authorization/resourceManagementPrivateLinks, Microsoft.ApiManagement/service, Microsoft.AppConfiguration/configurationStores, Microsoft.Batch/batchAccounts, Microsoft.BotService/botServices, Microsoft.Cache/Redis, Microsoft.CognitiveServices/accounts, Microsoft.Compute/diskAccesses, Microsoft.ContainerRegistry/registries, Microsoft.Dashboard/grafana, Microsoft.DBforMySQL/servers, Microsoft.DBforMariaDB/servers, Microsoft.DBforPostgreSQL/servers, Microsoft.DBforPostgreSQL/serverGroupsv2, Microsoft.DesktopVirtualization/hostpools, Microsoft.DesktopVirtualization/workspaces, Microsoft.Devices/IotHubs, Microsoft.DeviceUpdate/accounts, Microsoft.DocumentDB/databaseAccounts, Microsoft.DigitalTwins/digitalTwinsInstances, Microsoft.ElasticSan/elasticSans, Microsoft.EventGrid/topics, Microsoft.EventGrid/domains, Microsoft.EventGrid/partnerNamespaces, Microsoft.EventGrid/namespaces, Microsoft.EventHub/namespaces, Microsoft.HardwareSecurityModules/cloudHsmClusters, Microsoft.HDInsight/clusters, Microsoft.HybridCompute/privateLinkScopes, Microsoft.HealthcareApis/services, microsoft.insights/privateLinkScopes, Microsoft.KeyVault/managedHSMs, Microsoft.Keyvault/vaults, Microsoft.MachineLearningServices/workspaces, Microsoft.Media/mediaservices, Microsoft.Monitor/accounts, Microsoft.Network/applicationGateways, Microsoft.Network/privateLinkServices, Microsoft.Purview/accounts, Microsoft.PowerBI/privateLinkServicesForPowerBI, Microsoft.Search/searchServices, Microsoft.ServiceBus/namespaces, Microsoft.SignalRService/signalr, Microsoft.Sql/servers, Microsoft.Storage/storageAccounts, Microsoft.StorageSync/storageSyncServices, Microsoft.Synapse/workspaces, Microsoft.Web/sites, Microsoft.Web/hostingEnvironments, Microsoft.SignalRService/WebPubSub, Microsoft.DataFactory/factories, Microsoft.Databricks/workspaces, Microsoft.RecoveryServices/vaults, Microsoft.Kusto/clusters, Microsoft.KubernetesConfiguration/privateLinkScopes, Microsoft.OpenEnergyPlatform/energyServices, Microsoft.MachineLearningServices/registries, Microsoft.DBforMySQL/flexibleServers, Microsoft.DocumentDB/mongoClusters\r\naz_command_data_logger: Resource type must be one of Microsoft.AgFoodPlatform/farmBeats, Microsoft.Automation/automationAccounts, Microsoft.Authorization/resourceManagementPrivateLinks, Microsoft.ApiManagement/service, Microsoft.AppConfiguration/configurationStores, Microsoft.Batch/batchAccounts, Microsoft.BotService/botServices, Microsoft.Cache/Redis, Microsoft.CognitiveServices/accounts, Microsoft.Compute/diskAccesses, Microsoft.ContainerRegistry/registries, Microsoft.Dashboard/grafana, Microsoft.DBforMySQL/servers, Microsoft.DBforMariaDB/servers, Microsoft.DBforPostgreSQL/servers, Microsoft.DBforPostgreSQL/serverGroupsv2, Microsoft.DesktopVirtualization/hostpools, Microsoft.DesktopVirtualization/workspaces, Microsoft.Devices/IotHubs, Microsoft.DeviceUpdate/accounts, Microsoft.DocumentDB/databaseAccounts, Microsoft.DigitalTwins/digitalTwinsInstances, Microsoft.ElasticSan/elasticSans, Microsoft.EventGrid/topics, Microsoft.EventGrid/domains, Microsoft.EventGrid/partnerNamespaces, Microsoft.EventGrid/namespaces, Microsoft.EventHub/namespaces, Microsoft.HardwareSecurityModules/cloudHsmClusters, Microsoft.HDInsight/clusters, Microsoft.HybridCompute/privateLinkScopes, Microsoft.HealthcareApis/services, microsoft.insights/privateLinkScopes, Microsoft.KeyVault/managedHSMs, Microsoft.Keyvault/vaults, Microsoft.MachineLearningServices/workspaces, Microsoft.Media/mediaservices, Microsoft.Monitor/accounts, Microsoft.Network/applicationGateways, Microsoft.Network/privateLinkServices, Microsoft.Purview/accounts, Microsoft.PowerBI/privateLinkServicesForPowerBI, Microsoft.Search/searchServices, Microsoft.ServiceBus/namespaces, Microsoft.SignalRService/signalr, Microsoft.Sql/servers, Microsoft.Storage/storageAccounts, Microsoft.StorageSync/storageSyncServices, Microsoft.Synapse/workspaces, Microsoft.Web/sites, Microsoft.Web/hostingEnvironments, Microsoft.SignalRService/WebPubSub, Microsoft.DataFactory/factories, Microsoft.Databricks/workspaces, Microsoft.RecoveryServices/vaults, Microsoft.Kusto/clusters, Microsoft.KubernetesConfiguration/privateLinkScopes, Microsoft.OpenEnergyPlatform/energyServices, Microsoft.MachineLearningServices/registries, Microsoft.DBforMySQL/flexibleServers, Microsoft.DocumentDB/mongoClusters\r\ncli.knack.cli: Event: Cli.PostExecute [<function AzCliLogging.deinit_cmd_metadata_logging at 0x00000171AC6F98A0>]\r\naz_command_data_logger: exit code: 1\r\ncli.__main__: Command ran in 1.113 seconds (init: 0.450, invoke: 0.663)\r\ntelemetry.main: Begin splitting cli events and extra events, total events: 1\r\ntelemetry.client: Accumulated 0 events. Flush the clients.\r\ntelemetry.main: Finish splitting cli events and extra events, cli events: 1\r\ntelemetry.save: Save telemetry record of length 5673 in cache\r\ntelemetry.main: Begin creating telemetry upload process.\r\ntelemetry.process: Creating upload process: \"C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\python.exe C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\Lib\\site-packages\\azure\\cli\\telemetry\\__init__.pyc C:\\Users\\dareist\\.azure\"\r\ntelemetry.process: Return from creating process\r\ntelemetry.main: Finish creating telemetry upload process.\r\n\r\n### Expected behavior\r\n\r\nIt should approve the private endpoint connection on the private link hub.\r\n\r\n### Environment Summary\r\n\r\nazure-cli                         2.54.0\r\n\r\ncore                              2.54.0\r\ntelemetry                          1.1.0\r\n\r\nDependencies:\r\nmsal                            1.24.0b2\r\nazure-mgmt-resource             23.1.0b2\r\n\r\nPython location 'C:\\Program Files\\Microsoft SDKs\\Azure\\CLI2\\python.exe'\r\nExtensions directory 'C:\\Users\\dareist\\.azure\\cliextensions'\r\n\r\nPython (Windows) 3.11.5 (tags/v3.11.5:cce6ba9, Aug 24 2023, 14:38:34) [MSC v.1936 64 bit (AMD64)]\r\n\r\n### Additional context\r\n\r\n_No response_",
      "solution": "Hi, we're sending this friendly reminder because we haven't heard back from you in a while. We need more information about this issue to help address it. Please be sure to give us your input within the next **7 days**. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
      "labels": [
        "Network",
        "question",
        "needs-author-feedback",
        "no-recent-activity",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2023-11-27T18:06:38Z",
      "closed_at": "2025-12-20T17:29:11Z",
      "url": "https://github.com/Azure/azure-cli/issues/27926",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 27954,
      "title": "az cli commands haaaaaang",
      "problem": "### Describe the bug\n\nAs of late, all `az cli` commands I issue from either the native PowerShell terminal or the integrated VS Code terminal hang...for like 5 mins before executing. \n\n### Related command\n\n`az login`\n\n### Errors\n\nThe command is taken, but hangs for minutes before executing/completing.\n\n### Issue script & Debug output\n\nNA\n\n### Expected behavior\n\nThat `az cli` commands execute similar to the time it takes other CLI commands.\n\n### Environment Summary\n\nazure-cli: 2.51.0\r\nPowershell: \r\n```\r\nName                           Value\r\n----                           -----\r\nPSVersion                      7.3.4\r\nPSEdition                      Core\r\nGitCommitId                    7.3.4\r\nOS                             Microsoft Windows 10.0.22621\r\nPlatform                       Win32NT\r\nPSCompatibleVersions           {1.0, 2.0, 3.0, 4.0\u2026}\r\nPSRemotingProtocolVersion      2.3\r\nSerializationVersion           1.1.0.1\r\nWSManStackVersion              3.0\r\n```\r\nVS Code: \r\n```\r\nVersion: 1.84.2 (user setup)\r\nCommit: 1a5daa3a0231a0fbba4f14db7ec463cf99d7768e\r\nDate: 2023-11-09T10:51:52.184Z\r\nElectron: 25.9.2\r\nElectronBuildId: 24603566\r\nChromium: 114.0.5735.289\r\nNode.js: 18.15.0\r\nV8: 11.4.183.29-electron.0\r\nOS: Windows_NT x64 10.0.22621\r\n```\n\n### Additional context\n\nQuite a blocker when trying to script or do things in a timely fashion.",
      "solution": "Hi, we're sending this friendly reminder because we haven't heard back from you in a while. We need more information about this issue to help address it. Please be sure to give us your input within the next **7 days**. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
      "labels": [
        "Account",
        "question",
        "customer-reported",
        "needs-author-feedback",
        "no-recent-activity",
        "Auto-Assign",
        "Azure CLI Team",
        "Auto-Resolve",
        "OKR Candidate"
      ],
      "created_at": "2023-11-30T23:20:23Z",
      "closed_at": "2025-12-20T17:29:10Z",
      "url": "https://github.com/Azure/azure-cli/issues/27954",
      "comments_count": 6
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 27975,
      "title": "Trusted Launch default and Arm64",
      "problem": "### Describe the bug\r\n\r\nWhen launching Arm64 instances, the CLI tries to enable Trusted Launch but TS is not yet supported for Arm64 instances.\r\n\r\n### Related command\r\n\r\n```bash\r\naz vm create -g test-arm --name ubuntu-jammy --image \"Canonical:0001-com-ubuntu-server-jammy:22_04-lts-arm64:latest\" --ssh-key-values $SSH_KEY --size Standard_D4pls_v5 --admin-username ubuntu\r\n```\r\n\r\n### Errors\r\n\r\n```json\r\n{\"status\":\"Failed\",\"error\":{\"code\":\"DeploymentFailed\",\"target\":\"/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourceGroups/test-certify/providers/Microsoft.Resources/deployments/vm_deploy_T5wOKV7Zgk6xUQRqaxjOydnUsvHvvdj5\",\"message\":\"At least one resource deployment operation failed. Please list deployment operations for details. Please see https://aka.ms/arm-deployment-operations for usage details.\",\"details\":[{\"code\":\"BadRequest\",\"message\":\"Use of TrustedLaunch setting is not supported for the provided image. Please select Trusted Launch Supported Gen2 OS Image. For more information, see https://aka.ms/TrustedLaunch-FAQ.\"}]}}\r\n```\r\n\r\n### Issue script & Debug output\r\n\r\n```\r\nDEBUG: cli.knack.cli: Command arguments: ['vm', 'create', '--debug', '-g', 'test-certify', '-n', 'jammy-arm64-2', '--image', 'Canonical:0001-com-ubuntu-server-jammy:22_04-lts-arm64:latest', '--ssh-key-values', '/home/gauthier/canonical/enclave/ssh/canonical_rsa.pub', '--size', 'Standard_D4pls_v5', '--admin-username', 'ubuntu']\r\n[...]\r\nDEBUG: msal.telemetry: Generate or reuse correlation_id: 8a9e56ef-dc2a-415a-a310-076387e6d664\r\nDEBUG: cli.azure.cli.core.sdk.policies: Request URL: 'https://management.azure.com/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourcegroups/test-certify/providers/Microsoft.Resources/deployments/vm_deploy_Sj7414liWTGRcwLyM2ifyE8lhtCK3tN2?api-version=2022-09-01'\r\nDEBUG: cli.azure.cli.core.sdk.policies: Request method: 'PUT'\r\nDEBUG: cli.azure.cli.core.sdk.policies: Request headers:\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Content-Type': 'application/json'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Content-Length': '3605'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Accept': 'application/json'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'x-ms-client-request-id': '4146ba0b-9420-11ee-84f6-709cd161819f'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'CommandName': 'vm create'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'ParameterSetName': '--debug -g -n --image --ssh-key-values --size --admin-username'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'User-Agent': 'AZURECLI/2.55.0 (DEB) azsdk-python-azure-mgmt-resource/23.1.0b2 Python/3.11.5 (Linux-6.5.0-14-generic-x86_64-with-glibc2.38)'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Authorization': '*****'\r\nDEBUG: cli.azure.cli.core.sdk.policies: Request body:\r\nDEBUG: cli.azure.cli.core.sdk.policies: {\"properties\": {\"template\": {\"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\", \"contentVersion\": \"1.0.0.0\", \"parameters\": {}, \"variables\": {}, \"resources\": [{\"type\": \"Microsoft.Network/networkSecurityGroups\", \"name\": \"jammy-arm64-2NSG\", \"apiVersion\": \"2015-06-15\", \"location\": \"westeurope\", \"tags\": {}, \"dependsOn\": [], \"properties\": {\"securityRules\": [{\"name\": \"default-allow-ssh\", \"properties\": {\"protocol\": \"Tcp\", \"sourcePortRange\": \"*\", \"destinationPortRange\": \"22\", \"sourceAddressPrefix\": \"*\", \"destinationAddressPrefix\": \"*\", \"access\": \"Allow\", \"priority\": 1000, \"direction\": \"Inbound\"}}]}}, {\"apiVersion\": \"2022-01-01\", \"type\": \"Microsoft.Network/publicIPAddresses\", \"name\": \"jammy-arm64-2PublicIP\", \"location\": \"westeurope\", \"tags\": {}, \"dependsOn\": [], \"properties\": {\"publicIPAllocationMethod\": \"Static\"}, \"sku\": {\"name\": \"Standard\"}}, {\"apiVersion\": \"2015-06-15\", \"type\": \"Microsoft.Network/networkInterfaces\", \"name\": \"jammy-arm64-2VMNic\", \"location\": \"westeurope\", \"tags\": {}, \"dependsOn\": [\"Microsoft.Network/networkSecurityGroups/jammy-arm64-2NSG\", \"Microsoft.Network/publicIpAddresses/jammy-arm64-2PublicIP\"], \"properties\": {\"ipConfigurations\": [{\"name\": \"ipconfigjammy-arm64-2\", \"properties\": {\"privateIPAllocationMethod\": \"Dynamic\", \"subnet\": {\"id\": \"/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourceGroups/test-certify/providers/Microsoft.Network/virtualNetworks/nobleVNET/subnets/nobleSubnet\"}, \"publicIPAddress\": {\"id\": \"/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourceGroups/test-certify/providers/Microsoft.Network/publicIPAddresses/jammy-arm64-2PublicIP\"}}}], \"networkSecurityGroup\": {\"id\": \"/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourceGroups/test-certify/providers/Microsoft.Network/networkSecurityGroups/jammy-arm64-2NSG\"}}}, {\"apiVersion\": \"2022-11-01\", \"type\": \"Microsoft.Compute/virtualMachines\", \"name\": \"jammy-arm64-2\", \"location\": \"westeurope\", \"tags\": {}, \"dependsOn\": [\"Microsoft.Network/networkInterfaces/jammy-arm64-2VMNic\"], \"properties\": {\"hardwareProfile\": {\"vmSize\": \"Standard_D4pls_v5\"}, \"networkProfile\": {\"networkInterfaces\": [{\"id\": \"/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourceGroups/test-certify/providers/Microsoft.Network/networkInterfaces/jammy-arm64-2VMNic\", \"properties\": {\"deleteOption\": null}}]}, \"storageProfile\": {\"osDisk\": {\"createOption\": \"fromImage\", \"name\": null, \"caching\": \"ReadWrite\", \"managedDisk\": {\"storageAccountType\": null}}, \"imageReference\": {\"publisher\": \"Canonical\", \"offer\": \"0001-com-ubuntu-server-jammy\", \"sku\": \"22_04-lts-arm64\", \"version\": \"latest\"}}, \"osProfile\": {\"computerName\": \"jammy-arm64-2\", \"adminUsername\": \"ubuntu\", \"linuxConfiguration\": {\"disablePasswordAuthentication\": true, \"ssh\": {\"publicKeys\": [{\"keyData\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCwu2kUAGAuqH2LPGN1VO8H6MU2UK+PZNbLYQrQ1LAJF2qDAj9FU8FE/KjO6CvAt+kNnj9r/X2HypvVpA9AAa13n/0bY9TAi3zkAbaYK+WAu5ppRW6NYoXAi9+sPoxsqyZkfv5TpWBxaz4dCl0weZBO/tpzn84jW1OwRL27Uf+POZOSdg4LYMMukPbLxrnDZs0GyFBmUHghQM2sizPCI9egpx7UCUPmzPkar0bDz27C/bvpaFYdQ1mX4Y3tOcLl3Kk8+FmaztR0McV0lqzI9A7uWWh20n4BKcpL2NQjqd3ABa00tFhaY8QYFMqcgSbogZkPnrDInRJ+PqaoJ+hw2Ofxtx7Lg646mlVJpd54P3iWnrqJOeB2rkjVF8FcfHNiaZ5OS0EiMpNEYoIas6VCnHId162x/WHiESbHTrctUzRuynz4/1S+HR4zYlGUT/hr7ruKFuge8LrGx0Wom69s18amXz+PeNPSuoEOzYBFBbgllRFWYAmdCvPBeDx94vVr9ns= gauthier@canonical\\n\", \"path\": \"/home/ubuntu/.ssh/authorized_keys\"}]}}}, \"securityProfile\": {\"securityType\": \"TrustedLaunch\", \"uefiSettings\": {\"secureBootEnabled\": true, \"vTpmEnabled\": true}}}}], \"outputs\": {}}, \"parameters\": {}, \"mode\": \"incremental\"}}\r\nDEBUG: urllib3.connectionpool: Starting new HTTPS connection (1): management.azure.com:443\r\nDEBUG: urllib3.connectionpool: https://management.azure.com:443 \"PUT /subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourcegroups/test-certify/providers/Microsoft.Resources/deployments/vm_deploy_Sj7414liWTGRcwLyM2ifyE8lhtCK3tN2?api-version=2022-09-01 HTTP/1.1\" 201 2143\r\nDEBUG: cli.azure.cli.core.sdk.policies: Response status: 201\r\nDEBUG: cli.azure.cli.core.sdk.policies: Response headers:\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Cache-Control': 'no-cache'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Pragma': 'no-cache'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Content-Length': '2143'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Content-Type': 'application/json; charset=utf-8'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Expires': '-1'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Azure-AsyncOperation': 'https://management.azure.com/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourcegroups/test-certify/providers/Microsoft.Resources/deployments/vm_deploy_Sj7414liWTGRcwLyM2ifyE8lhtCK3tN2/operationStatuses/08584997492058693790?api-version=2022-09-01'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'x-ms-ratelimit-remaining-subscription-writes': '1199'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'x-ms-request-id': '165f4791-18d3-4a86-94c1-5e298f7d28df'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'x-ms-correlation-request-id': '165f4791-18d3-4a86-94c1-5e298f7d28df'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'x-ms-routing-request-id': 'FRANCECENTRAL:20231206T101440Z:165f4791-18d3-4a86-94c1-5e298f7d28df'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Strict-Transport-Security': 'max-age=31536000; includeSubDomains'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'X-Content-Type-Options': 'nosniff'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'X-Cache': 'CONFIG_NOCACHE'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'X-MSEdge-Ref': 'Ref A: 5307892AF6F34B4E9EC68C0082C45D40 Ref B: AMS231020512031 Ref C: 2023-12-06T10:14:38Z'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Date': 'Wed, 06 Dec 2023 10:14:40 GMT'\r\nDEBUG: cli.azure.cli.core.sdk.policies: Response content:\r\nDEBUG: cli.azure.cli.core.sdk.policies: {\"id\":\"/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourceGroups/test-certify/providers/Microsoft.Resources/deployments/vm_deploy_Sj7414liWTGRcwLyM2ifyE8lhtCK3tN2\",\"name\":\"vm_deploy_Sj7414liWTGRcwLyM2ifyE8lhtCK3tN2\",\"type\":\"Microsoft.Resources/deployments\",\"properties\":{\"templateHash\":\"14333805158764500841\",\"parameters\":{},\"mode\":\"Incremental\",\"provisioningState\":\"Accepted\",\"timestamp\":\"2023-12-06T10:14:40.3453655Z\",\"duration\":\"PT0.0001001S\",\"correlationId\":\"165f4791-18d3-4a86-94c1-5e298f7d28df\",\"providers\":[{\"namespace\":\"Microsoft.Network\",\"resourceTypes\":[{\"resourceType\":\"networkSecurityGroups\",\"locations\":[\"westeurope\"]},{\"resourceType\":\"publicIPAddresses\",\"locations\":[\"westeurope\"]},{\"resourceType\":\"networkInterfaces\",\"locations\":[\"westeurope\"]}]},{\"namespace\":\"Microsoft.Compute\",\"resourceTypes\":[{\"resourceType\":\"virtualMachines\",\"locations\":[\"westeurope\"]}]}],\"dependencies\":[{\"dependsOn\":[{\"id\":\"/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourceGroups/test-certify/providers/Microsoft.Network/networkSecurityGroups/jammy-arm64-2NSG\",\"resourceType\":\"Microsoft.Network/networkSecurityGroups\",\"resourceName\":\"jammy-arm64-2NSG\"},{\"id\":\"/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourceGroups/test-certify/providers/Microsoft.Network/publicIPAddresses/jammy-arm64-2PublicIP\",\"resourceType\":\"Microsoft.Network/publicIPAddresses\",\"resourceName\":\"jammy-arm64-2PublicIP\"}],\"id\":\"/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourceGroups/test-certify/providers/Microsoft.Network/networkInterfaces/jammy-arm64-2VMNic\",\"resourceType\":\"Microsoft.Network/networkInterfaces\",\"resourceName\":\"jammy-arm64-2VMNic\"},{\"dependsOn\":[{\"id\":\"/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourceGroups/test-certify/providers/Microsoft.Network/networkInterfaces/jammy-arm64-2VMNic\",\"resourceType\":\"Microsoft.Network/networkInterfaces\",\"resourceName\":\"jammy-arm64-2VMNic\"}],\"id\":\"/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourceGroups/test-certify/providers/Microsoft.Compute/virtualMachines/jammy-arm64-2\",\"resourceType\":\"Microsoft.Compute/virtualMachines\",\"resourceName\":\"jammy-arm64-2\"}]}}\r\nDEBUG: cli.azure.cli.core.sdk.policies: Request URL: 'https://management.azure.com/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourcegroups/test-certify/providers/Microsoft.Resources/deployments/vm_deploy_Sj7414liWTGRcwLyM2ifyE8lhtCK3tN2/operationStatuses/08584997492058693790?api-version=2022-09-01'\r\nDEBUG: cli.azure.cli.core.sdk.policies: Request method: 'GET'\r\nDEBUG: cli.azure.cli.core.sdk.policies: Request headers:\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'x-ms-client-request-id': '4146ba0b-9420-11ee-84f6-709cd161819f'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'CommandName': 'vm create'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'ParameterSetName': '--debug -g -n --image --ssh-key-values --size --admin-username'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'User-Agent': 'AZURECLI/2.55.0 (DEB) azsdk-python-azure-mgmt-resource/23.1.0b2 Python/3.11.5 (Linux-6.5.0-14-generic-x86_64-with-glibc2.38)'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Authorization': '*****'\r\nDEBUG: cli.azure.cli.core.sdk.policies: Request body:\r\nDEBUG: cli.azure.cli.core.sdk.policies: This request has no body\r\nDEBUG: urllib3.connectionpool: https://management.azure.com:443 \"GET /subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourcegroups/test-certify/providers/Microsoft.Resources/deployments/vm_deploy_Sj7414liWTGRcwLyM2ifyE8lhtCK3tN2/operationStatuses/08584997492058693790?api-version=2022-09-01 HTTP/1.1\" 200 21\r\nDEBUG: cli.azure.cli.core.sdk.policies: Response status: 200\r\nDEBUG: cli.azure.cli.core.sdk.policies: Response headers:\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Cache-Control': 'no-cache'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Pragma': 'no-cache'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Content-Length': '21'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Content-Type': 'application/json; charset=utf-8'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Expires': '-1'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'x-ms-ratelimit-remaining-subscription-reads': '11999'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'x-ms-request-id': '0a1f7d86-8c7b-4c0d-8384-38549574cc43'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'x-ms-correlation-request-id': '0a1f7d86-8c7b-4c0d-8384-38549574cc43'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'x-ms-routing-request-id': 'FRANCECENTRAL:20231206T101440Z:0a1f7d86-8c7b-4c0d-8384-38549574cc43'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Strict-Transport-Security': 'max-age=31536000; includeSubDomains'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'X-Content-Type-Options': 'nosniff'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'X-Cache': 'CONFIG_NOCACHE'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'X-MSEdge-Ref': 'Ref A: F6D3A7255AD54AD19DBF28AE090F0B87 Ref B: AMS231020512031 Ref C: 2023-12-06T10:14:40Z'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Date': 'Wed, 06 Dec 2023 10:14:40 GMT'\r\nDEBUG: cli.azure.cli.core.sdk.policies: Response content:\r\nDEBUG: cli.azure.cli.core.sdk.policies: {\"status\":\"Accepted\"}\r\nDEBUG: cli.azure.cli.core.sdk.policies: Request URL: 'https://management.azure.com/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourcegroups/test-certify/providers/Microsoft.Resources/deployments/vm_deploy_Sj7414liWTGRcwLyM2ifyE8lhtCK3tN2/operationStatuses/08584997492058693790?api-version=2022-09-01'\r\nDEBUG: cli.azure.cli.core.sdk.policies: Request method: 'GET'\r\nDEBUG: cli.azure.cli.core.sdk.policies: Request headers:\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'x-ms-client-request-id': '4146ba0b-9420-11ee-84f6-709cd161819f'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'CommandName': 'vm create'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'ParameterSetName': '--debug -g -n --image --ssh-key-values --size --admin-username'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'User-Agent': 'AZURECLI/2.55.0 (DEB) azsdk-python-azure-mgmt-resource/23.1.0b2 Python/3.11.5 (Linux-6.5.0-14-generic-x86_64-with-glibc2.38)'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Authorization': '*****'\r\nDEBUG: cli.azure.cli.core.sdk.policies: Request body:\r\nDEBUG: cli.azure.cli.core.sdk.policies: This request has no body\r\nDEBUG: urllib3.connectionpool: https://management.azure.com:443 \"GET /subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourcegroups/test-certify/providers/Microsoft.Resources/deployments/vm_deploy_Sj7414liWTGRcwLyM2ifyE8lhtCK3tN2/operationStatuses/08584997492058693790?api-version=2022-09-01 HTTP/1.1\" 200 642\r\nDEBUG: cli.azure.cli.core.sdk.policies: Response status: 200\r\nDEBUG: cli.azure.cli.core.sdk.policies: Response headers:\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Cache-Control': 'no-cache'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Pragma': 'no-cache'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Content-Length': '642'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Content-Type': 'application/json; charset=utf-8'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Expires': '-1'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'x-ms-ratelimit-remaining-subscription-reads': '11993'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'x-ms-request-id': '87a9ba34-4de1-432b-a2e2-4524f348ca85'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'x-ms-correlation-request-id': '87a9ba34-4de1-432b-a2e2-4524f348ca85'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'x-ms-routing-request-id': 'FRANCECENTRAL:20231206T101510Z:87a9ba34-4de1-432b-a2e2-4524f348ca85'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Strict-Transport-Security': 'max-age=31536000; includeSubDomains'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'X-Content-Type-Options': 'nosniff'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'X-Cache': 'CONFIG_NOCACHE'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'X-MSEdge-Ref': 'Ref A: 578A08CE34024D399DDAA89AF65F26F9 Ref B: AMS231020512031 Ref C: 2023-12-06T10:15:10Z'\r\nDEBUG: cli.azure.cli.core.sdk.policies:     'Date': 'Wed, 06 Dec 2023 10:15:10 GMT'\r\nDEBUG: cli.azure.cli.core.sdk.policies: Response content:\r\nDEBUG: cli.azure.cli.core.sdk.policies: {\"status\":\"Failed\",\"error\":{\"code\":\"DeploymentFailed\",\"target\":\"/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourceGroups/test-certify/providers/Microsoft.Resources/deployments/vm_deploy_Sj7414liWTGRcwLyM2ifyE8lhtCK3tN2\",\"message\":\"At least one resource deployment operation failed. Please list deployment operations for details. Please see https://aka.ms/arm-deployment-operations for usage details.\",\"details\":[{\"code\":\"BadRequest\",\"message\":\"Use of TrustedLaunch setting is not supported for the provided image. Please select Trusted Launch Supported Gen2 OS Image. For more information, see https://aka.ms/TrustedLaunch-FAQ.\"}]}}\r\nDEBUG: cli.azure.cli.core.azclierror: Traceback (most recent call last):\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/core/polling/base_polling.py\", line 517, in run\r\n    self._poll()\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/core/polling/base_polling.py\", line 557, in _poll\r\n    raise OperationFailed(\"Operation failed or canceled\")\r\nazure.core.polling.base_polling.OperationFailed: Operation failed or canceled\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/cli/core/commands/__init__.py\", line 697, in _run_job\r\n    result = cmd_copy(params)\r\n             ^^^^^^^^^^^^^^^^\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/cli/core/commands/__init__.py\", line 333, in __call__\r\n    return self.handler(*args, **kwargs)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/cli/core/commands/command_operation.py\", line 121, in handler\r\n    return op(**command_args)\r\n           ^^^^^^^^^^^^^^^^^^\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/cli/command_modules/vm/custom.py\", line 1181, in create_vm\r\n    LongRunningOperation(cmd.cli_ctx)(client.begin_create_or_update(resource_group_name, deployment_name, deployment))\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/cli/core/commands/__init__.py\", line 1013, in __call__\r\n    raise exception\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/cli/core/commands/__init__.py\", line 1000, in __call__\r\n    result = poller.result()\r\n             ^^^^^^^^^^^^^^^\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/core/polling/_poller.py\", line 255, in result\r\n    self.wait(timeout)\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/core/tracing/decorator.py\", line 78, in wrapper_use_tracer\r\n    return func(*args, **kwargs)\r\n           ^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/core/polling/_poller.py\", line 275, in wait\r\n    raise self._exception # type: ignore\r\n    ^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/core/polling/_poller.py\", line 192, in _start\r\n    self._polling_method.run()\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/core/polling/base_polling.py\", line 535, in run\r\n    raise HttpResponseError(\r\nazure.core.exceptions.HttpResponseError: (DeploymentFailed) At least one resource deployment operation failed. Please list deployment operations for details. Please see https://aka.ms/arm-deployment-operations for usage details.\r\nCode: DeploymentFailed\r\nMessage: At least one resource deployment operation failed. Please list deployment operations for details. Please see https://aka.ms/arm-deployment-operations for usage details.\r\nTarget: /subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourceGroups/test-certify/providers/Microsoft.Resources/deployments/vm_deploy_Sj7414liWTGRcwLyM2ifyE8lhtCK3tN2\r\nException Details:\t(BadRequest) Use of TrustedLaunch setting is not supported for the provided image. Please select Trusted Launch Supported Gen2 OS Image. For more information, see https://aka.ms/TrustedLaunch-FAQ.\r\n\tCode: BadRequest\r\n\tMessage: Use of TrustedLaunch setting is not supported for the provided image. Please select Trusted Launch Supported Gen2 OS Image. For more information, see https://aka.ms/TrustedLaunch-FAQ.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/cli/core/commands/arm.py\", line 109, in handle_template_based_exception\r\n    raise CLIError(ex.inner_exception.error.message)\r\n                   ^^^^^^^^^^^^^^^^^^^^^^^^\r\nAttributeError: 'OperationFailed' object has no attribute 'error'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/opt/az/lib/python3.11/site-packages/knack/cli.py\", line 233, in invoke\r\n    cmd_result = self.invocation.execute(args)\r\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/cli/core/commands/__init__.py\", line 663, in execute\r\n    raise ex\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/cli/core/commands/__init__.py\", line 726, in _run_jobs_serially\r\n    results.append(self._run_job(expanded_arg, cmd_copy))\r\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/cli/core/commands/__init__.py\", line 718, in _run_job\r\n    return cmd_copy.exception_handler(ex)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/cli/core/commands/arm.py\", line 112, in handle_template_based_exception\r\n    raise_subdivision_deployment_error(ex.response.internal_response.text, ex.error.code if ex.error else None)\r\n  File \"/opt/az/lib/python3.11/site-packages/azure/cli/core/commands/arm.py\", line 104, in raise_subdivision_deployment_error\r\n    raise DeploymentError(error_message)\r\nazure.cli.core.azclierror.DeploymentError: {\"status\":\"Failed\",\"error\":{\"code\":\"DeploymentFailed\",\"target\":\"/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourceGroups/test-certify/providers/Microsoft.Resources/deployments/vm_deploy_Sj7414liWTGRcwLyM2ifyE8lhtCK3tN2\",\"message\":\"At least one resource deployment operation failed. Please list deployment operations for details. Please see https://aka.ms/arm-deployment-operations for usage details.\",\"details\":[{\"code\":\"BadRequest\",\"message\":\"Use of TrustedLaunch setting is not supported for the provided image. Please select Trusted Launch Supported Gen2 OS Image. For more information, see https://aka.ms/TrustedLaunch-FAQ.\"}]}}\r\n\r\nERROR: cli.azure.cli.core.azclierror: {\"status\":\"Failed\",\"error\":{\"code\":\"DeploymentFailed\",\"target\":\"/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourceGroups/test-certify/providers/Microsoft.Resources/deployments/vm_deploy_Sj7414liWTGRcwLyM2ifyE8lhtCK3tN2\",\"message\":\"At least one resource deployment operation failed. Please list deployment operations for details. Please see https://aka.ms/arm-deployment-operations for usage details.\",\"details\":[{\"code\":\"BadRequest\",\"message\":\"Use of TrustedLaunch setting is not supported for the provided image. Please select Trusted Launch Supported Gen2 OS Image. For more information, see https://aka.ms/TrustedLaunch-FAQ.\"}]}}\r\nERROR: az_command_data_logger: {\"status\":\"Failed\",\"error\":{\"code\":\"DeploymentFailed\",\"target\":\"/subscriptions/5059ce5a-a72d-4085-acb7-33b421daa1ee/resourceGroups/test-certify/providers/Microsoft.Resources/deployments/vm_deploy_Sj7414liWTGRcwLyM2ifyE8lhtCK3tN2\",\"message\":\"At least one resource deployment operation failed. Please list deployment operations for details. Please see https://aka.ms/arm-deployment-operations for usage details.\",\"details\":[{\"code\":\"BadRequest\",\"message\":\"Use of TrustedLaunch setting is not supported for the provided image. Please select Trusted Launch Supported Gen2 OS Image. For more information, see https://aka.ms/TrustedLaunch-FAQ.\"}]}}\r\n[...]\r\n```\r\n\r\n### Expected behavior\r\n\r\nThe CLI should not default to Trusted Launch for Arm64 instances/images.\r\n\r\n### Environment Summary\r\n\r\n```json\r\n{\r\n  \"azure-cli\": \"2.55.0\",\r\n  \"azure-cli-core\": \"2.55.0\",\r\n  \"azure-cli-telemetry\": \"1.1.0\",\r\n  \"extensions\": {}\r\n}\r\n```\r\n\r\n### Additional context\r\n\r\n_No response_",
      "solution": "This is a known limitation, please use `--security-type=Standard` to bypass Trusted launch security type as workaround.\n\n---\n\nHi, we're sending this friendly reminder because we haven't heard back from you in a while. We need more information about this issue to help address it. Please be sure to give us your input within the next **7 days**. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
      "labels": [
        "Compute",
        "question",
        "customer-reported",
        "needs-author-feedback",
        "no-recent-activity",
        "Auto-Assign",
        "Azure CLI Team",
        "Auto-Resolve",
        "Similar-Issue",
        "OKR Candidate"
      ],
      "created_at": "2023-12-06T10:23:13Z",
      "closed_at": "2025-12-20T17:29:09Z",
      "url": "https://github.com/Azure/azure-cli/issues/27975",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 28062,
      "title": "Unable to login via  az login --scope https://graph.microsoft.com/.default",
      "problem": "### Describe the bug\n\nI am trying to use \"terraform apply\" command on WSL.\r\nFacing below error message \r\n`Error: building account: could not acquire access token to parse claims: running Azure CLI: exit status 1: ERROR: AADSTS530003: Your device is required to be managed to access this resource. Trace ID: b13f7094-564d-484a-bf0a-7943d2188a00 Correlation ID: 6109f588-c22c-48fc-ab31-99035cbe523a Timestamp: 2023-12-19 10:57:18Z\r\n\u2502 To re-authenticate, please run:\r\n\u2502 az login --scope https://graph.microsoft.com/.default\r\n\u2502\r\n\u2502   with provider[\"registry.terraform.io/hashicorp/azurerm\"],\r\n\u2502   on main.tf line 3, in provider \"azurerm\":\r\n\u2502    3: provider \"azurerm\" {\r\n\u2502\r\n`\r\n\r\nand If I try to login via  az login --scope https://graph.microsoft.com/.default.\r\nIt is giving me \r\n\r\n\r\n`Authentication failed\r\naccess_denied: $error_description. ($error_uri)\r\n\r\nYou can log an issue at [Azure CLI GitHub Repository](https://github.com/azure/azure-cli/issues) and we will assist you in resolving it.`\n\n### Related command\n\nterraform apply\r\n az login --scope https://graph.microsoft.com/.default\n\n### Errors\n\nError: building account: could not acquire access token to parse claims: running Azure CLI: exit status 1: ERROR: AADSTS530003: Your device is required to be managed to access this resource. Trace ID: b13f7094-564d-484a-bf0a-7943d2188a00 Correlation ID: 6109f588-c22c-48fc-ab31-99035cbe523a Timestamp: 2023-12-19 10:57:18Z\r\n\u2502 To re-authenticate, please run:\r\n\u2502 az login --scope https://graph.microsoft.com/.default\r\n\u2502\r\n\u2502   with provider[\"registry.terraform.io/hashicorp/azurerm\"],\r\n\u2502   on main.tf line 3, in provider \"azurerm\":\r\n\u2502    3: provider \"azurerm\" {\r\n\u2502\r\n\n\n### Issue script & Debug output\n\nNA\n\n### Expected behavior\n\nIt should login via  az login --scope https://graph.microsoft.com/.default\r\n\n\n### Environment Summary\n\ndeepanshu_linux@Deepanshu-PC:~/fcore-fusion-core/pctt/iac/aks_arm$ az --version\r\nazure-cli                         2.39.0 *\r\n\r\ncore                              2.39.0 *\r\ntelemetry                          1.0.6 *\r\n\r\nExtensions:\r\nk8s-extension                      1.4.0\r\ncustomlocation                     0.1.3\r\n\r\nDependencies:\r\nmsal                            1.18.0b1\r\nazure-mgmt-resource             21.1.0b1\r\n\r\nPython location '/opt/az/bin/python3'\r\nExtensions directory '/home/deepanshu_linux/.azure/cliextensions'\r\n\r\nPython (Linux) 3.10.5 (main, Jul 29 2022, 03:26:59) [GCC 9.4.0]\r\n\r\nLegal docs and information: aka.ms/AzureCliLegal\r\n\r\n\r\nYou have 3 updates available. Consider updating your CLI installation with 'az upgrade'\r\n\r\nPlease let us know how we are doing: https://aka.ms/azureclihats\r\nand let us know if you're interested in trying out our newest features: https://aka.ms/CLIUXstudy\r\ndeepanshu_linux@Deepanshu-PC:~/fcore-fusion-core/pctt/iac/aks_arm$\r\n\n\n### Additional context\n\n_No response_",
      "solution": "this workaround works for me: https://github.com/Azure/azure-cli/issues/27879#issuecomment-1835743397\n\n---\n\nHi, we're sending this friendly reminder because we haven't heard back from you in a while. We need more information about this issue to help address it. Please be sure to give us your input within the next **7 days**. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
      "labels": [
        "Account",
        "question",
        "needs-author-feedback",
        "no-recent-activity",
        "Upgrade",
        "Auto-Assign",
        "Azure CLI Team",
        "Auto-Resolve",
        "OKR Candidate"
      ],
      "created_at": "2023-12-19T11:21:51Z",
      "closed_at": "2025-12-20T17:29:08Z",
      "url": "https://github.com/Azure/azure-cli/issues/28062",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 28107,
      "title": "Azure CLI install intermittently failing not working on red hat enterprise Linux 7.9",
      "problem": "### Preconditions\n\n- [X] No need to upgrade Python SDK or the Python SDK is ready.\n\n### Related command\n\nunable to install az cli using the following instructions: https://learn.microsoft.com/en-us/cli/azure/install-azure-cli-linux?pivots=dnf .The instructions are not wrong but when I do them in cloud-init, they only work half the time, and the rest of the time I get an empty reply from server error.\n\n### Resource Provider\n\nN/A\n\n### Description of Feature or Work Requested\n\nN/A\n\n### Minimum API Version Required\n\nN/A\n\n### Swagger PR link / SDK link\n\nN/A\n\n### Request Example\n\nN/A\n\n### Target Date\n\n2024-01-05\n\n### PM Contact\n\nvachauhan\n\n### Engineer Contact\n\nvachopra\n\n### Additional context\n\n_No response_",
      "solution": "Hi, we're sending this friendly reminder because we haven't heard back from you in a while. We need more information about this issue to help address it. Please be sure to give us your input within the next **7 days**. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
      "labels": [
        "customer-reported",
        "Installation",
        "needs-author-feedback",
        "no-recent-activity",
        "feature-request",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2023-12-29T10:52:28Z",
      "closed_at": "2025-12-20T17:29:07Z",
      "url": "https://github.com/Azure/azure-cli/issues/28107",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 28077,
      "title": "Bad input handling for --scope parameter",
      "problem": "### Describe the bug\r\n\r\nMinor issue, but I discovered some bad input handling for az role commands that causes the command to hang or throw an unhandled error or an unexpected error. The bad input causes these unexpected behaviors when any string contains `{x[]}`, with any combination or permutation of extra characters, to hang forever. It seems the `x` can be any alphabet. You can also pass `{[]}` for Azure CLI to throw various uncaught errors. This seems to affect any command with a `--scope` parameter.\r\n\r\nPassing `{x[]}` causes the command to hang and never return:\r\n```\r\naz role assignment create --role Reader --scope \"{x[]}\" --assignee <assignee username> --description \"test description\"\r\naz role definition list --scope \"{x[]}\"\r\naz ad sp create-for-rbac -n MyApp --role Contributor --scopes \"{x[]}\"\r\n```\r\n\r\nPassing `{[]}` gives miscellaneous errors that may or may not be handled:\r\n```\r\naz role assignment create --role Reader --scope \"{[]}\" --assignee <assignee username> --description \"test description\"\r\naz role definition list --scope \"{[]}\"`\r\naz ad sp create-for-rbac -n MyApp --role Contributor --scopes \"{[]}\"\r\n```\r\nThis affects the user because the user might accidentally run something like this in PowerShell, for example:\r\n```\r\naz role definition list --scope /subscriptions/$account.id\r\n```\r\nThe `--scope` parameter value above is expanded into to something like the following (anything like `<*>` can be ignored, and is added to describe the values that should be there):\r\n```\r\n/subscriptions/@{environmentName=myEnv; homeTenantId=<home tenant ID>; id=<ID>; isDefault=True; managedByTenants=System.Object[]; name=System Subscription; state=Enabled; tenantId=<tenant ID>; user=}.id\r\n```\r\n\r\nThe above expansion contains the pattern `{x[]}`, which will cause the execution to hang forever, even though the user is at fault.\r\n\r\n\r\n### Related command\r\n\r\nAny command with a `--scope` parameter.\r\n\r\n### Errors\r\n\r\nHangs forever, or various errors depending on the command.\r\n\r\n### Issue script & Debug output\r\n\r\nThe commands hang and throw various errors depending on the command.\r\n\r\n### Expected behavior\r\n\r\nShould not hang, and the bad `--scope` input should be handled properly if possible, but at the very least it should not hang.\r\n\r\n### Environment Summary\r\n\r\n```\r\n(env) PS C:\\Users\\Administrator\\Desktop> az --version\r\nazure-cli                         2.55.0\r\n\r\ncore                              2.55.0\r\ntelemetry                          1.1.0\r\n\r\nDependencies:\r\nmsal                            1.24.0b2\r\nazure-mgmt-resource             23.1.0b2\r\n\r\nPython location 'C:\\Users\\Administrator\\Desktop\\env\\Scripts\\python.exe'\r\nExtensions directory 'C:\\Users\\Administrator\\.azure\\cliextensions'\r\n\r\nPython (Windows) 3.11.7 (tags/v3.11.7:fa7a6f2, Dec  4 2023, 19:24:49) [MSC v.1937 64 bit (AMD64)]\r\n\r\nLegal docs and information: aka.ms/AzureCliLegal\r\n\r\n\r\nYour CLI is up-to-date.\r\n```\r\n\r\n### Additional context\r\n\r\n_No response_",
      "solution": "This is very similar to https://github.com/Azure/azure-cli/issues/23160 where curly brackets in `--scope` corrupts string formatting.\r\n\r\n> [!NOTE] \r\n> In `str.format()` method, `[]` is used to access element; `.` is used to access attribute. See https://docs.python.org/3/library/string.html#format-string-syntax\r\n\r\n### Problem 1: Using `--scope '{[]}'` (`IndexError`)\r\n\r\nWhen using `--scope '{[]}'`, the error message is\r\n\r\n```\r\n> az role assignment list --scope '{[]}'\r\nThe command failed with an unexpected error. Here is the traceback:\r\nReplacement index 0 out of range for positional args tuple\r\nTraceback (most recent call last):\r\n  File \"D:\\cli\\py311\\Lib\\site-packages\\knack\\cli.py\", line 233, in invoke\r\n    cmd_result = self.invocation.execute(args)\r\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"d:\\cli\\azure-cli\\src\\azure-cli-core\\azure\\cli\\core\\commands\\__init__.py\", line 663, in execute\r\n    raise ex\r\n  File \"d:\\cli\\azure-cli\\src\\azure-cli-core\\azure\\cli\\core\\commands\\__init__.py\", line 726, in _run_jobs_serially\r\n    results.append(self._run_job(expanded_arg, cmd_copy))\r\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"d:\\cli\\azure-cli\\src\\azure-cli-core\\azure\\cli\\core\\commands\\__init__.py\", line 697, in _run_job\r\n    result = cmd_copy(params)\r\n             ^^^^^^^^^^^^^^^^\r\n  File \"d:\\cli\\azure-cli\\src\\azure-cli-core\\azure\\cli\\core\\commands\\__init__.py\", line 333, in __call__\r\n    return self.handler(*args, **kwargs)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"d:\\cli\\azure-cli\\src\\azure-cli-core\\azure\\cli\\core\\commands\\command_operation.py\", line 121, in handler\r\n    return op(**command_args)\r\n           ^^^^^^^^^^^^^^^^^^\r\n  File \"d:\\cli\\azure-cli\\src\\azure-cli\\azure\\cli\\command_modules\\role\\custom.py\", line 229, in list_role_assignments\r\n    assignments = _search_role_assignments(cmd.cli_ctx, assignments_client, definitions_client,\r\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"d:\\cli\\azure-cli\\src\\azure-cli\\azure\\cli\\command_modules\\role\\custom.py\", line 554, in _search_role_assignments\r\n    assignments = list(assignments_client.list_for_scope(scope=scope, filter=f))\r\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"D:\\cli\\py311\\Lib\\site-packages\\azure\\core\\paging.py\", line 123, in __next__\r\n    return next(self._page_iterator)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"D:\\cli\\py311\\Lib\\site-packages\\azure\\core\\paging.py\", line 75, in __next__\r\n    self._response = self._get_next(self.continuation_token)\r\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"D:\\cli\\py311\\Lib\\site-packages\\azure\\mgmt\\authorization\\v2022_04_01\\operations\\_role_assignments_operations.py\", line 1079, in get_next\r\n    request = prepare_request(next_link)\r\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"D:\\cli\\py311\\Lib\\site-packages\\azure\\mgmt\\authorization\\v2022_04_01\\operations\\_role_assignments_operations.py\", line 1051, in prepare_request\r\n    request.url = self._client.format_url(request.url)\r\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"D:\\cli\\py311\\Lib\\site-packages\\azure\\core\\pipeline\\transport\\_base.py\", line 634, in format_url\r\n    url = _format_url_section(url_template, **kwargs)\r\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"D:\\cli\\py311\\Lib\\site-packages\\azure\\core\\pipeline\\transport\\_base.py\", line 94, in _format_url_section\r\n    return template.format(**kwargs)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\r\nIndexError: Replacement index 0 out of range for positional args tuple\r\n```\r\n\r\nActually, you can even repro the same error with `--scope '{}'`:\r\n\r\n```\r\n> az role assignment list --scope '{}'\r\n...\r\n  File \"D:\\cli\\py311\\Lib\\site-packages\\azure\\core\\pipeline\\transport\\_base.py\", line 94, in _format_url_section\r\n    return template.format(**kwargs)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\r\nIndexError: Replacement index 0 out of range for positional args tuple\r\n```\r\n\r\nor `--scope '{.y}'`:\r\n\r\n```\r\n> az role assignment list --scope '{.y}'\r\n...\r\n  File \"D:\\cli\\py311\\Lib\\site-packages\\azure\\core\\pipeline\\transport\\_base.py\", line 94, in _format_url_section\r\n    return template.format(**kwargs)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\r\nIndexError: Replacement index 0 out of range for positional args tuple\r\n```\r\n\r\nAs shown in the call stack, it fails in Python SDK function `azure.core.pipeline.transport._base._format_url_section`.\r\n\r\nAzure CLI currently uses\r\n\r\nhttps://github.com/Azure/azure-cli/blob/a22079acc81a3aaa5a96bac55970c77755e94f85/src/azure-cli/requirements.py3.windows.txt#L11\r\n\r\nIn that version, `_format_url_section` is\r\n\r\nhttps://github.com/Azure/azure-sdk-for-python/blob/azure-core_1.28.0/sdk/core/azure-core/azure/core/pipeline/transport/_base.py#L78\r\n\r\n```py\r\ndef _format_url_section(template, **kwargs):\r\n    \"\"\"String format the template with the kwargs, auto-skip sections of the template that are NOT in the kwargs.\r\n\r\n\r\n    By default in Python, \"format\" will raise a KeyError if a template element is not found. Here the section between\r\n    the slashes will be removed from the template instead.\r\n\r\n\r\n    This is used for API like Storage, where when Swagger has template section not defined as parameter.\r\n\r\n\r\n    :param str template: a string template to fill\r\n    :keyword dict[str,str] kwargs: Template values as string\r\n    :rtype: str\r\n    :returns: Template completed\r\n    \"\"\"\r\n    components = template.split(\"/\")\r\n    while components:\r\n        try:\r\n            return template.format(**kwargs)\r\n        except KeyError as key:\r\n            formatted_components = template.split(\"/\")\r\n            components = [c for c in formatted_components if \"{{{}}}\".format(key.args[0]) not in c]\r\n            template = \"/\".join(components)\r\n    # No URL sections left - returning None\r\n```\r\n\r\n`IndexError` is not captured by `_format_url_section` so it bubbles up. I created https://github.com/Azure/azure-sdk-for-python/issues/33641 to track it.\r\n\r\n### Problem 2: Using `--scope '{x[]}'` (`KeyError`)\r\n\r\nFor `--scope '{x[]}'`, `_format_url_section` tries to remove unrecognized components from the URL, but `key.args[0]` is `x`, so `\"{{{}}}\".format(key.args[0])` evaluates to `{x}` which doesn't match `{x[]}`, resulting in infinite loop. `--scope '{x.y}'` has the same effect.\r\n\r\nhttps://github.com/Azure/azure-sdk-for-python/pull/31718 fixed the infinite loop by raising an error if no component is removed.\r\n\r\n`--scope '{x[]}'` now gives:\r\n\r\n```\r\n> az role assignment list --scope '{x[]}'\r\nThe command failed with an unexpected error. Here is the traceback:\r\nThe value provided for the url part '/{x[]}/providers/Microsoft.Authorization/roleAssignments?$filter=atScope()&api-version=2022-04-01' was incorrect, and resulted in an invalid url\r\nTraceback (most recent call last):\r\n  File \"D:\\cli\\py311\\Lib\\site-packages\\azure\\core\\pipeline\\transport\\_base.py\", line 101, in _format_url_section\r\n    return template.format(**kwargs)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\r\nKeyError: 'x'\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\n...\r\n  File \"D:\\cli\\py311\\Lib\\site-packages\\azure\\core\\pipeline\\transport\\_base.py\", line 107, in _format_url_section\r\n    raise ValueError(\r\nValueError: The value provided for the url part '/{x[]}/providers/Microsoft.Authorization/roleAssignments?$filter=atScope()&api-version=2022-04-01' was incorrect, and resulted in an invalid url\r\n```\r\n\r\nHowever, I don't think I will bump `azure-core` immediately for such an edge case. `azure-core` will be bumped eventually in the future.\r\n\r\n\n\n---\n\nHi, we're sending this friendly reminder because we haven't heard back from you in a while. We need more information about this issue to help address it. Please be sure to give us your input within the next **7 days**. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
      "labels": [
        "question",
        "Graph",
        "RBAC",
        "needs-author-feedback",
        "no-recent-activity",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2023-12-20T22:35:08Z",
      "closed_at": "2025-12-20T17:29:07Z",
      "url": "https://github.com/Azure/azure-cli/issues/28077",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 28130,
      "title": "az keyvault role assignment create is failing with please specify --hsm-name or --id",
      "problem": "### Describe the bug\n\nTrying to create a role assignment as below:\r\n<img width=\"911\" alt=\"MicrosoftTeams-image\" src=\"https://github.com/Azure/azure-cli/assets/52841896/859508ff-4d40-46b8-8655-1adc60be5145\">\r\n\n\n### Related command\n\naz keyvault role assignment create\n\n### Errors\n\nPlease specify --hsa-name or --id\n\n### Issue script & Debug output\n\ncli.knack.cli: __init__ debug log:\r\nEnable color in terminal.\r\ncli.knack.cli: Event: Cli.PreExecute []\r\ncli.knack.cli: Event: CommandParser.OnGlobalArgumentsCreate [<function CLILogging.on_global_arguments at 0x7f01b10131f0>, <function OutputProducer.on_global_arguments at 0x7f01b0f2ed30>, <function CLIQuery.on_global_arguments at 0x7f01b0ec6310>]\r\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableCreate []\r\ncli.azure.cli.core: Modules found from index for 'keyvault': ['azure.cli.command_modules.keyvault']\r\ncli.azure.cli.core: Loading command modules:\r\ncli.azure.cli.core: Name                  Load Time    Groups  Commands\r\ncli.azure.cli.core: keyvault                  0.013        20       113\r\ncli.azure.cli.core: Total (1)                 0.013        20       113\r\ncli.azure.cli.core: These extensions are not installed and will be skipped: ['azext_next']\r\ncli.azure.cli.core: Loading extensions:\r\ncli.azure.cli.core: Name                  Load Time    Groups  Commands  Directory\r\ncli.azure.cli.core: ai-examples               0.132         1         1  /usr/lib/python3.9/site-packages/azure-cli-extensions/ai-examples\r\ncli.azure.cli.core: Total (1)                 0.132         1         1  \r\ncli.azure.cli.core: Loaded 21 groups, 114 commands.\r\ncli.azure.cli.core: Found a match in the command table.\r\ncli.azure.cli.core: Raw command  : keyvault role assignment create\r\ncli.azure.cli.core: Command table: keyvault role assignment create\r\ncli.knack.cli: Event: CommandInvoker.OnPreCommandTableTruncate [<function AzCliLogging.init_command_file_logging at 0x7f01b036a3a0>]\r\ncli.azure.cli.core.azlogging: metadata file logging enabled - writing logs to '/home/dileep/.azure/commands/2024-01-04.00-02-35.keyvault_role_assignment_create.2551.log'.\r\naz_command_data_logger: command args: keyvault role assignment create --role {} --assignee-object-id {} --scope {} --debug\r\ncli.knack.cli: Event: CommandInvoker.OnPreArgumentLoad [<function register_global_subscription_argument.<locals>.add_subscription_parameter at 0x7f01b0310f70>]\r\ncli.knack.cli: Event: CommandInvoker.OnPostArgumentLoad []\r\ncli.knack.cli: Event: CommandInvoker.OnPostCommandTableCreate [<function register_ids_argument.<locals>.add_ids_arguments at 0x7f01b02fc040>, <function register_cache_arguments.<locals>.add_cache_arguments at 0x7f01b0306e50>]\r\ncli.knack.cli: Event: CommandInvoker.OnCommandTableLoaded []\r\ncli.knack.cli: Event: CommandInvoker.OnPreParseArgs []\r\ncli.knack.cli: Event: CommandInvoker.OnPostParseArgs [<function OutputProducer.handle_output_argument at 0x7f01b0f2edc0>, <function CLIQuery.handle_query_parameter at 0x7f01b0ec63a0>, <function register_ids_argument.<locals>.parse_ids_arguments at 0x7f01b0306dc0>]\r\ncli.azure.cli.core.azclierror: Traceback (most recent call last):\r\n  File \"/usr/lib64/az/lib/python3.9/site-packages/knack/cli.py\", line 233, in invoke\r\n    cmd_result = self.invocation.execute(args)\r\n  File \"/usr/lib64/az/lib/python3.9/site-packages/azure/cli/core/commands/__init__.py\", line 651, in execute\r\n    self._validation(expanded_arg)\r\n  File \"/usr/lib64/az/lib/python3.9/site-packages/knack/invocation.py\", line 113, in _validation\r\n    self._validate_arg_level(parsed_ns)\r\n  File \"/usr/lib64/az/lib/python3.9/site-packages/azure/cli/core/commands/__init__.py\", line 859, in _validate_arg_level\r\n    validator(**self._build_kwargs(validator, ns))\r\n  File \"/usr/lib64/az/lib/python3.9/site-packages/azure/cli/command_modules/keyvault/_validators.py\", line 192, in process_hsm_name\r\n    raise CLIError('Please specify --hsm-name or --id.')\r\nknack.util.CLIError: Please specify --hsm-name or --id.\r\n \r\ncli.azure.cli.core.azclierror: Please specify --hsm-name or --id.\r\naz_command_data_logger: Please specify --hsm-name or --id.\r\ncli.knack.cli: Event: Cli.PostExecute [<function AzCliLogging.deinit_cmd_metadata_logging at 0x7f01b036a5e0>]\r\naz_command_data_logger: exit code: 1\r\ncli.__main__: Command ran in 0.515 seconds (init: 0.148, invoke: 0.367)\r\ntelemetry.main: Begin splitting cli events and extra events, total events: 1\r\ntelemetry.client: Accumulated 0 events. Flush the clients.\r\ntelemetry.main: Finish splitting cli events and extra events, cli events: 1\r\ntelemetry.save: Save telemetry record of length 3566 in cache\r\ntelemetry.main: Begin creating telemetry upload process.\r\ntelemetry.process: Creating upload process: \"/usr/bin/python3.9 /usr/lib/az/lib/python3.9/site-packages/azure/cli/telemetry/__init__.py /home/dileep/.azure\"\r\ntelemetry.process: Return from creating process\r\ntelemetry.main: Finish creating telemetry upload process.\n\n### Expected behavior\n\nrole assignmnet should be created. With the same arguments az powershell is working as expected.\n\n### Environment Summary\n\nazure-cli                         2.55.0\r\n \r\ncore                              2.55.0\r\ntelemetry                          1.1.0\r\n \r\nExtensions:\r\nai-examples                        0.2.5\r\nazure-cli-ml                      1.41.0\r\nml                                2.22.0\r\nssh                                2.0.2\r\nstorage-preview                    0.8.3\r\n \r\nDependencies:\r\nmsal                            1.24.0b2\r\nazure-mgmt-resource             23.1.0b2\r\n \r\nPython location '/usr/bin/python3.9'\r\nExtensions directory '/home/dileep/.azure/cliextensions'\r\nExtensions system directory '/usr/lib/python3.9/site-packages/azure-cli-extensions'\r\n \r\nPython (Linux) 3.9.14 (main, Oct 12 2023, 19:48:32) \r\n[GCC 11.2.0]\r\n \r\nLegal docs and information: aka.ms/AzureCliLegal\r\n \r\nYour CLI is up-to-date.\n\n### Additional context\n\n_No response_",
      "solution": "Hi, we're sending this friendly reminder because we haven't heard back from you in a while. We need more information about this issue to help address it. Please be sure to give us your input within the next **7 days**. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
      "labels": [
        "KeyVault",
        "question",
        "customer-reported",
        "needs-author-feedback",
        "no-recent-activity",
        "Auto-Assign",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2024-01-04T00:07:15Z",
      "closed_at": "2025-12-20T17:29:06Z",
      "url": "https://github.com/Azure/azure-cli/issues/28130",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-cli",
      "issue_number": 28246,
      "title": "Ubuntu Lunar?",
      "problem": "### Describe the bug\r\n\r\nI believe I've followed [the Ubuntu install instructions](https://learn.microsoft.com/en-us/cli/azure/install-azure-cli-linux?pivots=apt#option-2-step-by-step-installation-instructions), however, when attempting to `apt-get update`, it fails to update the Azure CLI repo.\r\n\r\nI also don't see `lunar` in the list of dists: https://packages.microsoft.com/repos/azure-cli/dists/\r\n\r\n### Related command\r\n\r\n`apt-get update`\r\n\r\n### Errors\r\n\r\n```\r\nE: The repository 'https://packages.microsoft.com/repos/azure-cli lunar Release' does not have a Release file.\r\n```\r\n\r\n### Issue script & Debug output\r\n\r\n```\r\napt-get update\r\n```\r\n\r\n### Expected behavior\r\n\r\nIt updates `apt` with the various package metadata.\r\n\r\n### Environment Summary\r\n\r\nUbuntu Lunar\r\n\r\n### Additional context\r\n\r\nThe content of `/etc/apt/sources.list.d/azure-cli.list`:\r\n```\r\ndeb [arch=amd64 signed-by=/etc/apt/keyrings/microsoft.gpg] https://packages.microsoft.com/repos/azure-cli/ lunar main\r\n```",
      "solution": "Hi, we're sending this friendly reminder because we haven't heard back from you in a while. We need more information about this issue to help address it. Please be sure to give us your input within the next **7 days**. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!\n<!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. -->",
      "labels": [
        "question",
        "customer-reported",
        "needs-author-feedback",
        "no-recent-activity",
        "Azure CLI Team",
        "OKR Candidate"
      ],
      "created_at": "2024-01-24T22:23:18Z",
      "closed_at": "2025-12-20T17:29:03Z",
      "url": "https://github.com/Azure/azure-cli/issues/28246",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 44178,
      "title": "x-ms-query-source-authorization - Behavior difference",
      "problem": "Hi Team,\n\nWe are seeing a difference in functionality with AI search when the index has permission filters enabled.\n\nEarlier (I think even before 3-4 days)\n\n1) We have an index with permission filter fields enabled\n2) We have loaded in data which are open to all and also restricted to users and groups\n\nWhen querying this is where things have changed now (we are not sure why)\n\nWhen we query the index using AI search key authentication and without _x-ms-query-source-authorization_ header, AI search used to return all data, without applying any permission filter. This was the case on the portal as well when we looked at records we can see everything.\n\nHowever, starting from today we are noticing change in this behavior. Now what is happening is if we query using the access key auth only (without x-_ms-query-source-authorization_ header) only records which are marked as available to all is returned. Any records scoped to users are not returned.\n\nThis is problematic for us, as we have background processes which adds and removed entries from the AI search. Now querying for existing reocrds in AI search is not working at all as it does not return any results.\n\nUsing REST API -> THE CALL\n\n_indexes/{INDEX}/docs?search=*&$count=true&api-version=2025-05-01-preview_\nwith api-key header (admin key) is not returning any data when the docs have permission filter applied.\n\nOur understanding was that the permission filters only applies if the request has _x-ms-query-source-authorization_ header. \n\nCould you kindly check it and let me know if anything is changed in this area. This is very important for us, as  we may not able to do lot of background maintenance activities if this is the case.",
      "solution": "**Why the behavior changed and why it matters**\nThe previous behavior\u2014returning all documents when using only the admin API key\u2014was identified as a potential security gap because it bypassed ACL enforcement. This meant sensitive, user-scoped content could be exposed without identity context, which is not aligned with zero-trust principles.\n\n**What\u2019s new in the preview API**\nThis change is part of a fix for the older preview version 2025-05-01-preview and REST API 2025-11-01-preview has the capability to add the proper role to see all results for debugging and reflects an increase in security controls for query-time access enforcement. Starting with this preview, permission filters apply even when using admin keys unless you explicitly provide identity via the x-ms-query-source-authorization header or the elevated read as per the document provided below. This allows that:\n\n- Background processes and admin operations remain more secure.\n- ACL data is never returned without explicit proper authorization.\n\n**How to view all data for troubleshooting**\nIf you need to investigate or debug scenarios where ACL filtering affects results, you can use the new elevated read access feature in preview. This requires an explicit opt-in and is documented here: https://learn.microsoft.com/en-us/azure/search/search-query-access-control-rbac-enforcement#elevated-permissions-for-investigating-incorrect-results. You should enable RBAC for your search service (since you're using API keys, **both**). \n\nI hope this helps\n\n---\n\n Hi @abhilash-uniper to ensure secure debugging and prevent unintended data exposure, the latest preview version (2025-11-01-preview) require using the elevated read capability. This change was introduced as a security improvement across all preview including ACL functionality support (2025-05-01-preview and 2025-08-01-preview) to avoid scenarios where an application without the dev introducing token verification could inadvertently return results to end users. Using the updated version ensures administrators can view results safely while maintaining compliance with security best practices.  We usually are able to communicate all changes in documentation and communications, however, for public preview, security improvements would be prioritized when not utilizing best practices to guard rail the solutions as possible. Thank you for your understading.",
      "labels": [
        "question",
        "Search",
        "Service Attention",
        "customer-reported",
        "needs-team-attention"
      ],
      "created_at": "2025-11-25T17:07:48Z",
      "closed_at": "2026-02-06T00:28:24Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/44178",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 44637,
      "title": "SyntaxWarning: invalid escape sequence '\\W'",
      "problem": "- **Package Name**: azure-search-documents\n- **Package Version**: 11.6.0\n- **Operating System**: Linux\n- **Python Version**: 3.13.8\n\n**Describe the bug**\nWhen loading the package with antenv on a Azure App Service running Linux, the following error is thrown:\n`.../antenv/lib/python3.13/site-packages/azure/search/documents/indexes/_generated/models/_models_py3.py:6005: SyntaxWarning: invalid escape sequence '\\W'\npattern: str = \"\\W+\",\n.../antenv/lib/python3.13/site-packages/azure/search/documents/indexes/_generated/models/_models_py3.py:6230: SyntaxWarning: invalid escape sequence '\\W'\npattern: str = \"\\W+\",\n`\n\n**To Reproduce**\nSteps to reproduce the behavior:\nLoad the azure-search-documents package in Python 3.13.8 on Linux, using package version 11.6.0.\n\n**Expected behavior**\nNo error should be thrown.\n\n**Additional context**\nProblem is fixed in 11.7.0b2, as string has 'r' added to it: lines[ 8841](https://github.com/Azure/azure-sdk-for-python/blob/696d9d190c3d869ad5a0fb2d039db5d1b19eb02c/sdk/search/azure-search-documents/azure/search/documents/indexes/_generated/models/_models_py3.py#L8841) and [9066](https://github.com/Azure/azure-sdk-for-python/blob/696d9d190c3d869ad5a0fb2d039db5d1b19eb02c/sdk/search/azure-search-documents/azure/search/documents/indexes/_generated/models/_models_py3.py#L9066) -> `pattern: str = r\"\\W+\",`. Therefore an addition to the next stable release would be highly appreciated.\n",
      "solution": "I checked the current `main` branch of `azure-sdk-for-python` and confirmed that\nboth occurrences already use raw strings:\n\n    pattern: str = r\"\\W+\"\n\nCompiling the file does not raise any `SyntaxWarning` on Python 3.13.\n\nThis matches the fix mentioned in `11.7.0b2`, so it appears the issue is already\nresolved in `main` and should be included in the next stable release after 11.6.0.\n\n\n---\n\nThanks for reporting this, and thanks @HarshithReddy01 for confirming! Yes, this is fixed in main and will be included in the next stable release.",
      "labels": [
        "question",
        "Search",
        "Service Attention",
        "customer-reported",
        "needs-team-attention"
      ],
      "created_at": "2026-01-13T13:57:07Z",
      "closed_at": "2026-02-06T00:09:40Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/44637",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 43365,
      "title": "Results of Function call not audible",
      "problem": "**Is your feature request related to a problem? Please describe.**\nThe results from the tool execution are not audible. They are just logged to the console\n\n**Describe the solution you'd like**\nResults from the tool execution should be audible \nMaybe an example with a different handler that does that would be nice\nAlso, that example could start with the agent speaking and not being prompted, as happens during outbound calls\n",
      "solution": "Thanks for reaching out.\n\nCould you provide more information about the issue?\n\ne.g. which SDKs are you using? \n\nAlso, what steps do you take to repro the problem, and what did you expect to happen?\n\n---\n\nHi @pablocast, we're sending this friendly reminder because we haven't heard back from you in **7 days**. We need more information about this issue to help address it. Please be sure to give us your input. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!",
      "labels": [
        "question",
        "customer-reported",
        "no-recent-activity",
        "needs-author-feedback"
      ],
      "created_at": "2025-10-10T20:11:45Z",
      "closed_at": "2025-11-07T01:28:26Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/43365",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 34164,
      "title": "azure-communication-networktraversal needs linting updates for pylint version 3.0.3",
      "problem": "**ACTION NEEDED:** This version of pylint will be merged on **2024-07-15**. The build will begin to fail for this library if errors are not fixed.\n\n**Library name:** azure-communication-networktraversal\n**Pylint version:** 3.0.3\n**Pylint errors:** [Link to build (2024-04-22)](https://dev.azure.com/azure-sdk/internal/_build/results?buildId=3718436&view=logs&j=e5b925a9-9650-5321-24fd-5d9499fe02b8&t=e1fa7d9e-8471-5a74-cd7d-e1c9a992e07e)\n**How to fix:** Run the `next-pylint` tox command at the library package-level and resolve the linting errors.\n1) `../azure-communication-networktraversal>pip install \"tox<5\"`\n2) `../azure-communication-networktraversal>tox run -e next-pylint -c ../../../eng/tox/tox.ini --root .`\n\nSee the [Pylint Guide](https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/pylint_checking.md) for more information.",
      "solution": "Hi @azure-sdk, we deeply appreciate your input into this project. Regrettably, this issue has remained unresolved for over 2 years and inactive for 30 days, leading us to the decision to close it. We've implemented this policy to maintain the relevance of our issue queue and facilitate easier navigation for new contributors. If you still believe this topic requires attention, please feel free to create a new issue, referencing this one. Thank you for your understanding and ongoing support.",
      "labels": [
        "Service Attention",
        "Client",
        "pylint",
        "Communication - Network Traversal"
      ],
      "created_at": "2024-02-04T01:07:06Z",
      "closed_at": "2026-02-04T18:20:44Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/34164",
      "comments_count": 1
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 34246,
      "title": "Azure Monitor OpenTelemetry Exporter using deprecated semantic conventions",
      "problem": "- **Package Name**:  azure-monitor-opentelemetry-exporter\r\n- **Package Version**:  latest\r\n- **Operating System**: n/a/\r\n- **Python Version**:  n/a\r\n\r\n**Describe the bug**\r\nThe azure monitor opentelemetry exporter uses deprecated semantic conventions.\r\n\r\n- https://github.com/Azure/azure-sdk-for-python/blob/54e0fa6e8d9ff214c023964a3d1b299819d12061/sdk/monitor/azure-monitor-opentelemetry-exporter/azure/monitor/opentelemetry/exporter/export/trace/_exporter.py#L351\r\n\r\nExample:\r\nUses the `SpanAttributes.HTTP_METHOD` which is deprecated as per https://github.com/open-telemetry/opentelemetry-python/blob/d03a62245357eb40cac81d5e671fc2df83aef767/opentelemetry-semantic-conventions/src/opentelemetry/semconv/trace/__init__.py#L49\r\n\r\nWhen using a span with `SpanKind.Client` you have to rely on the deprecated semantic conventions for Azure Monitor to pick it up.\r\n\r\n```python\r\nwith tracer.start_as_current_span(\"OpenAI completion api request\", kind=SpanKind.CLIENT) as span:\r\n    span.set_attribute(\"http.method\", \"GET\") \r\n    span.set_attribute(\"http.url\", \"https://my-deployed-service.openai.azure.com/\")\r\n    \r\n   # or span.set_attribute(\"db.system\", \"my-deployed-service.openai.azure.com\") \r\n```    \r\n    \r\n",
      "solution": "> This is an issue for upstream OpenTelemetry. We are in the process of adding new semantic conventions to various http instrumentations. See the tracking issue [here](https://github.com/open-telemetry/opentelemetry-python-contrib/issues/1986). Once these are done, the exporters will be changed to allow for those new signals.\r\n\r\nThanks for the update. Is there a recommended workaround or migration guidance until this is completed? i.e. Do we use `db.system` or `az.namespace` attribute until then or keep using the deprecated http attributes?\r\n\r\nEDIT: I've just seen this and assume we keep using existing http semantic conventions. https://github.com/open-telemetry/semantic-conventions/tree/main/docs/http#semantic-conventions-for-http",
      "labels": [
        "bug",
        "Service Attention",
        "Client",
        "Monitor - Exporter"
      ],
      "created_at": "2024-02-08T17:20:11Z",
      "closed_at": "2025-11-05T17:58:11Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/34246",
      "comments_count": 8
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 44699,
      "title": "azure-ai-language-conversations needs linting updates for pylint version 4.0.4",
      "problem": "**ACTION NEEDED:** This version of pylint will be merged on **2026-04-13**. The build will begin to fail for this library if errors are not fixed.\n\n**Library name:** azure-ai-language-conversations\n**Pylint version:** 4.0.4\n**Pylint Build:** [Link to build (2026-02-01)](https://dev.azure.com/azure-sdk/internal/_build/results?buildId=5823231&view=logs&j=87f850b5-cf15-53c6-370a-4be21ee70ec7&t=b33d1587-3539-5735-af43-e3e62f02ca4b)\n**How to fix:** Run the `next-pylint` tox command at the library package-level and resolve the linting errors.\n1) `../azure-ai-language-conversations>pip install \"tox<5\"`\n2) `../azure-ai-language-conversations>tox run -e next-pylint -c ../../../eng/tox/tox.ini --root .`\n\nSee the [Pylint Guide](https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/pylint_checking.md) for more information.",
      "solution": "This has been fixed by this PR: https://github.com/Azure/azure-sdk-for-python/pull/44854. Thanks.",
      "labels": [
        "Cognitive - Language",
        "pylint"
      ],
      "created_at": "2026-01-17T11:49:10Z",
      "closed_at": "2026-02-03T20:54:39Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/44699",
      "comments_count": 1
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 44700,
      "title": "azure-ai-language-conversations-authoring needs linting updates for pylint version 4.0.4",
      "problem": "**ACTION NEEDED:** This version of pylint will be merged on **2026-04-13**. The build will begin to fail for this library if errors are not fixed.\n\n**Library name:** azure-ai-language-conversations-authoring\n**Pylint version:** 4.0.4\n**Pylint Build:** [Link to build (2026-02-01)](https://dev.azure.com/azure-sdk/internal/_build/results?buildId=5823231&view=logs&j=87f850b5-cf15-53c6-370a-4be21ee70ec7&t=b33d1587-3539-5735-af43-e3e62f02ca4b)\n**How to fix:** Run the `next-pylint` tox command at the library package-level and resolve the linting errors.\n1) `../azure-ai-language-conversations-authoring>pip install \"tox<5\"`\n2) `../azure-ai-language-conversations-authoring>tox run -e next-pylint -c ../../../eng/tox/tox.ini --root .`\n\nSee the [Pylint Guide](https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/pylint_checking.md) for more information.",
      "solution": "This has been fixed by this PR: https://github.com/Azure/azure-sdk-for-python/pull/44876. Thanks.",
      "labels": [
        "Cognitive - Language",
        "pylint"
      ],
      "created_at": "2026-01-17T11:50:27Z",
      "closed_at": "2026-02-03T20:52:51Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/44700",
      "comments_count": 1
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 44701,
      "title": "azure-ai-language-questionanswering needs linting updates for pylint version 4.0.4",
      "problem": "**ACTION NEEDED:** This version of pylint will be merged on **2026-04-13**. The build will begin to fail for this library if errors are not fixed.\n\n**Library name:** azure-ai-language-questionanswering\n**Pylint version:** 4.0.4\n**Pylint Build:** [Link to build (2026-02-01)](https://dev.azure.com/azure-sdk/internal/_build/results?buildId=5823231&view=logs&j=87f850b5-cf15-53c6-370a-4be21ee70ec7&t=b33d1587-3539-5735-af43-e3e62f02ca4b)\n**How to fix:** Run the `next-pylint` tox command at the library package-level and resolve the linting errors.\n1) `../azure-ai-language-questionanswering>pip install \"tox<5\"`\n2) `../azure-ai-language-questionanswering>tox run -e next-pylint -c ../../../eng/tox/tox.ini --root .`\n\nSee the [Pylint Guide](https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/pylint_checking.md) for more information.",
      "solution": "This has been fixed by this PR: https://github.com/Azure/azure-sdk-for-python/pull/44887. Thanks.",
      "labels": [
        "Cognitive - Language",
        "pylint"
      ],
      "created_at": "2026-01-17T11:51:22Z",
      "closed_at": "2026-02-03T20:51:48Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/44701",
      "comments_count": 1
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 44702,
      "title": "azure-ai-language-questionanswering-authoring needs linting updates for pylint version 4.0.4",
      "problem": "**ACTION NEEDED:** This version of pylint will be merged on **2026-04-13**. The build will begin to fail for this library if errors are not fixed.\n\n**Library name:** azure-ai-language-questionanswering-authoring\n**Pylint version:** 4.0.4\n**Pylint Build:** [Link to build (2026-02-01)](https://dev.azure.com/azure-sdk/internal/_build/results?buildId=5823231&view=logs&j=87f850b5-cf15-53c6-370a-4be21ee70ec7&t=b33d1587-3539-5735-af43-e3e62f02ca4b)\n**How to fix:** Run the `next-pylint` tox command at the library package-level and resolve the linting errors.\n1) `../azure-ai-language-questionanswering-authoring>pip install \"tox<5\"`\n2) `../azure-ai-language-questionanswering-authoring>tox run -e next-pylint -c ../../../eng/tox/tox.ini --root .`\n\nSee the [Pylint Guide](https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/pylint_checking.md) for more information.",
      "solution": "This has been fixed by this PR: https://github.com/Azure/azure-sdk-for-python/pull/44889. Thanks.",
      "labels": [
        "Cognitive - Language",
        "pylint"
      ],
      "created_at": "2026-01-17T11:52:24Z",
      "closed_at": "2026-02-03T18:58:10Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/44702",
      "comments_count": 1
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 44703,
      "title": "azure-ai-textanalytics needs linting updates for pylint version 4.0.4",
      "problem": "**ACTION NEEDED:** This version of pylint will be merged on **2026-04-13**. The build will begin to fail for this library if errors are not fixed.\n\n**Library name:** azure-ai-textanalytics\n**Pylint version:** 4.0.4\n**Pylint Build:** [Link to build (2026-02-01)](https://dev.azure.com/azure-sdk/internal/_build/results?buildId=5823482&view=logs&j=87f850b5-cf15-53c6-370a-4be21ee70ec7&t=b33d1587-3539-5735-af43-e3e62f02ca4b)\n**How to fix:** Run the `next-pylint` tox command at the library package-level and resolve the linting errors.\n1) `../azure-ai-textanalytics>pip install \"tox<5\"`\n2) `../azure-ai-textanalytics>tox run -e next-pylint -c ../../../eng/tox/tox.ini --root .`\n\nSee the [Pylint Guide](https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/pylint_checking.md) for more information.",
      "solution": "This has been fixed by this PR: https://github.com/Azure/azure-sdk-for-python/pull/44785. Thanks.",
      "labels": [
        "Cognitive - Language",
        "pylint"
      ],
      "created_at": "2026-01-17T11:53:27Z",
      "closed_at": "2026-02-03T18:57:11Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/44703",
      "comments_count": 1
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 44704,
      "title": "azure-ai-textanalytics-authoring needs linting updates for pylint version 4.0.4",
      "problem": "**ACTION NEEDED:** This version of pylint will be merged on **2026-04-13**. The build will begin to fail for this library if errors are not fixed.\n\n**Library name:** azure-ai-textanalytics-authoring\n**Pylint version:** 4.0.4\n**Pylint Build:** [Link to build (2026-02-01)](https://dev.azure.com/azure-sdk/internal/_build/results?buildId=5823231&view=logs&j=87f850b5-cf15-53c6-370a-4be21ee70ec7&t=b33d1587-3539-5735-af43-e3e62f02ca4b)\n**How to fix:** Run the `next-pylint` tox command at the library package-level and resolve the linting errors.\n1) `../azure-ai-textanalytics-authoring>pip install \"tox<5\"`\n2) `../azure-ai-textanalytics-authoring>tox run -e next-pylint -c ../../../eng/tox/tox.ini --root .`\n\nSee the [Pylint Guide](https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/pylint_checking.md) for more information.",
      "solution": "This has been fixed by this PR: https://github.com/Azure/azure-sdk-for-python/pull/44853. Thanks.",
      "labels": [
        "Cognitive - Language",
        "pylint"
      ],
      "created_at": "2026-01-17T11:54:38Z",
      "closed_at": "2026-02-03T18:56:12Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/44704",
      "comments_count": 1
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 38662,
      "title": "azure-ai-language-questionanswering needs typing updates for pyright version 1.1.407",
      "problem": "**ACTION NEEDED:** This version of pyright will be merged on **2026-04-13**. The build will begin to fail for this library if errors are not fixed.\n\n**Library name:** azure-ai-language-questionanswering\n**Pyright version:** 1.1.407\n**Pyright Build:** [Link to build (2026-02-01)](https://dev.azure.com/azure-sdk/internal/_build/results?buildId=5823231&view=logs&j=87f850b5-cf15-53c6-370a-4be21ee70ec7&t=d243185e-b901-5eef-29fe-f7943e030451)\n**How to fix:** Run the `next-pyright` tox command at the library package-level and resolve the typing errors.\n1) `../azure-ai-language-questionanswering>pip install \"tox<5\"`\n2) `../azure-ai-language-questionanswering>tox run -e next-pyright -c ../../../eng/tox/tox.ini --root .`\n\nSee the [Typing Guide](https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/static_type_checking.md#run-mypy) for more information.",
      "solution": "This has been fixed by this PR: https://github.com/Azure/azure-sdk-for-python/pull/44887. Thanks.",
      "labels": [
        "Service Attention",
        "Client",
        "Cognitive - Language",
        "pyright"
      ],
      "created_at": "2024-11-23T11:51:35Z",
      "closed_at": "2026-02-03T18:55:11Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/38662",
      "comments_count": 1
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 44062,
      "title": "azure-ai-language-questionanswering-authoring needs typing updates for pyright version 1.1.407",
      "problem": "**ACTION NEEDED:** This version of pyright will be merged on **2026-04-13**. The build will begin to fail for this library if errors are not fixed.\n\n**Library name:** azure-ai-language-questionanswering-authoring\n**Pyright version:** 1.1.407\n**Pyright Build:** [Link to build (2026-02-01)](https://dev.azure.com/azure-sdk/internal/_build/results?buildId=5823231&view=logs&j=87f850b5-cf15-53c6-370a-4be21ee70ec7&t=d243185e-b901-5eef-29fe-f7943e030451)\n**How to fix:** Run the `next-pyright` tox command at the library package-level and resolve the typing errors.\n1) `../azure-ai-language-questionanswering-authoring>pip install \"tox<5\"`\n2) `../azure-ai-language-questionanswering-authoring>tox run -e next-pyright -c ../../../eng/tox/tox.ini --root .`\n\nSee the [Typing Guide](https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/static_type_checking.md#run-mypy) for more information.",
      "solution": "This has been fixed by this PR: https://github.com/Azure/azure-sdk-for-python/pull/44889. Thanks.",
      "labels": [
        "Cognitive - Language",
        "pyright"
      ],
      "created_at": "2025-11-15T12:02:13Z",
      "closed_at": "2026-02-03T18:53:44Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/44062",
      "comments_count": 1
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 43490,
      "title": "azure-ai-textanalytics-authoring needs typing updates for pyright version 1.1.407",
      "problem": "**ACTION NEEDED:** This version of pyright will be merged on **2026-04-13**. The build will begin to fail for this library if errors are not fixed.\n\n**Library name:** azure-ai-textanalytics-authoring\n**Pyright version:** 1.1.407\n**Pyright Build:** [Link to build (2026-02-01)](https://dev.azure.com/azure-sdk/internal/_build/results?buildId=5823231&view=logs&j=87f850b5-cf15-53c6-370a-4be21ee70ec7&t=d243185e-b901-5eef-29fe-f7943e030451)\n**How to fix:** Run the `next-pyright` tox command at the library package-level and resolve the typing errors.\n1) `../azure-ai-textanalytics-authoring>pip install \"tox<5\"`\n2) `../azure-ai-textanalytics-authoring>tox run -e next-pyright -c ../../../eng/tox/tox.ini --root .`\n\nSee the [Typing Guide](https://github.com/Azure/azure-sdk-for-python/blob/main/doc/dev/static_type_checking.md#run-mypy) for more information.",
      "solution": "This has been fixed by this PR: https://github.com/Azure/azure-sdk-for-python/pull/44853.",
      "labels": [
        "Cognitive - Language",
        "pyright"
      ],
      "created_at": "2025-10-18T10:58:17Z",
      "closed_at": "2026-02-03T18:52:05Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/43490",
      "comments_count": 1
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 42964,
      "title": "SecretClient not working when URLs have uppercase letters",
      "problem": "- **Package Name**: azure-keyvault-secrets\n- **Package Version**: 4.10.0\n- **Operating System**: Windows\n- **Python Version**: 3.12.10\n\n**Describe the bug**\nWhen creating a client object with `SecretClient` and passing a URL with uppercase letters to `vault_url`, the code breaks. That started happening today.\n\n**To Reproduce**\n1. Run the following script:\n\n```python\n# /// script\n# dependencies = [\n#   \"azure-identity==1.23.1\",\n#   \"azure-keyvault-secrets==4.10.0\",\n# ]\n# ///\n\nimport os\n\nfrom azure.identity import DefaultAzureCredential\nfrom azure.keyvault.secrets import SecretClient\n\n\nidentity = DefaultAzureCredential(exclude_managed_identity_credential=True)\n\nkey_vault_client = SecretClient(\n    vault_url=f\"https://MY_KV_NAME.vault.azure.net/\", credential=identity\n)\n\nfor secret_properties in key_vault_client.list_properties_of_secrets():\n    secret = key_vault_client.get_secret(secret_properties.name)\n    \n```\n\nThis code works when `MY_KV_NAME` is fully written in lowercase.\n\nWhen there's at least one uppercase letter in `MY_KV_NAME`, I'm getting this error:\n\n```python\n  File \"<PROJECT-PATH>\\main.py\", line 20, in <module>\n    for secret_properties in key_vault_client.list_properties_of_secrets():\n  File \"<SITE-PACKAGES-PATH>\\site-packages\\azure\\core\\paging.py\", line 136, in __next__\n    return next(self._page_iterator)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<SITE-PACKAGES-PATH>\\site-packages\\azure\\core\\paging.py\", line 82, in __next__\n    self._response = self._get_next(self.continuation_token)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<SITE-PACKAGES-PATH>\\site-packages\\azure\\keyvault\\secrets\\_generated\\_operations\\_operations.py\", line 905, in get_next\n    pipeline_response: PipelineResponse = self._client._pipeline.run(  # pylint: disable=protected-access\n                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<SITE-PACKAGES-PATH>\\site-packages\\azure\\core\\pipeline\\_base.py\", line 242, in run\n    return first_node.send(pipeline_request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<SITE-PACKAGES-PATH>\\site-packages\\azure\\core\\pipeline\\_base.py\", line 98, in send\n    response = self.next.send(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<SITE-PACKAGES-PATH>\\site-packages\\azure\\core\\pipeline\\_base.py\", line 98, in send\n    response = self.next.send(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<SITE-PACKAGES-PATH>\\site-packages\\azure\\core\\pipeline\\_base.py\", line 98, in send\n    response = self.next.send(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^\n  [Previous line repeated 2 more times]\n  File \"<SITE-PACKAGES-PATH>\\site-packages\\azure\\core\\pipeline\\policies\\_redirect.py\", line 205, in send\n    response = self.next.send(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<SITE-PACKAGES-PATH>\\site-packages\\azure\\core\\pipeline\\policies\\_retry.py\", line 545, in send\n    response = self.next.send(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<SITE-PACKAGES-PATH>\\site-packages\\azure\\keyvault\\secrets\\_shared\\challenge_auth_policy.py\", line 120, in send\n    return self.handle_challenge_flow(request, response)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<SITE-PACKAGES-PATH>\\site-packages\\azure\\keyvault\\secrets\\_shared\\challenge_auth_policy.py\", line 149, in handle_challenge_flow\n    request_authorized = self.on_challenge(request, response)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<SITE-PACKAGES-PATH>\\site-packages\\azure\\keyvault\\secrets\\_shared\\challenge_auth_policy.py\", line 224, in on_challenge\n    raise ValueError(\nValueError: The challenge resource 'vault.azure.net' does not match the requested domain. Pass `verify_challenge_resource=False` to your client's constructor to disable this verification. See https://aka.ms/azsdk/blog/vault-uri for more information.\n```\n\n**Expected behavior**\nI expect `SecretClient` to not care about character case, as DNS is case insensitive. I also expect the behavior of `SecretClient` to be consistent within the same version (this error was not triggerd by a version update).\n",
      "solution": "Hi @CarlosDomingues, apologies for the late response. I looked into this today and unfortunately couldn't reproduce your error; I opened a draft PR to demonstrate the tests I'm using: https://github.com/Azure/azure-sdk-for-python/pull/43198.\n\nOur KV libraries use a shared challenge authentication policy, which is raising the error in your scenario. It looks like your client is failing this check to verify the challenge resource: https://github.com/Azure/azure-sdk-for-python/blob/e4573ded712667b3778518656179ea3c6eba6386/sdk/keyvault/azure-keyvault-secrets/azure/keyvault/secrets/_shared/challenge_auth_policy.py#L223-L228\n\nAs you can see in that snippet though, the request and challenge resource URLs are both `.lower`ed to ignore casing discrepancies. Testing confirms that the check is case insensitive.\n\nI then thought that the issue could be with the trailing slash in the `vault_url` you're creating your client with, since we do the URL comparison with a `.endswith` check -- however, any trailing slashes are already omitted. Again, testing confirms that wouldn't be the cause of the error.\n\nAre you still seeing this error on your end?\n\n---\n\nHi @CarlosDomingues, we're sending this friendly reminder because we haven't heard back from you in **7 days**. We need more information about this issue to help address it. Please be sure to give us your input. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!",
      "labels": [
        "question",
        "KeyVault",
        "Service Attention",
        "Client",
        "customer-reported",
        "no-recent-activity",
        "needs-author-feedback"
      ],
      "created_at": "2025-09-11T15:52:46Z",
      "closed_at": "2025-11-05T01:28:44Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/42964",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 44604,
      "title": "Configure_azure_monitor()` deadlocks on macOS when performance counters enabled",
      "problem": "- **Package Name**: \n- **Package Version**: 1.8.3\n- **Operating System**:\n- **Python Version**: \n\n**Describe the bug**\nA clear and concise description of what the bug is.\n\n# Bug report: `configure_azure_monitor()` deadlocks on macOS when performance counters enabled\n\n## Summary\nCalling `azure.monitor.opentelemetry.configure_azure_monitor()` on macOS with default settings (`enable_performance_counters=True`) hangs indefinitely inside `configure_azure_monitor()`.\n\nWorkaround: pass `enable_performance_counters=False`.\n\n## Environment\n- OS: macOS 26.2 (Build 25C56), arm64\n- Python: 3.11.14 (`/opt/homebrew/opt/python@3.11/bin/python3.11`)\n- Packages (venv):\n  - `azure-monitor-opentelemetry==1.8.3`\n  - `azure-monitor-opentelemetry-exporter==1.0.0b46`\n  - `azure-core==1.37.0`\n  - `azure-core-tracing-opentelemetry==1.0.0b12`\n  - `opentelemetry-api==1.39.0`\n  - `opentelemetry-sdk==1.39.0`\n  - `opentelemetry-instrumentation==0.60b0` (and related instrumentations pulled in by the distro)\n  - `psutil==7.2.1`\n\n## Repro steps\nFrom this repo root:\n\n1) Create venv + install deps:\n```bash\n/opt/homebrew/bin/python3.11 -m venv .venv-repro\nsource .venv-repro/bin/activate\npython -m pip install -U pip\npython -m pip install 'azure-monitor-opentelemetry~=1.6' python-dotenv\n```\n\n2) Repro hang (Ctrl+C to stop and print a traceback):\n```bash\nsource .venv-repro/bin/activate\npython repro_configure_azure_monitor_perf_counters_mac.py\n```\n\n3) Workaround (succeeds):\n```bash\nsource .venv-repro/bin/activate\npython repro_configure_azure_monitor_perf_counters_mac.py --disable-performance-counters\n```\n\nOptional: `python run_repro.py` runs both paths and interrupts the hang after ~10s to capture a traceback.\n\n## Expected behavior\n`configure_azure_monitor()` should return normally on macOS. If a specific performance counter is unsupported on the platform, it should be skipped without blocking configuration.\n\n## Actual behavior\n`configure_azure_monitor()` hangs (deadlock) on macOS when `enable_performance_counters=True` (default).\n\n`run_repro.py` captures this traceback (SIGINT after a timeout):\n```text\nWARNING:azure.monitor.opentelemetry.exporter._performance_counters._manager:Process I/O Rate performance counter is not available on this platform.\nTraceback (most recent call last):\n  File \"/Users/nagkumar/Documents/msft.nosync/enable_perf_counter_langchain_tracer/repro_configure_azure_monitor_perf_counters_mac.py\", line 93, in <module>\n    raise SystemExit(main())\n                     ^^^^^^\n  File \"/Users/nagkumar/Documents/msft.nosync/enable_perf_counter_langchain_tracer/repro_configure_azure_monitor_perf_counters_mac.py\", line 74, in main\n    configure_azure_monitor(\n  File \"/Users/nagkumar/Documents/msft.nosync/enable_perf_counter_langchain_tracer/.venv-repro/lib/python3.11/site-packages/azure/monitor/opentelemetry/_configure.py\", line 141, in configure_azure_monitor\n    _setup_metrics(configurations)\n  File \"/Users/nagkumar/Documents/msft.nosync/enable_perf_counter_langchain_tracer/.venv-repro/lib/python3.11/site-packages/azure/monitor/opentelemetry/_configure.py\", line 286, in _setup_metrics\n    enable_performance_counters(meter_provider=meter_provider)\n  File \"/Users/nagkumar/Documents/msft.nosync/enable_perf_counter_langchain_tracer/.venv-repro/lib/python3.11/site-packages/azure/monitor/opentelemetry/exporter/_performance_counters/_manager.py\", line 657, in enable_performance_counters\n    _PerformanceCountersManager(meter_provider)\n  File \"/Users/nagkumar/Documents/msft.nosync/enable_perf_counter_langchain_tracer/.venv-repro/lib/python3.11/site-packages/azure/monitor/opentelemetry/exporter/_utils.py\", line 407, in __call__\n    instance = super().__call__(*args, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/nagkumar/Documents/msft.nosync/enable_perf_counter_langchain_tracer/.venv-repro/lib/python3.11/site-packages/azure/monitor/opentelemetry/exporter/_performance_counters/_manager.py\", line 601, in __init__\n    _logger.warning(\"Process I/O Rate performance counter is not available on this platform.\")\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/logging/__init__.py\", line 1501, in warning\n    self._log(WARNING, msg, args, **kwargs)\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/logging/__init__.py\", line 1634, in _log\n    self.handle(record)\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/logging/__init__.py\", line 1644, in handle\n    self.callHandlers(record)\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/logging/__init__.py\", line 1706, in callHandlers\n    hdlr.handle(record)\n  File \"/opt/homebrew/Cellar/python@3.11/3.11.14_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/logging/__init__.py\", line 978, in handle\n    self.emit(record)\n  File \"/Users/nagkumar/Documents/msft.nosync/enable_perf_counter_langchain_tracer/.venv-repro/lib/python3.11/site-packages/opentelemetry/sdk/_logs/_internal/__init__.py\", line 579, in emit\n    logger.emit(self._translate(record))\n  File \"/Users/nagkumar/Documents/msft.nosync/enable_perf_counter_langchain_tracer/.venv-repro/lib/python3.11/site-packages/opentelemetry/sdk/_logs/_internal/__init__.py\", line 665, in emit\n    self._multi_log_record_processor.on_emit(writable_record)\n  File \"/Users/nagkumar/Documents/msft.nosync/enable_perf_counter_langchain_tracer/.venv-repro/lib/python3.11/site-packages/opentelemetry/sdk/_logs/_internal/__init__.py\", line 345, in on_emit\n    lp.on_emit(log_record)\n  File \"/Users/nagkumar/Documents/msft.nosync/enable_perf_counter_langchain_tracer/.venv-repro/lib/python3.11/site-packages/azure/monitor/opentelemetry/exporter/_performance_counters/_processor.py\", line 17, in on_emit\n    pcm = _PerformanceCountersManager()\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/nagkumar/Documents/msft.nosync/enable_perf_counter_langchain_tracer/.venv-repro/lib/python3.11/site-packages/azure/monitor/opentelemetry/exporter/_utils.py\", line 404, in __call__\n    with cls._lock:\nKeyboardInterrupt\n```\n\n## Root cause analysis (suspected)\nThis appears to be a self-deadlock caused by logging during singleton initialization:\n\n1) `configure_azure_monitor()` sets up logging before metrics.\n2) With performance counters enabled, logging setup installs `_PerformanceCountersLogRecordProcessor`.\n3) During metrics setup, `enable_performance_counters()` instantiates `_PerformanceCountersManager` (a `Singleton` guarded by a non-reentrant `threading.Lock`).\n4) On macOS, `ProcessIORate` is not available (`_IO_AVAILABLE == False`), so `_PerformanceCountersManager.__init__()` emits:\n   - `_logger.warning(\"Process I/O Rate performance counter is not available on this platform.\")`\n5) That warning is processed by OpenTelemetry\u2019s `LoggingHandler`, which invokes `_PerformanceCountersLogRecordProcessor.on_emit()`.\n6) `on_emit()` calls `_PerformanceCountersManager()` again, but the singleton lock is already held by the in-progress initialization \u2192 deadlock.\n\nThis likely impacts any platform where `ProcessIORate` is unavailable (macOS, and possibly some Linux distros).\n\n## Suggested fixes\nAny of these should break the cycle:\n- Make the singleton lock re-entrant (`threading.RLock`) so re-entry from the same thread can proceed.\n- Avoid logging from inside `_PerformanceCountersManager.__init__()` (or defer until after initialization).\n- Make `_PerformanceCountersLogRecordProcessor` avoid instantiating `_PerformanceCountersManager()` during initialization (e.g., only record if already created).\n\n## Notes\nThe repro script uses `APPLICATION_INSIGHTS_CONNECTION_STRING` if set, otherwise a valid-format fallback connection string; the deadlock occurs before any telemetry content is required.\n \n\n**To Reproduce**\nSteps to reproduce the behavior:\n#!/usr/bin/env python3\n\"\"\"\nHelper to run the repro in both modes:\n  1) `enable_performance_counters=False` (should succeed)\n  2) default `enable_performance_counters=True` (hangs on macOS; we interrupt to collect a traceback)\n\nRun from the venv used to install azure-monitor-opentelemetry:\n  python run_repro.py\n\"\"\"\n\nfrom __future__ import annotations\n\nimport os\nimport signal\nimport subprocess\nimport sys\nfrom dataclasses import dataclass\n\n\n@dataclass(frozen=True)\nclass RunResult:\n    cmd: list[str]\n    returncode: int | None\n    stdout: str\n    stderr: str\n    timed_out: bool\n\n\ndef _run(cmd: list[str], *, timeout_s: float) -> RunResult:\n    proc = subprocess.Popen(\n        cmd,\n        stdout=subprocess.PIPE,\n        stderr=subprocess.PIPE,\n        text=True,\n        env={**os.environ, \"PYTHONUNBUFFERED\": \"1\"},\n    )\n    try:\n        stdout, stderr = proc.communicate(timeout=timeout_s)\n        return RunResult(cmd, proc.returncode, stdout, stderr, False)\n    except subprocess.TimeoutExpired:\n        proc.send_signal(signal.SIGINT)\n        try:\n            stdout, stderr = proc.communicate(timeout=5)\n        except subprocess.TimeoutExpired:\n            proc.kill()\n            stdout, stderr = proc.communicate()\n        return RunResult(cmd, proc.returncode, stdout, stderr, True)\n\n\ndef main() -> int:\n    repro = \"repro_configure_azure_monitor_perf_counters_mac.py\"\n\n    good = _run(\n        [sys.executable, \"-u\", repro, \"--disable-performance-counters\", \"--sleep-seconds\", \"0.1\"],\n        timeout_s=30,\n    )\n    print(\"\\n=== disable-performance-counters (expected: succeeds) ===\")\n    print(good.stdout, end=\"\")\n    if good.stderr:\n        print(good.stderr, end=\"\", file=sys.stderr)\n    if good.returncode != 0:\n        print(f\"Unexpected non-zero exit: {good.returncode}\", file=sys.stderr)\n        return 1\n\n    bad = _run([sys.executable, \"-u\", repro, \"--sleep-seconds\", \"0.1\"], timeout_s=10)\n    print(\"\\n=== performance counters enabled (expected: hangs on macOS) ===\")\n    print(bad.stdout, end=\"\")\n    if bad.stderr:\n        print(bad.stderr, end=\"\", file=sys.stderr)\n\n    if bad.timed_out:\n        print(\"\\nResult: process did not exit within timeout (expected on macOS).\")\n        return 0\n\n    print(\"\\nResult: process exited without timing out (unexpected if bug reproduces).\")\n    print(f\"Exit code: {bad.returncode}\", file=sys.stderr)\n    return 2\n\n\nif __name__ == \"__main__\":\n    raise SystemExit(main())\n\n \n\n**Expected behavior**\nA clear and concise description of what you expected to happen.\n\n**Screenshots**\nIf applicable, add screenshots to help explain your problem.\n\n**Additional context**\nAdd any other context about the problem here.\n",
      "solution": "I confirm, the issue is fixed in 1.8.5. Thank you.",
      "labels": [
        "Monitor - Exporter",
        "Monitor - Distro"
      ],
      "created_at": "2026-01-09T20:31:15Z",
      "closed_at": "2026-02-02T15:45:56Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/44604",
      "comments_count": 6
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 44816,
      "title": "azure-ai-evaluation: maximum recursion depth exceeded",
      "problem": "- **Package Name**: azure.ai.evaluation\n- **Package Version**: 1.13.7\n- **Operating System**: Windows 11\n- **Python Version**: 3.11.11\n\n**Describe the bug**\nPlease find the details in https://github.com/Azure/azure-sdk-for-python/issues/43040\n\nIn a scheduled job / long-running environment, azure-ai-evaluation can fail with a RecursionError that is triggered by the SDK\u2019s stdout/stderr interception logic. This ultimately makes evaluate(...) fail (surfaced as an internal evaluation error).\n\n### Expected behavior\nevaluate(...) completes and returns results/metrics reliably in batch/concurrent runs.\n\n### Actual behavior\nEvaluation occasionally fails due to RecursionError originating from the SDK\u2019s stdout/stderr wrapper, which recursively forwards [write()](vscode-file://vscode-app/c:/Users/wenxingzhu/AppData/Local/Programs/Microsoft%20VS%20Code/resources/app/out/vs/code/electron-browser/workbench/workbench.html) calls through a deep chain of wrapped streams.\n\n### Suspected root cause\nThe legacy logging layer replaces sys.stdout and sys.stderr with NodeLogWriter via NodeLogManager. NodeLogWriter.write() scrubs credentials and then forwards output to a \u201cprevious\u201d stream self._prev_out.write(s) when no node context is present.\n\nUnder concurrency / multi-threaded execution, sys.stdout may be wrapped multiple times (wrapper \u2192 wrapper \u2192 wrapper \u2026), because each NodeLogManager captures the current sys.stdout as its prev_stdout. When later writing output (e.g., run summary / streaming output), the call chain through self._prev_out.write(...) becomes deep enough to overflow recursion depth.\n\nRelevant code locations:\n\nstdout/stderr replacement: _logging.py:162-188\nrecursive forwarding in write(): _logging.py:245-256\nrun streaming writes to sys.stdout: _run_submitter.py:204-263\nNodeLogManager used per-line (concurrent): _engine.py:443\n\n### Why this matters\nThis can make evaluation flaky/non-deterministic in production scheduled jobs, especially when concurrency is enabled.",
      "solution": "# Bug Report: Recursive stdout/stderr wrapping in NodeLogManager causes RecursionError\n\n## Summary\n`evaluate` can crash with `RecursionError: maximum recursion depth exceeded` when `NodeLogManager` wraps `sys.stdout`/`sys.stderr` more than once and a warning or log write occurs outside the node context. This results in `NodeLogWriter.write()` forwarding to another `NodeLogWriter.write()` repeatedly.\n\n## Impact\n- Evaluation runs abort early (no results or partial results).\n- The original warning/error output is lost or truncated.\n- CPU spikes briefly until the recursion limit is hit.\n- In hosted environments the process may be recycled, dropping in-flight runs/artifacts.\n\n## Environment\n- Package: `azure-ai-evaluation`\n- Module: `azure/ai/evaluation/_legacy/_common/_logging.py`\n- Python: 3.12 (observed), likely affects any version\n- Common triggers: warnings emitted by dependencies (e.g., `warnings.warn` in LLM client code)\n\n## Actual Behavior\nStack trace shows repeated calls to `NodeLogWriter.write`:\n\n```\nFile \".../azure/ai/evaluation/_legacy/_common/_logging.py\", line 255, in write\n  return self._prev_out.write(s)\nFile \".../azure/ai/evaluation/_legacy/_common/_logging.py\", line 255, in write\n  return self._prev_out.write(s)\n... repeated ...\nRecursionError: maximum recursion depth exceeded\n```\n\n## Expected Behavior\nWarnings and stdout/stderr writes should be forwarded to a real stream without recursion, and evaluation should continue.\n\n## Root Cause Analysis\n`NodeLogManager` replaces `sys.stdout`/`sys.stderr` with `NodeLogWriter`. If `NodeLogManager` is invoked in a context where the streams are already `NodeLogWriter` instances (nested contexts or host wrappers), `NodeLogWriter.write()` forwards to `_prev_out`, which is another `NodeLogWriter`. When no node context is set, this forwarding path repeats until the recursion limit is hit.\n\nRelevant code:\n- `NodeLogManager` replacement: `azure/ai/evaluation/_legacy/_batch_engine/_engine.py:443`\n- Forwarding path: `azure/ai/evaluation/_legacy/_common/_logging.py:245`\n\n## Steps to Reproduce\n1. Enter a context that already wraps `sys.stderr`/`sys.stdout` with `NodeLogWriter` (nested `NodeLogManager` or host wrapper).\n2. Trigger a write outside node context (e.g., `warnings.warn(\"test warning\")`).\n3. Observe recursion in `NodeLogWriter.write()` leading to `RecursionError`.\n\nMinimal repro (conceptual):\n```\nwith NodeLogManager():\n    with NodeLogManager():\n        warnings.warn(\"test warning\")\n```\n\n## Workaround\nReduce logging output to avoid warning writes (e.g., set `PF_LOGGING_LEVEL=ERROR` or `CRITICAL`). This avoids many warnings that hit the forwarding path, but it does not fix the underlying recursion risk.\n\n## Proposed Fix\n1. **Idempotent wrapping**: When entering `NodeLogManager`, if `sys.stdout`/`sys.stderr` are already `NodeLogWriter`, reuse them instead of wrapping again.\n2. **Safe forwarding**: In `NodeLogWriter.write()`, when no node context is set, unwrap `_prev_out` until a non-`NodeLogWriter` stream is found. Add cycle detection and fallback.\n3. **Fallback stream**: Store `sys.__stdout__`/`sys.__stderr__` in `NodeLogWriter` and write there if a cycle is detected or no real stream is found.\n\n## Test Coverage to Add\n- Nested `NodeLogManager` contexts should not raise `RecursionError` on stderr/stdout writes.\n- Warnings inside nested contexts should be forwarded safely.\n- Node-context capture behavior remains unchanged.\n\n## Files to Change\n- `azure-ai-evaluation/azure/ai/evaluation/_legacy/_common/_logging.py`\n- `azure-ai-evaluation/tests/unittests/` (new or existing logging tests)\n- Optional docs/changelog:\n  - `azure-ai-evaluation/TROUBLESHOOTING.md`\n  - `azure-ai-evaluation/CHANGELOG.md`\n\n\n---\n\nHi @nagkumar91 , the following script can reliably repro the bug. Although the specific locations where the recursion overflows the stack differ, they all belong to the same cause.\n\nAfter testing, looks like the new branch drafted by copilot does resolve the issue, but the unit test doesn't catch the bug correctly, which requires further update, here is a draft to update the unit test: https://github.com/Azure/azure-sdk-for-python/pull/44868\n\n```python\nfrom azure.ai.evaluation import evaluate # 1.14.0\nimport pandas as pd\nfrom pathlib import Path\nfrom typing import TypedDict\n\n\nclass TargetFunctionOutput(TypedDict):\n    response: str\n\n\nclass EvaluatorOutput(TypedDict):\n    character_count: int\n\n\nclass DummyEvaluator:\n    def __init__(self):\n        pass\n\n    def __call__(self, query: str, response: str) -> int:\n        return len(query) + len(response)\n\n\ndef eval_target(query: str) -> TargetFunctionOutput:\n    return TargetFunctionOutput(response=\"test response\")\n\n\ndef run_evaluate() -> None:\n    evaluate(\n        data=\"data.csv\",\n        target=eval_target,\n        evaluators={\n            \"dummy\": DummyEvaluator(),\n        },\n        evaluator_config={\n            \"default\": {\n                \"column_mapping\": {\n                    \"query\": \"${data.query}\",\n                    \"response\": \"${target.response}\",\n                },\n            }\n        },\n    )\n\n\nif __name__ == \"__main__\":\n    dataset_path = Path(\"data.csv\")\n    df = pd.DataFrame({\"query\": [\"hello\"] * 2000})\n    df.to_csv(dataset_path, index=False)\n    try:\n        runs = 50\n        for i in range(runs):\n            print(f\"Run {i + 1}/{runs}\")\n            run_evaluate()\n    finally:\n        dataset_path.unlink(missing_ok=True)\n\n```",
      "labels": [
        "question",
        "Service Attention",
        "customer-reported",
        "needs-team-attention",
        "Evaluation"
      ],
      "created_at": "2026-01-23T03:42:26Z",
      "closed_at": "2026-02-03T01:14:35Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/44816",
      "comments_count": 4
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 34098,
      "title": "[formrecognizer] Timing out via begin_analyze_document() on large files",
      "problem": "Cross-linking [this issue](https://github.com/Azure-Samples/azure-search-openai-demo/issues/485) in this repo\r\n\r\nCustomers seem to time out when attempting to process a document of 390 or more pages.",
      "solution": "Hi @rohit-ganguly, we deeply appreciate your input into this project. Regrettably, this issue has remained unresolved for over 2 years and inactive for 30 days, leading us to the decision to close it. We've implemented this policy to maintain the relevance of our issue queue and facilitate easier navigation for new contributors. If you still believe this topic requires attention, please feel free to create a new issue, referencing this one. Thank you for your understanding and ongoing support.",
      "labels": [
        "bug",
        "Service Attention",
        "Client",
        "customer-reported",
        "needs-team-attention",
        "Cognitive - Form Recognizer"
      ],
      "created_at": "2024-02-01T16:37:29Z",
      "closed_at": "2026-02-02T18:17:07Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/34098",
      "comments_count": 4
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 34079,
      "title": "CosmosDB proxy seems not working",
      "problem": "- **Package Name**: azure-cosmos\r\n- **Package Version**: 4.5.1\r\n- **Operating System**: Windows (same on Linux)\r\n- **Python Version**: 3.11.2\r\n\r\n**Describe the bug**\r\nThe CosmosDB client class provided with the proxy argument seems to ignore it while trying to connect to the CosmosDB resource and uses internet and public IP.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. I have a CosmosDB resource deployed in Azure. Also there is an AKS cluster deployed. The CosmosDB Networking configuration has the Service Endpoint enabled and the AKS Subnet added to the allowed:\r\n![image](https://github.com/Azure/azure-sdk-for-python/assets/70209709/8a00beb0-0f58-48e4-91e8-b63f41ed285e)\r\n2. I can list of the DBs of the CosmosDB resource with a query from a container in AKS using SDK :\r\n![image](https://github.com/Azure/azure-sdk-for-python/assets/70209709/1b15411e-2f6d-4a96-902f-0504296d725f)\r\nList acquired, pod has internal IP from the allowed Subnet CIDR.\r\n3. I have a Point-to-Site VPN enabled to the Virtual Network where the AKS Subnet exists. There is a proxy pod (with image ``scbunn/squid:latest``) deployed in AKS listening for port 3128 that I can connect through the VPN from my local host:\r\n![image](https://github.com/Azure/azure-sdk-for-python/assets/70209709/3349bea0-71b4-4017-846a-1394e655fbef)\r\n4. I created a python venv on my local host, installed the SDK packages for CosmosDB:\r\n![image](https://github.com/Azure/azure-sdk-for-python/assets/70209709/47b8ccc3-d918-4378-a279-63ef924cc04e)\r\n5. I tried to connect to the CosmosDB resource via the proxy but I got an error that my local host public IP was not authorized to access the resource:\r\n![image](https://github.com/Azure/azure-sdk-for-python/assets/70209709/37879d34-2720-4c03-9d1a-47edf811c5df)\r\n\r\nCode used:\r\n```\r\nfrom azure.cosmos import exceptions, CosmosClient, PartitionKey, documents, ProxyConfiguration\r\nimport os\r\nURL = 'https://***.documents.azure.com:443'\r\nKEY = '***'\r\nproxy=ProxyConfiguration()\r\nproxy.Host='10.1.0.29'\r\nproxy.Port=3128\r\nclient = CosmosClient(URL, credential=KEY, proxy_config=proxy, connection_timeout=5)\r\n```\r\n\r\n**Expected behavior**\r\nThe request should be successful or a proxy-related error can happen but not an error related to using my public IP for accessing the resource while proxy is specified.\r\n\r\n**Screenshots**\r\nSee above\r\n\r\n**Additional context**\r\nI tried using the ``documents.ConnectionPolicy()`` as proposed [here](https://github.com/Azure/azure-sdk-for-python/issues/33344#issuecomment-1836982793):\r\n```\r\nconnection_policy = documents.ConnectionPolicy()\r\nconnection_policy.ProxyConfiguration = documents.ProxyConfiguration()\r\nconnection_policy.ProxyConfiguration.Host = 'http://10.1.0.29'\r\nconnection_policy.ProxyConfiguration.Port = 3128\r\nclient = CosmosClient(URL, credential=KEY, connection_timeout=5, connection_policy=connection_policy)\r\n```\r\nbut result was the same.\r\n\r\nI also tried increasing the verbosity by running the code\r\n```\r\nimport logging\r\nlogger = logging.getLogger('azure.cosmos')\r\nlogger.setLevel(logging.INFO)\r\nlogging.basicConfig()\r\n```\r\nbut that didn't provide any additional insight why proxy is not used.",
      "solution": "@brunman-mikhail apologies on the delayed response on this one, but are you still facing the issue?\nI think the way to setup proxy in python SDK is like this, by passing the proxy object in the client config directly. \n\n`proxy={\"http\": \"http://10.1.0.29:3128\"}`\n\n---\n\n@kushagraThapar , thank you for the tip. If I'm not mistaken (that was some time ago) we switched to another proxy solution. If the environment configuration didn't change to much I'll try to reproduce the setup and try your proposal.\n\n---\n\nHi @brunman-mikhail, we deeply appreciate your input into this project. Regrettably, this issue has remained unresolved for over 2 years and inactive for 30 days, leading us to the decision to close it. We've implemented this policy to maintain the relevance of our issue queue and facilitate easier navigation for new contributors. If you still believe this topic requires attention, please feel free to create a new issue, referencing this one. Thank you for your understanding and ongoing support.",
      "labels": [
        "bug",
        "Cosmos",
        "Service Attention",
        "Client",
        "customer-reported",
        "needs-team-attention"
      ],
      "created_at": "2024-01-31T09:56:51Z",
      "closed_at": "2026-01-30T18:16:06Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/34079",
      "comments_count": 7
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 43607,
      "title": "azure-storage-blob<=12.17.0 fails with azure-core 1.36.0",
      "problem": "- **Package Name**: azure-storage-blob\n- **Package Version**: azure-storage-blob<=12.17.0\n- **Operating System**: any\n- **Python Version**: any\n\n**Describe the bug**\nazure-core removed six as a dependency in version 1.36.0\n\n**To Reproduce**\nSteps to reproduce the behavior:\n1. Install azure-storage-blob==12.17.0. six is not installed as dependency\n2. from azure.storage.blob import BlobServiceClient -> this immediately raises ModuleNotFoundError: No module named 'six'\n\n**Expected behavior**\nFor azure-storage-blob<=12.17.0, the dependency on azure-core should be locked to version <=1.35.1 to ensure the six module is included.\n\n**Screenshots**\n<img width=\"1747\" height=\"494\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/755438a9-620e-4d75-a25b-caad9acbac17\" />\n\n**Additional context**\nI did not verify if there are any issues with azure-storage-blob >= 12.18.0\n",
      "solution": "Hi @olam-harmonicinc, since you haven\u2019t asked that we `/unresolve` the issue, we\u2019ll close this out. If you believe further discussion is needed, please add a comment `/unresolve` to reopen the issue.",
      "labels": [
        "question",
        "customer-reported",
        "issue-addressed"
      ],
      "created_at": "2025-10-24T04:38:55Z",
      "closed_at": "2025-10-31T16:39:16Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/43607",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 41968,
      "title": "Handle ConnectionResetError in the retry policy of azure.storage.blob",
      "problem": "- **Package Name**:  azure-storage-blob\n- **Package Version**:  12.25.1\n- **Operating System**: Ubuntu 24.04\n- **Python Version**:  3.10\n\n**Describe the bug**\n\nWe are getting a few exception while fetching data using the async `download_blob` function. The exception would look similar to this:\n```\n(\"Response payload is not completed: <ContentLengthError: 400, message='Not enough data for satisfy content length header.'>. ConnectionResetError(104, 'Connection reset by peer')\"\n```\nwhile this might happen from time to time I suspect the retry policy is not triggered for such error. \n\nI have seen that in the `_shared/policies` [code](https://github.com/Azure/azure-sdk-for-python/blob/70db1ec12b8e23d19df0d4a2be5a77423d4b3063/sdk/storage/azure-storage-blob/azure/storage/blob/_shared/policies.py#L87:L92) we now have some handling code for specific error message. \n \nDo you think we can add this exception in the retry policy? \n\nIt is also possible that I'm missing something here. Thanks! \n\n**To Reproduce**\nSteps to reproduce the behavior:\n1. It is hard to reproduce since the exception is raised by a network error. \n\n**Expected behavior**\n\nI would like `ConnectionResetError` to be treated as a network error and retried accordingly.  \n\n**Screenshots**\nIf applicable, add screenshots to help explain your problem.\n\n**Additional context**\nAdd any other context about the problem here.\n",
      "solution": "Apologies about the confusion. Will re-open the issue for tracking.\n\n---\n\nHi @gdippolito, we're sending this friendly reminder because we haven't heard back from you in **7 days**. We need more information about this issue to help address it. Please be sure to give us your input. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!",
      "labels": [
        "Storage",
        "question",
        "Service Attention",
        "Client",
        "customer-reported",
        "no-recent-activity",
        "needs-author-feedback"
      ],
      "created_at": "2025-07-10T10:51:36Z",
      "closed_at": "2025-10-31T01:28:25Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/41968",
      "comments_count": 7
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 43116,
      "title": "no add_dataset_references function",
      "problem": "- **Package Name**: azure-ai-ml\n- **Package Version**: azure-ai-ml  1.23.1\n- **Operating System**: macOS Sequoia version 15.7\n- **Python Version**: Python 3.10.17\n\n**Describe the bug**\nThe class Model from the Azure-AI-ML package lacks the add_dataset_references method. According to the documentation, it should be available at: https://learn.microsoft.com/pl-pl/python/api/azureml-core/azureml.core.model.model?view=azure-ml-py#azureml-core-model-model-add-dataset-references\n**To Reproduce**\n```\nimport tempfile\ndata_asset_name = \"temp_evaluation_artifacts\"\nwith tempfile.TemporaryDirectory() as temp_dir:\n    from azure.ai.ml.constants import AssetTypes\n    from azure.ai.ml.entities import Data\n    import os\n    import pandas as pd\n    open_orders_temp_csv = os.path.join(temp_dir, \"open_orders_refined_data.csv\")\n\n    open_orders_df_p = pd.DataFrame({\"A\": [1, 2], \"B\": [3, 4]})\n\n    open_orders_df_p.to_csv(open_orders_temp_csv, index=False)\n    data_asset = Data(\n                  name=data_asset_name,\n                  path=temp_dir,\n                  type=AssetTypes.URI_FOLDER,\n                  description=\"Model evaluation artifacts including SMO-specific analysis\",\n                  tags={\n                      \"artifact_type\": \"evaluation_artifacts_temp\",\n                  },\n              )\n    registered_data = self.ml_client.data.create_or_update(data_asset)\n    ...load model with ml client\n    latest_model.add_dataset_references([(\"temp_eval_artifacts\", registered_data_asset)])\n```\n**Expected behavior**\ndata asset registered under model\n\n**Screenshots**\n<img width=\"760\" height=\"37\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/ff275592-569f-426b-a08f-f27ae481c6fa\" />\n\n",
      "solution": "@AleksandraSzymczak  - I think there is some confusion in your code snippet, its a mix of V1 and V2, But I am assuming your trying to trying to register a model with data reference. \nwe don't support in SDK V2 yet, There is workaround mentioned here.\nhttps://github.com/Azure/azure-sdk-for-python/issues/29429#issuecomment-1476439870",
      "labels": [
        "feature-request",
        "Machine Learning",
        "Service Attention",
        "Client",
        "customer-reported",
        "needs-team-attention"
      ],
      "created_at": "2025-09-24T12:44:47Z",
      "closed_at": "2025-10-30T14:30:49Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/43116",
      "comments_count": 4
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 33987,
      "title": "SDK doesn't work across multiple event loops",
      "problem": "- **Package Name**: azure-identity\r\n- **Package Version**: 1.15.0\r\n- **Operating System**: Windows\r\n- **Python Version**: 3.8\r\n\r\n**Describe the bug**\r\nWhen using the SDK across multiple event loops the credential is closed, resulting in request failure.\r\nNOTE: The client is still open, and there is no way to tell besides the error that the event loop is closed.\r\n\r\n**To Reproduce**\r\nUsing Azure App Configuration:\r\n```python\r\nimport os\r\nimport asyncio\r\nfrom azure.appconfiguration.aio import AzureAppConfigurationClient\r\nfrom azure.identity.aio import DefaultAzureCredential\r\n \r\nENDPOINT = os.environ.get(\"AZURE_APPCONFIG_ENDPOINT\")\r\ncredential = DefaultAzureCredential()\r\n \r\nasync def main():\r\n    global AZURE_APP_CONFIG\r\n    AZURE_APP_CONFIG = AzureAppConfigurationClient(ENDPOINT, credential)\r\n    message = await AZURE_APP_CONFIG.get_configuration_setting(key=\"testapp_settings_message\")\r\n    print(message.value)\r\n \r\nasync def getSecond():\r\n    global AZURE_APP_CONFIG\r\n    message = await AZURE_APP_CONFIG.get_configuration_setting(key=\"testapp_settings_message\")\r\n    print(message.value)\r\n \r\nasync def end():\r\n    global AZURE_APP_CONFIG\r\n    print(\"Closing connection\")\r\n    await AZURE_APP_CONFIG.close()\r\n    await credential.close()\r\n \r\nasyncio.run(main())\r\nasyncio.run(getSecond())\r\nasyncio.run(end())\r\n \r\n```\r\nResult:\r\n`RuntimeError: Event loop is closed`\r\n\r\n**Expected behavior**\r\nThe azure SDK should be able to be used in web frameworks such as Flask when in async each request is it's own event loop.\r\n",
      "solution": "Hey, @mrm9084. Thanks for the feedback. \r\n\r\nIs it certain that the credential is closed? I recreated the `RuntimeError: Event loop is closed` using your code snippet (and using BlobServiceClient instead), I found that I could reuse the credential in `getSecond` if I re-instantiated the client there. So the issue with the multiple event loops likely has to do with the client, or presumably the transport the client uses (`aiohttp`).\r\n\r\nAfter doing some searching, I found [this discussion](https://github.com/encode/httpx/discussions/2959) with someone using multiple event loops with `httpx`, and it seems the error might stem from how connection pooling is done. Something might be similar with `aiohttp`. \r\n\r\nI am not sure how to go about fixing this, but I found that using:\r\n\r\n```python\r\nasyncio.get_event_loop().run_until_complete(main())\r\nasyncio.get_event_loop().run_until_complete(getSecond())\r\nasyncio.get_event_loop().run_until_complete(end())\r\n```\r\n\r\ninstead of the `ayncio.run`s made things work as expected. \n\n---\n\nHi @mrm9084, we deeply appreciate your input into this project. Regrettably, this issue has remained unresolved for over 2 years and inactive for 30 days, leading us to the decision to close it. We've implemented this policy to maintain the relevance of our issue queue and facilitate easier navigation for new contributors. If you still believe this topic requires attention, please feel free to create a new issue, referencing this one. Thank you for your understanding and ongoing support.",
      "labels": [
        "Client",
        "Azure.Identity"
      ],
      "created_at": "2024-01-24T20:23:24Z",
      "closed_at": "2026-01-26T18:12:31Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/33987",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 43471,
      "title": "azure-ml-core 1.60.0 still fails with numpy>= 2.0",
      "problem": "- **Package Name**:  azureml-core\n- **Package Version**: 1.60.0\n- **Operating System**: any\n- **Python Version**:  any\n\n**Describe the bug**\nhttps://github.com/Azure/azure-sdk-for-python/issues/38052 claims to be addressed \"in the next release\". The issue was for 1.58.0, so I expected it to be fixed in 1.59.0 but I just reproduced the issue in 1.60.0.\nI also noticed numpy is not even a dependency of the package although it's used in several places.\n\n**To Reproduce**\nSteps to reproduce the behavior:\n\nInstall azureml-core==1.60.0. I don't even see numpy installed as a dependency (I installed in a new virtual environment).\nOpen the codebase: core/_metrics.py still references np.unicode_ which is not allowed in numpy >=2.0.\n\nExpected behavior\n\n**Expected behavior**\nA clear and concise description of what you expected to happen.\n\n**Screenshots**\nIf applicable, add screenshots to help explain your problem.\n\n**Additional context**\nI don't see numpy as a dependency:\n\n```\npip install azureml-core==1.60.0\nCollecting azureml-core==1.60.0\n  Downloading azureml_core-1.60.0-py3-none-any.whl (3.3 MB)\n     \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 3.3/3.3 MB 60.4 MB/s eta 0:00:00\nCollecting requests[socks]<3.0.0,>=2.19.1\n  Using cached requests-2.32.5-py3-none-any.whl (64 kB)\nCollecting msal<2.0.0,>=1.15.0\n  Using cached msal-1.34.0-py3-none-any.whl (116 kB)\nCollecting contextlib2<22.0.0\n  Using cached contextlib2-21.6.0-py2.py3-none-any.whl (13 kB)\nCollecting msrestazure<=0.7,>=0.4.33\n  Using cached msrestazure-0.6.4.post1-py2.py3-none-any.whl (40 kB)\nCollecting argcomplete<4\n  Using cached argcomplete-3.6.2-py3-none-any.whl (43 kB)\nCollecting azure-mgmt-network<=29.0.0\n  Using cached azure_mgmt_network-29.0.0-py3-none-any.whl (608 kB)\nCollecting azure-common<2.0.0,>=1.1.12\n  Using cached azure_common-1.1.28-py2.py3-none-any.whl (14 kB)\nCollecting pytz\n  Using cached pytz-2025.2-py2.py3-none-any.whl (509 kB)\nCollecting packaging<=25.0,>=20.0\n  Using cached packaging-25.0-py3-none-any.whl (66 kB)\nCollecting azure-mgmt-authorization<5,>=0.40.0\n  Using cached azure_mgmt_authorization-4.0.0-py3-none-any.whl (1.1 MB)\nCollecting jmespath<2.0.0\n  Using cached jmespath-1.0.1-py3-none-any.whl (20 kB)\nCollecting paramiko<4.0.0,>=2.0.8\n  Using cached paramiko-3.5.1-py3-none-any.whl (227 kB)\nCollecting pathspec<1.0.0\n  Using cached pathspec-0.12.1-py3-none-any.whl (31 kB)\nCollecting backports.tempfile\n  Using cached backports.tempfile-1.0-py2.py3-none-any.whl (4.4 kB)\nCollecting azure-mgmt-resource<=24.0.0,>=15.0.0\n  Using cached azure_mgmt_resource-24.0.0-py3-none-any.whl (3.6 MB)\nCollecting PyJWT<3.0.0\n  Using cached PyJWT-2.10.1-py3-none-any.whl (22 kB)\nCollecting azure-mgmt-containerregistry<11,>=8.2.0\n  Using cached azure_mgmt_containerregistry-10.3.0-py3-none-any.whl (2.3 MB)\nCollecting azure-mgmt-keyvault<11.0.0,>=0.40.0\n  Using cached azure_mgmt_keyvault-10.3.1-py3-none-any.whl (901 kB)\nCollecting docker<8.0.0\n  Using cached docker-7.1.0-py3-none-any.whl (147 kB)\nCollecting ndg-httpsclient<=0.5.1\n  Using cached ndg_httpsclient-0.5.1-py3-none-any.whl (34 kB)\nCollecting urllib3<3.0.0,>1.26.17\n  Using cached urllib3-2.5.0-py3-none-any.whl (129 kB)\nCollecting knack<0.13.0\n  Using cached knack-0.12.0-py3-none-any.whl (60 kB)\nCollecting python-dateutil<3.0.0,>=2.7.3\n  Using cached python_dateutil-2.9.0.post0-py2.py3-none-any.whl (229 kB)\nCollecting jsonpickle<5.0.0\n  Using cached jsonpickle-4.1.1-py3-none-any.whl (47 kB)\nCollecting azure-core<2.0.0\n  Using cached azure_core-1.36.0-py3-none-any.whl (213 kB)\nCollecting msrest<=0.7.1,>=0.5.1\n  Using cached msrest-0.7.1-py3-none-any.whl (85 kB)\nCollecting azure-graphrbac<1.0.0,>=0.40.0\n  Using cached azure_graphrbac-0.61.2-py2.py3-none-any.whl (142 kB)\nCollecting adal<=1.2.7,>=1.2.0\n  Using cached adal-1.2.7-py2.py3-none-any.whl (55 kB)\nCollecting azure-mgmt-storage<=23.0.0,>=16.0.0\n  Using cached azure_mgmt_storage-23.0.0-py3-none-any.whl (286 kB)\nCollecting msal-extensions<=2.0.0,>=0.3.0\n  Using cached msal_extensions-1.3.1-py3-none-any.whl (20 kB)\nCollecting SecretStorage<4.0.0\n  Using cached secretstorage-3.4.0-py3-none-any.whl (15 kB)\nCollecting pkginfo\n  Using cached pkginfo-1.12.1.2-py3-none-any.whl (32 kB)\nCollecting humanfriendly<11.0,>=4.7\n  Using cached humanfriendly-10.0-py2.py3-none-any.whl (86 kB)\nCollecting pyopenssl<26.0.0\n  Downloading pyopenssl-25.3.0-py3-none-any.whl (57 kB)\n     \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 57.3/57.3 kB 4.8 MB/s eta 0:00:00\nCollecting cryptography>=1.1.0\n  Downloading cryptography-46.0.3-cp38-abi3-manylinux_2_28_x86_64.whl (4.5 MB)\n     \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 4.5/4.5 MB 70.3 MB/s eta 0:00:00\nCollecting typing-extensions>=4.6.0\n  Using cached typing_extensions-4.15.0-py3-none-any.whl (44 kB)\nCollecting azure-mgmt-core<2.0.0,>=1.3.2\n  Using cached azure_mgmt_core-1.6.0-py3-none-any.whl (29 kB)\nCollecting isodate<1.0.0,>=0.6.1\n  Using cached isodate-0.7.2-py3-none-any.whl (22 kB)\nCollecting tabulate\n  Using cached tabulate-0.9.0-py3-none-any.whl (35 kB)\nCollecting pyyaml\n  Using cached pyyaml-6.0.3-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (770 kB)\nCollecting pygments\n  Using cached pygments-2.19.2-py3-none-any.whl (1.2 MB)\nCollecting certifi>=2017.4.17\n  Using cached certifi-2025.10.5-py3-none-any.whl (163 kB)\nCollecting requests-oauthlib>=0.5.0\n  Using cached requests_oauthlib-2.0.0-py2.py3-none-any.whl (24 kB)\nCollecting six\n  Using cached six-1.17.0-py2.py3-none-any.whl (11 kB)\nCollecting pyasn1>=0.1.1\n  Using cached pyasn1-0.6.1-py3-none-any.whl (83 kB)\nCollecting pynacl>=1.5\n  Using cached pynacl-1.6.0-cp38-abi3-manylinux_2_26_x86_64.manylinux_2_28_x86_64.whl (1.4 MB)\nCollecting bcrypt>=3.2\n  Downloading bcrypt-5.0.0-cp39-abi3-manylinux_2_28_x86_64.whl (278 kB)\n     \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 278.7/278.7 kB 12.8 MB/s eta 0:00:00\nCollecting charset_normalizer<4,>=2\n  Using cached charset_normalizer-3.4.4-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (153 kB)\nCollecting idna<4,>=2.5\n  Using cached idna-3.11-py3-none-any.whl (71 kB)\nCollecting PySocks!=1.5.7,>=1.5.6\n  Using cached PySocks-1.7.1-py3-none-any.whl (16 kB)\nCollecting jeepney>=0.6\n  Using cached jeepney-0.9.0-py3-none-any.whl (49 kB)\nCollecting backports.weakref\n  Using cached backports.weakref-1.0.post1-py2.py3-none-any.whl (5.2 kB)\nCollecting cffi>=2.0.0\n  Using cached cffi-2.0.0-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (216 kB)\nCollecting oauthlib>=3.0.0\n  Using cached oauthlib-3.3.1-py3-none-any.whl (160 kB)\nCollecting pycparser\n  Using cached pycparser-2.23-py3-none-any.whl (118 kB)\nInstalling collected packages: pytz, backports.weakref, azure-common, urllib3, typing-extensions, tabulate, six, pyyaml, PySocks, PyJWT, pygments, pycparser, pyasn1, pkginfo, pathspec, packaging, oauthlib, jsonpickle, jmespath, jeepney, isodate, idna, humanfriendly, contextlib2, charset_normalizer, certifi, bcrypt, backports.tempfile, argcomplete, requests, python-dateutil, knack, cffi, requests-oauthlib, pynacl, docker, cryptography, azure-core, SecretStorage, pyopenssl, paramiko, msrest, azure-mgmt-core, adal, ndg-httpsclient, msrestazure, msal, azure-mgmt-storage, azure-mgmt-resource, azure-mgmt-network, azure-mgmt-keyvault, azure-mgmt-containerregistry, azure-mgmt-authorization, msal-extensions, azure-graphrbac, azureml-core\nSuccessfully installed PyJWT-2.10.1 PySocks-1.7.1 SecretStorage-3.4.0 adal-1.2.7 argcomplete-3.6.2 azure-common-1.1.28 azure-core-1.36.0 azure-graphrbac-0.61.2 azure-mgmt-authorization-4.0.0 azure-mgmt-containerregistry-10.3.0 azure-mgmt-core-1.6.0 azure-mgmt-keyvault-10.3.1 azure-mgmt-network-29.0.0 azure-mgmt-resource-24.0.0 azure-mgmt-storage-23.0.0 azureml-core-1.60.0 backports.tempfile-1.0 backports.weakref-1.0.post1 bcrypt-5.0.0 certifi-2025.10.5 cffi-2.0.0 charset_normalizer-3.4.4 contextlib2-21.6.0 cryptography-46.0.3 docker-7.1.0 humanfriendly-10.0 idna-3.11 isodate-0.7.2 jeepney-0.9.0 jmespath-1.0.1 jsonpickle-4.1.1 knack-0.12.0 msal-1.34.0 msal-extensions-1.3.1 msrest-0.7.1 msrestazure-0.6.4.post1 ndg-httpsclient-0.5.1 oauthlib-3.3.1 packaging-25.0 paramiko-3.5.1 pathspec-0.12.1 pkginfo-1.12.1.2 pyasn1-0.6.1 pycparser-2.23 pygments-2.19.2 pynacl-1.6.0 pyopenssl-25.3.0 python-dateutil-2.9.0.post0 pytz-2025.2 pyyaml-6.0.3 requests-2.32.5 requests-oauthlib-2.0.0 six-1.17.0 tabulate-0.9.0 typing-extensions-4.15.0 urllib3-2.5.0\n```",
      "solution": "Hi @jkafrouni , We were not able to repro the issue in installing the azreml-core==1.60.0 at our end. However, we have a latest version of azreml-core 1.61.0.post1. could you please try to upgrade and let us know if you still face any issue.",
      "labels": [
        "question",
        "Machine Learning",
        "Service Attention",
        "Client",
        "customer-reported",
        "needs-team-attention"
      ],
      "created_at": "2025-10-16T19:17:31Z",
      "closed_at": "2026-01-25T18:13:08Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/43471",
      "comments_count": 4
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 17801,
      "title": "Azure SDK is over 500MB and growing on each release.",
      "problem": "The azure SDK is ridiculously large for reasons that I have a hard time understanding. We pip install it for our CI pipelines and the vast majority of the size of our container is coming from the Azure SDK, in the SDK the network directory is taking almost half of the size and this is because there are 39 versions of the SDK.\r\n\r\nI have never seen anyone doing such a strange approach to version their API clients. I fail to understand why anyone would even want to use the client from 2015 on a cloud product like Azure.\r\n\r\n```\r\nroot@1bba10bd1500:~/.pyenv/versions/3.9.2/lib/python3.9/site-packages/azure/mgmt/network# du -shc * | grep M | sort -n \r\n1.2M\taio\r\n2.4M\tv2015_06_15\r\n3.3M\tv2016_09_01\r\n3.5M\tv2016_12_01\r\n3.7M\tv2017_03_01\r\n4.4M\tv2017_06_01\r\n4.4M\tv2017_08_01\r\n4.9M\tv2017_09_01\r\n5.1M\tv2017_10_01\r\n5.1M\tv2017_11_01\r\n5.1M\tv2018_01_01\r\n5.7M\tv2018_02_01\r\n6.5M\tv2018_04_01\r\n6.6M\tv2018_06_01\r\n6.9M\tv2018_07_01\r\n8.3M\tv2018_08_01\r\n8.4M\tv2018_10_01\r\n8.6M\tv2018_11_01\r\n8.8M\tv2018_12_01\r\n9.0M\tv2019_02_01\r\n9.5M\tv2019_04_01\r\n10M\tv2019_06_01\r\n11M\tv2019_07_01\r\n11M\tv2019_08_01\r\n11M\tv2019_09_01\r\n11M\tv2019_11_01\r\n11M\tv2019_12_01\r\n12M\tv2020_03_01\r\n12M\tv2020_04_01\r\n13M\tv2020_05_01\r\n13M\tv2020_06_01\r\n13M\tv2020_07_01\r\n13M\tv2020_08_01\r\n259M\ttotal\r\n```\r\n\r\nCan the default release only prove the latest version of the client libraries, or at least provide a 'lean' version of the SDK? This release model is certainly not sustainable and is causing useless grief to your users.",
      "solution": "To clarify  #11149 is only about azure-mgmt-network which is the largest directory but the problem is present across the entire Azure SDK.\r\n\r\nI understand the reasoning for the approach to keep everything for backward compatibility but if you do have customers that point to the old versions then they should pin their requirement versions to the old pypi.org releases of the Azure SDK, not force everyone to keep a copy of everything around. How about providing two versions of the SDKs: one large with everything, one small with just the latest version.\r\n\n\n---\n\n@KranthiPakala-MSFT we are working on this, and there is ongoing discussion on the issue to be sure we consider all possible impact of any decisions, and nobody would be broken by it.\n\n---\n\n@sodul Yeah, agreed. So far I saw only keyvault being broken by your tool (which should be fixed soon I guess https://github.com/Azure/azure-sdk-for-python/issues/21623).\r\n\r\nI think there are actually 2 scenarios we're talking about.. Development - I agree, comments & doc strings are useful.\r\nHowever, building production image - docstrings are unnecessary.. The only trick there is - need to preserve number of empty lines as a replacement for a docstring comment to get same line numbers with exceptions.",
      "labels": [
        "bug",
        "Network",
        "Mgmt",
        "customer-reported",
        "issue-addressed"
      ],
      "created_at": "2021-04-05T19:07:06Z",
      "closed_at": "2025-10-27T16:39:51Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/17801",
      "comments_count": 30
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 43324,
      "title": "Python: cannot import name 'McpTool' from 'azure.ai.agents.models'",
      "problem": "- **Package Name**:  azure-ai-agents\n- **Package Version**:  1.1.0\n- **Operating System**: Windows\n- **Python Version**:  3.13.8\n\n**Describe the bug**\nError while importing MCP server.\nImportError: cannot import name 'McpTool' from 'azure.ai.agents.models'\n\n**To Reproduce**\nSteps to reproduce the behavior:\n1. Just import the module in python\n\n**Expected behavior**\nShould be able to import module\n\n**Screenshots**\nNone\n\n**Additional context**\nCode : https://learn.microsoft.com/en-us/azure/ai-foundry/agents/how-to/tools/model-context-protocol-samples?pivots=python#create-an-agent-with-the-mcp-tool\n\nEnvironment details as below:\n\nPython version : 3.13.8\n\npip show azure-ai-agents\nName: azure-ai-agents\nVersion: 1.1.0\nSummary: Microsoft Corporation Azure AI Agents Client Library for Python\nHome-page: https://github.com/Azure/azure-sdk-for-python/tree/main/sdk\nAuthor: Microsoft Corporation\nAuthor-email: [azpysdkhelp@microsoft.com](mailto:azpysdkhelp@microsoft.com)\nLicense: MIT License\nLocation:\nRequires: azure-core, isodate, typing-extensions\nRequired-by: azure-ai-projects",
      "solution": "Hi @ketanvh, since you haven\u2019t asked that we `/unresolve` the issue, we\u2019ll close this out. If you believe further discussion is needed, please add a comment `/unresolve` to reopen the issue.",
      "labels": [
        "customer-reported",
        "issue-addressed"
      ],
      "created_at": "2025-10-09T16:38:36Z",
      "closed_at": "2025-10-17T16:38:05Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/43324",
      "comments_count": 4
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 44514,
      "title": "Code",
      "problem": "### Type of issue\n\nCode doesn't work\n\n### Description\n\n\n\n[Enter feedback here]\n\n\n### Page URL\n\nhttps://learn.microsoft.com/en-us/python/api/overview/azure/ai-inference-readme?view=azure-python-preview\n\n### Content source URL\n\nhttps://github.com/MicrosoftDocs/azure-docs-sdk-python/blob/main/docs-ref-services/preview/ai-inference-readme.md\n\n### Document Version Independent Id\n\n4e812db1-b436-8e78-0f94-e55520096921\n\n### Platform Id\n\n322d5fbd-598b-36b7-03a3-51b1b399d17d\n\n### Article author\n\n@azure-sdk\n\n### Metadata\n\n* ID: b5c0ccea-f9f6-a1dc-2435-57e94588eb4c\n* PlatformId: 322d5fbd-598b-36b7-03a3-51b1b399d17d \n* Service: **ai**",
      "solution": "Hi @ganthalarohith-hash, we're sending this friendly reminder because we haven't heard back from you in **7 days**. We need more information about this issue to help address it. Please be sure to give us your input. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!",
      "labels": [
        "question",
        "customer-reported",
        "no-recent-activity",
        "needs-author-feedback"
      ],
      "created_at": "2025-12-26T06:52:59Z",
      "closed_at": "2026-01-24T01:29:00Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/44514",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 44237,
      "title": "ImportError: cannot import name 'LogData' from 'opentelemetry.sdk._logs' in v1.8.2",
      "problem": "- **Package Name**:  azure-monitor-opentelemetry\n- **Package Version**: 1.8.2\n- **Operating System**: Ubuntu\n- **Python Version**: 3.11\n\n**Describe the bug**\nAfter upgrading our Python app to azure-monitor-opentelemetry version 1.8.2, it no longer starts. The behavior looks similar to what\u2019s described in #41996. As a temporary workaround, we downgraded the package to 1.6.13, following the suggestion in that thread. However, that\u2019s not a sustainable long-term fix, so I\u2019m opening this issue to help get the problem addressed in the latest release.\n\nStack trace:\n\n> ImportError: cannot import name 'LogData' from 'opentelemetry.sdk._logs' (/usr/local/lib/python3.11/site-packages/opentelemetry/sdk/_logs/__init__.py)\nProcess SpawnProcess-2:\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.11/multiprocessing/process.py\", line 314, in _bootstrap\n    self.run()\n  File \"/usr/local/lib/python3.11/multiprocessing/process.py\", line 108, in run\n    self._target(*self._args, **self._kwargs)\n  File \"/usr/local/lib/python3.11/site-packages/uvicorn/_subprocess.py\", line 78, in subprocess_started\n    target(sockets=sockets)\n  File \"/usr/local/lib/python3.11/site-packages/uvicorn/server.py\", line 62, in run\n    return asyncio.run(self.serve(sockets=sockets))\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/asyncio/runners.py\", line 190, in run\n    return runner.run(main)\n           ^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/asyncio/runners.py\", line 118, in run\n    return self._loop.run_until_complete(task)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"uvloop/loop.pyx\", line 1518, in uvloop.loop.Loop.run_until_complete\n  File \"/usr/local/lib/python3.11/site-packages/uvicorn/server.py\", line 69, in serve\n    config.load()\n  File \"/usr/local/lib/python3.11/site-packages/uvicorn/config.py\", line 458, in load\n    self.loaded_app = import_from_string(self.app)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/uvicorn/importer.py\", line 21, in import_from_string\n    module = importlib.import_module(module_str)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/importlib/__init__.py\", line 126, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<frozen importlib._bootstrap>\", line 1204, in _gcd_import\n  File \"<frozen importlib._bootstrap>\", line 1176, in _find_and_load\n  File \"<frozen importlib._bootstrap>\", line 1147, in _find_and_load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 690, in _load_unlocked\n  File \"<frozen importlib._bootstrap_external>\", line 940, in exec_module\n  File \"<frozen importlib._bootstrap>\", line 241, in _call_with_frames_removed\n  File \"/app/src/app.py\", line 7, in <module>\n    from \\*\\*\\* import \\*\\*\\*\n  File \"/usr/local/lib/python3.11/site-packages/\\*\\*\\*.py\", line 19, in <module>\n    from ..utils.logger import get_logger\n  File \"/usr/local/lib/python3.11/site-packages/\\*\\*\\*.py\", line 267, in <module>\n    logger = get_logger(__name__)\n             ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/\\*\\*\\*.py\", line 121, in get_logger\n    return LoggerFactory().get(logger_name)\n           ^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/\\*\\*\\*.py\", line 5, in __call__\n    cls._instances[cls] = super(Singleton, cls).__call__(*args, **kwargs)\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/site-packages/\\*\\*\\*.py\", line 83, in __init__\n    from azure.monitor.opentelemetry import configure_azure_monitor\n  File \"/usr/local/lib/python3.11/site-packages/azure/monitor/opentelemetry/__init__.py\", line 7, in <module>\n    from azure.monitor.opentelemetry._configure import configure_azure_monitor\n  File \"/usr/local/lib/python3.11/site-packages/azure/monitor/opentelemetry/_configure.py\", line 33, in <module>\n    from azure.monitor.opentelemetry._constants import (\n  File \"/usr/local/lib/python3.11/site-packages/azure/monitor/opentelemetry/_constants.py\", line 7, in <module>\n    from azure.monitor.opentelemetry.exporter._constants import (  # pylint: disable=import-error,no-name-in-module\n  File \"/usr/local/lib/python3.11/site-packages/azure/monitor/opentelemetry/exporter/__init__.py\", line 7, in <module>\n    from azure.monitor.opentelemetry.exporter.export.logs._exporter import AzureMonitorLogExporter\n  File \"/usr/local/lib/python3.11/site-packages/azure/monitor/opentelemetry/exporter/export/logs/_exporter.py\", line 14, in <module>\n    from opentelemetry.sdk._logs import LogData\nImportError: cannot import name 'LogData' from 'opentelemetry.sdk._logs' (/usr/local/lib/python3.11/site-packages/opentelemetry/sdk/_logs/__init__.py)\n",
      "solution": "Same issue here.\nWe did not update azure-monitor-opentelemetry sdk, it already was 1.8.2.\nBut we updated its dependencies:\n  - Updating opentelemetry-api (1.38.0 -> 1.39.0)\n  - Updating opentelemetry-semantic-conventions (0.59b0 -> 0.60b0)\n  - Updating opentelemetry-instrumentation (0.59b0 -> 0.60b0)\n  - Updating opentelemetry-util-http (0.59b0 -> 0.60b0)\n  - Updating opentelemetry-instrumentation-asgi (0.59b0 -> 0.60b0)\n  - Updating opentelemetry-instrumentation-dbapi (0.59b0 -> 0.60b0)\n  - Updating opentelemetry-instrumentation-wsgi (0.59b0 -> 0.60b0)\n  - Updating opentelemetry-instrumentation-django (0.59b0 -> 0.60b0)\n  - Updating opentelemetry-instrumentation-fastapi (0.59b0 -> 0.60b0)\n  - Updating opentelemetry-instrumentation-flask (0.59b0 -> 0.60b0)\n  - Updating opentelemetry-instrumentation-psycopg2 (0.59b0 -> 0.60b0)\n  - Updating opentelemetry-instrumentation-requests (0.59b0 -> 0.60b0)\n  - Updating opentelemetry-instrumentation-urllib (0.59b0 -> 0.60b0)\n  - Updating opentelemetry-instrumentation-urllib3 (0.59b0 -> 0.60b0)\n\nI temporarely fixed by forcing opentelemetry-api v1.38.0\n\n---\n\nThis broke my team's builds as well. The problem is actually in the Azure code here, not OpenTelemtry SDK. It's improper to import private (`_` prefix) resources from packages/modules you do not directly own.\n\n---\n\n> [@pietervdheijden](https://github.com/pietervdheijden) Thank you for bringing this up. We will release a new version of `azure-monitor-opentelemetry` tomorrow that will use the OTEL version which is stable while we continue to get breaking changes from opentelemetry. Will keep you posted once release is done and ready to be used.\n\nHello @rads-1996 ,\nDo you have any news about the release  of azure-monitor-opentelemetry correcting the issue ?",
      "labels": [
        "question",
        "Monitor",
        "Service Attention",
        "customer-reported",
        "no-recent-activity",
        "needs-author-feedback"
      ],
      "created_at": "2025-12-03T15:22:02Z",
      "closed_at": "2026-01-09T01:29:00Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/44237",
      "comments_count": 28
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 42453,
      "title": "Azure Function OpenTelemetry instrumentation of FastAPI",
      "problem": "- **Package Name**: azure-monitor-opentelemetry\n- **Package Version**: \n- **Operating System**: Windows/Linux\n- **Python Version**: 3.11.9\n\n**Describe the bug**\n\nI am testing to use opentelemetry for a fastapi app running in azure function. I use the auto instrumentation of fastapi given by the package `opentelemetry-instrumentation-fastapi`. \n\nWhile it is working and all logs and spans are exported to Azure AppInsights, the specific entry in the requests table is created in an unfortunate way.\n\nI have one route \"/hello/{name}\". As you can see from the spans created from opentelemetry the spans get the name \"GET /hello/{name}\" while the entry in the requests table gets the name \"GET /hello/1\" (with the actual url). This destroys the grouping in appInsights as can bee seen in the screenshots:\n\n**To Reproduce**\n\nfunction_app.py\n```\nimport logging\n\nimport azure.functions as func\nimport fastapi\nfrom opentelemetry.instrumentation.fastapi import FastAPIInstrumentor\n\nfastapi_app = fastapi.FastAPI()\n\nFastAPIInstrumentor.instrument_app(fastapi_app)\n\nlogger = logging.getLogger(__name__)\n\n\n@fastapi_app.get(\"/hello/{name}\")\nasync def get_name(name: str):\n    logger.info(f\"Hello {name}\")\n    return {\n        \"name\": name,\n    }\n\n\napp = func.AsgiFunctionApp(app=fastapi_app,\n                           http_auth_level=func.AuthLevel.ANONYMOUS,\n                           function_name='fastapi')\nimport logging\n\nimport azure.functions as func\nimport fastapi\nfrom opentelemetry.instrumentation.fastapi import FastAPIInstrumentor\n\nfastapi_app = fastapi.FastAPI()\n\nFastAPIInstrumentor.instrument_app(fastapi_app)\n\nlogger = logging.getLogger(__name__)\n\n\n@fastapi_app.get(\"/hello/{name}\")\nasync def get_name(name: str):\n    logger.info(f\"Hello {name}\")\n    return {\n        \"name\": name,\n    }\n\n\napp = func.AsgiFunctionApp(app=fastapi_app,\n                           http_auth_level=func.AuthLevel.ANONYMOUS,\n                           function_name='fastapi')\n\n```\n\nhost.json:\n```\n{\n  \"version\": \"2.0\",\n  \"extensions\": {\n    \"http\": {\n      \"routePrefix\": \"\"\n    }\n  },\n  \"telemetryMode\": \"OpenTelemetry\"\n}\n```\nlocal.settings.json\n```\n{\n  \"IsEncrypted\": false,\n  \"Values\": {\n    \"PYTHON_ENABLE_INIT_INDEXING\": \"1\",\n    \"PYTHON_ENABLE_OPENTELEMETRY\": true,\n    \"PYTHON_APPLICATIONINSIGHTS_ENABLE_TELEMETRY\": true,\n    \"FUNCTIONS_WORKER_RUNTIME\": \"python\",\n    \"AzureWebJobsStorage\": \"XXXXXXXXXXXXXXXXXXXXXX\",\n    \"APPLICATIONINSIGHTS_CONNECTION_STRING\": \"XXXXXXXXXXXXXXXXXXXXXXX\"\n  }\n}\n```\nrequirements.txt:\n```\nazure-functions==1.24.0b3\nfastapi==0.116.1\nazure-monitor-opentelemetry==1.6.13\nopentelemetry-instrumentation-fastapi==0.57.b0\n\n```\n\n\n**Expected behavior**\nUse the route name (with route param template) or the actual endpoint (function) name.\n\n**Screenshots**\n<img width=\"1171\" height=\"782\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/f0087d7e-2c77-4158-aef8-65966f13df78\" />\n\n<img width=\"1749\" height=\"256\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/7489d8b7-544c-4488-bbbd-e6c434b7b98e\" />\n\n**Additional context**\nAdd any other context about the problem here.\n",
      "solution": "@claria I agree with you about the function app behavior, they have hardcoded all endpoints to fall under *route and that behavior is correctly reflected in application insights - \n\n<img width=\"608\" height=\"178\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/d1d00219-311b-4046-a866-b22eaa8488d7\" />\n\nI tried running the application without using function app and discovered that the grouping is being done correctly because FastApi handles the requests directly without the azure function wrapper - \n\n<img width=\"1788\" height=\"134\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/1369c694-2c2e-47cf-a240-bdf22921f427\" />\n\nSince the logic has been hardcoded by the azure-functions team, you can reach out to them for an alternative or a possible solution, the azure-monitor-opentelemetry is correctly grouping the requests as demonstrated above without using the function app. \n\nThis is the place where the logic for *route has been added - https://github.com/Azure/azure-functions-python-library/blob/b28a46a23d4feebef89d8675efad2b988f867100/azure/functions/decorators/function_app.py and the repository where you can raise the issue.\n\n---\n\nHi @claria, we're sending this friendly reminder because we haven't heard back from you in **7 days**. We need more information about this issue to help address it. Please be sure to give us your input. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!\n\n---\n\nHi, please keep the issue open until somebody reacts to the issue in the azure-functions-python-worker repo.\nThanks",
      "labels": [
        "question",
        "Service Attention",
        "customer-reported",
        "no-recent-activity",
        "needs-author-feedback",
        "Monitor - Distro"
      ],
      "created_at": "2025-08-11T09:09:13Z",
      "closed_at": "2026-01-22T01:29:03Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/42453",
      "comments_count": 24
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 41768,
      "title": "Grounding with Bing Custom Seach fails in AI Foundry with error: \"Error: invalid_tool_input; The specified connection ID was not found in the project or account connections. Please verify that the connection id in tool input is correct and exists in the project or account.\"",
      "problem": "- **Package Name**: \n- azure-ai-projects~=1.0.0b11\n- **Package Version**: \n- **Operating System**:\n- Agents Playground, ubuntu 22.04.5 LTS\n- **Python Version**: \n3.10.12\n\n**Describe the bug**\nWhen using Grounding with Bing Custom Search as a knowledge source for an AI Foundry agent, the below error is recieved upon trying to send a message to the agent. The problem occurs both when running in the Agents Playground in AI foundry as well as running the code sample locally.\n\n`{'code': 'tool_user_error', 'message': \"Error: invalid_tool_input; The specified connection ID '/subscriptions/<subscription_id>/resourceGroups/<resource_group_name>/providers/Microsoft.CognitiveServices/accounts/<ai-foundry-resouce-name>/projects/<project_name>/connections/<connection_name>' was not found in the project or account connections. Please verify that the connection id in tool input is correct and exists in the project or account.\"}`\n\n**To Reproduce**\nSteps to reproduce the behavior:\n1. Follow the instructions: https://learn.microsoft.com/en-us/azure/ai-foundry/agents/how-to/tools/bing-custom-search-samples?pivots=portal\n2. Try to interact with the agent\n\n**Expected behavior**\nRecieve a response from the AI Agent using the Bing Custom Search tool.\n\n**Screenshots**\n\n![Image](https://github.com/user-attachments/assets/fda68f7b-034b-4b0b-8442-f4b51aaca8b1)\n\n**Additional Information**\nI created the connection according to the instructions provided, and retried multiple times.",
      "solution": "Hi @DanielEstehghariSopra this is a known issue and we are working to fix it. Please see the following workaround:\n1. create a customkeys connection with the following info\napi-key your Bing resource api key\nresource-idsubscriptions/sub_id/resourceGroups/rg_name/providers/Microsoft.Bing/accounts/<custom_search_resource_name>\ntarget https://api.bing.microsoft.com/\n2. create agent through API or sdk ([How to use the Custom Bing Search with Azure AI Foundry Agent Service tool - Azure OpenAI | Microsoft Learn](https://learn.microsoft.com/en-us/azure/ai-foundry/agents/how-to/tools/bing-custom-search-samples?pivots=rest))\n\n---\n\n> Hi [@DanielEstehghariSopra](https://github.com/DanielEstehghariSopra) this is a known issue and we are working to fix it. Please see the following workaround:\n> \n> 1. create a customkeys connection with the following info\n>    api-key your Bing resource api key\n>    resource-idsubscriptions/sub_id/resourceGroups/rg_name/providers/Microsoft.Bing/accounts/<custom_search_resource_name>\n>    target https://api.bing.microsoft.com/\n> 2. create agent through API or sdk ([How to use the Custom Bing Search with Azure AI Foundry Agent Service tool - Azure OpenAI | Microsoft Learn](https://learn.microsoft.com/en-us/azure/ai-foundry/agents/how-to/tools/bing-custom-search-samples?pivots=rest))\n\nThanks for your reply @lindazqli. I tried this approach, both creating an agent using the SDK and the API, but to no avail. Same issue. Please get back with an update soon as our team otherwise will need to migrate to another provider.\n\n---\n\n@DanielEstehghariSopra could you please elaborate on the issue?",
      "labels": [
        "question",
        "Service Attention",
        "Client",
        "customer-reported",
        "no-recent-activity",
        "needs-author-feedback",
        "Cognitive - Bing"
      ],
      "created_at": "2025-06-25T15:28:52Z",
      "closed_at": "2025-08-09T01:28:37Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/41768",
      "comments_count": 9
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 44353,
      "title": "Azure AI Evaluation: Unable to run custom evaluator in Foundry Portal",
      "problem": "### Describe the bug\nI am unable to run my custom evaluator through the Foundry portal. When triggering an evaluation run, the following error appears:\n\n**\"Please provide a valid evaluator. Invalid or missing numeric result.\"**\n\nI was able to:\n- Successfully create the evaluator in the portal  \n- Configure a new eval run using this evaluator  \n- Start the eval run, but it fails with the above error  \n\nNo detailed logs are available to indicate what went wrong.\n\nRegion - westus\n\n### To Reproduce\n1. Create a custom evaluator on the Foundry portal  \n2. Configure an eval run and select this evaluator  \n3. Start the eval run  \n4. Observe failure with the error above  \n\n### Expected behavior\nThe evaluation should run successfully using the custom evaluator, or at minimum provide detailed logs indicating what part of the evaluator output is invalid.\n\n### Screenshots\n<img width=\"149\" height=\"83\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/57a38edd-cf66-4a2e-988f-9bd65545acfb\" />\n\n<img width=\"335\" height=\"95\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/edf52f56-f62a-49ba-a43c-6a4fb9c63189\" />\n\n<img width=\"449\" height=\"75\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/38d8c702-a341-4de8-95b1-b18034647108\" />\n\n### Additional context\nIt appears the evaluator is being detected and invoked, but the system rejects its output due to an \u201cinvalid or missing numeric result.\u201d More verbose logging or an example of the required return format would be helpful for debugging.\n\n",
      "solution": "We need more information to reproduce the issue. Can you provide sample prompt which is failing for you. \n\nMeanwhile, please refer to the sample code for prompt based custom evaluator and its evaluations. \nhttps://github.com/Azure/azure-sdk-for-python/blob/main/sdk/ai/azure-ai-projects/samples/evaluations/sample_eval_catalog_prompt_based_evaluators.py\n\nAbove sample provide python script to create prompt based custom evaluator and use it in the evaluation APIs. \n\n---\n\nThank you! I have tested the updated prompt and it works.\n\n \nA few suggestions:\n1. We should consider making the error message more detailed. In the documentation, we can first explain the need to explicitly specify the output format (e.g., adding a prompt for JSON output). The error message could also mention that the prompt format might be the issue.\n\n2. I was able to use my previous prompt in Sweden Central, so this might also be related to a different judge model being used there. So maybe something to add to documentation.",
      "labels": [
        "question",
        "Service Attention",
        "Client",
        "customer-reported",
        "needs-team-attention",
        "Evaluation"
      ],
      "created_at": "2025-12-09T23:13:00Z",
      "closed_at": "2026-01-20T18:58:12Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/44353",
      "comments_count": 7
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 42180,
      "title": "Azure Monitor Exporter cannot export large telemetry items",
      "problem": "- **Package Name**: azure-monitor-opentelemetry\n- **Package Version**: 1.6.12\n- **Operating System**: macOS\n- **Python Version**: 3.12\n\n**Describe the bug**\nWhen collecting log data based on OpenTelemetry using Azure Monitor Exporter, if the size of the log data exceeds 65536, the exporter fails to send the data to Azure Monitor and logs the following error:\n\n```\n {\"asctime\": \"2025-07-23 21:16:58,588\", \"levelname\": \"ERROR\", \"name\": \"azure.monitor.opentelemetry.exporter.export._base\", \"message\": \"Data drop 400: Telemetry item length must not exceed 65536 {'additional_properties': {}, 'version': 1, 'name': 'Microsoft.ApplicationInsights.Message', 'time': '2025-07-23T12:16:57.971359Z', 'sample_rate': 100, 'sequence': None, 'instrumentation_key': 'ac6b85d2-b020-41b7-8eec-d509218bbb3a', 'tags': {<ContextTagKeys.AI_DEVICE_ID: 'ai.device.id'>: '****.local', <ContextTagKeys.AI_DEVICE_LOCALE: 'ai.device.locale'>: 'ja_JP', <ContextTagKeys.AI_DEVICE_TYPE: 'ai.device.type'>: 'Other', <ContextTagKeys.AI_INTERNAL_SDK_VERSION: 'ai.internal.sdkVersion'>: 'fum_py3.12.7:otel1.31.1:ext1.0.0b40', <ContextTagKeys.AI_CLOUD_ROLE: 'ai.cloud.role'>: 'worker', <ContextTagKeys.AI_CLOUD_ROLE_INSTANCE: 'ai.cloud.roleInstance'>: '****.local', <ContextTagKeys.AI_INTERNAL_NODE_NAME: 'ai.internal.nodeName'>: '*****.local', <ContextTagKeys.AI_OPERATION_ID: 'ai.operation.id'>: '6536649b4e39bb156c6461e3a3d30ce2', <ContextTagKeys.AI_OPERATION_PARENT_ID: 'ai.operation.parentId'>: 'c3452b2d48964e7c'}, 'data': <azure.monitor.opentelemetry.exporter._generated.models._models_py3.MonitorBase object at 0x11138db20>}.\", \"pathname\": \"/myprojects-path/.venv/lib/python3.12/site-packages/azure/monitor/opentelemetry/exporter/export/_base.py\", \"module\": \"_base\", \"lineno\": 230, \"request\": null, \"response\": null}\n````\n\n**To Reproduce**\n\n```\nimport logging\nfrom azure.monitor.opentelemetry import configure_azure_monitor\n\n# Set up your application logger\nlogger = logging.getLogger(\"my-app-logger\")\n\n# Configure Azure Monitor to collect logs from the specified logger name\nconfigure_azure_monitor(\n    logger_name=\"my-app-logger\",  # Collect logs from your namespaced logger\n)\n\nlogger.info(\"<Large TEXT>\")\n```\n\n**Expected behavior**\n\nIn Azure Functions, even large logs are sent to Application Insights via the Azure Functions Worker, so this limitation does not occur.\nWith the OpenTelemetry-based Azure Monitor Exporter, there is no way to  handle oversized log messages.\nThis makes it difficult to migrate to OpenTelemetry-based monitoring, as we cannot guarantee that all logs will be delivered to Application Insights.\nPlease provide a way to handle log messages that exceed the 65536 byte limit.\nAlternatively, a way to suppress this error, would be helpful.\n\n**Screenshots**\nNo screenshots.\n\n**Additional context**\nThis limitation is a blocker for migrating to OpenTelemetry-based monitoring in our Azure Functions environment.\nAny workaround or guidance would be appreciated.\n",
      "solution": "@yamaday-isid I am unable to reproduce the issue based on the code you shared, can you share the repro code and the dependencies?\n\n---\n\nHi @yamaday-isid, we're sending this friendly reminder because we haven't heard back from you in **7 days**. We need more information about this issue to help address it. Please be sure to give us your input. If we don't hear back from you within **14 days** of this comment the issue will be automatically closed. Thank you!\n\n---\n\n> @yamaday-isid I am unable to reproduce the issue based on the code you shared, can you share the repro code and the dependencies?\n\n@rads-1996 \n\nSorry for the delayed response.\nThis issue may have been caused by the old OpenCensus Python SDK being used alongside our code.\nAfter removing those dependencies, the issue did not recur.\n\nWe apologize for any inconvenience this may have caused. ",
      "labels": [
        "question",
        "Service Attention",
        "Client",
        "customer-reported",
        "no-recent-activity",
        "needs-author-feedback",
        "Monitor - Distro"
      ],
      "created_at": "2025-07-23T12:53:09Z",
      "closed_at": "2025-09-26T01:28:30Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/42180",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-sdk-for-python",
      "issue_number": 42073,
      "title": "azure-monitor-opentelemetry: OTEL_RESOURCE_ATTRIBUTES are overridden by AzureVMResourceDetector",
      "problem": "- **Package Name**: azure-monitor-opentelemetry\n- **Package Version**: 1.6.10\n- **Operating System**: linux\n- **Python Version**: 3.11.2\n\n**Describe the bug**\nAccording to [Azure documentation](https://learn.microsoft.com/en-us/azure/azure-monitor/app/opentelemetry-configuration?tabs=python#set-the-cloud-role-name-and-the-cloud-role-instance), `cloud_RoleInstance` can be populated by setting the following:\n```sh\nexport OTEL_RESOURCE_ATTRIBUTES=\"service.instance.id=my-instance\"\n```\nWhen I tried it, `cloud_RoleInstance` remained the UUID of the VM.\n\n\n**To Reproduce**\nSteps to reproduce the behavior:\n1. Run on Azure VM.\n2. Set the the environment variable as above.\n3. Run a code that uses `configure_azure_monitor()` initialization and produces a trace log.\n4. Check the `cloud_RoleInstance` on Application Insights for the trace log.\n \n**Expected behavior**\n\nThe value of `cloud_RoleInstance` should be \"my-instance\".\n\nInstead it is the UUID of the pod.\n\n**Screenshots**\nN/A\n\n**Additional context**\nAfter debugging it, I realized that the problem resides in setting of `OTEL_EXPERIMENTAL_RESOURCE_DETECTORS` here:\n\nhttps://github.com/Azure/azure-sdk-for-python/blob/e7074f1c0e558a3a382916301067d7a5f819c3ec/sdk/monitor/azure-monitor-opentelemetry/azure/monitor/opentelemetry/_utils/configurations.py#L132-L133\n\nOpen Telemetry runs the extra detectors **after** running `OTELResourceDetector` which populates the Resource based on the environment variables.\n\nAs a side note: I think that there is a problem which check of `_is_on_aks()` [here](https://github.com/open-telemetry/opentelemetry-python-contrib/blob/f20fa77ad59d90aae4978ae28cb1a98b12fbb959/resource/opentelemetry-resource-detector-azure/src/opentelemetry/resource/detector/azure/_utils.py#L26-L27). I'm running on AKS, this env var is not set for the pod, so the AzureVMResourceDetector logic is falsely executed.\n\n**Workaround**\nAs a workaround, one can set the following environment variable:\n```sh\nexport OTEL_EXPERIMENTAL_RESOURCE_DETECTORS=\"otel\"\n```",
      "solution": "@yoshigev thanks for reporting the issue, looks like this about our current precedence of resource configurations, Azure App Services, Azure Functions and AKS should have precedence over other env variables, only higher precedence would be explicitly configuring in the code when calling configure_azure_monitor method. We can definitely improve documentation for these cases. Can you describe your environment a little bit more?, are you using AKS resource of Azure VM? \n\n---\n\nHi @hectorhdzg,\n\nSo I understand this is a feature and not a bug \ud83d\ude1f.\n\nMy setup is regular AKS. Due to the problem I mentioned in `_is_on_aks`, the package does not skip the AzureVMResourceDetector, so it get the data of the underlying Node. The result is that roleInstance is populated with the id of the node, and roleName is not populated.\n\nNote that we are not using a detector service - our code directly sends the traces to application-insights.\n\nAlso note that, in the exact setup, the C# and Node.JS versions of the package populates roleInstance with the os host-name which corresponds to the Pod name.\n\n---\n\n@yoshigev If you look at the documentation for the usage of the env variable - `OTEL_EXPERIMENTAL_RESOURCE_DETECTORS`, it is clearly stated that if this variable is not set explicitly then it defaults to  \"azure_app_service, azure_vm\" - \n\n<img width=\"1007\" height=\"153\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/a1950f74-08fd-42c7-9a92-2aca7b824f8b\" />\n\n\nFurther looking at it's documentation, it specifies that  - \n\n\"The [OTEL_EXPERIMENTAL_RESOURCE_DETECTORS](https://opentelemetry-python.readthedocs.io/en/latest/sdk/environment_variables.html#envvar-OTEL_EXPERIMENTAL_RESOURCE_DETECTORS) is a comma-separated string of names of resource detectors.**These names must be the same as the names of entry points for the `opentelemetry_resource_detector` entry point**\"\n\nThat is why when you set \n`export OTEL_EXPERIMENTAL_RESOURCE_DETECTORS=\"otel\" `\nin your workaround it fetches the correct detector and populates the role instance with the pod name - \n\n<img width=\"723\" height=\"222\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/c3c4fe76-48e2-4c62-9d5c-901e4c40307e\" />\n\n\nThis is by design and not a bug.",
      "labels": [
        "Service Attention",
        "customer-reported",
        "no-recent-activity",
        "needs-author-feedback",
        "Monitor - Distro"
      ],
      "created_at": "2025-07-17T09:23:23Z",
      "closed_at": "2025-10-22T01:28:46Z",
      "url": "https://github.com/Azure/azure-sdk-for-python/issues/42073",
      "comments_count": 10
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1760,
      "title": "[Bug] Python 3.13 custom/user logs are not emitted",
      "problem": "### Expected Behavior\n\nRegardless of python version, I would expect custom logs (i.e. using `logging` library) to be emitted.\n\nAnd therefore should show up in the invocation logs, app insights tables, and in the console when running the function locally using `func host start` with the core tools.\n\n### Actual Behavior\n\nWhen using the Python 3.13 worker, custom logs are not emitted. You only get the function start and complete logs.\n\nWhen using Python 3.12, custom logs are emitted for the exact same code.\n\nThis behaviour is observed both locally (`func host start`) and in the deployed Azure Function.\n\n#### Screenshots of deployed function App Insights\n\nPython 3.13 (not working)\n\n<img width=\"1396\" height=\"118\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/a58df586-7a22-468c-a245-48ef180d91fe\" />\n\nPython 3.12 (working)\n\n<img width=\"1412\" height=\"125\" alt=\"Python 3.12 - logs are showing\" src=\"https://github.com/user-attachments/assets/e81ca988-88e5-4d7e-88dc-e97903afdc99\" />\n\nNote: Expected that debug log won't appear as this is with the default log level.\n\n#### Screenshots from running locally\n\nPython 3.13 (not working)\n\n<img width=\"1296\" height=\"176\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/b14f6575-90a5-428c-a566-725e706ca6d9\" />\n\nPython 3.12 (working)\n\n<img width=\"1279\" height=\"225\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/199aed59-a7ee-4abb-bfe5-77a4ad02c928\" />\n\n### Steps to Reproduce\n\n1. Use Python runtime 3.13 on Azure Function (or create a venv with Python 3.13 locally)\n2. Write a function that includes `import logging` and calls `logging.debug`, `logging.info`, `logging.warn` or `logging.error`\n3. Deploy / start the function app\n4. Execute the function via its trigger\n5. Observe that no logs are output other than the `Executing ...` and `Executed ...` info logs\n\n### Relevant code being tried\n\n```shell\nimport logging\n\nimport azure.functions as func\n\napp = func.FunctionApp()\n\n\n@app.route(\n    route=\"demo_logs_missing\",\n    methods=[\"GET\"],\n    trigger_arg_name=\"_req\",\n)\ndef demo_logs_missing(_req: func.HttpRequest) -> func.HttpResponse:\n    logging.debug(\"Example debug log\")\n    logging.info(\"Example info log\")\n    logging.warning(\"Example warning\")\n    logging.error(\"Example error log\")\n    return func.HttpResponse(\"OK\")\n```\n\n### Relevant log output\n\n```shell\n\n```\n\n### requirements.txt file\n\n```shell\nazure-functions\n```\n\n### Where are you facing this problem?\n\nProduction Environment (explain below)\n\n### Function app name\n\n_No response_\n\n### Additional Information\n\n_No response_",
      "solution": "Hi @adamwhitneysoftwire, thanks for reporting. We've identified and fixed this issue - https://github.com/Azure/azure-functions-python-worker/pull/1745. The fix will be released as part of runtime version 4.1043, which is currently rolling out. ETA to reach all regions is end of September / early October. \n\n---\n\nHi @hallvictoria \n\nThe issue is not fixed fully yet. I am facing below issue where in logs part of **separate invocations are getting merged** and may be due to that additional logs of second invocation is stuck somewhere and not tracked with app insights at all.\n\n<img width=\"1012\" height=\"233\" alt=\"image\" src=\"https://github.com/user-attachments/assets/c8273d51-83bc-4cae-ad70-3cf0278bd105\" />\n\nImage Logs Explanation:\n1.) 3rd log is part of 1st invocation which adds item to Service Bus Queue.\n2.) First 2 logs are part of 2nd invocation which are part of Service Bus Queue Trigger.\n\n**Help to understand the exact issue and provide the fix for same.**\n\n_Note:- Same works totally fine with Python 3.12_\n\nThanks in advance.\n\n---\n\nHi @vigneshvaid, this is fixed by https://github.com/Azure/azure-functions-python-worker/pull/1811! It'll be present in host version 4.1046, which will start rolling out soon. Tentative ETA for release completion is February",
      "labels": [
        "bug",
        "python"
      ],
      "created_at": "2025-09-01T14:46:10Z",
      "closed_at": "2025-09-02T14:53:15Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1760",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1358,
      "title": "[BUG] Logging not working from other threads",
      "problem": "Reopenning #1158 because it's still broken in later versions:\r\n\r\n### Investigative information\r\nPython version: 3.10.11\r\nCore Tools Version: 4.0.5413\r\nFunction Runtime Version: 4.25.3.21264\r\n\r\n### Repro steps\r\ndispatch a function that uses logging to a background thread\r\n\r\n### Expected behavior\r\nThe logged text appears in the logs\r\n\r\n### Actual behavior\r\nThe text isn't logged\r\n\r\n#### Example:\r\n\r\n```\r\nimport logging\r\nfrom concurrent.futures import ThreadPoolExecutor\r\nimport azure.functions as func\r\n\r\ndef main(req: func.HttpRequest) -> func.HttpResponse:\r\n    logging.info('Python HTTP trigger function processed a request.')\r\n\r\n    with ThreadPoolExecutor() as pool:\r\n        pool.submit(foo)\r\n\r\n    return func.HttpResponse(\r\n        \"This HTTP triggered function executed successfully\",\r\n        status_code=200\r\n    )\r\n\r\n\r\ndef foo():\r\n    logging.info(\"Hello from foo\")\r\n    print(\"foo completed\")\r\n```\r\n\r\nWhen I trigger this, In the console I can see \"foo completed\" but not \"Hello from foo\".\r\n\r\n### Contents of the requirements.txt file:\r\nazure-functions==1.17.0",
      "solution": "Upon further investigation it looks like the\"fix\" was to pass to the client the responsibility of setting the thread's invocation_id which was the root cause.\r\n\r\n```\r\ndef thread_function(context: func.Context, message: int):\r\n    context.local_thread.invocation_id = context.invocation_id\r\n    logging.info(message)\r\n```\r\n\r\nBut this isn't a good solution, setting aside this is a runtime detail, we don't always control how the threads are created. For example when using the FastAPI framework which is what motivated the original issue. This is something the runtime should handle on its own.\n\n---\n\nI think I might be seeing something related to this. I'm working on a reproduction of the issue. With fastapi, a ContextVar set in a middleware sometimes disappears further down the request processing, specially if there's asyncio.gather on multiple async tasks. Running in uvicorn or gunicorn with many workers and threads doesn't cause the issue, but using AsgiMiddleware to wrap it in an azure function host does cause the failure. It appears the context gets lost. \n\n---\n\nThe reasoning behind the fix is that threads initiated by a user do not inherently contain a running event loop. Therefore, the worker validates whether threads have a running event loop; those lacking it will reference the local storage for that specific executing thread. To allow users access and distinguish these threads from other runtime threads, thread_local_storage has been exposed for safe usage.\r\n\r\nFor other runtime threads such as with `FastAPI`, this is a different issue with special cases. This issue here captures part of it: https://github.com/Azure-Samples/fastapi-on-azure-functions/issues/11\r\nwhich can be fixed by fetching the current logging instance as shown in the thread. But the logs will not be tracked properly in Application Insights. This highlights an issue in communicating with the host & App Insights - the logs are not properly being picked up and will require further investigation.",
      "labels": [
        "needs-investigation",
        "bug",
        "python"
      ],
      "created_at": "2023-11-20T15:28:25Z",
      "closed_at": "2026-01-05T15:44:02Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1358",
      "comments_count": 11
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1623,
      "title": "[Bug] Psycopg: Unable to connect in async mode with asyncio on Windows",
      "problem": "### Expected Behavior\n\nThe application should connect to the database without errors when running in async mode.\n\n### Actual Behavior\n\nThe application throws the error mentioned above and fails to connect.\n\n\n### Steps to Reproduce\n\n- Create a Python Azure Functions app structured with Blueprints.\n- Add asyncio logic and attempt to establish an async connection with Psycopg.\n- Run the app on Windows.\n\n### Relevant code being tried\n\n``\n```shell\nimport asyncio\nimport azure.functions as func\nimport datetime\nimport json\nimport logging\n\nfrom psycopg_pool import AsyncConnectionPool\n\napp=func.FunctionApp()\nasyncio.set_event_loop_policy(asyncio.WindowsSelectorEventLoopPolicy())\n\n@app.route(route=\"test\")\nasync def main(req: func.HttpRequest) -> func.HttpResponse:    \n  logging.info('Python HTTP trigger function processed a request.')   \n  # Database connection parameters    \n  conn_info = \"dbname=test user=testpassword=123 host=localhost port=5432\"    \n  try:        \n  pool = AsyncConnectionPool(conninfo=conn_info )        # Connect to the database       \n  async with pool.connection() as conn:            \n      async with conn.cursor() as cur:                # Execute the query                \n          await cur.execute(\"SELECT * FROM test LIMIT 1;\")                \n          row = await cur.fetchone()                # Process the result                \n          if row:                    \n              return func.HttpResponse(f\"Row: {row}\", status_code=200)                \n          else:                    \n              return func.HttpResponse(\"No rows found\", status_code=404)    \n  except Exception as e:        \n      logging.error(f\"Error: {e}\")        \n  return func.HttpResponse(f\"Error: {e}\", status_code=500)\n```\n\n### Relevant log output\n\n```shell\nerror connecting in 'pool-1': Psycopg cannot use the 'ProactorEventLoop' to run in async mode. Please use a compatible event loop, for instance by setting 'asyncio.set_event_loop_policy(WindowsSelectorEventLoopPolicy())'\n```\n\n### requirements.txt file\n\n```shell\nazure-functions==1.18.0\npsycopg-binary==3.2.3\npsycopg-pool==3.2.4\npsycopg==3.2.3\n```\n\n### Where are you facing this problem?\n\nLocal - Core Tools\n\n### Function app name\n\n_No response_\n\n### Additional Information\n\nI am facing an issue with my Python Azure Functions application (v2), which is structured using Blueprints. When I add asyncio to the application and try to run it on Windows, it throws the error mentioned above.\nI have tried the solution mentioned in various pages where the event loop policy is explicitly set as shown below:\n```\nimport asyncio\nasyncio.set_event_loop_policy(asyncio.WindowsSelectorEventLoopPolicy())\n```\nI have tried adding this in function_app.py but the issue persists. I am using python 3.11.\n\nI would appreciate any guidance on resolving this issue or insights into potential misconfigurations.",
      "solution": "hello, please let me know if the issue still exists.\n\n---\n\nClosing the issue as there no recent activity. Please reopen if the issue still exists.",
      "labels": [
        "bug",
        "needs-attention :wave:",
        "python"
      ],
      "created_at": "2024-12-17T04:23:14Z",
      "closed_at": "2025-02-10T16:34:02Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1623",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1815,
      "title": "[Bug] Worker failed to index functions",
      "problem": "### Expected Behavior\n\nI expected the worker to start without problems\n\n### Actual Behavior\n\nAfter deployment I could see an error in Application Insights. The python worker seems to be unable to start.\n\n\n### Steps to Reproduce\n\nMy test azure function works using the following:\nRuntime version: 4.1044.300.1\nPython 3.12\nopentelemetry-api in requirements.txt\n\nMy production azure function works using the following:\nRuntime version: 4.1045.100.0\nPython 3.12\nopentelemetry-api==1.24.0 in requirements.txt\n\nWhenever I change opentelemetry-api==1.24.0 to opentelemetry-api I receive the error below.\n\n### Relevant code being tried\n\n```shell\n\n```\n\n### Relevant log output\n\n```shell\nResult: Failure\nType: \nException: StopIteration: \nStack:   File \"/azure-functions-host/workers/python/3.12/LINUX/X64/azure_functions_worker/dispatcher.py\", line 485, in _handle__functions_metadata_request\n    self.load_function_metadata(\n  File \"/azure-functions-host/workers/python/3.12/LINUX/X64/azure_functions_worker/dispatcher.py\", line 465, in load_function_metadata\n    self.index_functions(function_path, function_app_directory)) \\\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/azure-functions-host/workers/python/3.12/LINUX/X64/azure_functions_worker/dispatcher.py\", line 847, in index_functions\n    indexed_functions = loader.index_function_app(function_path)\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/azure-functions-host/workers/python/3.12/LINUX/X64/azure_functions_worker/utils/wrappers.py\", line 44, in call\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/azure-functions-host/workers/python/3.12/LINUX/X64/azure_functions_worker/loader.py\", line 244, in index_function_app\n    imported_module = importlib.import_module(module_name)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/python/3/lib/python3.12/importlib/__init__.py\", line 90, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<frozen importlib._bootstrap>\", line 1387, in _gcd_import\n  File \"<frozen importlib._bootstrap>\", line 1360, in _find_and_load\n  File \"<frozen importlib._bootstrap>\", line 1331, in _find_and_load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 935, in _load_unlocked\n  File \"<frozen importlib._bootstrap_external>\", line 999, in exec_module\n  File \"<frozen importlib._bootstrap>\", line 488, in _call_with_frames_removed\n  File \"/home/site/wwwroot/function_app.py\", line 17, in <module>\n    from azure.monitor.opentelemetry import configure_azure_monitor\n  File \"/home/site/wwwroot/.python_packages/lib/site-packages/azure/monitor/opentelemetry/__init__.py\", line 7, in <module>\n    from azure.monitor.opentelemetry._configure import configure_azure_monitor\n  File \"/home/site/wwwroot/.python_packages/lib/site-packages/azure/monitor/opentelemetry/_configure.py\", line 10, in <module>\n    from opentelemetry.instrumentation.instrumentor import (  # type: ignore\n  File \"/home/site/wwwroot/.python_packages/lib/site-packages/opentelemetry/instrumentation/instrumentor.py\", line 26, in <module>\n    from opentelemetry.instrumentation._semconv import (\n  File \"/home/site/wwwroot/.python_packages/lib/site-packages/opentelemetry/instrumentation/_semconv.py\", line 19, in <module>\n    from opentelemetry.instrumentation.utils import http_status_to_status_code\n  File \"/home/site/wwwroot/.python_packages/lib/site-packages/opentelemetry/instrumentation/utils.py\", line 25, in <module>\n    from opentelemetry import context, trace\n  File \"/home/site/wwwroot/.python_packages/lib/site-packages/opentelemetry/context/__init__.py\", line 70, in <module>\n    _RUNTIME_CONTEXT = _load_runtime_context()\n                       ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/site/wwwroot/.python_packages/lib/site-packages/opentelemetry/context/__init__.py\", line 60, in _load_runtime_context\n    return next(  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n```\n\n### requirements.txt file\n\n```shell\n# Azure Functions\nazure-functions\nazure-storage-queue\nazure-storage-blob\n\n# Authentication\nPyJWT[crypto]\nrequests\n\n# Connections\naiohttp\n\n# JSON\nujson\n\n# Models\npydantic[email]\ncountry-converter\n\n# Snowflake\nsnowflake-connector-python>=3.7.0,<4.0.0\nsnowflake-sqlalchemy\n\n# OpenTelemetry and Application Insights\nazure-monitor-opentelemetry\nopentelemetry-instrumentation-logging\nopentelemetry-api\n```\n\n### Where are you facing this problem?\n\nProduction Environment (explain below)\n\n### Function app name\n\n_No response_\n\n### Additional Information\n\n_No response_",
      "solution": "I tried creating a 3.12 app on Premium (function runtime version 4.1045) with those dependencies & import statement, but I still wasn't able to reproduce the issue. \n\nHow are you deploying your app? I used Core Tools - `func azure functionapp publish`.\n\nThere weren't any Python worker updates from 4.1044 to 4.1045, so it doesn't seem likely that the host update version is the cause. If you're willing to [share your app name privately](https://github.com/Azure/azure-functions-host/wiki/Sharing-Your-Function-App-name-privately), we can also take a look from the backend to see if there are any errors.\n\n\n---\n\n> I tried creating a 3.12 app on Premium (function runtime version 4.1045) with those dependencies & import statement, but I still wasn't able to reproduce the issue.\n> \n> How are you deploying your app? I used Core Tools - `func azure functionapp publish`.\n> \n> There weren't any Python worker updates from 4.1044 to 4.1045, so it doesn't seem likely that the host update version is the cause. If you're willing to [share your app name privately](https://github.com/Azure/azure-functions-host/wiki/Sharing-Your-Function-App-name-privately), we can also take a look from the backend to see if there are any errors.\n\nI am using https://learn.microsoft.com/en-us/azure/devops/pipelines/tasks/reference/azure-function-app-v1?view=azure-pipelines for deployment.\n\nUTC execution time: Mon, 15 Dec 2025 07:13:13\nGUID: bddf70e0-6712-4b96-b5d6-1772a78452c3\nRegion: Norway East\n\nIs 404 the expected return status from https://github.com/Azure/azure-functions-host/wiki/Sharing-Your-Function-App-name-privately ?\n\n---\n\n> Is 404 the expected return status\n\nYep, thanks for that.\n\nTwo things to be called out here:\n\n- [Remote build](https://learn.microsoft.com/en-us/azure/azure-functions/functions-deployment-technologies?tabs=linux#remote-build) is not being used - [local builds](https://learn.microsoft.com/en-us/azure/azure-functions/functions-reference-python?tabs=get-started%2Casgi%2Capplication-level&pivots=python-mode-decorators#local-build) are okay but require your local / pipeline environment to match what is in production. Your app is running on Python 3.12, so you'll need to have an ubuntu image and use Python 3.12 to build the app ([example](https://learn.microsoft.com/en-us/azure/azure-functions/functions-how-to-azure-devops?tabs=python%2Clinux%2Ccontainer-apps&pivots=v1#example-yaml-build-pipelines-1)).\n- The exact exception is being thrown on [this line](https://github.com/open-telemetry/opentelemetry-python/blob/102fec2be1fe9d0a8e299598a21ad6ec3b96dcca/opentelemetry-api/src/opentelemetry/context/__init__.py#L60) - it's failing to load the context.\n\nCould you try deploying your app using remote build? You can use [Core Tools](https://learn.microsoft.com/en-us/azure/azure-functions/functions-run-local?tabs=linux%2Cisolated-process%2Cnode-v4%2Cpython-v2%2Chttp-trigger%2Ccontainer-apps&pivots=programming-language-python#project-file-deployment) or the [VSCode extension](https://learn.microsoft.com/en-us/azure/azure-functions/how-to-create-function-vs-code?pivot=programming-language-csharp&tabs=go%2Clinux&pivots=programming-language-csharp#deploy-the-project-to-azure) if you don't want to make any changes to your pipeline or deploy to a fresh app using remote build to narrow down if the issue is with the deployment pipeline.",
      "labels": [
        "bug",
        "python"
      ],
      "created_at": "2025-12-10T09:26:28Z",
      "closed_at": "2025-12-18T19:37:27Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1815",
      "comments_count": 10
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1613,
      "title": "Azure Blob trigger function AKS trigger issue",
      "problem": "I have a blob-triggered Azure function, which is deployed on AKS with keda scaling based on the blob entries.\nI used Azure/azure-functions-host#10624 to make each function accept only one blob item. The problem I have is that all created pods read the same file, but if I use queues-based triggers and scaling, different queue elements are read by different functions. According to my understanding, the blob trigger internally uses queues to do its tasks, so why is the behaviour different from having a blob trigger? \n\n_P.S.: I am moving the files to a different folder after the process is completed._\n\nhost.json\n```\n{\n  \"version\": \"2.0\",\n  \"logging\": {\n    \"applicationInsights\": {\n      \"samplingSettings\": {\n        \"isEnabled\": true,\n        \"excludedTypes\": \"Request\"\n      }\n    }\n  },\n  \"extensions\": {\n    \"blobs\": {\n      \"maxDegreeOfParallelism\": 1\n    }\n  },\n  \"extensionBundle\": {\n    \"id\": \"Microsoft.Azure.Functions.ExtensionBundle\",\n    \"version\": \"[4.*, 5.0.0)\"\n  }\n}\n```\n```\nhost: 2.0\n\"FUNCTIONS_WORKER_RUNTIME\": \"python\",\n\"AzureWebJobsFeatureFlags\": \"EnableWorkerIndex\",\n\"PYTHON_ISOLATE_WORKER_DEPENDENCIES\": \"1\",\n```\n```\nfrom blob_helper import initialize_blob_service_client,upload_dataframe_to_blob\nimport logging\napp = func.FunctionApp(http_auth_level=func.AuthLevel.ANONYMOUS)\n@app.function_name(name=\"PythonFunction\")\n@app.blob_trigger(\n    arg_name=\"myblob\", \n    path=\"sheets/input/{name}\",  # Blob path for trigger\n    connection=\"DataLakeConnectionString\"\n)\n```\n\nkeda\n```\napiVersion: keda.sh/v1alpha1\nkind: ScaledObject\nmetadata:\n  name: python-fuction-scaler\n  namespace: prod\nspec:\n  scaleTargetRef:\n    name: python-fuction \n  minReplicaCount: 0\n  maxReplicaCount: 10\n  triggers:\n    - type: azure-blob\n      metadata:\n        blobContainerName: \"sheets\"\n        blobPrefix: \"input\"\n        connectionFromEnv: \"DataLakeConnectionString\"\n        targetBlobCount: \"1\"\n      authenticationRef:\n        name: secrets\n```",
      "solution": "What I was able to find out was that each instance of the Azure Blob triggered function was creating a new queue and setting a lock in that, so is it possible to have a common queue for all? I think with that my issue should be solved.\n\n---\n\n@JAdluri, from what I am able to get from the documentation you attached, I can provide the\n```\nQueue Service URI (required for blob triggers2)\t<CONNECTION_NAME_PREFIX>__queueServiceUri\n```\nbut that will not help me with the issue I am facing.\n\nI want my blob-triggered function to know that a particular blob is already being read in another pod so it can read the next message in the blob.\n\nEg:\nCurrent behaviour:\nBlob name: Input_Files\nBlob1, Blob2, Blob3, Blob4..\n\nAKS pods:\nPod 1: triggers read Blob1 and creale Input_Files_12342 and locks the element in that queue\nPod 2: triggers read Blob1 and creale Input_Files_34342 and locks the element in that queue\n\nExpected behaviour:\nBlob name: Input_Files\nBlob1, Blob2, Blob3, Blob4..\n\nAKS pods:\nPod 1: triggers read Blob1 and creale Input_Files_12342 and locks the element in that queue\nPod 2: triggers read Blob1 find it already read, so read Blob2 and add it in Input_Files_34342 and locks the element in that queue\n\n",
      "labels": [
        "needs-attention :wave:"
      ],
      "created_at": "2024-11-21T13:16:02Z",
      "closed_at": "2025-12-17T19:34:29Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1613",
      "comments_count": 4
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1648,
      "title": "Deployment Error: teradatasqlalchemy Module Not Found on Azure",
      "problem": "I am experiencing a deployment issue with my Azure Function where the teradatasqlalchemy module is not recognized during deployment, despite working correctly locally. The error messages are as follows:\n`2025-03-07T09:51:43Z   [Error]   Failed to create engine: No module named 'teradatasqlalchemy.dialect'\n2025-03-07T09:51:43Z   [Error]   Teradata data fetch/store error: No module named 'teradatasqlalchemy.dialect'`\n\nLocal Setup: Everything works as expected.\nAzure Deployment:The error occurs during deployment.\n\nThe teradatasqlalchemy module should be correctly installed and recognized during Azure deployment, allowing the Azure Function to run without errors.\n\nAttempted Solutions\nVerified that teradatasqlalchemy is correctly listed in requirements.txt.\nAttempted to disable remote build by setting ENABLE_ORYX_BUILD = false and SCM_DO_BUILD_DURING_DEPLOYMENT = 0.\n\nAdditional Context\nThis issue seems related to how dependencies are handled during remote builds in Azure. Any assistance in resolving this would be greatly appreciated. \n\nSimilar Issue which was closed #1299 ",
      "solution": "Hi @Catastrophe1  , I tried the above solutions , didn't worked , have attached SS above.\n\n---\n\nHello @hallvictoria , thank you for your help. We worked with @Mikeflames , and the issue has now been resolved. Thanks again for your help and follow up on it.",
      "labels": [],
      "created_at": "2025-03-07T15:13:41Z",
      "closed_at": "2025-12-17T19:13:01Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1648",
      "comments_count": 11
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 911,
      "title": "[BUG] Support for ASGI startup events",
      "problem": "### Investigative information\r\n###### Please provide the following:\r\n\r\n\r\n- Timestamp: 2021-11-10T10:58:00\r\n- Function App name: (debugging locally)\r\n- Function name(s) (as appropriate):(debugging locally)\r\n- Core Tools version: 3.0.3785 Commit hash: db6fe71b2f05d09757179d5618a07bba4b28826f  (64-bit)\r\n\r\n### Repro steps\r\n###### Provide the steps required to reproduce the problem:\r\n\r\n1. Setup a new Function App, with an HTTP trigger and the following code in `func/__init__.py`:\r\n\r\n```python\r\nimport logging\r\n\r\nimport azure.functions as func\r\nfrom azure.functions import AsgiMiddleware\r\nfrom api_fastapi import app\r\n\r\nIS_INITED = False\r\n\r\n\r\ndef run_setup(app, loop):\r\n    \"\"\"Workaround to run Starlette startup events on Azure Function Workers.\"\"\"\r\n    global IS_INITED\r\n    if not IS_INITED:\r\n        loop.run_until_complete(app.router.startup())\r\n        IS_INITED = True\r\n\r\n\r\ndef main(req: func.HttpRequest, context: func.Context) -> func.HttpResponse:\r\n    asgi_middleware = AsgiMiddleware(app)\r\n    run_setup(app, asgi_middleware._loop)\r\n    return asgi_middleware.handle(req, context)\r\n\r\n```\r\n2. After the 1st request, you will get the following exception:\r\n\r\n```\r\n[2021-11-10T09:58:11.178Z] Executed 'Functions.api_az_function' (Failed, Id=50cbe047-48bd-42be-9314-0194c2e17ec9, Duration=65ms)\r\n[2021-11-10T09:58:11.181Z] System.Private.CoreLib: Exception while executing function: Functions.api_az_function. System.Private.CoreLib: Result: Failure\r\nException: RuntimeError: Task <Task pending name='Task-39' coro=<AsgiResponse.from_app() running at C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.8/WINDOWS/X64\\azure\\functions\\_http_asgi.py:65> cb=[_run_until_complete_cb() at C:\\Users\\User\\AppData\\Local\\Programs\\Python\\Python38\\lib\\asyncio\\base_events.py:184]> got Future <Future pending> attached to a different loop\r\n```\r\n### Expected behavior\r\n###### Provide a description of the expected behavior.\r\n\r\n- The Function should be able to fulfil any number of requests.\r\n\r\n### Actual behavior\r\n###### Provide a description of the actual behavior observed.\r\n\r\n- Because the AsgiMiddleware is instantiated for each call, the event loop is not reused and thus we get the exception.\r\n\r\n### Known workarounds\r\n###### Provide a description of any known workarounds.\r\n\r\n- Have a global AsgiMiddleware object as shown here:\r\n\r\n ```python\r\nimport logging\r\n\r\nimport azure.functions as func\r\nfrom azure.functions import AsgiMiddleware\r\nfrom api_fastapi import app\r\n\r\nIS_INITED = False\r\nASGI_MIDDLEWARE = AsgiMiddleware(app)\r\n\r\n\r\ndef run_setup(app, loop):\r\n    \"\"\"Workaround to run Starlette startup events on Azure Function Workers.\"\"\"\r\n    global IS_INITED\r\n    if not IS_INITED:\r\n        loop.run_until_complete(app.router.startup())\r\n        IS_INITED = True\r\n\r\n\r\ndef main(req: func.HttpRequest, context: func.Context) -> func.HttpResponse:\r\n    run_setup(app, ASGI_MIDDLEWARE._loop)\r\n    return ASGI_MIDDLEWARE.handle(req, context)\r\n\r\n ```\r\n\r\n### Contents of the requirements.txt file:\r\n###### Provide the requirements.txt file to help us find out module related issues.\r\n\r\n```txt\r\nazure-functions==1.7.2\r\nfastapi==0.70.0\r\n```\r\n",
      "solution": "After more digging in `azure.functions._http_asgi`, I managed to reuse the worker's event loop like this:\r\n\r\n```python\r\nimport logging\r\n\r\nimport azure.functions as func\r\nfrom azure.functions._http_asgi import AsgiResponse, AsgiRequest\r\nfrom api_fastapi import app\r\n\r\nIS_INITED = False\r\n\r\n\r\nasync def run_setup(app):\r\n    \"\"\"Workaround to run Starlette startup events on Azure Function Workers.\"\"\"\r\n    global IS_INITED\r\n    if not IS_INITED:\r\n        await app.router.startup()\r\n        IS_INITED = True\r\n\r\n\r\nasync def handle_asgi_request(req: func.HttpRequest, context: func.Context) -> func.HttpResponse:\r\n    asgi_request = AsgiRequest(req, context)\r\n    scope = asgi_request.to_asgi_http_scope()\r\n    asgi_response = await AsgiResponse.from_app(app, scope, req.get_body())\r\n    return asgi_response.to_func_response()\r\n\r\n\r\nasync def main(req: func.HttpRequest, context: func.Context) -> func.HttpResponse:\r\n    await run_setup(app)\r\n    return await handle_asgi_request(req, context)\r\n```\r\n\r\nIn [Improve throughput performance of Python apps in Azure Functions](https://docs.microsoft.com/en-us/azure/azure-functions/python-scale-performance-reference), it is recommended to define the `main `function as asynchronous.\r\n\r\nShouldn't this then be the preferred way to run ASGI applications?\n\n---\n\n> After more digging in `azure.functions._http_asgi`, I managed to reuse the worker's event loop like this:\r\n> \r\n> ```python\r\n> import logging\r\n> \r\n> import azure.functions as func\r\n> from azure.functions._http_asgi import AsgiResponse, AsgiRequest\r\n> from api_fastapi import app\r\n> \r\n> IS_INITED = False\r\n> \r\n> \r\n> async def run_setup(app):\r\n>     \"\"\"Workaround to run Starlette startup events on Azure Function Workers.\"\"\"\r\n>     global IS_INITED\r\n>     if not IS_INITED:\r\n>         await app.router.startup()\r\n>         IS_INITED = True\r\n> \r\n> \r\n> async def handle_asgi_request(req: func.HttpRequest, context: func.Context) -> func.HttpResponse:\r\n>     asgi_request = AsgiRequest(req, context)\r\n>     scope = asgi_request.to_asgi_http_scope()\r\n>     asgi_response = await AsgiResponse.from_app(app, scope, req.get_body())\r\n>     return asgi_response.to_func_response()\r\n> \r\n> \r\n> async def main(req: func.HttpRequest, context: func.Context) -> func.HttpResponse:\r\n>     await run_setup(app)\r\n>     return await handle_asgi_request(req, context)\r\n> ```\r\n> \r\n> In [Improve throughput performance of Python apps in Azure Functions](https://docs.microsoft.com/en-us/azure/azure-functions/python-scale-performance-reference), it is recommended to define the `main `function as asynchronous.\r\n> \r\n> Shouldn't this then be the preferred way to run ASGI applications?\r\n\r\nThis works for me too, but there is no way to perform the app global teardown operations (FastAPI shutdown event), since you have no hook on the running threadpool context of function worker.\r\n\r\nThis is dirty if you have some channel open (like an open AIOHttp session) :(\r\n\r\n**Note**: You have to put this:\r\n\r\n```python\r\n    global IS_INITED\r\n    if not IS_INITED:\r\n        await app.router.startup()\r\n        IS_INITED = True\r\n```\r\n\r\nwithin a thread lock in order to avoid races\n\n---\n\nI've run across a different issue with the AsgiMiddleware and arrived at basically the same solution as [posted above](https://github.com/Azure/azure-functions-python-worker/issues/911#issuecomment-965050632). I noticed that simple async functions do not behave as I would expect an async application should. For example, I tested the following:\r\n\r\n```\r\nfrom __app__.app import app\r\nimport azure.functions as func\r\nimport asyncio\r\nimport nest_asyncio\r\nnest_asyncio.apply() # as suggested in docs\r\n\r\n@app.get(\"/api/test\")\r\nasync def test(code: Optional[str] = None):\r\n    await asyncio.sleep(5)\r\n    return \"OK\"\r\n\r\nasync def main(req: func.HttpRequest, context: func.Context) -> func.HttpResponse:\r\n    return await AsgiMiddleware(app).handle(req, context)\r\n```\r\n\r\nIf you hit this endpoint above with a few concurrent requests, you'll notice that they execute serially instead of concurrently (I assume because the AsgiMiddleware blocks with a call to `run_until_complete` [here](https://github.com/Azure/azure-functions-python-library/blob/e06cfd105a93cf395b15995af568646b53a99c80/azure/functions/_http_asgi.py#L170)). E.g., if I hit this endpoint twice in rapid succession, the second request will take ~10 seconds to complete instead of ~5 seconds. \r\n\r\nUsing a plain azure function without the middleware works as expected (e.g., the above scenario completes in ~5 seconds with two concurrent requests):\r\n```\r\nasync def main(req: func.HttpRequest, context: func.Context) -> func.HttpResponse:\r\n    await asyncio.sleep(5)\r\n    return \"OK\"\r\n```\r\n\r\nAs mentioned, the [posted solution](https://github.com/Azure/azure-functions-python-worker/issues/911#issuecomment-965050632) resolves this, but I'm concerned about the implications of this as mentioned [above](https://github.com/Azure/azure-functions-python-worker/issues/911#issuecomment-1108144026). It would be great to see a robust solution for this in the near future if possible.\r\n",
      "labels": [
        "documentation"
      ],
      "created_at": "2021-11-10T10:08:49Z",
      "closed_at": "2025-12-17T17:58:03Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/911",
      "comments_count": 11
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1651,
      "title": "Cryptography module 44.0.0 causing error \"ImportError //lib/x86_64-linux-gnu/libc.so.6 /version `GLIBC_2.33' not found\"",
      "problem": "### **Background:**\n\nAzure python functions apps running python versions  3.11 and below using cryptography module 44.0.0 fail with error\n\nException:\nFull Exception : Exception while executing function /Functions.api ---> Microsoft.Azure.WebJobs.Script.Workers.Rpc.RpcException /Result /Failure Exception /ImportError //lib/x86_64-linux-gnu/libc.so.6 /version `GLIBC_2.33' not found (required by /home/site/wwwroot/.python_packages/lib/site-packages/cryptography/hazmat/bindings/_rust.abi3.so). Cannot find module. Please check the requirements.txt file for the missing module. For more info, please refer the troubleshooting guide /https://aka.ms/functions-modulenotfound.........................continued\n\n### **Root Cause:**\nAny Python function app, using azure-identity or any cryptography dependent module, built on the newest version of debian based system brings in a requirement of using GLIB_C version >= 2.33. Azure functions for python 3.11 and below are built on Bullseye with GLIB_C 2.31 is installed, and this causes a library-not-found issue.\n\n### **Mitigation:**\nMultiple approaches to mitigate:\n\n- Use Remote Build when deploying \nRetry performing the deployment using the Remote Build: https://learn.microsoft.com/en-us/azure/azure-functions/functions-deployment-technologies?tabs=windows#remote-build\n\n- Use older action image for azure pipelines and GitHub Action \n Azure Pipelines:  please change the vmImageName tag from \u201cubuntu-latest\u201d to \u201cubuntu-20.04\u201d for your yaml file- please refer to https://learn.microsoft.com/en-us/azure/devops/pipelines/agents/hosted?view=azure-devops&tabs=yaml#software \nGitHub Actions: please change the runs-on tag from \u201cubuntu-latest\u201d to \u201cubuntu-20.04\u201d for your yaml file- please refer to https://docs.github.com/en/actions/using-github-hosted-runners/using-github-hosted-runners/about-github-hosted-runners#supported-runners-and-hardware-resources\n\n- For local build , please use Ubuntu 20.04 or any Debian 11 based image when doing a zip-deploy.\n[to be used only if 1 and 2 cannot be done] If you use azure-identity or any library leveraging azure-identity module\n \n- Please pin the cryptography library to cryptography==43.0.3. After making this change, redeploy your app. For more details, refer to azure-sdk-for-python/issues/38725\n\n### **Recommendation / Long-term Solution:**\nThe official recommendation is to migrate to Python 3.12, which is currently in preview. The Python 3.12 image is built on Bookworm, and it brings in a later version of GLIB_C. Thus, the latest versions of cryptography are supported when using Python 3.12.\n\nThe ETA for 3.12 GA is the end of March 2025.",
      "solution": "Is there an ETA for this? We are already in production with the second mitigation you proposed: using an older action image for Azure Pipelines.\n\nBut with Ubuntu-20 expiring on April 1st, we need a resolution soon. Any updates?\n\n---\n\nSolved installing in requirements.txt:\n\ncryptography==43.0.3\n\n\n\n---\n\nGiven that 3.12 looks like the solution here, are there any plans to actually be able to change language version in a consumption plan function?\n\nAccording to [this](https://learn.microsoft.com/en-us/azure/azure-functions/functions-reference-python?tabs=get-started%2Casgi%2Capplication-level&pivots=python-mode-decorators#python-version) it's not supported to change the language version in consumption plan and redeploying is far from ideal.",
      "labels": [
        "announcement"
      ],
      "created_at": "2025-03-12T14:55:40Z",
      "closed_at": "2025-12-17T16:46:33Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1651",
      "comments_count": 18
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1808,
      "title": "Azure Function App (Python 3.11 on Linux) stopped detecting all functions after Flex Consumption update \u2013 even Basic plan does not work",
      "problem": "Hi everyone,\n\nI\u2019m running into a blocking issue with a Python 3.11 Azure Function App on Linux.\n\nUntil this week my Function App contained three HTTP-triggered Python functions and everything worked perfectly. After Microsoft rolled out the new Flex Consumption infrastructure, the Azure Portal suddenly shows no functions at all. The \u201cFunctions\u201d blade is completely empty and the runtime no longer detects any triggers.\n\nTo troubleshoot I tried the following:\n\nStayed on Flex Consumption \u2192 no functions detected\n\nSwitched to a Basic App Service Plan \u2192 still no functions detected\n\nTested both folder structures:\n\nA single function_app.py at the root\n\nEach function in its own folder with __init__.py + function_app.py\n\nRedeployed multiple times (ZIP deploy, VS Code deploy, GitHub Actions)\n\nConfirmed Python version is still 3.11\n\nCreated a completely new Function App \u2192 same issue\n\nStill, the runtime loads zero functions, not even a minimal test like \u201cping\u201d.\n\nMy questions:\n\nWhat is the correct folder structure for Python on Linux now?\nHas Microsoft changed the requirements with the new Flex Consumption rollout?\n\nWhich setting could cause the Python worker to stop scanning for functions?\n(e.g. WEBSITE_RUN_FROM_PACKAGE, worker version, app settings\u2026)\n\nAre there known issues with Python on the new Flex Consumption plan?\n\nWhy does the same code also fail to load under a Basic plan?\nI\u2019m fine running my Function App on Basic if that solves it \u2014 I just want the runtime to detect the functions again.\n\nCan someone provide a minimal working folder layout for a Python 3.11 HTTP-triggered Function (Linux), valid today?\n\nContext:\n\nLanguage: Python 3.11\n\nOS: Linux\n\nPlan tried: Flex Consumption (new model) \u2192 not working, Basic \u2192 also not working\n\nDeployment: ZIP deploy (no Docker)\n\nPreviously working code now loads 0 functions according to the portal and runtime logs.\n\nAny help or a minimal working example is highly appreciated.\n\nThank you!",
      "solution": "Hi @insitelyEU, thanks for reporting.\n\nAre you seeing any specific errors from the logs or App Insights? If you're willing to [share your app name privately](https://github.com/Azure/azure-functions-host/wiki/Sharing-Your-Function-App-name-privately), we can also take a look on the backend.\n\n> After Microsoft rolled out the new Flex Consumption infrastructure\n\nFlex Consumption has been out for over a year now. What rollout are you referring to?\n\nTo answer your questions:\n\n> What is the correct folder structure for Python on Linux now? / Has Microsoft changed the requirements with the new Flex Consumption rollout?\n\nWe recommend using the V2 programming model. The folder structure is documented [here](https://learn.microsoft.com/en-us/azure/azure-functions/functions-reference-python?tabs=get-started%2Casgi%2Capplication-level&pivots=python-mode-decorators#folder-structure). There should only be a single `function_app.py` file - mixing V1 programming model (`init.py` + `function.json`) and V2 (`function_app.py`) is not supported. The project structure is the same across all plans.\n\n> Which setting could cause the Python worker to stop scanning for functions? / Are there known issues with Python on the new Flex Consumption plan? / Why does the same code also fail to load under a Basic plan?\n\nThe function app will have the same behavior across all plans. In this scenario, since the app fails on both Flex and Basic, the issue is most likely the app package itself. A couple of things you can check:\n- Are the app dependencies being built on Python 3.11 on a Linux OS? If there's a mismatch in the platform that the dependencies were built on (eg, if they were built using 3.12 and Windows), then there could be issues in loading the functions. For simplicity, I'd recommend using [remote build](https://learn.microsoft.com/en-us/azure/azure-functions/functions-deployment-technologies?tabs=linux#remote-build) to build the dependencies. You can run `func azure functionapp publish` from Core Tools to build and deploy the app easily.\n- You mentioned deploying using Zip Deploy to Flex Consumption - I'm assuming you mean [One Deploy](https://learn.microsoft.com/en-us/azure/azure-functions/functions-deployment-technologies?tabs=windows#one-deploy)?\n- You can verify if the function loads and executes successfully locally using [Core Tools](https://learn.microsoft.com/en-us/azure/azure-functions/functions-run-local?tabs=windows%2Cisolated-process%2Cnode-v4%2Cpython-v2%2Chttp-trigger%2Ccontainer-apps&pivots=programming-language-python).\n\n> Can someone provide a minimal working folder layout for a Python 3.11 HTTP-triggered Function (Linux), valid today?\n\n- [HTTP trigger tutorial](https://github.com/Azure-Samples/functions-quickstart-python-http-azd)\n- [Samples using other triggers](https://learn.microsoft.com/en-us/samples/azure-samples/azure-functions-flex-consumption-samples/azure-functions-flex-consumption-samples/)\n- [Tutorial with different ways to deploy to a flex app](https://learn.microsoft.com/en-us/azure/azure-functions/flex-consumption-how-to?tabs=azure-cli%2Ccore-tools&pivots=programming-language-python#deploy-your-code-project)\n\n",
      "labels": [
        "needs-author feedback"
      ],
      "created_at": "2025-11-30T15:37:45Z",
      "closed_at": "2025-12-17T16:40:05Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1808",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1496,
      "title": "[BUG] Init Indexing leads to exception being not outputted on timeout ",
      "problem": "<!--\r\nBefore creating a new issue, please check if the issue already exists in the [open issues panel](https://github.com/Azure/azure-functions-python-worker/issues?q=is%3Aissue+is%3Aopen) and please check the [Troubleshooting Guides](https://github.com/Azure/azure-functions-python-worker/wiki#troubleshooting-guides) in our wiki.\r\nPlease describe your issue or feature request below.\r\n-->\r\n\r\n### Investigative information\r\n###### Please provide the following:\r\n- Timestamp:\r\nstarted around may 10 20:43 UTC\r\n- Function App name:\r\nprd-modelo-preditivo(staging)\r\nhml-modelo-preditivo(staging)\r\n\r\n\r\n\r\n### Repro steps\r\n###### Provide the steps required to reproduce the problem:\r\nNo repro at the moment, but basically since the push out of :\r\nPYTHON_ENABLE_INIT_INDEXING \r\n\r\nWe have seen an issue that has led to the exceptions during init leading to ten second timeout between host and language worker prevents logging of the exception causing the problem during this step.  Which leads to confusion on why a failure may be occuring during startup of the language worker. \r\n\r\n\r\n<html>\r\n<body>\r\n<!--StartFragment--><span><span class=\"ui-provider a b c d e f g h i j k l m n o p q r s t u v w x y z ab ac ae af ag ah ai aj ak\" dir=\"ltr\"><p>Indexing times using old indexing</p><p>&nbsp;</p>\r\npercentile_AverageTime_30 | percentile_AverageTime_50 | percentile_AverageTime_75 | percentile_AverageTime_90 | percentile_AverageTime_95 | percentile_AverageTime_99\r\n-- | -- | -- | -- | -- | --\r\n16.5 | 16.5 | 16.6 | 21.406 | 21.406 | 21.406\r\n\r\n<p>&nbsp;</p></span></span><!--EndFragment-->\r\n</body>\r\n</html>\r\n\r\n### Expected behavior\r\nMetadata call during Indexing should occur while if a timeout happens, it will return the exception that occurred during this time that leads to the timeout and log that exception as well.\r\n\r\n### Actual behavior\r\nOnly a timeout exception is shown\r\nSystem.TimeoutException : The operation has timed out.    at Microsoft.Azure.WebJobs.Script.Grpc.GrpcWorkerChannel.PendingItem.OnTimeout() at /src/azure-functions-host/src/WebJobs.Script.Grpc/Channel/GrpcWorkerChannel.cs : 1764\r\n\r\nWhile the captured exception isn't logged out during indexing.\r\n\r\n\r\n### Known workarounds\r\n###### Provide a description of any known workarounds.\r\nPYTHON_ENABLE_INIT_INDEXING  = 0 in app settings will allow you to see the real exception of the failure\r\n\r\n\r\n\r\n### Contents of the requirements.txt file:\r\n###### Provide the requirements.txt file to help us find out module related issues.\r\nn/a\r\n\r\n### Related information\r\n###### Provide any related information\r\n(https://github.com/Azure/azure-functions-python-worker/blob/5bc5d39efffe86da25cacdf7d612a2bc03b32ec3/azure_functions_worker/constants.py#L68C32-L68C59)\r\n\r\nICM # 503543832\r\n\r\n<details>\r\n<summary>Source</summary>\r\n\r\n\r\n</details>\r\n-->\r\n",
      "solution": "This has been fixed with https://github.com/Azure/azure-functions-python-worker/pull/1632 and https://github.com/Azure/azure-functions-python-worker/pull/1666.\n\nNow, the `init_request` timeout has been increased to match `metadata_request` and the init indexing logic has been refactored. It will now explicitly fail the `WorkerInit` request if an exception occurs & the exception is logged to console for local running and App Insights for production.\n\nClosing as the fix has been released, but please feel free to reopen if there are still issues or questions!",
      "labels": [],
      "created_at": "2024-05-15T00:42:10Z",
      "closed_at": "2025-12-16T21:27:55Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1496",
      "comments_count": 1
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1165,
      "title": "[BUG] Azure Functions Python Worker does not report errors during function startup",
      "problem": "We have encountered an issue when using version 4 of the azure-functions-python-worker package. \r\n\r\nThe problem occured when the python function crashed during startup, due to an import error, which was breaking our code.\r\n\r\nIn this case, there is no error message in the azure logs. This makes it very difficult to identify the reason for the crash and debug it.\r\n\r\nOne sign of this issue is when the \"Syncing triggers...\" action fails during deployment after multiple retries. \r\n\r\nAnother sign is receiving a \"no functions found\" warning that has nothing to do with the error.\r\n\r\nTo reproduce the bug, you can create any function that has an import error, syntax error or any other error that prevents the function from starting.\r\n\r\nThe fundamental issue seems to be that there is no direct access to the python runtime where the app lives. The only deployment option for the \"consumption\" plan is ZipDeploy that builds everything in a separate environment and then transfers the files to the actual azure function environment. We accidentally managed to find the actual bug in the code that was crashing the function when we decided to use a custom docker image for our azure function app after all our previous debugging attempts failed. Inside the docker container, we executed the \"func start\" during build time just to test if it's working and that's where we saw the import error.\r\n\r\nWe believe that the azure logging should report the function crash in the same way that running it in the console locally does. This would greatly improve the debugging experience for developers.\r\n\r\nWe hope that this issue can be addressed in a future release of the azure-functions-python-worker package.",
      "solution": "Hi @sapountzis  It's great that you have provided all the details about the bug and also suggested a workaround for it. This will help the Azure team to reproduce the bug and fix it in the future. will update you soon on this.\n\n---\n\nReproduction example\r\n\r\n```python\r\nimport azure.functions as func\r\nimport logging\r\nimport not_existing_package\r\n\r\napp = func.FunctionApp()\r\n\r\n\r\n@app.function_name(name='test_func')\r\n@app.schedule(schedule='0 10 4 * * *', arg_name='timer', run_on_startup=False, use_monitor=False)\r\nasync def test_func(timer: func.TimerRequest) -> None:\r\n    logging.warning('hello')\r\n```\r\n\r\nTry this in the cloud and see if you get anything in the logs\n\n---\n\nWe would also love this bug to be fixed. We circumvented the problem by adding a script that calls the function_app.py module directly with the python binary to print the stack trace when it can not start.",
      "labels": [
        "Needs: Triage :mag:",
        "console-logging"
      ],
      "created_at": "2023-01-20T11:52:34Z",
      "closed_at": "2025-12-16T15:47:08Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1165",
      "comments_count": 8
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1094,
      "title": "ModuleNotFoundError: No module named '__main__'",
      "problem": "# Announcement\r\nWe have identified an issue with a subset of python functions apps which have imported libraries like python-dotenv are seeing an error with functions runtime 4.9.1 and above. \r\n\r\nThe function apps are failing with the following error:\r\n```python\r\n`Microsoft.Azure.WebJobs.Host.FunctionInvocationException : \r\nException while executing function: Functions.HttpTrigger ---> Microsoft.Azure.WebJobs.Script.Workers.Rpc.RpcException : \r\nResult: Failure Exception: ModuleNotFoundError: No module named '__main__' \r\nStack: \r\nFile '/azure-functions-host/workers/python/3.9/LINUX/X64/azure_functions_worker/dispatcher.py', line 448, in _handle__invocation_request call_result = await self._loop.run_in_executor( \r\nFile '/usr/local/lib/python3.9/concurrent/futures/thread.py', line 58, in run result = self.fn(*self.args, **self.kwargs) \r\nFile '/azure-functions-host/workers/python/3.9/LINUX/X64/azure_functions_worker/dispatcher.py', line 691, in _run_sync_func return ExtensionManager.get_sync_invocation_wrapper(context, \r\nFile '/azure-functions-host/workers/python/3.9/LINUX/X64/azure_functions_worker/extension.py', line 215, in _raw_invocation_wrapper result = function(**args) \r\nFile '/home/site/wwwroot/HttpTrigger/__init__.py', line 8, in main return func.HttpResponse(f'Dotenv: {load_dotenv(find_dotenv())}') \r\nFile '/home/site/wwwroot/.python_packages/lib/site-packages/dotenv/main.py', line 284, in find_dotenv if usecwd or _is_interactive() or getattr(sys, 'frozen', False): \r\nFile '/home/site/wwwroot/.python_packages/lib/site-packages/dotenv/main.py', line 281, in _is_interactive main = __import__('__main__', None, None, fromlist=['__file__']) `\r\n```\r\n ## Mitigation\r\nAdd the app setting PYTHON_ISOLATE_WORKER_DEPENDENCIES to 0 as described in the documentation [here](https://docs.microsoft.com/en-us/azure/azure-functions/functions-app-settings#python_isolate_worker_dependencies-preview)\r\n\r\n## Fix\r\nThe fix is being rolled out and will be available in runtime versions 1.10.2 and higher.\r\n\r\n",
      "solution": "> > I am still seeing this on uk-south premium plan. Combined with #1050 this issue blocks use of Tensorflow and Dill on Azure Functions.\r\n> \r\n> @drewsilcock Have you enabled PYTHON_ISOLATE_WORKER_DEPENDENCIES in your app settings? Also, could you share your requirements.txt?\r\n\r\nI have `PYTHON_ISOLATE_WORKER_DEPENDENCIES` set to `1` as a necessary step to fixing issues https://github.com/Azure/azure-functions-python-worker/issues/1217 and https://github.com/Azure/azure-functions-python-worker/issues/1050.\r\n\r\nI can since figured out a hacky workaround for this issue that doesn't require setting `PYTHON_ISOLATE_WORKER_DEPENDENCIES` to `0`, which is simply to create the file `__main__.py` in the folder of my function and then put\r\n\r\n```python\r\nimport os\r\nimport path\r\nsys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__))))\r\n```\r\n\r\nat the top of the `__init__.py` for the function - this unblocks me from being able to use these libraries, but obviously isn't an ideal solution.\r\n\r\nFor reference, `requirements.txt`:\r\n\r\n```requirements.txt\r\nabsl-py==1.4.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\naiohttp==3.8.4 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\naiosignal==1.3.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nalembic==1.10.4 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nastunparse==1.6.3 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nasync-cache==1.1.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nasync-timeout==4.0.2 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nattrs==23.1.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nazure-core==1.26.4 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nazure-cosmos==4.3.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nazure-eventhub==5.11.2 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nazure-functions==1.13.3 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nazure-storage-blob==12.16.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nbinaryornot==0.4.4 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ncachetools==5.3.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ncertifi==2022.12.7 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ncffi==1.15.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nchardet==5.1.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ncharset-normalizer==3.1.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nclick==8.1.3 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ncloudpickle==2.2.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ncolorama==0.4.6 ; python_version >= \"3.9\" and python_version < \"3.10\" and platform_system == \"Windows\"\r\ncomtrade==0.0.10 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ncontourpy==1.0.7 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ncryptography==40.0.2 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ncycler==0.11.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ndatabricks-cli==0.17.6 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ndecorator==5.1.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ndill==0.3.4 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ndm-tree==0.1.8 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ndocker==6.0.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nentrypoints==0.4 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nflask==2.2.3 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nflatbuffers==23.3.3 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nfonttools==4.39.3 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nfrozenlist==1.3.3 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ngast==0.4.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ngitdb==4.0.10 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ngitpython==3.1.31 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ngoogle-auth-oauthlib==1.0.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ngoogle-auth==2.17.3 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ngoogle-pasta==0.2.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ngreenlet==2.0.2 ; python_version >= \"3.9\" and platform_machine == \"aarch64\" and python_version < \"3.10\" or python_version >= \"3.9\" and platform_machine == \"ppc64le\" and python_version < \"3.10\" or python_version >= \"3.9\" and platform_machine == \"x86_64\" and python_version < \"3.10\" or python_version >= \"3.9\" and platform_machine == \"amd64\" and python_version < \"3.10\" or python_version >= \"3.9\" and platform_machine == \"AMD64\" and python_version < \"3.10\" or python_version >= \"3.9\" and platform_machine == \"win32\" and python_version < \"3.10\" or python_version >= \"3.9\" and platform_machine == \"WIN32\" and python_version < \"3.10\"\r\ngrpcio==1.54.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ngunicorn==20.1.0 ; python_version >= \"3.9\" and python_version < \"3.10\" and platform_system != \"Windows\"\r\nh5py==3.8.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nidna==3.4 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nimportlib-metadata==5.2.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nimportlib-resources==5.12.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nisodate==0.6.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nitsdangerous==2.1.2 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\njax==0.4.8 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\njinja2==3.1.2 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\njoblib==1.2.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nkeras==2.12.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nkiwisolver==1.4.4 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nlibclang==16.0.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nmako==1.2.4 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nmarkdown==3.4.3 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nmarkupsafe==2.1.2 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nmatplotlib==3.7.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nml-dtypes==0.1.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nmlflow==1.30.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nmultidict==6.0.4 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nnumpy==1.23.5 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\noauthlib==3.2.2 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nopt-einsum==3.3.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\npackaging==21.3 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\npandas==1.5.3 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\npillow==9.5.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nplotly==5.14.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nprometheus-client==0.16.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nprometheus-flask-exporter==0.22.3 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nprotobuf==4.22.3 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\npsycopg-binary==3.1.8 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\npsycopg-c==3.1.8 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\npsycopg-pool==3.1.7 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\npsycopg[c,pool]==3.1.8 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\npyasn1-modules==0.3.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\npyasn1==0.5.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\npycparser==2.21 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\npydantic==1.10.7 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\npydantic[dotenv]==1.10.7 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\npyjwt==2.6.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\npyparsing==3.0.9 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\npython-dateutil==2.8.2 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\npython-dotenv==1.0.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\npytz==2022.7.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\npywin32==306 ; python_version >= \"3.9\" and python_version < \"3.10\" and sys_platform == \"win32\"\r\npyyaml==6.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nquerystring-parser==1.2.4 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nredis==4.5.4 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nrequests-oauthlib==1.3.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nrequests==2.28.2 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nrsa==4.9 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nscikit-learn==1.0.2 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nscipy==1.10.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nsetuptools==67.7.2 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nsix==1.16.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nsmmap==5.0.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nsqlalchemy==1.4.47 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nsqlparse==0.4.4 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ntabulate==0.9.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ntenacity==8.2.2 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ntensorboard-data-server==0.7.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ntensorboard-plugin-wit==1.8.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ntensorboard==2.12.2 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ntensorflow-estimator==2.12.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ntensorflow-io-gcs-filesystem==0.32.0 ; python_version >= \"3.9\" and python_version < \"3.10\" and platform_machine != \"arm64\" or python_version >= \"3.9\" and python_version < \"3.10\" and platform_system != \"Darwin\"\r\ntensorflow-probability==0.18.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ntensorflow==2.12.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ntermcolor==2.3.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nthreadpoolctl==3.1.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ntqdm==4.65.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ntyping-extensions==4.5.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\ntzdata==2023.3 ; python_version >= \"3.9\" and python_version < \"3.10\" and sys_platform == \"win32\"\r\nurllib3==1.26.15 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nwaitress==2.1.2 ; python_version >= \"3.9\" and python_version < \"3.10\" and platform_system == \"Windows\"\r\nwebsocket-client==1.5.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nwerkzeug==2.2.3 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nwheel==0.40.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nwrapt==1.14.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nxarray==0.21.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nyarl==1.9.1 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\nzipp==3.15.0 ; python_version >= \"3.9\" and python_version < \"3.10\"\r\n```\n\n---\n\n> I can since figured out a hacky workaround for this issue that doesn't require setting `PYTHON_ISOLATE_WORKER_DEPENDENCIES` to `0`, which is simply to create the file `__main__.py` in the folder of my function and then put\n> \n> import os\n> import path\n> sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__))))\n> at the top of the `__init__.py` for the function - this unblocks me from being able to use these libraries, but obviously isn't an ideal solution.\n> \n\nThank you for sharing your solution! Your solution fixed the same issue but for a different Python module on my local dev environment running Azure Functions Python 3.14, `rlcompleter` used by the `torch` module. Setting `PYTHON_ISOLATE_WORKER_DEPENDENCIES=0` (or `1` for that matter) did not resolve the issue.\n\nInstead of adding the lines of code you mentioned in `__init.py__` for one of my functions, I created  `__init.py__` and `__main__.py` in the root directory and added the lines of code in the root directory `__init.py__`. This fix worked for all functions that is importing `torch`, the problematic module. I'm using Azure Functions Python v1 programming model. \n\nIt's an odd error that isn't an issue on Azure Functions Python 3.13.\n\nHere's the error message for anyone curious\n\n```log\n ---> Microsoft.Azure.WebJobs.Script.Workers.Rpc.RpcException: Result: Failure\nType: \nException: ModuleNotFoundError: No module named '__main__'. Cannot find module. Please check the requirements.txt file for the missing module. For more info, please refer the troubleshooting guide: https://aka.ms/functions-modulenotfound. Current sys.path: /home/site/wwwroot/.python_packages/lib/site-packages /azure-functions-host/workers/python/3.14/LINUX/X64 /opt/python/3/lib/python314.zip /opt/python/3/lib/python3.14 /opt/python/3/lib/python3.14/lib-dynload /opt/python/3/lib/python3.14/site-packages /home/site/wwwroot\nStack:   File \"/azure-functions-host/workers/python/3.14/LINUX/X64/azure_functions_runtime_v1/handle_event.py\", line 118, in function_load_request\n    func = load_function(\n  File \"/azure-functions-host/workers/python/3.14/LINUX/X64/azure_functions_runtime_v1/utils/wrappers.py\", line 50, in call\n    raise extend_exception_message(e, message)\n  File \"/azure-functions-host/workers/python/3.14/LINUX/X64/azure_functions_runtime_v1/utils/wrappers.py\", line 46, in call\n    return func(*args, **kwargs)\n  File \"/azure-functions-host/workers/python/3.14/LINUX/X64/azure_functions_runtime_v1/loader.py\", line 94, in load_function\n    mod = importlib.import_module(fullmodname)\n  File \"/opt/python/3/lib/python3.14/importlib/__init__.py\", line 88, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n  File \"/home/site/wwwroot/GetInquiryRecommendationsV2/__init__.py\", line 13, in <module>\n    from src.shared import tre\n  File \"/home/site/wwwroot/src/shared/tre.py\", line 9, in <module>\n    import torch\n  File \"/home/site/wwwroot/.python_packages/lib/site-packages/torch/__init__.py\", line 2161, in <module>\n    from torch import _VF as _VF, functional as functional  # usort: skip\n  File \"/home/site/wwwroot/.python_packages/lib/site-packages/torch/functional.py\", line 8, in <module>\n    import torch.nn.functional as F\n  File \"/home/site/wwwroot/.python_packages/lib/site-packages/torch/nn/__init__.py\", line 8, in <module>\n    from torch.nn.modules import *  # usort: skip # noqa: F403\n  File \"/home/site/wwwroot/.python_packages/lib/site-packages/torch/nn/modules/__init__.py\", line 1, in <module>\n    from .module import Module  # usort: skip\n  File \"/home/site/wwwroot/.python_packages/lib/site-packages/torch/nn/modules/module.py\", line 17, in <module>\n    from torch.utils._python_dispatch import is_traceable_wrapper_subclass\n  File \"/home/site/wwwroot/.python_packages/lib/site-packages/torch/utils/__init__.py\", line 8, in <module>\n    from torch.utils import (\n  File \"/home/site/wwwroot/.python_packages/lib/site-packages/torch/utils/data/__init__.py\", line 1, in <module>\n    from torch.utils.data.dataloader import (\n  File \"/home/site/wwwroot/.python_packages/lib/site-packages/torch/utils/data/dataloader.py\", line 23, in <module>\n    import torch.distributed as dist\n  File \"/home/site/wwwroot/.python_packages/lib/site-packages/torch/distributed/__init__.py\", line 3, in <module>\n    import pdb\n  File \"/opt/python/3/lib/python3.14/pdb.py\", line 103, in <module>\n    from rlcompleter import Completer\n  File \"/opt/python/3/lib/python3.14/rlcompleter.py\", line 37, in <module>\n    import __main__\n```\n\nEdit 12/12/25:\nActually simply creating `__main__.py` in the root directory fixed the issue.",
      "labels": [
        "announcement"
      ],
      "created_at": "2022-08-23T22:41:15Z",
      "closed_at": "2023-12-21T16:25:14Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1094",
      "comments_count": 6
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1809,
      "title": "Function app freezes when receiving POST request larger than about 2 million characters (locally) on python 3.13",
      "problem": "## Setup\nWhen I run my Azure function app locally via `func start` in PowerShell I try to send a POST request to an endpoint I created. The POST request simply consists of one key and its value with more than about 2 million random alphanumeric characters. \n\n`function_app.py`\n```python\nimport azure.functions as func\nimport json\nimport logging\n\napp = func.FunctionApp()\n\n@app.route(\"test\",methods=[\"POST\"])\ndef test(req: func.HttpRequest) -> func.HttpResponse:\n    logging.info(\"Processing request at /test endpoint.\")\n\n    try:\n        return func.HttpResponse(\n            json.dumps(\"Received document successfully.\"),\n            status_code=200,\n            mimetype=\"application/json\"\n        )\n    \n    except ValueError:\n        return func.HttpResponse(\n            \"Invalid JSON payload.\",\n            status_code=400\n        )\n    except Exception as e:\n        logging.error(f\"Unexpected error: {e}\")\n        return func.HttpResponse(\n            \"Internal server error.\",\n            status_code=500\n        )\n```\n\n`test.py`\n```python\nimport requests\nimport random\nimport string\n\nrnd = ''.join(random.choices(string.ascii_letters + string.digits, k=2_500_000))\nprint(len(rnd))\n\ndata = {\"base64_document\": rnd}\n\nresponse = requests.post(\"http://localhost:7071/api/test\", json=data)\nprint(response.status_code)\n\n```\n## Problem\nNow when I run `func start` and after that `python test.py` I get the output in the log\n\n```\n'local.settings.json' found in root directory (REDACTED).\nResolving worker runtime to 'python'.\nFound Python version 3.13.9 (python3).\nAzure Functions Core Tools\nCore Tools Version:       4.5.0+e74aae22c9630777c9f58354f290a6e214218546 (64-bit)\nFunction Runtime Version: 4.1044.400.25520\n[2025-11-30T06:02:59.501Z] Worker process started and initialized.\nFunctions:\n        test: [POST] http://localhost:7071/api/test\nFor detailed output, run func with --verbose flag.\n[2025-11-30T06:03:17.837Z] Worker process started and initialized.\n[2025-11-30T06:03:23.816Z] Executing 'Functions.test' (Reason='This function was programmatically called via the host APIs.', Id=ca3951a9-cb7a-41ea-9267-edb2367ba261)\n[2025-11-30T06:13:23.834Z] Timeout value of 00:10:00 exceeded by function 'Functions.test' (Id: 'ca3951a9-cb7a-41ea-9267-edb2367ba261'). Initiating cancellation.\n[2025-11-30T06:13:23.843Z] Executed 'Functions.test' (Failed, Id=ca3951a9-cb7a-41ea-9267-edb2367ba261, Duration=600076ms)\n[2025-11-30T06:13:23.844Z] Microsoft.Azure.WebJobs.Host: Timeout value of 00:10:00 was exceeded by function: Functions.test.\n```\n\nbut nothing after that. **It runs for a 10 minutes (the timeout duration I set) and eventually gives me a 500 or 504.**\n\nI have tried all configurations for my `host.json` and `local.settings.json` I could find and change them to the maximum values but that did not fix my problem. \n\nThis problem should be easily reproducible though because the problem also occurs with the default settings and the provided code when running on python version 3.13. Does anyone have an idea how to fix this without changing the request data type (like multipart) or chunking?  \n \nI tested out different python versions and it seems to be an issue exclusive to python 3.13 (I tested 3.13.9, 3.13.8, 3,12.12, 3.10.11). 3.10 and 3.12 worked.\n\n",
      "solution": "Hi @BenKGIT, thanks for reporting.\n\nThis has been fixed in https://github.com/Azure/azure-functions-python-worker/pull/1805. It'll be part of host version 4.1046, and ETA for the release to complete is Jan - Feb. The recommendation for this scenario currently is to stay on python 3.12.\n\nClosing this as the fix has been merged & release is in-progress, but please feel free to re-open if you have any further questions or if your app picks up the new host update and the issue persists.  ",
      "labels": [],
      "created_at": "2025-12-01T18:09:01Z",
      "closed_at": "2025-12-01T19:27:04Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1809",
      "comments_count": 1
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1688,
      "title": "[Bug] Opportunistic code in `get_function_return_type`.",
      "problem": "### Expected Behavior\n\nThere should be no error\n\n### Actual Behavior\n\nThere is an error (please see log output)\n\n### Steps to Reproduce\n\n_No response_\n\n### Relevant code being tried\n\n```shell\nimport json\nfrom typing import Generic, Mapping, Optional, TypeVar, Union\n\nimport azure.functions as func\n\n# Type for valid JSON-serializable values\nJsonType = Union[list, tuple, dict, str, int, float, bool]\nT = TypeVar(\"T\", bound=JsonType)\n\n\nclass JsonResponse(func.HttpResponse, Generic[T]):\n    def __init__(\n        self,\n        body: T,\n        status_code: int = 200,\n        headers: Optional[Mapping[str, str]] = None,\n    ):\n        headers = (headers or {}) | {\"Content-Type\": \"application/json\"}\n        super().__init__(json.dumps(body), status_code=status_code, headers=headers, charset=\"utf-8\")\n\n    def json(self) -> T:\n        \"\"\"Get the original body that was passed to the response.\n\n        Returns:\n            The original body object, preserving its exact type.\n        \"\"\"\n        return json.loads(self.get_body().decode(\"utf-8\"))\n\n@app.route(route=\"health\")\ndef health(req: func.HttpRequest) -> site_monitor.func.JsonResponse:\n    \"\"\"Health check endpoint that returns initialization status.\"\"\"\n    return site_monitor.func.JsonResponse(\n        {\n            \"status\": \"healthy\",\n            \"initialized\": init_event.is_set(),\n            \"healthy\": True,\n            \"uptime_seconds\": int(time.monotonic() - startup_time),\n        },\n    )\n```\n\n### Relevant log output\n\n```shell\n[2025-06-01T13:52:36.579Z] Indexed function app and found 2 functions\n[2025-06-01T13:52:36.589Z] Worker failed to index functions\n[2025-06-01T13:52:36.590Z] Result: Failure\nException: AttributeError: 'NoneType' object has no attribute '__name__'\nStack:   File \"C:\\Devel\\bin\\node-v22.15.0-win-x64\\node_modules\\azure-functions-core-tools\\bin\\workers\\python\\3.12\\WINDOWS\\X64\\azure_functions_worker\\dispatcher.py\", line 480, in _handle__functions_metadata_request\n    self.load_function_metadata(\n  File \"C:\\Devel\\bin\\node-v22.15.0-win-x64\\node_modules\\azure-functions-core-tools\\bin\\workers\\python\\3.12\\WINDOWS\\X64\\azure_functions_worker\\dispatcher.py\", line 460, in load_function_metadata\n    self.index_functions(function_path, function_app_directory)) \\\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Devel\\bin\\node-v22.15.0-win-x64\\node_modules\\azure-functions-core-tools\\bin\\workers\\python\\3.12\\WINDOWS\\X64\\azure_functions_worker\\dispatcher.py\", line 846, in index_functions\n    loader.process_indexed_function(\n  File \"C:\\Devel\\bin\\node-v22.15.0-win-x64\\node_modules\\azure-functions-core-tools\\bin\\workers\\python\\3.12\\WINDOWS\\X64\\azure_functions_worker\\loader.py\", line 145, in process_indexed_function\n    function_info = functions_registry.add_indexed_function(\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Devel\\bin\\node-v22.15.0-win-x64\\node_modules\\azure-functions-core-tools\\bin\\workers\\python\\3.12\\WINDOWS\\X64\\azure_functions_worker\\functions.py\", line 457, in add_indexed_function\n    self.get_function_return_type(annotations,\n  File \"C:\\Devel\\bin\\node-v22.15.0-win-x64\\node_modules\\azure-functions-core-tools\\bin\\workers\\python\\3.12\\WINDOWS\\X64\\azure_functions_worker\\functions.py\", line 275, in get_function_return_type\n    return_anno).__name__ == 'Out':\n                 ^^^^^^^^\n.\n[2025-06-01T13:52:36.595Z] 0 functions found (Worker)\n[2025-06-01T13:52:36.602Z] 0 functions loaded\n```\n\n### requirements.txt file\n\n```shell\n\n```\n\n### Where are you facing this problem?\n\nLocal - Core Tools\n\n### Function app name\n\n_No response_\n\n### Additional Information\n\nI would like to report opportunistic code [function.py](https://github.com/Azure/azure-functions-python-worker/blob/dev/azure_functions_worker/functions.py#L273-L275) file.\n\nThe `typing_inspect.get_origin()` can return `None` [link](https://github.com/python/cpython/blob/3.13/Lib/typing.py#L2528-L2555)",
      "solution": "Hi @VRGhost, thanks for reporting this.\n\nThe intended flow for this code snippet is that, wherever `get_origin` returns None, `is_generic_type` would return False, so the `'NoneType' object has no attribute '__name__'` error would never be hit.\n```\nif typing_inspect.is_generic_type(\n                    return_anno) and typing_inspect.get_origin(\n                    return_anno).__name__ == 'Out':\n```\n\nHowever, in your scenario, `is_generic_type` is returning True, and `get_origin` isn't returning the correct type. We have a PR out now to get this fixed.",
      "labels": [
        "bug",
        "python"
      ],
      "created_at": "2025-06-01T13:54:48Z",
      "closed_at": "2025-10-29T15:17:38Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1688",
      "comments_count": 1
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1797,
      "title": "[Bug] Azure Functions Python 3.13 Dependency Isolation Bug with `grpcio`",
      "problem": "### Expected Behavior\n\nAzure Functions Python 3.13 container should successfully start and load functions when using packages that depend on `grpcio`, such as `google-cloud-aiplatform`. The dependency isolation feature should handle version conflicts between the runtime's internal dependencies and application dependencies without causing crashes.\n\n### Actual Behavior\n\nThe Azure Functions runtime fails to start with exit code 139 when importing packages that depend on `grpcio` (specifically `google-cloud-aiplatform`). The Python worker crashes during the dependency loading phase, causing the entire Functions host to shut down and restart repeatedly until it exceeds the retry limit. The issue is specific to the [Python 3.13 container image tag: 4-python3.13](https://mcr.microsoft.com/en-us/artifact/mar/azure-functions/python/tags) and does not occur with Python 3.12 containers or local development.\n\n### Steps to Reproduce\n\n1. Clone the repository: `git clone https://github.com/RodriGoncaDeeployer/dummy_func.git`\n2. Switch to the failing branch: `git checkout fail`\n3. Build the Docker image: `docker compose build`\n4. Run the Docker container: `docker compose up --force-recreate`\n5. Wait approximately 2 minutes for the error to manifest\n6. Observe the Python worker crash with exit code 139\n\nThe crash is triggered by the import statement `from google.api_core.exceptions import NotFound` in \n[function_app.py](https://github.com/RodriGoncaDeeployer/dummy_func/blob/success/function_app.py). \n\nCommenting out this import allows the function to start successfully.\n\n### Relevant code being tried\n\n```shell\nimport json\nimport sys\n\nimport azure.functions as func\n\n# Fails when using Python 3.13 docker image and when deployed to Azure Functions using docker container deployment.\n# It does not fail when running locally with Python 3.13\nfrom google.api_core.exceptions import NotFound\n\n# ------------------------------------------------------------\n\nfunc.HttpResponse.mimetype = \"application/json\"\nfunc.HttpResponse.charset = \"utf-8\"\n\napp = func.FunctionApp(http_auth_level=func.AuthLevel.ANONYMOUS)\n\n\n@app.function_name(name=\"endpoint\")\n@app.route(route=\"endpoint\", methods=[\"GET\"])\ndef main(req: func.HttpRequest) -> str:\n    response: dict[str, str] = {\"python\": sys.version}\n\n    return func.HttpResponse(json.dumps(response), status_code=200)\n```\n\n### Relevant log output\n\n```shell\n...\ndummy-func     | dbug: Microsoft.Azure.WebJobs.Script.Workers.Rpc.RpcFunctionInvocationDispatcher[0]\ndummy-func     |       Handling WorkerErrorEvent for runtime:python, workerId:python. Failed with: Microsoft.Azure.WebJobs.Script.Workers.WorkerProcessExitException: python exited with code 139 (0x8B)\ndummy-func     |        ---> System.Exception\ndummy-func     |          --- End of inner exception stack trace ---\ndummy-func     | dbug: Microsoft.Azure.WebJobs.Script.Workers.Rpc.RpcFunctionInvocationDispatcher[0]\ndummy-func     |       Attempting to dispose webhost or jobhost channel for workerId: '98b7cf7b-502d-49c1-8739-195b21895722', runtime: 'python'\ndummy-func     | dbug: Microsoft.Azure.WebJobs.Script.Workers.Rpc.RpcFunctionInvocationDispatcher[0]\ndummy-func     |       No initialized worker channels for runtime 'python'. Delaying future invocations\ndummy-func     | dbug: Microsoft.Azure.WebJobs.Script.Workers.Rpc.RpcFunctionInvocationDispatcher[0]\ndummy-func     |       Restarting worker channel for runtime: 'python'\ndummy-func     | fail: Microsoft.Azure.WebJobs.Script.Workers.Rpc.RpcFunctionInvocationDispatcher[0]\ndummy-func     |       Exceeded language worker restart retry count for runtime:python. Shutting down and proactively recycling the Functions Host to recover\n...\ndummy-func     | warn: Host.Startup[0]\ndummy-func     |       No job functions found. Try making your job classes and methods public. If you're using binding extensions (e.g. Azure Storage, ServiceBus, Timers, etc.) make sure you've called the registration method for the extension(s) in your startup code (e.g. builder.AddAzureStorage(), builder.AddServiceBus(), builder.AddTimers(), etc.).\n```\n\n### requirements.txt file\n\n```shell\nazure-functions==1.24.0\ngoogle-cloud-aiplatform==1.121.0\n```\n\n### Where are you facing this problem?\n\nLocal - Core Tools\n\n### Function app name\n\nhttps://github.com/RodriGoncaDeeployer/dummy_func\n\n### Additional Information\n\nSee [README.md](https://github.com/RodriGoncaDeeployer/dummy_func) for detailed instructions on how to reproduce the bug.",
      "solution": "Hi @RodriGoncaDeeployer, thanks for reporting.\n\nThis is fixed in host version 4.1043. The images are currently still using 4.1042, but they should be updated by next week. As a mitigation, you can create an app through the portal and deploy using remote build. \n\n---\n\nHi, this should be fixed. Please feel free to reopen if you're still facing issues.\n\nI took a quick look at your repo - in your docker setup, I didn't see where you were installing / copying over dependencies into `.python_packages/lib/site-packages`. For dependency isolation to work properly, dependencies should be installed there.\n\nEg:\n```\nCOPY requirements.txt /\nRUN pip install --target=\"/home/site/wwwroot/.python_packages/lib/site-packages\" -r /requirements.txt\n\nCOPY . /home/site/wwwroot\n```",
      "labels": [
        "bug",
        "python"
      ],
      "created_at": "2025-10-20T19:26:22Z",
      "closed_at": "2025-10-27T15:52:08Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1797",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1785,
      "title": "[Bug] Bug Title Here",
      "problem": "### Expected Behavior\n\nos.getenv(\"erp_LANDING_STORE_CONNECTION_STRING\").strip() returns the environment variable I have set under App Settings.\n\n### Actual Behavior\n\nos.getenv(\"erp_LANDING_STORE_CONNECTION_STRING\").strip() causes an Error.\n\n### Steps to Reproduce\n\nAs this works with another function app in my RG there is no guarantee you can reproduce it, but:\nDeploy a FlexConsumption app (I used terraform and Visual Studio Code for the deployment using 'func azure functionapp publish')\nPrint the environment variables and see that the environment variable does not exist.\n\n### Relevant code being tried\n\n```shell\n@my_bp.service_bus_queue_trigger(arg_name=\"inputMessage\", queue_name=f\"{azure_environment}-test-queue\", connection=\"SERVICE_BUS_CONNECTION_STRING\")\n\ndef env_print_func(inputMessage: func.ServiceBusMessage):\n    os.getenv(\"erp_LANDING_STORE_CONNECTION_STRING\").strip()\n```\n\n### Relevant log output\n\n```shell\nAttributeError: 'NoneType' object has no attribute 'strip'\n```\n\n### requirements.txt file\n\n```shell\n\n```\n\n### Where are you facing this problem?\n\nProduction Environment (explain below)\n\n### Function app name\n\n_No response_\n\n### Additional Information\n\n'os.getenv(\"erp_LANDING_STORE_CONNECTION_STRING\").strip()' gives me the error \"'NoneType' object has no attribute 'strip'\". \n\nThis seems similar to some other reports here, but I am on python 3.11, not 3.13, on FlexConsumption: Runtime Stack    Python - 3.11\nFurther, when I print all environment variables using 'logger.warning(f\"Env vars: {dict(os.environ)}\")' I see 87 environment variables, but not the \"erp_LANDING_STORE_CONNECTION_STRING\" variable for some reason.\n\nWhat is even stranger is that sometimes it works, and then it stops working again when processing multiple messages. Maybe it has something to do with new instances not being set up  completely during start and scale out:\nServiceBus message 1 - Succeeds\nServiceBus message 2 - Succeeds\nServiceBus message 3 - Succeeds\nServiceBus message 4 - Fails\n...\nServiceBus message 33 - Fails\n\nSometimes a manual restart fixes the issue for a little bit.",
      "solution": "@hallvictoria Hi again. \n\nSorry for the delayed response, but I spent most of yesterday trying to replicate the issue and I am starting to question my sanity as I have been unable to replicate the problem. \n\nTo answer your question and give more context, let me lay out the chronological events of the past few days. \n\nWe have had a linux function app with the serverless SKU for a while, working just fine and as intended. \nWe saw the need for some additional capabilities and decided to migrate over to the FlexConsumption SKU, and I made the requisite changes. \nAs before, the environment variable was set in the app settings, and the code and trigger bindings were unchanged. The only changes I made were to the terraform IaC. \nWhen a full redeploy was made we found that the system failed with a confusing error, so we added more logs and eventually identified that one required environment variable, while present in the Azure portal GUI, was missing. \nFor several hours the problem was reproducable across all variations:\n  1. I tried python 3.10, 3.11, 3.12 and even 3.13. I am aware the documentation states there is no support for python 3.13 yet, but I also found some resources here on github saying you could get 3.13 to work. \n  2. I tried changing the permissions of the function app and gave it its own storage account and blob container with the fastest SSD option. \n  3. I tried deploying a second separate function app and saw the same issue. \n\nI did originally deploy two Flex SKU Function apps to the same resource group, but then I ran into some issues and ended up separating them into two resource groups instead. \nHowever, after all the testing above, and probably something else that I have forgotten, I gave up and went to bed after a quick deploy of our main branch to reset to a stable system. \n\nThe next day I redeployed the same flex consumption branch and restarted my testing. No issues. \nI changed to 3.10, 3.11 and 3.12. No issues. I never managed to get 3.13 to work as the health check of the app and the bindings always failed, even though the code seemed to be updated.\nI ran hundreds of concurrent heavy tasks through the function app, and no issues. \nI artificially inflated some of the data payloads and nothing. New failures related to timeout in the service bus queue started popping up, but the function app was rock solid. \n\n\nSo either it was a temporary problem the day I did my original testing and made this bug report, or I have changed something through all my actions that fixed it. \nAnyways, I am planning to deploy a parallel production environment using the Flex SKU and mirroring all traffic through it for a few days to verify that it does not happen again, and I will come back to you.\nIf you do not hear from me within a few days, then you can close this bug report. \n\n---\n\nThanks for your response, and I'm sorry to hear you've had so many issues with this migration. If the issue reoccurs and you're willing, you can also [share the function app name](https://github.com/Azure/azure-functions-host/wiki/Sharing-Your-Function-App-name-privately), and we can take a closer look.\n\n> I am aware the documentation states there is no support for python 3.13 yet\n\nTo clarify on this comment, I'm assuming you mean that Python 3.13 is not GA yet. We do have support for [Python 3.13, but it is currently in preview](https://learn.microsoft.com/en-us/azure/azure-functions/functions-reference-python?tabs=get-started%2Casgi%2Capplication-level&pivots=python-mode-configuration#python-version).\n\nI'll set the issue to auto-close in 7 days if there's no further activity, but please feel free to re-open if the issue occurs again.",
      "labels": [
        "bug",
        "python"
      ],
      "created_at": "2025-10-07T16:14:31Z",
      "closed_at": "2025-10-17T11:52:22Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1785",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1682,
      "title": "Python: support logging ExceptionGroup sub-exceptions",
      "problem": "### Description\n\nUsing the following code:\n```python\n#!/usr/bin/env python\n\nimport asyncio\nimport azure.functions as func\n\napp = func.FunctionApp()\n\n@app.timer_trigger(schedule='0 */1 * * * *', arg_name='mytimer', run_on_startup=True)\nasync def test_task_group_trigger(mytimer):\n\tawait test_task_group()\n\nasync def test_task_group():\n\tasync def inner_task(i):\n\t\tawait asyncio.sleep(0)\n\t\ti/0\n\n\tasync with asyncio.TaskGroup() as tg:\n\t\tfor i in range(4):\n\t\t\ttg.create_task(inner_task(i))\n\nif __name__ == '__main__':\n\tasyncio.run(test_task_group())\n```\n\nWhen run in the terminal, `./function_app.py`, I get:\n\n```\n  + Exception Group Traceback (most recent call last):\n  |   File \"/home/user/code/work/canopy/guidepost/tg-test/./function_app.py\", line 22, in <module>\n  |     asyncio.run(test_task_group())\n  |   File \"/home/user/.local/share/pyenv/versions/3.12.10/lib/python3.12/asyncio/runners.py\", line 195, in run\n  |     return runner.run(main)\n  |            ^^^^^^^^^^^^^^^^\n  |   File \"/home/user/.local/share/pyenv/versions/3.12.10/lib/python3.12/asyncio/runners.py\", line 118, in run\n  |     return self._loop.run_until_complete(task)\n  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  |   File \"/home/user/.local/share/pyenv/versions/3.12.10/lib/python3.12/asyncio/base_events.py\", line 691, in run_until_complete\n  |     return future.result()\n  |            ^^^^^^^^^^^^^^^\n  |   File \"/home/user/code/work/canopy/guidepost/tg-test/./function_app.py\", line 17, in test_task_group\n  |     async with asyncio.TaskGroup() as tg:\n  |                ^^^^^^^^^^^^^^^^^^^\n  |   File \"/home/user/.local/share/pyenv/versions/3.12.10/lib/python3.12/asyncio/taskgroups.py\", line 71, in __aexit__\n  |     return await self._aexit(et, exc)\n  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  |   File \"/home/user/.local/share/pyenv/versions/3.12.10/lib/python3.12/asyncio/taskgroups.py\", line 164, in _aexit\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (4 sub-exceptions)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/home/user/code/work/canopy/guidepost/tg-test/./function_app.py\", line 15, in inner_task\n    |     i/0\n    |     ~^~\n    | ZeroDivisionError: division by zero\n    +---------------- 2 ----------------\n    | Traceback (most recent call last):\n    |   File \"/home/user/code/work/canopy/guidepost/tg-test/./function_app.py\", line 15, in inner_task\n    |     i/0\n    |     ~^~\n    | ZeroDivisionError: division by zero\n    +---------------- 3 ----------------\n    | Traceback (most recent call last):\n    |   File \"/home/user/code/work/canopy/guidepost/tg-test/./function_app.py\", line 15, in inner_task\n    |     i/0\n    |     ~^~\n    | ZeroDivisionError: division by zero\n    +---------------- 4 ----------------\n    | Traceback (most recent call last):\n    |   File \"/home/user/code/work/canopy/guidepost/tg-test/./function_app.py\", line 15, in inner_task\n    |     i/0\n    |     ~^~\n    | ZeroDivisionError: division by zero\n    +------------------------------------\n```\n\nWhich is quite helpful. Unfortunately, in `func host start --verbose`, I get the following traceback instead:\n\n```\n[2025-05-05T22:41:00.001Z] Executing 'Functions.test_task_group_trigger' (Reason='Timer fired at 2025-05-05T15:41:00.0009036-07:00', Id=f3dbc3f3-9b36-479c-bec8-8f73a4031247)\n[2025-05-05T22:41:00.012Z] Received FunctionInvocationRequest, request ID: 660324cb-db0f-4c07-a270-f6c6ed38ca78, function ID: 71e25862-8f0b-570b-91de-6ee32efde7c7, function name: test_task_group_trigger, invocation ID: f3dbc3f3-9b36-479c-bec8-8f73a4031247, function type: async, timestamp (UTC): 2025-05-05 22:41:00.004631\n[2025-05-05T22:41:00.016Z] Executed 'Functions.test_task_group_trigger' (Failed, Id=f3dbc3f3-9b36-479c-bec8-8f73a4031247, Duration=13ms)\n[2025-05-05T22:41:00.016Z] System.Private.CoreLib: Exception while executing function: Functions.test_task_group_trigger. System.Private.CoreLib: Result: Failure\n[2025-05-05T22:41:00.016Z] Exception: ExceptionGroup: unhandled errors in a TaskGroup (4 sub-exceptions)\n[2025-05-05T22:41:00.016Z] Stack:   File \"/usr/lib/azure-functions-core-tools/workers/python/3.12/LINUX/X64/azure_functions_worker/dispatcher.py\", line 659, in _handle__invocation_request\n[2025-05-05T22:41:00.016Z]     await self._run_async_func(fi_context, fi.func, args)\n[2025-05-05T22:41:00.017Z]   File \"/usr/lib/azure-functions-core-tools/workers/python/3.12/LINUX/X64/azure_functions_worker/dispatcher.py\", line 996, in _run_async_func\n[2025-05-05T22:41:00.017Z]     return await ExtensionManager.get_async_invocation_wrapper(\n[2025-05-05T22:41:00.017Z]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n[2025-05-05T22:41:00.017Z]   File \"/usr/lib/azure-functions-core-tools/workers/python/3.12/LINUX/X64/azure_functions_worker/extension.py\", line 143, in get_async_invocation_wrapper\n[2025-05-05T22:41:00.017Z]     result = await function(**args)\n[2025-05-05T22:41:00.017Z]              ^^^^^^^^^^^^^^^^^^^^^^\n[2025-05-05T22:41:00.017Z]   File \"/home/user/code/work/canopy/guidepost/tg-test/function_app.py\", line 13, in test_task_group_trigger\n[2025-05-05T22:41:00.017Z]     await test_task_group()\n[2025-05-05T22:41:00.017Z]   File \"/home/user/code/work/canopy/guidepost/tg-test/function_app.py\", line 20, in test_task_group\n[2025-05-05T22:41:00.017Z]     async with asyncio.TaskGroup() as tg:\n[2025-05-05T22:41:00.017Z]                ^^^^^^^^^^^^^^^^^^^\n[2025-05-05T22:41:00.017Z]   File \"/home/user/.local/share/pyenv/versions/3.12.10/lib/python3.12/asyncio/taskgroups.py\", line 71, in __aexit__\n[2025-05-05T22:41:00.017Z]     return await self._aexit(et, exc)\n[2025-05-05T22:41:00.017Z]            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n[2025-05-05T22:41:00.017Z]   File \"/home/user/.local/share/pyenv/versions/3.12.10/lib/python3.12/asyncio/taskgroups.py\", line 164, in _aexit\n[2025-05-05T22:41:00.017Z]     raise BaseExceptionGroup(\n[2025-05-05T22:41:00.017Z] .\n```\n\nWhich isn't all that helpful. It would be nice if `func host` could log the inner exceptions in an ExceptionGroup so that using asyncio/anyio is a little friendlier.",
      "solution": "Thank you for the workaround.\n\n> We can look into perhaps handling sync vs. async exceptions differently.\n\nYes, I would appreciate that greatly. Would you mind please pointing out where in the code that is handled, so that I may try my hand at a PR? For versions prior to 3.11, y'all could use https://pypi.org/project/exceptiongroup/#formatting-exception-groups, which includes\n\n-    traceback.format_exception()\n-    traceback.format_exception_only()\n-    traceback.print_exception()\n-    traceback.print_exc()\n\n",
      "labels": [],
      "created_at": "2025-05-05T22:52:59Z",
      "closed_at": "2025-10-09T17:20:26Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1682",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1779,
      "title": "Could not load file or assembly ... Version=8.0.0.0",
      "problem": "I have an issue spinning up a new devcontainer for Azure Functions. Using the Dockerfile below, I am able to spin up the container, func init, and func new an HTTP Trigger without issue. When I func new a Queue Trigger, I get the error message below.\n\nI posted this originally in the dotnet worker issues area, but I think it may be more relevant here. Just looking for some direction on how to proceed. \n\nIf it matters, I am on an ARM M1 Mac. I have a docker-compose file to spin up multiple containers (Python Functions) that assist a .NET Web app. I have used this devcontainer config successfully until recently, maybe the last 3 months? (Unfortunately, development isn't my only role, so I don't spin it up every week).\n\nHappy to close both threads once I get a grasp on what's happening. It's clear that the .NET version that's running in the container doesn't have some of the .NET 8 assemblies, but I don't know why that has become an issue now or how to troubleshoot it. \n\n> I reproduce with the following Dockerfile:\n> \n> \n> \n> ```\n> FROM mcr.microsoft.com/azure-functions/python:4-python3.11-core-tools\n> \n> WORKDIR /home/site/wwwroot\n> \n> RUN func init . --worker-runtime python --force\n> \n> RUN func new --template \"Queue Trigger\" --name thetrigger\n> \n> EXPOSE 80\n> \n> CMD [\"func\", \"start\", \"--verbose\", \"--python\"]\n> ```\n> \n> \n> then spin up the container:\n> \n> \n> ```\n> docker build -t myfuncapp .\n> \n> docker run -it --rm -p 7071:80 myfuncapp\n> ```\n> \n> \n> when I run it, I get \n> \n> ```\n> Error configuring services in an external startup class.\n> [2025-09-24T14:45:21.328Z] Error configuring services in an external startup class. Microsoft.Azure.WebJobs.Extensions.Storage.Queues: Could not load file or assembly 'System.ComponentModel, Version=8.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'. The system cannot find the file specified.\n> [2025-09-24T14:45:21.328Z] .\n> [2025-09-24T14:45:21.332Z] A host error has occurred during startup operation '80c93a23-f2f3-4057-a194-de530a0a2dfc'.\n> [2025-09-24T14:45:21.332Z] Microsoft.Azure.WebJobs.Script: Error configuring services in an external startup class. Microsoft.Azure.WebJobs.Extensions.Storage.Queues: Could not load file or assembly 'System.ComponentModel, Version=8.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'. The system cannot find the file specified.\n> [2025-09-24T14:45:21.332Z] .\n> Value cannot be null. (Parameter 'provider')\n> ```\n> \n> \n> My devcontainer is more complicated, but I get the same result. If the function app only has http and timer triggers, I am able to start without issue; however, once I \"func new\" a queue trigger, I get that error. I have tried migrating to other versions of the base image, but I have not found one that resolves this. \n\n _Originally posted by @gallowasusc in [#3115](https://github.com/Azure/azure-functions-dotnet-worker/issues/3115#issuecomment-3329047815)_",
      "solution": "Hi @gallowasusc, thanks for reporting.\n\nThe `core-tools` images are very old and no longer maintained. Could you try using a different image instead, like `mcr.microsoft.com/azure-functions/python:4-python3.11`?\n\nThe issue is because the `core-tools` image brings an old version of the host but the latest version of the extension bundles, and there is an incompatibility there. If you need the older host version, you can also pin the extension bundle version to 4.21.0 or below.",
      "labels": [
        "needs-attention :wave:"
      ],
      "created_at": "2025-09-29T20:42:32Z",
      "closed_at": "2025-10-01T17:18:34Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1779",
      "comments_count": 2
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1772,
      "title": "[Bug] OTelManager `set_azure_libs_available` sets incorrect variable",
      "problem": "https://github.com/Azure/azure-functions-python-worker/blob/a4c24b219f1c833c287c785d21b173cbfe57718f/runtimes/v2/azure_functions_runtime/otel.py#L15-L29\n\nSee line 29 in the above snippet. \nIt sets `self._aotel_libs_available = True`, this variable doesn't exist on the class, it should be `self._otel_libs_available = True`.\n\nThis bug is also in the v1 runtime version. ",
      "solution": "Hi @ashleysommer, thanks for reporting. This has been fixed in `azure-functions-runtime` version 1.1.0b1 and host runtime version 4.1044, which will complete around October - November. ",
      "labels": [],
      "created_at": "2025-09-24T00:53:25Z",
      "closed_at": "2025-09-24T16:00:59Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1772",
      "comments_count": 1
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1770,
      "title": "[Bug] Python 3.13 does not work with App settings environment variables",
      "problem": "### Expected Behavior\n\nUsing Azure Functions - Flex Consumption - Python 3.13 App settings environment variables do not work, e.g.\n`[os.environ[\"myAppSetting\"]` throws exception `KeyError: 'myAppSetting'`\n\nWorks fine locally but fails when deployed to Azure using Python 3.13. App Setting environment variables work fine in lower versions like Python 3.12\n\nNo known issues are reported here https://learn.microsoft.com/en-us/azure/azure-functions/functions-reference-python?tabs=get-started%2Casgi%2Capplication-level&pivots=python-mode-decorators or here https://learn.microsoft.com/en-us/azure/azure-functions/python-313-changes\n\n### Actual Behavior\n\nApp settings environment variables do not work in Python 3.13 and throw an exception.\n\n### Steps to Reproduce\n\n1. Create Azure Functions Flex Consumption using Python 3.13\n2. Attempt to read an App settings environment variable (e.g. sample code https://learn.microsoft.com/en-us/azure/azure-functions/functions-reference-python?tabs=get-started%2Casgi%2Capplication-level&pivots=python-mode-decorators#environment-variables) and the function will throw an exception incorrectly.\n\n### Relevant code being tried\n\n```shell\nimport logging\nimport os\n\nimport azure.functions as func\n\napp = func.FunctionApp()\n\n@app.function_name(name=\"HttpTrigger1\")\n@app.route(route=\"req\")\ndef main(req: func.HttpRequest) -> func.HttpResponse:\n  # Get the setting named 'myAppSetting'\n  my_app_setting_value = os.environ[\"myAppSetting\"]\n  logging.info(f'My app setting value:{my_app_setting_value}')\n```\n\n### Relevant log output\n\n```shell\nKeyError: 'myAppSetting'\n```\n\n### requirements.txt file\n\n```shell\nazure-functions\n```\n\n### Where are you facing this problem?\n\nAzure Functions invocation in Azure Cloud\n\n### Function app name\n\n_No response_\n\n### Additional Information\n\n_No response_",
      "solution": "Hi @mabeshark, thanks for reporting. The fix has been released as part of `azure-functions-runtime==1.0.0b2`.\n\nYou can fix the issue immediately by adding `azure-functions-runtime==1.0.0b2` to your requirements.txt file. (More information on this pinning feature in our [Python 3.13+ Guide](https://learn.microsoft.com/en-us/azure/azure-functions/python-313-changes))\n\nAlternatively, we are currently releasing this fix in host runtime version 4.1043. ETA for that is late September - October timeframe.\n\n For more information, see https://github.com/Azure/azure-functions-python-worker/issues/1732",
      "labels": [
        "bug",
        "python"
      ],
      "created_at": "2025-09-23T00:43:48Z",
      "closed_at": "2025-09-23T15:22:12Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1770",
      "comments_count": 1
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1383,
      "title": "Manually marking Service Bus Queue Function as Failed",
      "problem": "#### Is your question related to a specific version? If so, please specify: Programming Model V1, Azure FUnction v4, python 3.10\r\n\r\n#### What binding does your question apply to, if any? (e.g. Blob Trigger, Event Hub Binding, etc) Service Bus Queue\r\n\r\n#### Question\r\n\r\nCurrently I have policy of retrying setup on function and Service Bus level. When the processing throws an error the message goes back to queue 3 times as expected (defined by property **Max delivery count**). However, for some types of exceptions I don't want to retry processing, because I know the retry won't help and it's pointless to waist computing power for that. So I can't catch the exception on the top level, check whether I should retry or no. The problem is that I still want to throw that exception after catching it, so the function execution will be marked as failed. Is there any way to mark the message as completed and then throw the exception? Or to silence the exception but add some kind of property to function execution context, so that it will be visible as failed?",
      "solution": "Facing this issue right now with local testing.\r\nTried just raising an Exception but that causes the function to fire immediately again ignoring the message lock.\r\n~One solution I found for now is marking a function as failed by doing `sys.exit(0)` which seems to have the desired outcome but this produces a weird start-up traceback but after will perform as expected. I don't feel comfortable doing this thought because I do not know what it will do when deployed.~\r\nFrom the above the function is executing when the message should be unlocked but it does not run properly (does not actually execute the contents of the function).\r\nWork around for now is just to manually add back in a message to the queue.\r\n\r\nThere should be a functionality like in c# to be able to set autoComplete to False or a special exception in the azure.functions.ServiceBus class that a service bus trigger will listen to and mark it as a failed function without trying to retry the function again.\n\n---\n\nThe only solution i've found for now is to move message to dead letter queue and then rethrow exception. This [sample](https://github.com/Azure/azure-sdk-for-python/blob/main/sdk/servicebus/azure-servicebus/samples/sync_samples/deadletter_messages_and_correct.py) can help\n\n---\n\n@andreyshv I'm running into this too and think you're right that dead-lettering is the correct action. However, I'm stuck on actually implementing the call to `dead_letter_message()` as shown in that example code because it expects an `azure.servicebus.ServiceBusReceivedMessage` object instead of the `azure.functions.ServiceBusMessage` type the function provides. Any chance you have a solution to that problem handy?",
      "labels": [],
      "created_at": "2023-12-18T16:45:16Z",
      "closed_at": "2025-09-17T19:36:19Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1383",
      "comments_count": 9
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1732,
      "title": "[Bug] Python 3.13 on Flex Consumption can't see custom environment variables",
      "problem": "### Expected Behavior\n\nThe code to have access to environment variables, similar to previous versions of Python.\n\n### Actual Behavior\n\nCustom environment variables are not visible.\n\n### Steps to Reproduce\n\nJust deploy a basic Python 3.13 function on Flex Consumption and try to read environment variables.\n\n### Relevant code being tried\n\n```shell\nimport json\nimport os\nfrom platform import python_version\n\nimport azure.functions as func\n\napp = func.FunctionApp(http_auth_level=func.AuthLevel.ANONYMOUS)\n\n\n@app.route(route=\"http_trigger\")\ndef http_trigger(req: func.HttpRequest) -> func.HttpResponse:\n    return func.HttpResponse(\n        json.dumps(\n            {\n                \"python\": python_version(),\n                \"environ\": {k: v for k, v in sorted(os.environ.items())},\n            },\n            indent=2,\n            ensure_ascii=False,\n        ),\n        mimetype=\"application/json\",\n        headers={\"Cache-Control\": \"no-cache\"},\n    )\n```\n\n### Relevant log output\n\n```shell\n\n```\n\n### requirements.txt file\n\n```shell\n\n```\n\n### Where are you facing this problem?\n\nProduction Environment (explain below)\n\n### Function app name\n\n_No response_\n\n### Additional Information\n\n_No response_",
      "solution": "The fix has been released as part of `azure-functions-runtime==1.0.0b2`.\n\nYou can fix the issue immediately by adding `azure-functions-runtime==1.0.0b2` to your requirements.txt file. (More information on this pinning feature in our [Python 3.13+ Guide](https://learn.microsoft.com/en-us/azure/azure-functions/python-313-changes))\n\nAlternatively, we will release this fix in host runtime version 4.1043. ETA for that will be September - October timeframe.",
      "labels": [
        "bug",
        "python"
      ],
      "created_at": "2025-08-05T08:29:23Z",
      "closed_at": "2025-08-13T18:26:39Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1732",
      "comments_count": 2
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1726,
      "title": "Overwrite data in azure table storage",
      "problem": "How to overwrite data in Azure Table Storage using table binding? The code in the [current doc](https://learn.microsoft.com/en-us/azure/azure-functions/functions-bindings-storage-table-output?tabs=isolated-process%2Cnodejs-v4%2Cpython-v2%2Ctable-api&pivots=programming-language-python) throws error while trying to overwrite data.\n\n```\n[2025-07-28T19:10:01.161Z] Executed 'Functions.table_in_binding' (Failed, Id=71f6229a-5662-4da9-82ae-544423c79958, Duration=1164ms)\n[2025-07-28T19:10:01.161Z] System.Private.CoreLib: Exception while executing function: Functions.table_in_binding. Microsoft.Azure.WebJobs.Host: Error while handling parameter _binder after function returned:. Azure.Data.Tables: The specified entity already exists.\n[2025-07-28T19:10:01.161Z] RequestId:4980989c-d002-0017-65f3-ffbc8b000000\n[2025-07-28T19:10:01.161Z] Time:2025-07-28T19:10:01.1302649Z\n[2025-07-28T19:10:01.161Z] Status: 409 (Conflict)\n[2025-07-28T19:10:01.161Z] ErrorCode: EntityAlreadyExists\n```",
      "solution": "Thanks for reporting this - From [documentation note](https://learn.microsoft.com/en-us/azure/azure-functions/functions-bindings-storage-table-output?tabs=isolated-process%2Cnodejs-v4%2Cpython-v2%2Ctable-api&pivots=programming-language-python) - doesn't look like extensions support any other operations except insert.\n\n>  Note -\n> This output binding only supports creating new entities in a table. If you need to update an existing entity from your function code, instead use an Azure Tables SDK directly.",
      "labels": [],
      "created_at": "2025-07-28T19:11:23Z",
      "closed_at": "2025-07-29T04:02:00Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1726",
      "comments_count": 1
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1715,
      "title": "Transient RpcException/AssertionError on Python Function Invocation",
      "problem": "#### Is your question related to a specific version? If so, please specify:\n\nAzure Functions Host version: 4.x (4.1039.500.1)\nPlatform: Linux\nSKU: Consumption Plan\nLanguage: Python 3.10\n\n#### What language does your question apply to? (e.g. C#, JavaScript, Java, All) \n\nPython\n\n#### Question\n\nI'd appreciate some help in diagnosing a transient error in my Python Function App. A timer-triggered function failed for 3 consecutive invocations before recovering on its own. There were no deployments or configuration changes made during this period.\n\nThe failure is an `RpcException` originating from the host, which seems to be caused by an underlying `AssertionError` within the Python worker process. Here is the relevant part of the exception stack trace:\n\n```python\n Exception while executing function\n /Functions.timer ---> Microsoft.Azure.WebJobs.Script.Workers.Rpc.RpcException \n /Result\n /Failure Exception\n /AssertionError\n / \n\n /  \n '/azure-functions-host/workers/python/3.10/LINUX/X64/azure_functions_worker/dispatcher.py', line 606, in _handle__invocation_request     assert fi is not None     \nSystem.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    \n```\n\nCould you please help explain what this error indicates? Given that it was transient and occurred on a Consumption plan app, could this be related to instance initialisation (like a cold start)?\n\nFor a business-critical application, what is the recommended way to prevent this specific type of failure? Would moving to a plan with pre-warmed instances (Premium or App Service Plan) be an effective mitigation strategy?\n\n![More failure details](https://github.com/user-attachments/assets/5a784b51-42da-4220-926d-29cc9901ffc0)",
      "solution": "Thanks for your patience on this.\n\n**[Error Background]**\nThe worker stores all [necessary function metadata](https://github.com/Azure/azure-functions-python-worker/blob/4dc961761331e48ac1ede13e1ec0f5766ee97d2a/workers/azure_functions_worker/functions.py#L22) (eg: input type, output type, return type) to use when executing the function. The [`assert fi is not None`](https://github.com/Azure/azure-functions-python-worker/blob/4dc961761331e48ac1ede13e1ec0f5766ee97d2a/workers/azure_functions_worker/dispatcher.py#L606) call is used to guarantee that the metadata exists -- basically that the worker knows how to execute that function.\n\nThis error was caused by a transient platform issue during specialization (the process where the container is initialized for your specific app). The worker attempted to execute the function but failed to locate the necessary metadata, resulting in the `assert fi is not None` failure.\n\nWhile investigating, this is what I found:\n\n- Your functions were running successfully before the issue occurred.\n- The worker was shut down (via SIGTERM), and a new instance started.\n- Specialization then failed \u2014 specifically, the container assign call didn\u2019t succeed.\n- As a result, the worker couldn't find the function metadata, and the executions failed.\n- The issue resolved itself once a new container instance was created.\n\n**Recommendations**\n\n- Customer-side: This was a transient platform issue. I haven't seen this error happen in the past week for your app nor an increase in specialization failures across all apps, so switching plans isn't necessary unless you're looking for enhanced performance or scale guarantees.\n- Platform-side: I'll follow up with our internal platform teams to investigate further and improve container specialization reliability.\n\nClosing this issue now that RCA and next steps have been provided, but feel free to re-open if you have further questions or concerns!",
      "labels": [],
      "created_at": "2025-07-01T10:45:48Z",
      "closed_at": "2025-07-14T21:06:14Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1715",
      "comments_count": 4
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1714,
      "title": "Azure Functions Core Tools\\workers\\python\\3.11/WINDOWS/Arm64/worker.py does not exist",
      "problem": "### Version\n\nI am getting below error when run` func start` in windows ARM64 machine:\n```\n Failed to initialize worker provider for: C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\n[2025-07-07T10:42:55.094Z] Microsoft.Azure.WebJobs.Script: File DefaultWorkerPath: C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.11/WINDOWS/Arm64/worker.py does not exist.\n[2025-07-07T10:42:55.532Z] Failed to initialize worker provider for: C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\n[2025-07-07T10:42:55.534Z] Microsoft.Azure.WebJobs.Script: File DefaultWorkerPath: C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.11/WINDOWS/Arm64/worker.py does not exist.\n[2025-07-07T10:42:55.542Z] Failed to initialize worker provider for: C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\n[2025-07-07T10:42:55.543Z] Microsoft.Azure.WebJobs.Script: File DefaultWorkerPath: C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.11/WINDOWS/Arm64/worker.py does not exist.\n[2025-07-07T10:42:55.777Z] A host error has occurred during startup operation 'eb252b9d-14a2-432f-a981-8e11af48835d'.\n[2025-07-07T10:42:55.780Z] Microsoft.Azure.WebJobs.Script: WorkerConfig for runtime: python not found.\n```\n\n### Description\n\nI am getting below error when run` func start` in windows ARM64 machine:\n```\n Failed to initialize worker provider for: C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\n[2025-07-07T10:42:55.094Z] Microsoft.Azure.WebJobs.Script: File DefaultWorkerPath: C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.11/WINDOWS/Arm64/worker.py does not exist.\n[2025-07-07T10:42:55.532Z] Failed to initialize worker provider for: C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\n[2025-07-07T10:42:55.534Z] Microsoft.Azure.WebJobs.Script: File DefaultWorkerPath: C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.11/WINDOWS/Arm64/worker.py does not exist.\n[2025-07-07T10:42:55.542Z] Failed to initialize worker provider for: C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\n[2025-07-07T10:42:55.543Z] Microsoft.Azure.WebJobs.Script: File DefaultWorkerPath: C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.11/WINDOWS/Arm64/worker.py does not exist.\n[2025-07-07T10:42:55.777Z] A host error has occurred during startup operation 'eb252b9d-14a2-432f-a981-8e11af48835d'.\n[2025-07-07T10:42:55.780Z] Microsoft.Azure.WebJobs.Script: WorkerConfig for runtime: python not found.\n```\n\n### Steps to reproduce\n\nI have installed azure-functions-core-tools x64 in windows ARM64 machine. when run func start command, it give below error:\n`[2025-07-07T10:42:55.089Z] Failed to initialize worker provider for: C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\n[2025-07-07T10:42:55.094Z] Microsoft.Azure.WebJobs.Script: File DefaultWorkerPath: C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.11/WINDOWS/Arm64/worker.py does not exist.\n[2025-07-07T10:42:55.532Z] Failed to initialize worker provider for: C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\n[2025-07-07T10:42:55.534Z] Microsoft.Azure.WebJobs.Script: File DefaultWorkerPath: C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.11/WINDOWS/Arm64/worker.py does not exist.\n[2025-07-07T10:42:55.542Z] Failed to initialize worker provider for: C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\n[2025-07-07T10:42:55.543Z] Microsoft.Azure.WebJobs.Script: File DefaultWorkerPath: C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.11/WINDOWS/Arm64/worker.py does not exist.\n[2025-07-07T10:42:55.777Z] A host error has occurred during startup operation 'eb252b9d-14a2-432f-a981-8e11af48835d'.\n[2025-07-07T10:42:55.780Z] Microsoft.Azure.WebJobs.Script: WorkerConfig for runtime: python not found.\n[2025-07-07T10:42:55.799Z] Failed to stop host instance '4c7abd88-5cda-40ec-bb64-f799e56ff422'.`",
      "solution": "> Hi [@ravindrakmr480](https://github.com/ravindrakmr480), yes, Windows Arm64 is not yet supported for python. Support for this is dependent on a new build from `grpcio`, and I don't have an ETA for that.\n> \n> We can revisit this once `grpcio` provides a build for `win-arm64`, but for now I will close this issue as not supported.\n\nIs there a repo for grpcio we could look for or create an issue? Edit: found it here https://github.com/grpc/grpc/issues.\n\nhttps://github.com/grpc/grpc/issues/37588#issuecomment-2315245351\n>There are currently no plans to provide native arm64 dlls for Windows.\nHowever see https://github.com/grpc/grpc/issues/31975 and https://github.com/grpc/grpc/pull/32017 for workarounds\n\nand https://github.com/grpc/grpc/issues/38538\n\nShould not be closed as completed I think better to do closed as not planned.",
      "labels": [
        "Needs: Triage (Functions)"
      ],
      "created_at": "2025-07-07T11:09:32Z",
      "closed_at": "2025-07-08T14:34:17Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1714",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1703,
      "title": "Error when running Python app locally after installing new Core Tools in M1 Mac",
      "problem": "Ran into fail to initialize worker error when running `func start` after installing new Core Tools in M1 Mac (MacOS Version 15.5). Error shows up regardless of how core tools was installed, through npm or homebrew. \n\nI looked into the file mentioned in the error: `usr/local/Cellar/azure-functions-core-tools@4/4.0.7317/workers/python/3.11/OSX/Arm64/worker.py`. It seems that instead of `/Arm64`, a directory called `/X64` is there instead, and the file **worker.py** is in that folder. \n \n```\nFound Python version 3.11.9 (python3).\n\nAzure Functions Core Tools\nCore Tools Version:       4.0.7317 Commit hash: N/A +5ca56d37938824531b691f094d0a77fd6f51af20 (64-bit)\nFunction Runtime Version: 4.1038.300.25164\n\n[2025-06-21T20:05:07.760Z] Failed to initialize worker provider for: /usr/local/Cellar/azure-functions-core-tools@4/4.0.7317/workers/python\n[2025-06-21T20:05:07.765Z] Microsoft.Azure.WebJobs.Script: File DefaultWorkerPath: /usr/local/Cellar/azure-functions-core-tools@4/4.0.7317/workers/python/3.11/OSX/Arm64/worker.py does not exist.\n[2025-06-21T20:05:09.191Z] Failed to initialize worker provider for: /usr/local/Cellar/azure-functions-core-tools@4/4.0.7317/workers/python\n[2025-06-21T20:05:09.192Z] Microsoft.Azure.WebJobs.Script: File DefaultWorkerPath: /usr/local/Cellar/azure-functions-core-tools@4/4.0.7317/workers/python/3.11/OSX/Arm64/worker.py does not exist.\n[2025-06-21T20:05:09.205Z] Failed to initialize worker provider for: /usr/local/Cellar/azure-functions-core-tools@4/4.0.7317/workers/python\n[2025-06-21T20:05:09.205Z] Microsoft.Azure.WebJobs.Script: File DefaultWorkerPath: /usr/local/Cellar/azure-functions-core-tools@4/4.0.7317/workers/python/3.11/OSX/Arm64/worker.py does not exist.\n[2025-06-21T20:05:09.505Z] A host error has occurred during startup operation 'e09d272a-5731-4110-b7c9-79da53139037'.\n[2025-06-21T20:05:09.505Z] Microsoft.Azure.WebJobs.Script: WorkerConfig for runtime: python not found.\n[2025-06-21T20:05:09.529Z] Failed to stop host instance '6a8df250-a8a5-4e1a-a2f8-0fc745da472d'.\n[2025-06-21T20:05:09.529Z] Microsoft.Azure.WebJobs.Host: The host has not yet started.\nValue cannot be null. (Parameter 'provider')\n```",
      "solution": "@unknown1989-99 - I have an M1 Mac. The problem was my Homebrew installed packages for Intel based architecture, not ARM64, so the Azure Functions Core Tools I installed with Homebrew didn't work for my Mac. I fixed the issue after reinstalling Homebrew for ARM64 systems, and then Core Tools. \n\nIf you run `which brew` or `brew --prefix` and get `/usr/local/bin/brew` and `/usr/local`, respectively, then your Homebrew installs packages for the Intel architecture. Just uninstall that and make sure you install the right one for ARM64. I used the following commands: \n* For uninstall: `/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/uninstall.sh)\"` (You may have to manually remove some remnants of Homebrew after running this since the script doesn't catch everything.)\n* For install: `arch -arm64 /bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"`. \n\nYou can test if you installed the right one by running `which brew` again. It should return `/opt/homebrew/bin/brew`. \n\nFinally, you can uninstall Core Tools and resintall it with Homebrew. Your Homebrew should install the ARM64 based package now. If you want to be doubly sure, you can do `arch -arm64 brew tap azure/functions` and then `arch -arm64 brew install azure-functions-core-tools@4`",
      "labels": [],
      "created_at": "2025-06-21T20:18:41Z",
      "closed_at": "2025-06-23T19:14:35Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1703",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1665,
      "title": "[Bug] Python worker restarts repeatedly because of python cache generation",
      "problem": "### Expected Behavior\n\nFunctions should not get caught in reboot loops because of automatic pycache generation\nUser should not manually have to disable pycache generation\n\n### Actual Behavior\n\nAs __pycache__ or .pyc files are auto-written to disk, the file change triggers a worker restart causing reboot loops as the function initalizes\n\n### Steps to Reproduce\n\n1. Deploy a Python app from ZIP without __pycache__ folders included\n\n### Relevant code being tried\n\n```shell\n\n```\n\n### Relevant log output\n\n```shell\n\n```\n\n### requirements.txt file\n\n```shell\n\n```\n\n### Where are you facing this problem?\n\nProduction Environment (explain below)\n\n### Function app name\n\n_No response_\n\n### Additional Information\n\nFilesystem monitoring should ignore `__pycache__` / `.pyc`  files, or the worker environment should set PYTHONPYCACHEPREFIX to avoid issues.\n\nSee #366 ",
      "solution": "Hi @stewartadam, thanks for reporting. Setting this environment variable to true by default would have performance impacts (and potentially other unintended effects), which would impact all customers, not just those who use Docker. It would require extensive testing on our end, and it's not something we're looking at right now.\n\nThere are workarounds provided specifically for customers who use Docker, as mentioned in the previous issue. We can add this environment variable into the Dockerfile generated by CoreTools to help with this, but the change would be in that Dockerfile, not the worker.\n\n---\n\nSorry, missed this.\n\nWe currently maintain only two directories: the worker directory and `home/site/wwwroot`. Changing `PYTHONPYCACHEPREFIX` to point to either of these wouldn't address the issue. Writing to a third, new directory by default could introduce risk\u2014it could conflict with directories used by the system, user code, or future platform features. To avoid unintended side effects, we recommend customers explicitly set `PYTHONPYCACHEPREFIX` themselves, ensuring the chosen path is safe for their specific scenario.\n\nWe also considered setting `PYTHONDONTWRITEBYTECODE`, but that could lead to performance regressions I mentioned earlier.\n\nOur main concern here is introducing a default environment variable that could affect all customers. Since this issue affects only a subset of users, and there are clear workarounds available, we believe it's best addressed at the customer level.",
      "labels": [
        "bug",
        "python"
      ],
      "created_at": "2025-04-09T20:43:26Z",
      "closed_at": "2025-06-06T19:13:42Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1665",
      "comments_count": 4
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1615,
      "title": "[Bug] Only TimerTrigger function get warning \"Auth level is not applied to non http function app\"",
      "problem": "### Expected Behavior\n\nNo warning was received.\n\n### Actual Behavior\n\nI get a warning that \"Auth level is not applied to non-http function app\", when I have not set any Auth level and only using timer triggered functions.\n\nThe full warning is: \"Auth level is not applied to non http function app. Ref: https://docs.microsoft.com/azure/azure-functions/functions-bindings-http-webhook-trigger?tabs=in-process%2Cfunctionsv2&pivots=programming-language-python#http-auth\"\n\n\n### Steps to Reproduce\n\n1. Create a repo with AZ function for python v2 with a single Timer trigger function\n\n### Relevant code being tried\n\n```shell\n\n```\n\n### Relevant log output\n\n```shell\n\n```\n\n### requirements.txt file\n\n```shell\n\n```\n\n### Where are you facing this problem?\n\nProduction Environment (explain below)\n\n### Function app name\n\n_No response_\n\n### Additional Information\n\nI think the issue is linked to this code: https://github.com/Azure/azure-functions-python-library/blob/39363d876db17d77b5747f4ce3878305dab235cf/azure/functions/decorators/function_app.py#L3637 \n\nThe issue I think is\n\n```python \n\n#  self._require_auth_level is None\n\nif not self._require_auth_level:\n            self._require_auth_level = any(\n                function.is_http_function() for function in functions)\n\n#  self._require_auth_level is False since no HTTP functions\n\n\nif not self._require_auth_level:\n# This is triggered, but I do not think it should be? \n    logging.warning(\n        'Auth level is not applied to non http '\n        'function app. Ref: '\n        'https://docs.microsoft.com/azure/azure-functions/functions'\n        '-bindings-http-webhook-trigger?tabs=in-process'\n        '%2Cfunctionsv2&pivots=programming-language-python#http-auth')\n```",
      "solution": "I cannot verify if the issue still exists as I am moving to different projects. \n\n---\n\nClosing due to inactivity -- if the issue is still occurring, please feel free to reopen",
      "labels": [
        "needs-attention :wave:"
      ],
      "created_at": "2024-12-02T12:47:29Z",
      "closed_at": "2025-01-07T16:54:07Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1615",
      "comments_count": 6
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1508,
      "title": "[Bug] dispatcher.py task factory doesn't allow for optional `context` parameter",
      "problem": "### Expected Behavior\n\nPython 3.11 allows for a named `context` parameter to be passed in when constructing a task (https://github.com/python/cpython/blob/3.11/Lib/asyncio/tasks.py#L106). However, the task factory that creates a `ContextEnabledTask` inside of `dispatcher.py` doesn't allow for that parameter. When a task is added that attempts to utilize the parameter, an error is raised instead:\r\n\r\n```\r\nSystem.Private.CoreLib: Exception while executing function: Functions.mention_queue_trigger. System.Private.CoreLib: Result: Failure\r\nException: TypeError: Dispatcher.dispatch_forever.<locals>.<lambda>() got an unexpected keyword argument 'context'\r\n...\r\nFile \"~\\Python\\Python311\\Lib\\asyncio\\base_events.py\", line 449, in create_task\r\n    task = self._task_factory(self, coro, context=context)\r\n```\n\n### Actual Behavior\n\nThe task_factory lambda and the ContextEnabledTask should be able to accept the optional, named parameter of `context`\n\n### Steps to Reproduce\n\nUsing the existing task_factory, attempt to add a new task along with the named `context` parameter.\n\n### Relevant code being tried\n\n```shell\nThe following fix appears to resolve the issue:\r\n\r\n\r\n+++ b/azure_functions_worker/dispatcher.py\r\n@@ -141,7 +141,7 @@ class Dispatcher(metaclass=DispatcherMeta):\r\n                         worker_id=self.worker_id)))\r\n\r\n             self._loop.set_task_factory(\r\n-                lambda loop, coro: ContextEnabledTask(coro, loop=loop))\r\n+                lambda loop, coro, context=None: ContextEnabledTask(coro, loop=loop, context=context))\r\n\r\n             # Detach console logging before enabling GRPC channel logging\r\n             logger.info('Detaching console logging.')\r\n@@ -849,8 +849,8 @@ class AsyncLoggingHandler(logging.Handler):\r\n class ContextEnabledTask(asyncio.Task):\r\n     AZURE_INVOCATION_ID = '__azure_function_invocation_id__'\r\n\r\n-    def __init__(self, coro, loop):\r\n-        super().__init__(coro, loop=loop)\r\n+    def __init__(self, coro, loop, context=None):\r\n+        super().__init__(coro, loop=loop, context = context)\r\n\r\n         current_task = asyncio.current_task(loop)\r\n         if current_task is not None:\r\n\r\n```\n```\n\n\n### Relevant log output\n\n_No response_\n\n### requirements.txt file\n\n_No response_\n\n### Where are you facing this problem?\n\nLocal - Core Tools\n\n### Function app name\n\n_No response_\n\n### Additional Information\n\n_No response_",
      "solution": "@jreed-Aces have you found a workaround for this? I'm having the same issue right now and you just happened to create this 2 days ago \ud83d\ude42\n\n---\n\n@brbarnett We downgraded to Python 3.10, which doesn't have the optional `context` parameter. It fixes the issue, but it's far from ideal. \r\n\r\nLocally the code fix I posted above works, but that doesn't help when deploying to Azure.\n\n---\n\nI have the same issue with **py 3.11**... Fixed for the moment with **py 3.10 version** ",
      "labels": [
        "bug",
        "python"
      ],
      "created_at": "2024-06-10T17:44:23Z",
      "closed_at": "2024-08-14T19:08:08Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1508",
      "comments_count": 22
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1338,
      "title": "[BUG] Azure function python v2 not visible in Azure Portal after deployment",
      "problem": "Follow the steps mentioned in the document to deploy the function.\r\nhttps://learn.microsoft.com/en-us/azure/azure-functions/create-first-function-vs-code-python?pivots=python-mode-decorators\r\n\r\n### Investigative information\r\n###### Please provide the following:\r\n\r\n\r\n- Timestamp: always happening\r\n- Core Tools version: V1.2.0, through VS code extension\r\n- VS code- 1.83.1\r\n\r\n### Repro steps\r\n###### Provide the steps required to reproduce the problem:\r\n\r\n\r\n1. Follow steps as in above doc\r\n2. Create a blob trigger function\r\n3. add the below requirements.txt\r\n4. add the below to app.py\r\n5. test locally- runs perfectly!\r\n6. deploy to azure using VS code, right click \"deploy to azure\", once successful - **DOESNT SHOW IN PORTAL**.\r\n\r\n-->\r\n\r\n### Expected behavior\r\n###### Provide a description of the expected behavior.\r\n\r\n1. The function should be visible on portal\r\n2. The function should be executed once blob is uploaded into the blob-storage\r\n3. Expected to work as it behaves on local.\r\n\r\n### Actual behavior\r\n###### Provide a description of the actual behavior observed.\r\n\r\n1. Cannot find the function\r\n2. The function doesnt execute when the endpoint is hit\r\n3. the local test works but the deployed function doesnt\r\n4. fails in consumption plan\r\n5. fails in app service plan\r\n\r\n\r\n### Known workarounds\r\n###### Provide a description of any known workarounds.\r\n\r\nNo workarounds\r\n\r\n### Contents of the requirements.txt file:\r\n###### Provide the requirements.txt file to help us find out module related issues.\r\n\r\nFiles at the end\r\n\r\n### Related information\r\n###### Provide any related information\r\n\r\n* No specific source files except the two above\r\n* Python version used - 3.9.13\r\n* referred these but not helpful to fix the bug https://learn.microsoft.com/en-us/azure/azure-functions/machine-learning-pytorch?tabs=bash\r\n* https://stackoverflow.com/questions/76458717/why-is-the-functions-runtime-not-finding-my-functions-when-i-import-certain-pack/76463210?noredirect=1#comment134830419_76463210\r\n\r\n\r\n<details>\r\n<summary>Source</summary>\r\n\r\n```python\r\nimport azure.functions as func\r\nimport logging\r\nimport os\r\n\r\n#qdrant\r\nfrom qdrant_client import QdrantClient\r\nfrom qdrant_client.models import Distance, VectorParams,PointStruct \r\n\r\n#encoder for vecotrizing embeddings\r\nfrom sentence_transformers import SentenceTransformer\r\n\r\nfrom langchain.document_loaders import PyPDFLoader\r\nfrom langchain.document_loaders import DirectoryLoader\r\nfrom langchain.text_splitter import RecursiveCharacterTextSplitter\r\n\r\n#https://stackoverflow.com/questions/75627362/azure-functions-python-error-no-job-functions\r\n\r\napp = func.FunctionApp()\r\n\r\n@app.blob_trigger(arg_name=\"myblob\", path=\"mycontainer\",\r\n                               connection=\"BlobStorageConnectionString\") \r\ndef blob_trigger(myblob: func.InputStream):\r\n    logging.info(f\"Python blob trigger function processed blob\"\r\n                f\"Name: {myblob.name}\"\r\n                f\"Blob Size: {myblob.length} bytes\")\r\n\r\n\r\n```\r\n\r\n```txt\r\n# DO NOT include azure-functions-worker in this file\r\n# The Python Worker is managed by Azure Functions platform\r\n# Manually managing azure-functions-worker may cause unexpected issues\r\n\r\nazure-functions\r\n-f https://download.pytorch.org/whl/torch_stable.html\r\ntorch==1.13.1+cpu\r\ntorchvision==0.14.1+cpu\r\ntorchaudio==0.13.1\r\nsentence_transformers==2.2.2\r\nlangchain==0.0.274\r\nqdrant_client==1.2.0\r\npypdf==3.9.0\r\n```\r\n\r\n</details>\r\n\r\n\r\nSeveral customers reported this issue here, which was closed with no answer. \r\nhttps://github.com/Azure/azure-functions-python-worker/issues/1262\r\nPlease kindly look in and suggest.\r\n\r\n\r\nTagging you from the closed issue where the MS team hasn't been responding.\r\n@Otimkev \r\n@andrewmmm\r\n@jsm-NK\r\n@aadamsx\r\n@JarroVGIT\r\n@SiddheshDesai06",
      "solution": "If your function is working locally - and deploys successfully but no files or functions are visible after deployment - this is potentially the issue: \r\nhttps://github.com/Azure/azure-functions-python-worker/issues/1262#issuecomment-1784778748\n\n---\n\n> Adding a comment to this ticket as well since this one is open. (#1262 is closed)\r\n> \r\n> All I had in my requirements.txt file was azure-functions and I still saw this.\r\n\r\nSaw what, exactly? The issue in #1262 can have many causes. Do you built locally and do a ZIP deployment? Do you perform a remote build? I have a special repo with reproducible steps for the issue of 'Functions not showing in Azure Portal', and they all have the same issue: there is an unhandled exception raised in the root of your script or imports. The reason may vary:\r\n- You do a ZIP deployment, but perform the `pip install` step on a Windows machine, while deploying to a Linux machine and one of your dependencies was specifically downloaded for Windows;\r\n- You have a relative import that doesn't work;\r\n- You get an environment variable that doesn't exists in the root of your `.py` file with ` my_var = os.environ('MYVAR')` (this will raise a `KeyError` if `MYVAR` doesn't exists);\r\n\r\nEtc. There are countless ways to induce this behavior and the only thing Microsoft has to do is to propagate the exception raised to Application Insight so we can actually see what is wrong. \r\n\r\nIf you have no idea what is wrong: pull everything in the scope of your function method. So, rather than doing this:\r\n\r\n```python\r\nimport azure.functions as func\r\nimport my_package\r\nimport os\r\n\r\nmyvar = os.environ(\"MYVAR\")\r\n\r\napp = func.FunctionApp()\r\n\r\n@app.function_name(name=\"HttpExample\")\r\n@app.route(route=\"hello\")\r\ndef test_function(req: func.HttpRequest) -> func.HttpResponse:\r\n    return func.HttpResponse(\"HttpExample function processed a request!\")\r\n```\r\n\r\n\r\nTry this:\r\n\r\n```python\r\nimport azure.functions as func\r\n\r\napp = func.FunctionApp()\r\n\r\n@app.function_name(name=\"HttpExample\")\r\n@app.route(route=\"hello\")\r\ndef test_function(req: func.HttpRequest) -> func.HttpResponse:\r\n    import my_package\r\n    import os\r\n\r\n    myvar = os.environ(\"MYVAR\")\r\n    return func.HttpResponse(\"HttpExample function processed a request!\")\r\n```\r\n\r\nNow call your function and see what exception you get. If you don't get an exception, then at least you can move back the lines of code one by one to pinpoint which one is causing issues.\r\n\n\n---\n\nThanks for you great feedback and insights on this problem!\r\n\r\nMy use case is pretty simple; I create an HttpTrigger, then I create another one in a new blueprint file, and do the import and register_functions in function_app.py. As such:\r\n\r\n- I have no entries in requirements.txt except for azure-functions.\r\n- The only relative import I have is importing the blueprint so I can register it. When I comment out the register_app but not the import, it works fine, i.e., I see the function on the portal. So presumably the import is fine.\r\n- I'm not accessing any environment variables.\r\n\r\nRight now, I'm thinking the only way out is to back off to V1, which seems to work fine.\r\n\r\nYes, I look forward to some logging that will pinpoint the source of the problem.\r\n\r\nThanks again!",
      "labels": [
        "needs-attention :wave:"
      ],
      "created_at": "2023-10-30T09:11:15Z",
      "closed_at": "2023-12-20T15:21:37Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1338",
      "comments_count": 30
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1672,
      "title": "Azure Python Function (in Linux App Service) fails after updating azure functions runtime from 4.1037.1 to  4.1038.400.1",
      "problem": "Azure Python Function (in Linux App Service) fails after updating azure functions runtime from 4.1037.1 to  4.1038.400.1 \n\nUsing:\n\n- Python 3.11\n- azure-monitor-opentelemetry-exporter==1.0.0b27\n- opentelemetry-api==1.25.0\n- opentelemetry-sdk==1.25.0\n- opentelemetry-semantic-conventions==0.46b0\n\n**Setting the Azure Functions Runtime to 4.1038.400.4 fixes the issue.**\n\nThe error we get:\n\n```\nException while executing function: Functions.health Result: Failure\nException: ImportError: cannot import name '_OTEL_PYTHON_EVENT_LOGGER_PROVIDER' from 'opentelemetry.environment_variables' (/home/site/wwwroot/.python_packages/lib/site-packages/opentelemetry/environment_variables.py). Cannot find module. Please check the requirements.txt file for the missing module. For more info, please refer the troubleshooting guide: https://aka.ms/functions-modulenotfound. Current sys.path: ['/home/site/wwwroot', '/home/site/wwwroot/.python_packages/lib/site-packages', '/azure-functions-host/workers/python/3.11/LINUX/X64', '/usr/local/lib/python311.zip', '/usr/local/lib/python3.11', '/usr/local/lib/python3.11/lib-dynload', '/usr/local/lib/python3.11/site-packages']\nStack:   File \"/azure-functions-host/workers/python/3.11/LINUX/X64/azure_functions_worker/dispatcher.py\", line 546, in _handle__function_load_request\n    func = loader.load_function(\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/azure-functions-host/workers/python/3.11/LINUX/X64/azure_functions_worker/utils/wrappers.py\", line 49, in call\n    raise extend_exception_message(e, message)\n  File \"/azure-functions-host/workers/python/3.11/LINUX/X64/azure_functions_worker/utils/wrappers.py\", line 44, in call\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/azure-functions-host/workers/python/3.11/LINUX/X64/azure_functions_worker/loader.py\", line 220, in load_function\n    mod = importlib.import_module(fullmodname)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/importlib/__init__.py\", line 126, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<frozen importlib._bootstrap>\", line 1204, in _gcd_import\n  File \"<frozen importlib._bootstrap>\", line 1176, in _find_and_load\n  File \"<frozen importlib._bootstrap>\", line 1147, in _find_and_load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 690, in _load_unlocked\n  File \"<frozen importlib._bootstrap_external>\", line 940, in exec_module\n  File \"<frozen importlib._bootstrap>\", line 241, in _call_with_frames_removed\n  File \"/home/site/wwwroot/health/healthcheck.py\", line 3, in <module>\n    from utils.get_extension import get_extension\n  File \"/home/site/wwwroot/utils/get_extension.py\", line 13, in <module>\n    discovered_plugins = {\n                         ^\n  File \"/home/site/wwwroot/utils/get_extension.py\", line 14, in <dictcomp>\n    name: importlib.import_module(name)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.11/importlib/__init__.py\", line 126, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/site/wwwroot/extension/core_kafka/__init__.py\", line 6, in <module>\n    import health.common as health\n  File \"/home/site/wwwroot/health/common.py\", line 7, in <module>\n    from sink.utils.metrics import DeliveryMetricTypes, DeliveryMetricsCollector\n  File \"/home/site/wwwroot/sink/utils/metrics.py\", line 7, in <module>\n    from sink.utils.metrics_extensions import CustomAzureMetricExporter\n  File \"/home/site/wwwroot/sink/utils/metrics_extensions.py\", line 4, in <module>\n    from azure.monitor.opentelemetry.exporter import AzureMonitorMetricExporter\n  File \"/usr/local/lib/python3.11/site-packages/azure/monitor/opentelemetry/__init__.py\", line 7, in <module>\n    from azure.monitor.opentelemetry._configure import configure_azure_monitor\n  File \"/usr/local/lib/python3.11/site-packages/azure/monitor/opentelemetry/_configure.py\", line 10, in <module>\n    from opentelemetry._events import _set_event_logger_provider\n  File \"/usr/local/lib/python3.11/site-packages/opentelemetry/_events/__init__.py\", line 22, in <module>\n    from opentelemetry.environment_variables import (\n \n```",
      "solution": "Hello @heldersantocristovao96 Thank you for reporting please mention the steps to reproduce the issue .\n\n---\n\nYou mention that setting the host `4.1038.400.4` fixes the issue, but its broken in `4.1038.400.1`?\n\nThat seems pretty logical as .4 is a hotfix that was deployed on v4.1038 of the host. Given `4.1038.400.4` is the latest and the issue is resolved there, I don't understand how this is an issue?",
      "labels": [],
      "created_at": "2025-04-23T08:45:27Z",
      "closed_at": "2025-04-29T09:43:45Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1672",
      "comments_count": 2
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1525,
      "title": "```func new``` not creating a valid template with Python",
      "problem": "On https://learn.microsoft.com/en-us/azure/azure-functions/create-first-function-cli-python?tabs=linux%2Cbash%2Cazure-cli%2Cbrowser#create-a-local-function it is explained that a new function can be created with the command ```func new --name HttpExample --template \"HTTP trigger\" --authlevel \"anonymous\"```. However, this executing this command generates invalid code. When trying to run ```func start``` afterwards, an exception is raised:\r\n```\r\nWorker failed to index functions\r\nResult: Failure\r\nException: AttributeError: anonymous\r\n```\r\n\r\nIt appears that the function decorator is not generated correctly: It should be ```@app.route(route=\"HttpExample\", auth_level=func.AuthLevel.ANONYMOUS)``` instead of ```@app.route(route=\"HttpExample\", auth_level=func.AuthLevel.Anonymous)```.",
      "solution": "Hi @gavin-aguiar, my PR https://github.com/Azure/azure-functions-core-tools/pull/4382 has been approved and merged. The problem is that it is in the azure-functions-core-tools library, so this issue didn't get automatically closed. \n\nThis issue can be closed now.\n\nThank you for reporting it Lukas! Your issue was very helpful to find and fix. The fix should be included in the next release, but I'm not sure when that will be.",
      "labels": [
        "bug"
      ],
      "created_at": "2024-07-01T07:23:23Z",
      "closed_at": "2025-04-22T15:44:44Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1525",
      "comments_count": 2
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1487,
      "title": "[BUG] ModuleNotFoundError: No module named 'dotenv'",
      "problem": "### Investigative information\r\n###### Please provide the following:\r\n\r\n\r\n- Timestamp: April 29th\r\n- Function App name: functionapp-test-dotenv\r\n- Function name(s) (as appropriate): main\r\n- Core Tools version: 4.0.5611\r\n\r\n### Repro steps\r\n\r\nStep 1: Clone [this](https://github.com/emielsteerneman/functionapp_test_dotenv) repository, which is a project I have setup to demonstrate this bug. It is a python 3.11 function app in its most basic form, with `dotenv` as requirement.\r\nStep 2: Deploy this project to a Python 3.11 function app on Azure. \r\n\r\n### Expected behavior\r\n\r\nThe function app should deploy and start without errors. The `/api/hello` endpoint should work.\r\n\r\n### Actual behavior\r\n\r\nAn error `ModuleError : No module named 'dotenv'` is thrown.\r\n\r\n![Screenshot from 2024-04-30 11-34-50](https://github.com/Azure/azure-functions-python-worker/assets/5947757/d7f15840-1ddc-4895-910a-8200cc4e3f72)\r\n\r\n### Known workarounds\r\nNone\r\n\r\n### Contents of the requirements.txt file:\r\n###### Provide the requirements.txt file to help us find out module related issues.\r\n\r\n```\r\nazure-functions\r\npython-dotenv\r\n```\r\n\r\n### Related information\r\n\r\nI've ran into this problem a month ago. I have been trying to deploy [my actual project](https://github.com/emielsteerneman/TDP/tree/refactor) for some time now, but I keep running into errors that are not logged anywhere except in screenshot above. Neither the Core Tools, the Github CI/CD Actions, the Logstream, or the App Insights logs (specifically the `traces`) show any error when deploying. I've managed to trace it back to the `dotenv` module.  Removing the `dotenv` module from the project makes it run without problem. <b> Locally </b>, using `func start`, everything works as intended. Only when deploying it to Azure does it fail.\r\n\r\n* Links to source\r\nProject that demonstrates this problem : https://github.com/emielsteerneman/functionapp_test_dotenv\r\nRelated Stackoverflow post : https://stackoverflow.com/questions/78381457/where-to-find-azure-functionapp-deploy-errors-for-python-3-11-in-the-azure-porta/78382299\r\nActual project to deploy : https://github.com/emielsteerneman/TDP/tree/refactor\r\nPossibly related issue : https://github.com/Azure/azure-functions-python-worker/issues/1094\r\n\r\n<details>\r\n<summary>Source and stack trace</summary>\r\n\r\n```python\r\nimport azure.functions as func\r\nimport dotenv\r\nfrom dotenv import load_dotenv\r\n\r\napp = func.FunctionApp(http_auth_level=func.AuthLevel.ANONYMOUS)\r\n\r\n@app.route('hello')\r\ndef main(req):\r\n    return func.HttpResponse(\"Hello World! : \" + str(load_dotenv), mimetype=\"text/plain\")\r\n```\r\n\r\n<b>Microsoft.Azure.WebJobs.Script.Workers.Rpc.RpcException</b>\r\nWorker failed to index functions\r\nResult: Failure Exception: ModuleNotFoundError: No module named 'dotenv'. Cannot find module. Please check the requirements.txt file for the missing module. For more info, please refer the troubleshooting guide: https://aka.ms/functions-modulenotfound. Current sys.path: ['/tmp/functions\\\\standby\\\\wwwroot', '/home/site/wwwroot/.python_packages/lib/site-packages', '/azure-functions-host/workers/python/3.11/LINUX/X64', '/usr/local/lib/python311.zip', '/usr/local/lib/python3.11', '/usr/local/lib/python3.11/lib-dynload', '/usr/local/lib/python3.11/site-packages'] Stack: File '/azure-functions-host/workers/python/3.11/LINUX/X64/azure_functions_worker/dispatcher.py', line 348, in _handle__functions_metadata_request fx_metadata_results = self.index_functions(function_path) ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ File '/azure-functions-host/workers/python/3.11/LINUX/X64/azure_functions_worker/dispatcher.py', line 633, in index_functions indexed_functions = loader.index_function_app(function_path) ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ File '/azure-functions-host/workers/python/3.11/LINUX/X64/azure_functions_worker/utils/wrappers.py', line 49, in call raise extend_exception_message(e, message) File '/azure-functions-host/workers/python/3.11/LINUX/X64/azure_functions_worker/utils/wrappers.py', line 44, in call return func(*args, **kwargs) ^^^^^^^^^^^^^^^^^^^^^ File '/azure-functions-host/workers/python/3.11/LINUX/X64/azure_functions_worker/loader.py', line 222, in index_function_app imported_module = importlib.import_module(module_name) ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ File '/usr/local/lib/python3.11/importlib/init.py', line 126, in import_module return _bootstrap._gcd_import(name[level:], package, level) ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ File '/home/site/wwwroot/function_app.py', line 2, in import dotenv\r\n\r\n<b>Error: No module named 'dotenv', Cannot find module.</b>\r\nError: No module named 'dotenv', Cannot find module. Please check the requirements.txt file for the missing module. For more info, please refer the troubleshooting guide: https://aka.ms/functions-modulenotfound. Current sys.path: ['/tmp/functions\\\\standby\\\\wwwroot', '/home/site/wwwroot/.python_packages/lib/site-packages', '/azure-functions-host/workers/python/3.11/LINUX/X64', '/usr/local/lib/python311.zip', '/usr/local/lib/python3.11', '/usr/local/lib/python3.11/lib-dynload', '/usr/local/lib/python3.11/site-packages'] Traceback (most recent call last): File '/azure-functions-host/workers/python/3.11/LINUX/X64/azure_functions_worker/utils/wrappers.py', line 44, in call return func(*args, **kwargs) ^^^^^^^^^^^^^^^^^^^^^ File '/azure-functions-host/workers/python/3.11/LINUX/X64/azure_functions_worker/loader.py', line 222, in index_function_app imported_module = importlib.import_module(module_name) ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ File '/usr/local/lib/python3.11/importlib/init.py', line 126, in import_module return _bootstrap._gcd_import(name[level:], package, level) ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ File '', line 1204, in _gcd_import File '', line 1176, in _find_and_load File '', line 1147, in _find_and_load_unlocked File '', line 690, in _load_unlocked File '', line 940, in exec_module File '', line 241, in _call_with_frames_removed File '/home/site/wwwroot/function_app.py', line 2, in import dotenv ModuleNotFoundError: No module named 'dotenv'\r\n\r\n<b> ERROR: Error: No module named 'dotenv', Cannot find module. </b>\r\nERROR: Error: No module named 'dotenv', Cannot find module. Please check the requirements.txt file for the missing module. For more info, please refer the troubleshooting guide: https://aka.ms/functions-modulenotfound. Current sys.path: ['/tmp/functions\\\\standby\\\\wwwroot', '/home/site/wwwroot/.python_packages/lib/site-packages', '/azure-functions-host/workers/python/3.11/LINUX/X64', '/usr/local/lib/python311.zip', '/usr/local/lib/python3.11', '/usr/local/lib/python3.11/lib-dynload', '/usr/local/lib/python3.11/site-packages']\r\n\r\n<b> No job functions found. Try making your job classes and methods  </b>\r\nNo job functions found. Try making your job classes and methods public. If you're using binding extensions (e.g. Azure Storage, ServiceBus, Timers, etc.) make sure you've called the registration method for the extension(s) in your startup code (e.g. builder.AddAzureStorage(), builder.AddServiceBus(), builder.AddTimers(), etc.).\r\n\r\n</details>\r\n",
      "solution": "> @emielsteerneman are you still facing this issue? Few things to try out with your workflow file:\r\n> \r\n>     * Remove the venv\r\n> \r\n>     * Install the pip dependencies using this target `--target=\".python_packages/lib/site-packages`\r\n> \r\n> \r\n> Here is a sample github workflow file. https://learn.microsoft.com/en-us/azure/azure-functions/functions-how-to-github-actions?tabs=linux%2Cpython&pivots=method-manual#example-workflow-configuration-file\r\n\r\nI don't know if I'm still facing this issue. For now I switched to Python 3.10 where this issue is not present. The Github workflow might fix the issue. Unfortunately, doing your steps is not possible with `func azure functionapp publish`. I don't have the time this week to test the Github workflow, but probably somewhere within the next three weeks.\n\n---\n\n@hallvictoria I'm having the same issue using python 3.11 and python-dotenv==1.0.1.  I had this working in one of my functions app that uses basic authentication. Getting this error for the same function when it's deployed with disabled basic authentication.  The workaround of adding `--target=\".python_packages/lib/site-packages` didn't work.",
      "labels": [
        "needs-attention :wave:"
      ],
      "created_at": "2024-04-30T10:07:55Z",
      "closed_at": "2025-01-07T16:43:32Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1487",
      "comments_count": 9
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1662,
      "title": "Clarify Retry Behavior in Azure Function Apps (Service Bus)",
      "problem": "#### Is your question related to a specific version? If so, please specify:\nExtension Bundle:\n```json\n\"extensionBundle\": {\n    \"id\": \"Microsoft.Azure.Functions.ExtensionBundle\",\n    \"version\": \"[4.*, 5.0.0)\"\n},\n```\n\nPython Programming Model:\n```json\n\"version\": \"2.0\"\n```\n\n#### What binding does your question apply to, if any? (e.g. Blob Trigger, Event Hub Binding, etc) \n```python\n@app.service_bus_queue_trigger(...)\n# and \n@app.retry(...)\n```\n\n#### Question\n\nI've configured retries using the following code:\n\n**function_app.py**:\n```python\n@app.function_name(name=\"...\")\n@app.service_bus_queue_trigger(...)\n@app.retry(\n    strategy=\"exponential_backoff\",\n    max_retry_count=\"3\",\n    minimum_interval=\"00:00:08\",\n    maximum_interval=\"00:00:60\",\n)\ndef process_something(...):\n    pass\n```\n\n**host.json**:\n```json\n\"extensions\": {\n    \"serviceBus\": {\n        \"clientRetryOptions\": {\n            \"mode\": \"exponential\",\n            \"tryTimeout\": \"00:01:00\",\n            \"delay\": \"00:00:00.80\",\n            \"maxDelay\": \"00:01:00\",\n            \"maxRetries\": 3\n        }\n    }\n}\n```\n\nWhen I start the function app (locally or in the cloud) I get the following warning:\n\n```\nSoon retries will not be supported for function 'Functions.process_something'. For more information, please visit http://aka.ms/func-retry-policies.\n```\n\nWhen I follow the link, I don't find any information regarding a deprecation or a migration path to an alternative solution.\n\n**Now my questions**:\n* Is the warning correct and retries using the decorator will stop working?\n* If so, how should we implement retries?\n\n**More feedback**:\nFor us developers it's much easier if (updated) documentation is located next to the code. As an example: to understand what the `@app.retry` parameter actually does, I have to follow the link and hope that\n* the link is working\n* the link is up-2-date\n* the documentation applies to the language I am using\n\nPlease let me know if you need any further information \ud83d\udc4d \n\nBest\nElias",
      "solution": "Hi @JAdluri,\n\nThanks for the clarification! That makes a lot of sense. As you guys work on aligning the functionality of [these Python bindings with the C# ones](https://github.com/Azure/azure-functions-python-worker/issues/1659), I believe this will provide a clean approach to error handling.\n\nI have a couple of requests:\n* Please maintain the current retry functionality (the one using the decorator) until you guys implement [manual message dead lettering or abandonment](https://github.com/Azure/azure-functions-python-worker/issues/1659) \ud83d\ude05 \n* It would be great if you could update [the documentation](https://learn.microsoft.com/en-us/azure/azure-functions/functions-bindings-error-pages?tabs=fixed-delay%2Cisolated-process%2Cnode-v4%2Cpython-v2&pivots=programming-language-python#retry-examples) to include how to implement `fixed_delay` and/or `exponential_backoff` strategies with dead letter messages **in Python** using this new approach \ud83d\udc4d \n\nThanks again for your help! For me everything is clear now, so the issue can be closed \ud83d\ude04 \n\nBest,\nElias",
      "labels": [
        "needs-attention :wave:"
      ],
      "created_at": "2025-04-03T09:00:47Z",
      "closed_at": "2025-04-14T07:22:55Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1662",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1273,
      "title": "[BUG] Starlette app throws 'State' object has no attribute 'dbpool' when deployed as an az func but runs normally with uvicorn",
      "problem": "### Investigative information\r\n###### Please provide the following:\r\n\r\n\r\n- Timestamp: 2023-06-28 08:58:35.849\r\n- Function App name: https://raster.azurewebsites.net\r\n- Function name(s) (as appropriate): http_app_func\r\n- Core Tools version: 4.0.5095\r\n- Invocation id: 9afa1aa8-76ae-4d3f-87ee-90c58bd0d927 (taken from the function logs)\r\n- Region: West Europe\r\n\r\n### Repro steps\r\n```bash\r\nexport DATABASE_URL=\"postgresql://<username>:<password>@<domain>:5432/<database>\"\r\n```\r\n```python\r\nimport azure.functions as func\r\n\r\nfrom fastapi import Depends, FastAPI, Query\r\nfrom psycopg import OperationalError\r\nfrom psycopg_pool import PoolTimeout\r\nfrom typing import Dict\r\n\r\nfapp = FastAPI()\r\n\r\n\r\n@fapp.get(\"/healthz\", description=\"Health Check\", tags=[\"Health Check\"])\r\ndef ping(\r\n    timeout: int = Query(1, description=\"Timeout getting SQL connection from the pool.\")\r\n) -> Dict:\r\n    \"\"\"Health check.\"\"\"\r\n    try:\r\n        with fapp.state.dbpool.connection(timeout) as conn:\r\n            with conn.cursor() as cursor:\r\n                cursor.execute(\"SELECT 1;\")\r\n                version = cursor.fetchone()\r\n        return {\"database_online\": True}\r\n    except (OperationalError, PoolTimeout):\r\n        return {\"database_online\": False}\r\n\r\napp = func.AsgiFunctionApp(app=fapp, http_auth_level=func.AuthLevel.ANONYMOUS)\r\n```\r\n```bash\r\nfunc start\r\n```\r\n\r\n\r\n### Expected behavior\r\nI expect to get a response \r\n\r\n### Actual behavior\r\nThere is a 500 response and the error in the function is `Exception: AttributeError: 'State' object has no attribute 'dbpool'`\r\n\r\nFull error:\r\n```\r\nResult: Failure Exception: AttributeError: 'State' object has no attribute 'dbpool' Stack: File \"/azure-functions-host/workers/python/3.10/LINUX/X64/azure_functions_worker/dispatcher.py\", line 475, in _handle__invocation_request call_result = await self._run_async_func( File \"/azure-functions-host/workers/python/3.10/LINUX/X64/azure_functions_worker/dispatcher.py\", line 758, in _run_async_func return await ExtensionManager.get_async_invocation_wrapper( File \"/azure-functions-host/workers/python/3.10/LINUX/X64/azure_functions_worker/extension.py\", line 147, in get_async_invocation_wrapper result = await function(**args) File \"/azure-functions-host/workers/python/3.10/LINUX/X64/azure/functions/decorators/function_app.py\", line 2068, in http_app_func return await asgi_middleware.handle_async(req, context) File \"/azure-functions-host/workers/python/3.10/LINUX/X64/azure/functions/_http_asgi.py\", line 199, in handle_async return await self._handle_async(req, context) File \"/azure-functions-host/workers/python/3.10/LINUX/X64/azure/functions/_http_asgi.py\", line 204, in _handle_async asgi_response = await AsgiResponse.from_app(self._app, File \"/azure-functions-host/workers/python/3.10/LINUX/X64/azure/functions/_http_asgi.py\", line 80, in from_app await app(scope, res._receive, res._send) File \"/home/site/wwwroot/.python_packages/lib/site-packages/fastapi/applications.py\", line 271, in __call__ await super().__call__(scope, receive, send) File \"/home/site/wwwroot/.python_packages/lib/site-packages/starlette/applications.py\", line 118, in __call__ await self.middleware_stack(scope, receive, send) File \"/home/site/wwwroot/.python_packages/lib/site-packages/starlette/middleware/errors.py\", line 184, in __call__ raise exc File \"/home/site/wwwroot/.python_packages/lib/site-packages/starlette/middleware/errors.py\", line 162, in __call__ await self.app(scope, receive, _send) File \"/home/site/wwwroot/.python_packages/lib/site-packages/starlette_cramjam/middleware.py\", line 112, in __call__ await responder(scope, receive, send) File \"/home/site/wwwroot/.python_packages/lib/site-packages/starlette_cramjam/middleware.py\", line 142, in __call__ await self.app(scope, receive, self.send_with_compression) File \"/home/site/wwwroot/.python_packages/lib/site-packages/titiler/core/middleware.py\", line 62, in __call__ await self.app(scope, receive, send_wrapper) File \"/home/site/wwwroot/.python_packages/lib/site-packages/starlette/middleware/cors.py\", line 84, in __call__ await self.app(scope, receive, send) File \"/home/site/wwwroot/.python_packages/lib/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__ raise exc File \"/home/site/wwwroot/.python_packages/lib/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__ await self.app(scope, receive, sender) File \"/home/site/wwwroot/.python_packages/lib/site-packages/fastapi/middleware/asyncexitstack.py\", line 21, in __call__ raise e File \"/home/site/wwwroot/.python_packages/lib/site-packages/fastapi/middleware/asyncexitstack.py\", line 18, in __call__ await self.app(scope, receive, send) File \"/home/site/wwwroot/.python_packages/lib/site-packages/starlette/routing.py\", line 706, in __call__ await route.handle(scope, receive, send) File \"/home/site/wwwroot/.python_packages/lib/site-packages/starlette/routing.py\", line 276, in handle await self.app(scope, receive, send) File \"/home/site/wwwroot/.python_packages/lib/site-packages/starlette/routing.py\", line 66, in app response = await func(request) File \"/home/site/wwwroot/.python_packages/lib/site-packages/fastapi/routing.py\", line 237, in app raw_response = await run_endpoint_function( File \"/home/site/wwwroot/.python_packages/lib/site-packages/fastapi/routing.py\", line 165, in run_endpoint_function return await run_in_threadpool(dependant.call, **values) File \"/home/site/wwwroot/.python_packages/lib/site-packages/starlette/concurrency.py\", line 41, in run_in_threadpool return await anyio.to_thread.run_sync(func, *args) File \"/home/site/wwwroot/.python_packages/lib/site-packages/anyio/to_thread.py\", line 33, in run_sync return await get_asynclib().run_sync_in_worker_thread( File \"/home/site/wwwroot/.python_packages/lib/site-packages/anyio/_backends/_asyncio.py\", line 877, in run_sync_in_worker_thread return await future File \"/home/site/wwwroot/.python_packages/lib/site-packages/anyio/_backends/_asyncio.py\", line 807, in run result = context.run(func, *args) File \"/home/site/wwwroot/.python_packages/lib/site-packages/titiler/pgstac/factory.py\", line 637, in register_search with request.app.state.dbpool.connection() as conn: File \"/home/site/wwwroot/.python_packages/lib/site-packages/starlette/datastructures.py\", line 705, in __getattr__ raise AttributeError(message.format(self.__class__.__name__, key))\r\n```\r\n\r\n\r\n### Known workarounds\r\n\r\n### Contents of the requirements.txt file:\r\nIt is a FastAPI app\r\n\r\n### Related information\r\n",
      "solution": "@bhagyshricompany Just updated the issue with the required info\n\n---\n\nThankyou for the update. Im closing the issue as of now.",
      "labels": [
        "needs-attention :wave:"
      ],
      "created_at": "2023-06-23T13:28:59Z",
      "closed_at": "2025-04-14T07:10:39Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1273",
      "comments_count": 6
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1572,
      "title": "BUG In Azure Function Trigger with Managed Identity",
      "problem": "### Expected Behavior\n\nIf you want to use [managed identity](https://learn.microsoft.com/en-us/azure/azure-functions/functions-bindings-event-hubs-trigger?tabs=python-v2%2Cisolated-process%2Cnodejs-v4%2Cfunctionsv2%2Cextensionv5&pivots=programming-language-python#identity-based-connections) for a function to have a trigger binding for event hub you can do:\r\n\r\nPython\r\n```Python\r\nbp = func.Blueprint()\r\nconsumergroup = \"$Default\"\r\n@bp.event_hub_message_trigger(\r\n    arg_name=\"event\",\r\n    event_hub_name=\"name\",   \r\n    connection=\"ehconnection\",   \r\n    consumer_group=consumergroup)\r\n```\r\nlocal.settings.json (for running local) \r\n\r\n```log\r\nlocalsettings.json(for running locally)\r\n  \"ehconnection__fullyQualifiedNamespace\": \"<namespace>.servicebus.windows.net\",\r\n \"ehconnection__credential\": \"managedIdentity\",\r\n \"ehconnection__clientId\": \"<clientId>\"`\r\n ```\r\n \r\nThis does not work\n\n### Actual Behavior\n\nIt tries to connect to 169.254.169.254 which is a know address for Azure VMs. But it seems the Azure Function (local) runtime doest no provide that. (see log below)\r\n\r\nMost probably in the Azure runtime it will work, but locally it does not work.\r\n\r\n**Note**: In \"ehconnection__clientId\": \"<clientId>\" I have set my user id. I obtained it via : `az ad signed-in-user show` and field id from there.\r\n\r\n```log\r\n[2024-09-03T10:17:58.894Z] Request [e98db5b7-e2aa-486e-be42-6180b172abbb] exception Azure.RequestFailedException: Operation timed out (169.254.169.254:80)\r\n[2024-09-03T10:17:58.895Z]  ---> System.Net.Http.HttpRequestException: Operation timed out (169.254.169.254:80)\r\n[2024-09-03T10:17:58.895Z]  ---> System.Net.Sockets.SocketException (60): Operation timed out\r\n[2024-09-03T10:17:58.895Z]    at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)\r\n[2024-09-03T10:17:58.895Z]    at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)\r\n[2024-09-03T10:17:58.895Z]    at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|277_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)\r\n[2024-09-03T10:17:58.895Z]    at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)\r\n[2024-09-03T10:17:58.896Z]    --- End of inner exception stack trace ---\r\n[2024-09-03T10:17:58.896Z]    at System.Net.Http.HttpConnectionPool.ConnectToTcpHostAsync(String host, Int32 port, HttpRequestMessage initialRequest, Boolean async, CancellationToken cancellationToken)\r\n[2024-09-03T10:17:58.896Z]    at System.Net.Http.HttpConnectionPool.ConnectAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)\r\n[2024-09-03T10:17:58.896Z]    at System.Net.Http.HttpConnectionPool.CreateHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)\r\n[2024-09-03T10:17:58.896Z]    at System.Net.Http.HttpConnectionPool.AddHttp11ConnectionAsync(HttpRequestMessage request)\r\n[2024-09-03T10:17:58.896Z]    at System.Threading.Tasks.TaskCompletionSourceWithCancellation`1.WaitWithCancellationAsync(CancellationToken cancellationToken)\r\n[2024-09-03T10:17:58.896Z]    at System.Net.Http.HttpConnectionPool.GetHttp11ConnectionAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)\r\n[2024-09-03T10:17:58.896Z]    at System.Net.Http.HttpConnectionPool.SendWithVersionDetectionAndRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)\r\n[2024-09-03T10:17:58.897Z]    at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)\r\n[2024-09-03T10:17:58.897Z]    at Azure.Core.Pipeline.HttpClientTransport.ProcessAsync(HttpMessage message, Boolean async)\r\n[2024-09-03T10:17:58.897Z]    --- End of inner exception stack trace ---\r\n[2024-09-03T10:17:58.897Z]    at Azure.Core.Pipeline.HttpClientTransport.ProcessAsync(HttpMessage message, Boolean async)\r\n[2024-09-03T10:17:58.897Z]    at Azure.Core.Pipeline.HttpPipelineTransportPolicy.ProcessAsync(HttpMessage message, ReadOnlyMemory`1 pipeline)\r\n[2024-09-03T10:17:58.897Z]    at Azure.Core.Pipeline.ResponseBodyPolicy.ProcessAsync(HttpMessage message, ReadOnlyMemory`1 pipeline, Boolean async)\r\n[2024-09-03T10:17:58.897Z]    at Azure.Core.Pipeline.LoggingPolicy.ProcessAsync(HttpMessage message, ReadOnlyMemory`1 pipeline, Boolean async)\r\n[2024-09-03T10:18:05.586Z] Request [e98db5b7-e2aa-486e-be42-6180b172abbb] attempt number 4 took 75.0s\r\n[2024-09-03T10:18:05.586Z] Request [e98db5b7-e2aa-486e-be42-6180b172abbb] GET http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&resource=REDACTED&client_id=REDACTED\r\n```\r\n\r\n\r\n\r\n\n\n### Steps to Reproduce\n\n1 Write an azure function that has Azure EventHub inbound binding\r\n2 configure it to use managed identity\r\n3 try to run it locally\r\n\r\n\n\n### Relevant code being tried\n\n_No response_\n\n### Relevant log output\n\n_No response_\n\n### requirements.txt file\n\n_No response_\n\n### Where are you facing this problem?\n\nLocal - Core Tools\n\n### Additional Information\n\n_No response_",
      "solution": "Hello @MiguelElGallo could you please let me know if the issue still exists",
      "labels": [
        "bug",
        "needs-author feedback",
        "python"
      ],
      "created_at": "2024-09-03T10:25:07Z",
      "closed_at": "2025-04-10T08:46:32Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1572",
      "comments_count": 4
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1641,
      "title": "[Bug] Azure Portal Function Invocation Page Fails to Load with \"An unexpected error has occurred\"",
      "problem": "### Description\n\nWhen navigating to the Function Invocation page in the Azure Portal, the page fails to load and displays the following error message:\n\n<img width=\"1606\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/6456be9e-6da3-4ef8-9289-24622f9353ca\" />\n\nThis prevents viewing function execution details, making it difficult to monitor and debug function invocations through the portal. Additionally, the error message does not provide any actionable information to diagnose or resolve the issue on my end.\n\n### Expected Behavior\n\nThe Function Invocation page should load successfully, displaying invocation details for troubleshooting.\n\n### Actual Behavior\n\nThe page fails to load with an error message instead of showing function invocation details. The message is too generic, offering no clear steps for resolution.\n\n### Steps to Reproduce\n\n1. Navigate to the Azure Portal.\n2. Open the Functions blade for a .NET 8 Isolated Azure Function App.\n3. Click on a specific function and go to the Invocations tab.\n4. Observe the error message.\n\n### Environment Information\n\n- OS: Windows\n- Runtime: .NET 8 (Isolated)\n- Regions: WestUS and WestUS2\n- Trigger Types: HTTP, CosmosDB, ServiceBus\n\n### Additional Context\n\n- This has persisted since Feb. 14, 2025.\n- Function execution is working as expected.\n- Logs are streaming correctly in the Logs tab in the Azure Portal.\n- Logs are also accessible locally using the `azure-cli` tool.\n- The issue persists across multiple functions and applications.\n- Refreshing or switching browsers does not resolve the issue.\n- The error message is too vague to take any corrective action without additional information.",
      "solution": "Just to back this up.  I don't use uBlock Origin (in this instance) but I do use a PiHole.  For anyone looking at this issue, remove/suspend your ad-blocker and see if this solves your problems.  This worked for me.\n\nEdit:  it looks like its this domain that (when blocked) causes the issue.  \napi.applicationinsights.io\n\n---\n\n> Just to back this up. I don't use uBlock Origin (in this instance) but I do use a PiHole. For anyone looking at this issue, remove/suspend your ad-blocker and see if this solves your problems. This worked for me.\n> \n> Edit: it looks like its this domain that (when blocked) causes the issue. api.applicationinsights.io\n\nAdd api.applicationinsights.io and all his subdomain to the whitelist in PiHole works great. Thanks a lot!",
      "labels": [],
      "created_at": "2025-02-15T17:54:40Z",
      "closed_at": "2025-02-19T15:36:02Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1641",
      "comments_count": 14
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1439,
      "title": "[BUG] Functions no longer callable from logic apps after migrating to V2 model (python)",
      "problem": "### Investigative information\r\n\r\n- Timestamp: 2024-03-05 11:00:00\r\n- Core Tools version: 4.0.5455\r\n\r\n### Repro steps\r\n\r\n1 - Define a function using the V2 python model and blueprints:\r\n\r\n```\r\nimport azure.functions as func\r\nimport logging\r\n\r\napp = func.FunctionApp(http_auth_level=func.AuthLevel.ANONYMOUS)\r\n\r\n@app.route()\r\ndef http_trigger(req: func.HttpRequest) -> func.HttpResponse:\r\n    logging.info('Python HTTP trigger function processed a request.')\r\n\r\n    name = req.params.get('name')\r\n    if not name:\r\n        try:\r\n            req_body = req.get_json()\r\n        except ValueError:\r\n            pass\r\n        else:\r\n            name = req_body.get('name')\r\n\r\n    if name:\r\n        return func.HttpResponse(f\"Hello, {name}. This HTTP triggered function executed successfully.\")\r\n    else:\r\n        return func.HttpResponse(\r\n            \"This HTTP triggered function executed successfully. Pass a name in the query string or in the request body for a personalized response.\",\r\n            status_code=200)\r\n\r\n```\r\n\r\n2. Deploy the function.\r\n3. I verify http_trigger shows in the function app in Azure\r\n4. Try to call the function from a logic app using the \"Azure Functions\" action\r\n\r\n### Expected behavior\r\nI can select the \"http_trigger\" method just like with the V1 model.\r\n\r\n### Actual behavior\r\nThe list of available methods is empty\r\n\r\n![image](https://github.com/Azure/azure-functions-python-worker/assets/48496885/a54539ae-d91e-41e4-a71b-1af9e53b821b)\r\n\r\n### Contents of the requirements.txt file:\r\n\r\n```\r\nazure-functions\r\n```\r\n\r\n### Notes:\r\nThe same behaviour is observed when using blueprints:\r\n\r\n```\r\nimport azure.functions as func\r\nimport logging\r\n\r\nbp = func.Blueprint()\r\n\r\n@bp.route()\r\ndef http_trigger(req: func.HttpRequest) -> func.HttpResponse:\r\n    ...\r\n\r\napp = func.FunctionApp(http_auth_level=func.AuthLevel.ANONYMOUS)\r\napp.register_blueprint(bp)\r\n```\r\n\r\n",
      "solution": "Hello @ManelBH Could you please let me know if you are still facing the issue .",
      "labels": [
        "needs-author feedback",
        "no recent activity"
      ],
      "created_at": "2024-03-05T10:38:00Z",
      "closed_at": "2025-03-27T15:44:07Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1439",
      "comments_count": 8
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1634,
      "title": "Portal Fails to Show Function Invocation results",
      "problem": "### Expected Behavior\n\nIdeally, you should be able to see if a function has executed and if not, why it failed. This information should be easy to find and require a small amount of clicking around in the UI to find an error message.  Azure Function users spend too much time futzing around in the UI which takes time away from working on their application.  See [here](https://github.com/Azure/azure-functions-python-worker/issues/1262#issuecomment-2119241515) for an example. \n\nInvocations output: \n\n![Image](https://github.com/user-attachments/assets/1d7a7e79-cc54-4c2f-999f-9649044f81e7)\nIf I have this output, I can click on functions, success or not, and see the logs for that function. This is Ideal. \n\n### Actual Behavior\n\nIn a similar deployment: \n\n![Image](https://github.com/user-attachments/assets/6b46479a-cfcd-4c6d-89fb-39d5f65f5255)\nI am seeing in the logs that the function has failed to execute. Probably something with my code, or configuration. If only I could find out what. \n\n![Image](https://github.com/user-attachments/assets/9888dec4-7568-4467-84d2-2c937e190196)\nThe function says that it did not invocate at all. No error and no success. So I can't see the error to know what happened. \n\nSays all of my functions are `enabled`. So that's good. \n\n![Image](https://github.com/user-attachments/assets/348a8636-f8ab-47e4-bbac-1ea1e017bbda)\n\n\nAlso looks like the functions are running in _healthy_ status. \n\n![Image](https://github.com/user-attachments/assets/a1a5b599-4558-4cb4-bb6a-a1df93b358c7)\n\nI'm out of ideas on how to see how or why the function is failing to deploy. It's probably simple but I don't know how to find it. \n\n\n### Steps to Reproduce\n\nCreate an azure functions resource. \n\nMake a function app in python. I'm told the .net functions are much more stable. You can do this use the az function tools in VSC. \n\nDeploy the function. \n\nBest of luck. \n\n### Relevant code being tried\n\n```shell\nHere is my function: \nhttps://github.com/BillmanH/exoplanets/blob/main/function_app.py\n\nI'm very confident that the issue is with my code. I could probably fix it in a second if I could see the error.\n```\n\n### Relevant log output\n\n```shell\nConnected!\n2025-01-20T20:05:00Z   [Information]   Executing 'Functions.ututimer' (Reason='Timer fired at 2025-01-20T20:05:00.0025586+00:00', Id=b347570c-f743-4f48-a5f3-5fbacdd0a35e)\n2025-01-20T20:05:00Z   [Verbose]   Sending invocation id: 'b347570c-f743-4f48-a5f3-5fbacdd0a35e\n2025-01-20T20:05:00Z   [Verbose]   Posting invocation id:b347570c-f743-4f48-a5f3-5fbacdd0a35e on workerId:8cb3be66-a99b-4266-90ad-30de831c36ef\n2025-01-20T20:05:00Z   [Information]   EXOADMIN: <ututimer> deploy version: dec3.2\n2025-01-20T20:05:01Z   [Error]   Executed 'Functions.ututimer' (Failed, Id=b347570c-f743-4f48-a5f3-5fbacdd0a35e, Duration=806ms)\n```\n\n### requirements.txt file\n\n```shell\nhttps://github.com/BillmanH/exoplanets/blob/main/requirements.txt\n```\n\n### Where are you facing this problem?\n\nProduction Environment (explain below)\n\n### Function app name\n\nexo-jobs-stage.azurewebsites.net\n\n### Additional Information\n\nThis is a hobby use case, however the issue is relevant to production systems. Many industrial users look at this as a non-starter for Azure functions in Python. ",
      "solution": "That's great. Can you show how you were able to get this stack trace? \n\nMore than solving this bug (which we always knew was an issue with my code), I want to be able to solve the issue myself. I'll probably have more issues in the future. \n\nThis application relies on EventHubs and Function triggers to work. So I have a staging function environment so that I can see them working before moving into production. Because of the eventhub route, I can't rely on local machine testing. I need to be able to see the error in Azure. \n\n\non these two: \n* Were you able to check the App Insights logs for this app?\n* Also, is the invocation tab still showing 0 executions total?\n\nI'll answer them separately when I get home. The info is good intel for other who might have similar issues. ",
      "labels": [
        "bug",
        "needs-attention :wave:",
        "python"
      ],
      "created_at": "2025-01-20T20:06:32Z",
      "closed_at": "2025-03-13T08:27:25Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1634",
      "comments_count": 10
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1299,
      "title": "remote build VS code issue - ModuleNotFoundError: No module named 'teradatasqlalchemy.dialect",
      "problem": "Error : Result: Failure Exception: ModuleNotFoundError: No module named 'teradatasqlalchemy.dialect' \r\n\r\nHello Team,\r\n\r\nPlease refer the requirement.txt and init.py for reference and to reproduce issue\r\n\r\n**init.py**\r\n\r\nimport logging\r\nfrom sqlalchemy import create_engine\r\nimport azure.functions as func\r\n\r\n\r\ndef main(req: func.HttpRequest) -> func.HttpResponse:\r\n    logging.info('Python HTTP trigger function processed a request.')\r\n     \r\n    teradata_client = create_engine(\"teradatasql://username:passwd@server_name\")\r\n    logging.info('after teradata')\r\n\r\n    name = req.params.get('name')\r\n    if not name:\r\n        try:\r\n            req_body = req.get_json()\r\n        except ValueError:\r\n            pass\r\n        else:\r\n            name = req_body.get('name')\r\n\r\n    if name:\r\n        return func.HttpResponse(f\"Hello, {name}. This HTTP triggered function executed successfully.\")\r\n    else:\r\n        return func.HttpResponse(\r\n             \"This HTTP triggered function executed successfully. Pass a name in the query string or in the request body for a personalized response.\",\r\n             status_code=200\r\n        )\r\n\r\n**requirement.txt**\r\n\r\nazure-functions\r\nteradatasqlalchemy\r\n\r\nDeployed the above code using vs code in python function app version ~4 and receiving an Failure Exception: ModuleNotFoundError: No module named 'teradatasqlalchemy.dialect' . even though same code is working fine on local\r\n\r\n=> Also noticed that adding there is an issue with remote build only I believe\r\n=> Even tried to do the pip install explicitly on kudu site but no luck\r\n\r\nCan you please help me with this? You can simply create the test function app, create the sample http trigger, add the code, and reproduce.\r\n\r\nThanks\r\n\r\n",
      "solution": "@bhagyshricompany are you able to reproduce the issue ?\n\n---\n\n@Sagarthore11 No problem, a heads up, oyrx team identified this is a known issue which got fixed in https://github.com/microsoft/Oryx/releases/tag/20230403.1 by setting app setting ORYX_DISABLE_PIP_UPGRADE to true then publish with remote build.\r\n![image](https://github.com/Azure/azure-functions-python-worker/assets/12449837/cf0e9652-e23c-4d2b-bd0e-c4ff197e01f1)\r\n\r\nRemote build right now uses Oryx Version: 0.2.20230210.1. I will let you know when remote build will release with oyrx 20230403.1\r\n\n\n---\n\nHi are there any updates / resolution ? Please let me know \n@YunchuWang ",
      "labels": [
        "needs-attention :wave:"
      ],
      "created_at": "2023-08-07T16:55:57Z",
      "closed_at": "2023-09-07T11:13:55Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1299",
      "comments_count": 29
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1638,
      "title": "[Bug] ModuleNotFoundError: No module named 'dotenv' - related to #1487",
      "problem": "### Expected Behavior\n\nThe issue #1487 was closed, however, I encountered the same issue in the following specific scenario:\n- Python 3.11 \n- python-dotenv==1.0.1\n- Use \"User Assigned Managed Identity\" for deployment (basic authentication disabled)\n\nThe workaround of adding --target=\".python_packages/lib/site-packages didn't fix the issue.\n\n### Actual Behavior\n\n_No response_\n\n### Steps to Reproduce\n\n_No response_\n\n### Relevant code being tried\n\n```shell\n\n```\n\n### Relevant log output\n\n```shell\n\n```\n\n### requirements.txt file\n\n```shell\n\n```\n\n### Where are you facing this problem?\n\nLocal - Core Tools\n\n### Function app name\n\n_No response_\n\n### Additional Information\n\n_No response_",
      "solution": "Hello @Mike-Hanna could you please mention clear steps to reproduce the issue .\n\n---\n\nClosing the issue as there is no recent activity. Please reopen the if the issue still exists",
      "labels": [
        "bug",
        "needs-author feedback",
        "python"
      ],
      "created_at": "2025-01-31T21:37:10Z",
      "closed_at": "2025-02-10T16:33:13Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1638",
      "comments_count": 2
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1573,
      "title": "Error on first deploy to Azure Functions and not deployed.",
      "problem": "### Version\n\nPython: 3.11\r\nCore tools: 4.0.5907\n\n### Description\n\nThe following error occurs during the first deploy to Azure Functions and it is not deployed.\r\nExecute the same command again and the deployment will succeed.\r\n\r\nFirst deployment\r\n```\r\n$ func azure functionapp publish func-test\r\nLocal python version '3.8.10' is different from the version expected for your deployed Function App. This may result in 'ModuleNotFound' errors in Azure Functions. Please create a Python Function App for version 3.8 or change the virtual environment on your local machine to match 'Python|3.11'.\r\nGetting site publishing info...\r\n[2024-09-04T10:09:33.768Z] Starting the function app deployment...\r\nRemoving WEBSITE_CONTENTAZUREFILECONNECTIONSTRING app setting.\r\nRemoving WEBSITE_CONTENTSHARE app setting.\r\nCreating archive for current directory...\r\nPerforming remote build for functions project.\r\nDeleting the old .python_packages directory\r\nUploading 1.3 KB [################################################################################]\r\nRemote build in progress, please wait...\r\nSequence contains no elements\r\n$\r\n```\r\n\r\nSecond deployment\r\n```\r\n$ func azure functionapp publish func-test\r\nLocal python version '3.8.10' is different from the version expected for your deployed Function App. This may result in 'ModuleNotFound' errors in Azure Functions. Please create a Python Function App for version 3.8 or change the virtual environment on your local machine to match 'Python|3.11'.\r\nGetting site publishing info...\r\n[2024-09-04T10:09:33.768Z] Starting the function app deployment...\r\nCreating archive for current directory...\r\nPerforming remote build for functions project.\r\nDeleting the old .python_packages directory\r\nUploading 1.3 KB [################################################################################]\r\nRemote build in progress, please wait...\r\nUpdating submodules.\r\nPreparing deployment for commit id '6b8baeb5-1'.\r\nPreDeployment: context.CleanOutputPath False\r\nPreDeployment: context.OutputPath /home/site/wwwroot\r\nRepository path is /tmp/zipdeploy/extracted\r\nRunning oryx build...\r\nCommand: oryx build /tmp/zipdeploy/extracted -o /home/site/wwwroot --platform python --platform-version 3.11 -p packagedir=.python_packages/lib/site-packages\r\nOperation performed by Microsoft Oryx, https://github.com/Microsoft/Oryx\r\nYou can report issues at https://github.com/Microsoft/Oryx/issues\r\n\r\nOryx Version: 0.2.20230210.1, Commit: a49c8f6b8abbe95b4356552c4c884dea7fd0d86e, ReleaseTagName: 20230210.1\r\n\r\nBuild Operation ID: 1aa8c03afbb27e30\r\nRepository Commit : 6b8baeb5-1733-418b-a1e3-493df532aef4\r\nOS Type           : bullseye\r\nImage Type        : githubactions\r\n\r\nDetecting platforms...\r\nDetected following platforms:\r\n  python: 3.11.8\r\nVersion '3.11.8' of platform 'python' is not installed. Generating script to install it...\r\n\r\n\r\nSource directory     : /tmp/zipdeploy/extracted\r\nDestination directory: /home/site/wwwroot\r\n\r\n\r\nDownloading and extracting 'python' version '3.11.8' to '/tmp/oryx/platforms/python/3.11.8'...\r\nDetected image debian flavor: bullseye.\r\nDownloaded in 1 sec(s).\r\nVerifying checksum...\r\nExtracting contents...\r\nperforming sha512 checksum for: python...\r\nDone in 8 sec(s).\r\n\r\nimage detector file exists, platform is python..\r\nOS detector file exists, OS is bullseye..\r\nPython Version: /tmp/oryx/platforms/python/3.11.8/bin/python3.11\r\nCreating directory for command manifest file if it does not exist\r\nRemoving existing manifest file\r\n\r\nRunning pip install...\r\nDone in 22 sec(s).\r\n\r\n...\r\n\r\nCreating placeholder blob for linux consumption function app...\r\nSCM_RUN_FROM_PACKAGE placeholder blob scm-latest-func-test.zip located\r\nUploading built content /home/site/artifacts/functionappartifact.squashfs for linux consumption function app...\r\nResetting all workers for func-test.azurewebsites.net\r\nDeployment successful. deployer = Push-Deployer deploymentPath = Functions App ZipDeploy. Extract zip. Remote build.\r\nRemote build succeeded!\r\n[2024-09-04T10:16:23.626Z] Syncing triggers...\r\nFunctions in func-test:\r\n    test - [httpTrigger]\r\n        Invoke url: https://func-test.azurewebsites.net/api/test\r\n$\r\n```\n\n### Steps to reproduce\n\nDeploy locally using Core tools.",
      "solution": "I have the same problem (failed with `Sequence contains no elements` message), the workaround is to run the command twice. \n\nIt would be good if a real fix or explanation could be dropped here...",
      "labels": [
        "needs-attention :wave:"
      ],
      "created_at": "2024-09-04T10:25:06Z",
      "closed_at": "2024-10-10T08:30:52Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1573",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1603,
      "title": "[Bug] Blob trigger uses incorrect authentication method",
      "problem": "### Expected Behavior\n\nWhen using identity-based connection settings it should use the managed identity auth method.\n\n\n### Actual Behavior\n\nIt tries to use the connection string method and fails because it tries to parse a non-existent setting.\n\n### Steps to Reproduce\n\n1. Create identity-based connections in the environment variables, in this case:  `DATALAKE__queueServiceUri` & `DATALAKE__blobServiceUri`\n2. Create a blob trigger using `connection=\"DATALAKE\"`\n3.  Create a test blob in the path defined for the blob trigger\n4.  It will result into erroring parsing the non-existent \"DATALAKE\" env variable.\n\nIf you use the `AzureWebJobsStorage__accountname` and set `connection=\"AzureWebJobsStorage\"` without having the `AzureWebJobsStorage` setting it works, so it's only for custom connections which are [documented here](https://learn.microsoft.com/en-us/azure/azure-functions/functions-bindings-storage-blob-trigger?tabs=python-v2%2Cisolated-process%2Cnodejs-v4%2Cextensionv5&pivots=programming-language-python#identity-based-connections)\n\n\n### Relevant code being tried\n```json\n{\n  \"IsEncrypted\": false,\n  \"Values\": {\n    \"FUNCTIONS_WORKER_RUNTIME\": \"python\",\n    \"AzureWebJobsFeatureFlags\": \"EnableWorkerIndexing\",\n    \"AzureWebJobsStorage\": \"UseDevelopmentStorage=true\",\n    \"DATALAKE__blobServiceUri\": \"https://REDACTED.blob.core.windows.net/\",\n    \"DATALAKE__serviceUri\": \"https://REDACTED.blob.core.windows.net/\",\n    \"DATALAKE__queueServiceUri\": \"https://REDACTED.queue.core.windows.net/\"\n  }\n}\n```\n\n```python\nimport logging\nimport os\n\nimport azure.functions as func\nfrom azure.identity import DefaultAzureCredential\nfrom azure.storage.blob import BlobClient\nimport azurefunctions.extensions.bindings.blob as blob\n\nbp = func.Blueprint()\n\n@bp.function_name(name=\"process_blob_weather_data\")\n@bp.blob_trigger(\n    arg_name=\"sourceblob\", path=\"bronze/weatherdata/{name}.json\", connection=\"DATALAKE\"\n)\ndef process_blob_weather_data(sourceblob: blob.BlobClient):\n    logging.info('Starting to process blob')\n    logging.info(\n        f\"Python blob trigger function processed blob! Perms \\n\"\n        f\"Properties: {sourceblob.get_blob_properties()}\\n\"\n        f\"Blob content head: {sourceblob.download_blob().read(size=1)}\"\n    )\n    \n    logging.info('Blob processed')\n```\n### Relevant log output\n```\nContextEnabledTask exception was never retrieved\nfuture: <ContextEnabledTask finished name='Task-8' coro=<Dispatcher._dispatch_grpc_request() done, defined at C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.11\\WINDOWS\\X64\\azure_functions_worker\\dispatcher.py:263> exception=UnboundLocalError(\"cannot access local variable 'http_v2_enabled' where it is not associated with a value\")>\nTraceback (most recent call last):\n  File \"C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.11\\WINDOWS\\X64\\azure_functions_worker\\dispatcher.py\", line 565, in _handle__invocation_request  \n    args[pb.name] = bindings.from_incoming_proto(\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.11\\WINDOWS\\X64\\azure_functions_worker\\bindings\\meta.py\", line 183, in from_incoming_proto       \n    return deferred_bindings_decode(binding=binding,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.11\\WINDOWS\\X64\\azure_functions_worker\\bindings\\meta.py\", line 301, in deferred_bindings_decode  \n    deferred_binding_type = binding.decode(datum,\n                            ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Source\\InSparkSolutions\\smallestAzureDataplatform\\functions\\.venv\\Lib\\site-packages\\azurefunctions\\extensions\\bindings\\blob\\blobClientConverter.py\", line 43, in decode\n    return BlobClient(data=data).get_sdk_type()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Source\\InSparkSolutions\\smallestAzureDataplatform\\functions\\.venv\\Lib\\site-packages\\azurefunctions\\extensions\\bindings\\blob\\blobClient.py\", line 35, in get_sdk_type\n    return BlobClientSdk.from_connection_string(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Source\\InSparkSolutions\\smallestAzureDataplatform\\functions\\.venv\\Lib\\site-packages\\azure\\storage\\blob\\_blob_client.py\", line 347, in from_connection_string        \n    account_url, secondary, credential = parse_connection_str(conn_str, credential, 'blob')\n                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Source\\InSparkSolutions\\smallestAzureDataplatform\\functions\\.venv\\Lib\\site-packages\\azure\\storage\\blob\\_shared\\base_client.py\", line 368, in parse_connection_str   \n    conn_str = conn_str.rstrip(\";\")\n               ^^^^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'rstrip'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.11\\WINDOWS\\X64\\azure_functions_worker\\dispatcher.py\", line 274, in _dispatch_grpc_request       \n    resp = await request_handler(request)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.11\\WINDOWS\\X64\\azure_functions_worker\\dispatcher.py\", line 655, in _handle__invocation_request  \n    if http_v2_enabled:\n       ^^^^^^^^^^^^^^^\nUnboundLocalError: cannot access local variable 'http_v2_enabled' where it is not associated with a value\n```\n### requirements.txt file\n\nazure-functions\npandas\nrequests\nazure-identity\nazure-storage-blob\nazurefunctions-extensions-bindings-blob\n\n### Where are you facing this problem?\n\nLocal - Core Tools\n\n### Function app name\n\n_No response_\n\n### Additional Information\n\n_No response_",
      "solution": "Hi @hallvictoria I updated it, I was on version `1.0.0b1` locally, my CICD for the FA already installed `1.0.0b2` and shows another error in the logs, which now also show locally:\n\n```\n[2024-10-25T06:30:46.545Z] Executed 'Functions.process_blob_weather_data' (Failed, Id=0a4d9f70-4774-4994-8b3d-229ca51f7de2, Duration=82ms)\n[2024-10-25T06:30:46.548Z] System.Private.CoreLib: Exception while executing function: Functions.process_blob_weather_data. System.Private.CoreLib: Result: Failure\nException: ClientAuthenticationError: Operation returned an invalid status 'Server failed to authenticate the request. Please refer to the information in the www-authenticate header.'\nErrorCode:NoAuthenticationInformation\nStack:   File \"C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.11\\WINDOWS\\X64\\azure_functions_worker\\dispatcher.py\", line 604, in _handle__invocation_request\n    call_result = await self._loop.run_in_executor(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\DonHeerschap\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.11\\WINDOWS\\X64\\azure_functions_worker\\dispatcher.py\", line 933, in _run_sync_func\n    return ExtensionManager.get_sync_invocation_wrapper(context,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Program Files\\Microsoft\\Azure Functions Core Tools\\workers\\python\\3.11\\WINDOWS\\X64\\azure_functions_worker\\extension.py\", line 215, in _raw_invocation_wrapper\n    result = function(**args)\n             ^^^^^^^^^^^^^^^^\n  File \"C:\\Source\\InSparkSolutions\\smallestAzureDataplatform\\functions\\blueprints\\blob_process_weather_data.py\", line 19, in process_blob_weather_data     \n    f\"Properties: {sourceblob.get_blob_properties()}\\n\"\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Source\\InSparkSolutions\\smallestAzureDataplatform\\functions\\.venv\\Lib\\site-packages\\azure\\core\\tracing\\decorator.py\", line 94, in wrapper_use_tracer\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Source\\InSparkSolutions\\smallestAzureDataplatform\\functions\\.venv\\Lib\\site-packages\\azure\\storage\\blob\\_blob_client.py\", line 1080, in get_blob_properties\n    process_storage_error(error)\n  File \"C:\\Source\\InSparkSolutions\\smallestAzureDataplatform\\functions\\.venv\\Lib\\site-packages\\azure\\storage\\blob\\_shared\\response_handlers.py\", line 186, in process_storage_error\n    exec(\"raise error from None\")   # pylint: disable=exec-used # nosec\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<string>\", line 1, in <module>\n  File \"C:\\Source\\InSparkSolutions\\smallestAzureDataplatform\\functions\\.venv\\Lib\\site-packages\\azure\\storage\\blob\\_blob_client.py\", line 1070, in get_blob_properties\n    blob_props = cast(BlobProperties, self._client.blob.get_properties(\n                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Source\\InSparkSolutions\\smallestAzureDataplatform\\functions\\.venv\\Lib\\site-packages\\azure\\core\\tracing\\decorator.py\", line 94, in wrapper_use_tracer\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Source\\InSparkSolutions\\smallestAzureDataplatform\\functions\\.venv\\Lib\\site-packages\\azure\\storage\\blob\\_generated\\operations\\_blob_operations.py\", line 1900, in get_properties\n    map_error(status_code=response.status_code, response=response, error_map=error_map)\n  File \"C:\\Source\\InSparkSolutions\\smallestAzureDataplatform\\functions\\.venv\\Lib\\site-packages\\azure\\core\\exceptions.py\", line 161, in map_error\n    raise error\n.\n```\n\nThis is the RBAC of the targeted storage account (db-test being SP being set on my local machine with environment vars with `AZURE_TENANT_ID`, `AZURE_CLIENT_ID`, & `AZURE_CLIENT_SECRET`), which I think is not missing anything:\n\n![Image](https://github.com/user-attachments/assets/79b1945e-a0d4-4341-9e2f-c92787d12aca)\n\n\n",
      "labels": [
        "bug",
        "python"
      ],
      "created_at": "2024-10-23T21:26:49Z",
      "closed_at": "2025-01-22T16:39:12Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1603",
      "comments_count": 5
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 915,
      "title": "Support running on M1 Macs [Python]",
      "problem": "Hey, \r\n\r\ni am running into issues with python azure function under VSCode. FYI the same example I will present is working fine with JS.\r\n\r\nSet up:\r\nMac M1 Big Sur v11.2.1\r\npython 3.9.1\r\nCore Tools Version:       3.0.3284 \r\n\r\nI am following the usual workflow: func init, func new, func start. When I start the function, this is what I get:\r\n\r\n```python\r\nFound Python version 3.9.1 (python3).\r\n\r\nAzure Functions Core Tools\r\nCore Tools Version:       3.0.3284 Commit hash: 98bc25e668274edd175a1647fe5a9bc4ffb6887d \r\nFunction Runtime Version: 3.0.15371.0\r\n\r\n\u00c42021-02-16T20:28:10.779Z\u00c5 Traceback (most recent call last):\r\n\u00c42021-02-16T20:28:10.783Z\u00c5   File \"/opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/worker.py\", line 84, in <module>\r\n\u00c42021-02-16T20:28:10.783Z\u00c5     from azure_functions_worker import main\r\n\u00c42021-02-16T20:28:10.783Z\u00c5   File \"/opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/azure_functions_worker/main.py\", line 8, in <module>\r\n\u00c42021-02-16T20:28:10.783Z\u00c5     from . import dispatcher\r\n\u00c42021-02-16T20:28:10.783Z\u00c5   File \"/opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/azure_functions_worker/dispatcher.py\", line 21, in <module>\r\n\u00c42021-02-16T20:28:10.783Z\u00c5     import grpc\r\n\u00c42021-02-16T20:28:10.783Z\u00c5   File \"/opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/grpc/__init__.py\", line 23, in <module>\r\n\u00c42021-02-16T20:28:10.783Z\u00c5     from grpc._cython import cygrpc as _cygrpc\r\n\u00c42021-02-16T20:28:10.784Z\u00c5 ImportError: dlopen(/opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/grpc/_cython/cygrpc.cpython-39-darwin.so, 2): no suitable image found.  Did find:\r\n\u00c42021-02-16T20:28:10.785Z\u00c5  /opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/grpc/_cython/cygrpc.cpython-39-darwin.so: mach-o, but wrong architecture\r\n\u00c42021-02-16T20:28:10.788Z\u00c5  /opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/grpc/_cython/cygrpc.cpython-39-darwin.so: mach-o, but wrong architecture\r\n\u00c42021-02-16T20:28:10.788Z\u00c5 Traceback (most recent call last):\r\n\u00c42021-02-16T20:28:10.788Z\u00c5   File \"/opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/worker.py\", line 84, in <module>\r\n\u00c42021-02-16T20:28:10.788Z\u00c5     from azure_functions_worker import main\r\n\u00c42021-02-16T20:28:10.794Z\u00c5   File \"/opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/azure_functions_worker/main.py\", line 8, in <module>\r\n\u00c42021-02-16T20:28:10.794Z\u00c5     from . import dispatcher\r\n\u00c42021-02-16T20:28:10.794Z\u00c5   File \"/opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/azure_functions_worker/dispatcher.py\", line 21, in <module>\r\n\u00c42021-02-16T20:28:10.794Z\u00c5     import grpc\r\n\u00c42021-02-16T20:28:10.794Z\u00c5   File \"/opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/grpc/__init__.py\", line 23, in <module>\r\n\u00c42021-02-16T20:28:10.799Z\u00c5     from grpc._cython import cygrpc as _cygrpc\r\n\u00c42021-02-16T20:28:10.799Z\u00c5 **ImportError: dlopen(/opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/grpc/_cython/cygrpc.cpython-39-darwin.so, 2): no suitable image found.  Did find:**\r\n\u00c42021-02-16T20:28:10.799Z\u00c5  /opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/grpc/_cython/cygrpc.cpython-39-darwin.so: mach-o, but wrong architecture\r\n\u00c42021-02-16T20:28:10.799Z\u00c5  /opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/grpc/_cython/cygrpc.cpython-39-darwin.so: mach-o, but wrong architecture\r\n\u00c42021-02-16T20:28:10.799Z\u00c5 Traceback (most recent call last):\r\n\u00c42021-02-16T20:28:10.800Z\u00c5   File \"/opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/worker.py\", line 84, in <module>\r\n\u00c42021-02-16T20:28:10.800Z\u00c5     from azure_functions_worker import main\r\n\u00c42021-02-16T20:28:10.800Z\u00c5   File \"/opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/azure_functions_worker/main.py\", line 8, in <module>\r\n\u00c42021-02-16T20:28:10.800Z\u00c5     from . import dispatcher\r\n\u00c42021-02-16T20:28:10.800Z\u00c5   File \"/opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/azure_functions_worker/dispatcher.py\", line 21, in <module>\r\n\u00c42021-02-16T20:28:10.800Z\u00c5     import grpc\r\n\u00c42021-02-16T20:28:10.800Z\u00c5   File \"/opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/grpc/__init__.py\", line 23, in <module>\r\n\u00c42021-02-16T20:28:10.800Z\u00c5     from grpc._cython import cygrpc as _cygrpc\r\n\u00c42021-02-16T20:28:10.800Z\u00c5 **ImportError: dlopen(/opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/grpc/_cython/cygrpc.cpython-39-darwin.so, 2): no suitable image found.  Did find:**\r\n\u00c42021-02-16T20:28:10.800Z\u00c5  /opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/grpc/_cython/cygrpc.cpython-39-darwin.so: mach-o, but wrong architecture\r\n\u00c42021-02-16T20:28:10.801Z\u00c5 Exceeded language worker restart retry count for runtime:python. Shutting down and proactively recycling the Functions Host to recover\r\n\u00c42021-02-16T20:28:10.808Z\u00c5  /opt/homebrew/Cellar/azure-functions-core-tools\u00c93/3.0.3284/workers/python/3.9/OSX/X64/grpc/_cython/cygrpc.cpython-39-darwin.so: mach-o, but wrong architecture\r\n\r\nFunctions:\r\n\r\n HttpTrigger: \u00c4GET,POST\u00c5 http://localhost:7071/api/HttpTrigger\r\n\r\nFor detailed output, run func with --verbose flag.\r\n```\r\n\r\nI would appreciate some advice here!\r\nThanks and all the best",
      "solution": "The issue is still present. \r\nM1 MacBook Pro\r\n\r\n> Core Tools Version:       4.0.3780 Commit hash: 2b9e0e618f69993ff119009e48587b67ac85450e  (64-bit)\r\n> Function Runtime Version: 4.0.0.16394\r\n\r\n> ImportError: dlopen(/opt/homebrew/Cellar/azure-functions-core-tools@4/4.0.3780/workers/python/3.9/OSX/X64/grpc/_cython/cygrpc.cpython-39-darwin.so, 0x0002): tried: '/opt/homebrew/Cellar/azure-functions-core-tools@4/4.0.3780/workers/python/3.9/OSX/X64/grpc/_cython/cygrpc.cpython-39-darwin.so' (mach-o file, but is an incompatible architecture (have 'x86_64', need 'arm64e')), '/usr/local/lib/cygrpc.cpython-39-darwin.so' (no such file), '/usr/lib/cygrpc.cpython-39-darwin.so' (no such file)\n\n---\n\n> The issue is still present. M1 MacBook Pro\r\n> \r\n> > Core Tools Version:       4.0.3780 Commit hash: [2b9e0e6](https://github.com/Azure/azure-functions-core-tools/commit/2b9e0e618f69993ff119009e48587b67ac85450e)  (64-bit)\r\n> > Function Runtime Version: 4.0.0.16394\r\n> \r\n> > ImportError: dlopen(/opt/homebrew/Cellar/azure-functions-core-tools@4/4.0.3780/workers/python/3.9/OSX/X64/grpc/_cython/cygrpc.cpython-39-darwin.so, 0x0002): tried: '/opt/homebrew/Cellar/azure-functions-core-tools@4/4.0.3780/workers/python/3.9/OSX/X64/grpc/_cython/cygrpc.cpython-39-darwin.so' (mach-o file, but is an incompatible architecture (have 'x86_64', need 'arm64e')), '/usr/local/lib/cygrpc.cpython-39-darwin.so' (no such file), '/usr/lib/cygrpc.cpython-39-darwin.so' (no such file)\r\n\r\nStill got the exact same error. Running two macbooks for this right now, waiting to solve this problem. Lets hope it comes quick in some way. \n\n---\n\nLooks like Core Tools is able to run in x64 emulation but it\u2019s starting the python worker in ARM. The worker uses x64 binaries in some places and that\u2019s where it appears to be failing. Are you able to run the entire stack with x64 emulation? I only have an Intel Mac so I can\u2019t try this out.\r\n\r\n/cc @vrdmr ",
      "labels": [],
      "created_at": "2021-02-16T20:39:55Z",
      "closed_at": "2023-11-22T17:42:08Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/915",
      "comments_count": 30
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1629,
      "title": "[Bug] Importing from azure-storage-blob makes functions not showing on Linux App Service Plan",
      "problem": "### Expected Behavior\n\nMy functions are running and visible on Azure in the Overview->functions list.\n\n### Actual Behavior\n\nMy functions are not showing on Azure in the Overview->functions list.\n\n### Steps to Reproduce\n\n1. Create a default Http Trigger Azure Function Python Project.\n2. Just add \"azure-storage-blob\" in requirements.txt and \"from azure.storage.blob import BlobServiceClient\" in the function_app.py\n3. Create in Azure a Function App ( App Service Plan Linux Basic B1 ) Python (3.10 or 3.11 ( tried with both))\n4. Deploy application to Azure Function.\n5. Functions are not showing on Azure in the Overview->functions list.\n\nIf i comment the import line \"from azure.storage.blob import BlobServiceClient\" and redeploy, functions are working and visible.\n\n\n### Relevant code being tried\n\n```shell\nimport azure.functions as func\nimport logging\nfrom azure.storage.blob import BlobServiceClient\n\napp = func.FunctionApp(http_auth_level=func.AuthLevel.ANONYMOUS)\n\n@app.route(route=\"http_trigger3\")\ndef http_trigger3(req: func.HttpRequest) -> func.HttpResponse:\n    logging.info('Python HTTP trigger3 function processed a request.')\n\n    name = req.params.get('name')\n    if not name:\n        try:\n            req_body = req.get_json()\n        except ValueError:\n            pass\n        else:\n            name = req_body.get('name')\n\n    if name:\n        return func.HttpResponse(f\"Hello, my dear3 {name}. This HTTP triggered function executed successfully.\")\n    else:\n        return func.HttpResponse(\n             \"This HTTP triggered function executed successfully. Pass a name in the query string or in the request body for a personalized response.\",\n             status_code=200\n        )\n```\n\n### Relevant log output\n\n```shell\n2025-01-13T13:54:55.421 [Information] Initializing function HTTP routes\nNo HTTP routes mapped\n2025-01-13T13:54:55.440 [Information] Host initialized (321ms)\n2025-01-13T13:54:55.460 [Information] Host started (360ms)\n2025-01-13T13:54:55.460 [Information] Job host started\n2025-01-13T13:55:10.147 [Information] Host lock lease acquired by instance ID '59ed4a69001d7adf38f26ae63c4e590c'.\n2025-01-13T13:55:25.482 [Information] Loading functions metadata\n2025-01-13T13:55:25.483 [Information] Reading functions metadata (Custom)\n2025-01-13T13:55:25.484 [Information] 0 functions found (Custom)\n2025-01-13T13:55:25.484 [Information] 0 functions loaded\n2025-01-13T13:55:25.506 [Information] HttpOptions\n{\n  \"DynamicThrottlesEnabled\": false,\n  \"EnableChunkedRequestBinding\": false,\n  \"MaxConcurrentRequests\": -1,\n  \"MaxOutstandingRequests\": -1,\n  \"RoutePrefix\": \"api\"\n}\n2025-01-13T13:55:25.514 [Information] ConcurrencyOptions\n{\n  \"DynamicConcurrencyEnabled\": false,\n  \"MaximumFunctionConcurrency\": 500,\n  \"CPUThreshold\": 0.8,\n  \"SnapshotPersistenceEnabled\": true\n}\n2025-01-13T13:55:25.554 [Information] Loading functions metadata\n2025-01-13T13:55:25.554 [Information] Reading functions metadata (Custom)\n2025-01-13T13:55:25.555 [Information] 0 functions found (Custom)\n2025-01-13T13:55:25.555 [Information] 0 functions loaded\n```\n\n### requirements.txt file\n\n```shell\nazure-storage-blob\nazure-functions\n```\n\n### Where are you facing this problem?\n\nProduction Environment (explain below)\n\n### Function app name\n\n_No response_\n\n### Additional Information\n\nI have a function that works with blobs and who already run in production environment. But when i tried to deploy the same on a test environment, the problem appears. I have isolated the problem and i think it is just the line 'from azure.storage.blob import BlobServiceClient' that causes the issue. So i share with you a minimal project that reproduces the problem.",
      "solution": "Hi @AlexanderWassmann, I deployed an app to the B1 plan using Python 3.11 with the code and requirements.txt provided, and I didn't have the issue. Was your repro using this same code?\n\n<img width=\"414\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/d96e837a-75ba-4d55-bc0b-69121fcf161d\" />\n\n<img width=\"1507\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/eb83e231-6594-472c-9cff-c8123e95ca92\" />\n\nFrom the issue description, it looks like the problem is with the `azure-storage-blob` library not being found.  From my understanding, the same code / requirements works in the prod environment but not the dev environment. Is that correct?\n\nCould you share more information on how you're deploying the app and what all package dependencies are included in the app requirements? Alternatively, if you could [share your function app name](https://github.com/Azure/azure-functions-host/wiki/Sharing-Your-Function-App-name-privately) that would help us take a closer look.",
      "labels": [
        "bug",
        "needs-attention :wave:",
        "python"
      ],
      "created_at": "2025-01-13T14:12:07Z",
      "closed_at": "2025-01-16T15:34:39Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1629",
      "comments_count": 4
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1609,
      "title": "[Bug] EventGrid Trigger Function fails because input binding in function.json does not match Python type annotation",
      "problem": "### Expected Behavior\n\nThe Function should execute without error.\n\n### Actual Behavior\n\nThe Function fails with an error message saying that the type of the input binding in `function.json` does not match the Python type annotation of the parameter in the entrypoint function.\n\n### Steps to Reproduce\n\nUsing Python version 3.10.*:\n\n1. Create a Function by copying the v1 programming model example in the Azure docs [here](https://learn.microsoft.com/en-us/azure/azure-functions/functions-bindings-event-grid-trigger?tabs=python-v1%2Cisolated-process%2Cnodejs-v4%2Cextensionv3&pivots=programming-language-python)\n2. Use the [pex](https://docs.pex-tool.org/) library to package the Function as an executable zip file (contains Python dependencies and Function-related files like `host.json` and `function.json`)\n3. Zip-deploy the packaged Function (e.g., `az functionapp deployment source config-zip --src example.zip --build-remote false --name myfunc  --resource-group myresourcegroup --verbose`)\n4. Execute the Function via the Test/Run interface in the Azure Portal or by triggering an event\n\n### Relevant code being tried\n\nThe v1 programming model example from the Azure docs [here](https://learn.microsoft.com/en-us/azure/azure-functions/functions-bindings-event-grid-trigger?tabs=python-v1%2Cisolated-process%2Cnodejs-v4%2Cextensionv3&pivots=programming-language-python).\n\n### Relevant log output\n\n```shell\nResult: Failure Exception: FunctionLoadError: cannot load the test_pex function: type of event binding in function.json \"eventGridTrigger\" does not match its Python annotation \"EventGridEvent\"\nStack: File \"/azure-functions-host/workers/python/3.10/LINUX/X64/azure_functions_worker/dispatcher.py\", line 541, in _handle__function_load_request self._functions.add_function(\nFile \"/azure-functions-host/workers/python/3.10/LINUX/X64/azure_functions_worker/functions.py\", line 392, in add_function input_types, output_types, _ = self.validate_function_params(\nFile \"/azure-functions-host/workers/python/3.10/LINUX/X64/azure_functions_worker/functions.py\", line 251, in validate_function_params raise FunctionLoadError(\n```\n\n### requirements.txt file\n\n```shell\nazure-functions==1.21.3\n```\n\n### Where are you facing this problem?\n\nProduction Environment (explain below)\n\n### Additional Information\n\nThis error began occurring in my deployed Functions without any changes to code or dependencies. I have also seen this error in a handful of failed invocations of Functions that otherwise execute without error.\n\nI replicated the error with the example Function found on the [docs page for Azure Event Grid trigger for Azure Functions](https://learn.microsoft.com/en-us/azure/azure-functions/functions-bindings-event-grid-trigger?tabs=python-v1%2Cisolated-process%2Cnodejs-v4%2Cextensionv3&pivots=programming-language-python).\n\nI can \"fix\" this error by removing the `func.EventGridEvent` type annotation from the `main` entrypoint function definition. A [similar issue](https://github.com/Azure/azure-functions-python-worker/issues/1135) was raised several years ago.",
      "solution": "This issue is now preventing me from deploying a Queue triggered Function:\n\n```\nResult: Failure Exception: FunctionLoadError: cannot load the modDfQueueTrigger function: type of msg binding in function.json \"queueTrigger\" does not match its Python annotation \"QueueMessage\" Stack: File \"/azure-functions-host/workers/python/3.10/LINUX/X64/azure_functions_worker/dispatcher.py\", line 541, in _handle__function_load_request self._functions.add_function( File \"/azure-functions-host/workers/python/3.10/LINUX/X64/azure_functions_worker/functions.py\", line 392, in add_function input_types, output_types, _ = self.validate_function_params( File \"/azure-functions-host/workers/python/3.10/LINUX/X64/azure_functions_worker/functions.py\", line 251, in validate_function_params raise FunctionLoadError(\n```\n\nUnfortunately the workaround of simply removing the type annotation from the Function entrypoint results in a different error:\n\n```\nResult: Failure Exception: TypeError: unable to decode incoming TypedData: unsupported combination of TypedData field 'string' and expected binding type <class 'azure.functions.durable_functions.DurableClientConverter'> Stack: File \"/azure-functions-host/workers/python/3.10/LINUX/X64/azure_functions_worker/dispatcher.py\", line 626, in _handle__invocation_request args[pb.name] = bindings.from_incoming_proto( File \"/azure-functions-host/workers/python/3.10/LINUX/X64/azure_functions_worker/bindings/meta.py\", line 192, in from_incoming_proto raise TypeError(\n```\n\n@bhagyshricompany @hallvictoria please assist.\n\n---\n\n**Update:** I have resolved this issue by using an alternate approach to packaging code for zip deployment. We were using the `pex_binary` target provided by Pants which produces a zip with third party dependencies installed in a `.deps/` subdirectory that is mounted at runtime which is likely the source of the issue here. It turns out that the [python_aws_lambda_function](https://www.pantsbuild.org/stable/docs/python/integrations/aws-lambda) target packages the code in a flatter structure that is also compatible with the Azure Functions runtime.\n\nClosing.",
      "labels": [
        "bug",
        "needs-attention :wave:",
        "python"
      ],
      "created_at": "2024-11-12T03:17:05Z",
      "closed_at": "2025-01-14T16:52:50Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1609",
      "comments_count": 7
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1436,
      "title": "[BUG] Failure to debug Python Functions using VSCode + WSL2 + Ubuntu 22.04",
      "problem": "Tools\r\n- VSCode\r\n- WSL2\r\n- Ubuntu 22.04\r\n- Python 3.10.12\r\n\r\nI am using the Code created when using Workspace/New Project...\r\nProject consistently fails with: **ConnectionRefusedError: [Errno 111]**\r\n\r\n\r\n### Investigative information\r\nI have tried everything I can find on the internet including #2808;\r\nPython works on this VM;\r\nI have deleted the project and started again and restarted WSl2\r\n\r\nIf I run:  _func host start / func start_ the function works with: p://localhost:7071/api/http_trigger1?name=\"test\"\r\n\r\nIf I try to make a C# function works as expected.\r\n\r\nI modified launch.json to include:       \"command\": \"host start   --verbose\",\r\nAttached is the Output:\r\n\r\n*  Executing task: .venv/bin/python -m pip install -r requirements.txt \r\n\r\nRequirement already satisfied: azure-functions in ./.venv/lib/python3.10/site-packages (from -r requirements.txt (line 5)) (1.18.0)\r\n *  Terminal will be reused by tasks, press any key to close it. \r\n\r\n *  Executing task: . .venv/bin/activate && func host start   --verbose \r\n\r\nFound Python version 3.10.12 (python3).\r\n\r\n                  %%%%%%\r\n                 %%%%%%\r\n            @   %%%%%%    @\r\n          @@   %%%%%%      @@\r\n       @@@    %%%%%%%%%%%    @@@\r\n     @@      %%%%%%%%%%        @@\r\n       @@         %%%%       @@\r\n         @@      %%%       @@\r\n           @@    %%      @@\r\n                %%\r\n                %\r\n\r\n\r\nAzure Functions Core Tools\r\nCore Tools Version:       4.0.5455 Commit hash: N/A  (64-bit)\r\nFunction Runtime Version: 4.27.5.21554\r\n\r\n[2024-02-23T18:20:57.501Z] Starting metrics publisher for container : wsl. Publishing endpoint is https://:31002/api/metrics\r\n[2024-02-23T18:20:57.557Z] Initializing LinuxContainerActivityPublisher\r\n[2024-02-23T18:20:57.557Z] Starting LinuxContainerActivityPublisher\r\nMS_FUNCTION_LOGS 5,,,,,ScriptApplicationHostOptionsSetup,\"\",\"ScmRunFromPackage is empty.\",4.27.5.21554,2024-02-23T18:20:57.5600849Z,,\"\",,,,WSL,,,,\r\n[2024-02-23T18:20:57.607Z] Building host: version spec: , startup suppressed: 'False', configuration suppressed: 'False', startup operation id: '93a298d3-ebf7-4eac-aea6-e67cd4fb582f'\r\n[2024-02-23T18:20:57.612Z] Reading host configuration file '/workspaces/functionApp/host.json'\r\n[2024-02-23T18:20:57.613Z] Host configuration file read:\r\n[2024-02-23T18:20:57.613Z] {\r\n[2024-02-23T18:20:57.613Z]   \"version\": \"2.0\",\r\n[2024-02-23T18:20:57.614Z]   \"logging\": {\r\n[2024-02-23T18:20:57.614Z]     \"applicationInsights\": {\r\n[2024-02-23T18:20:57.614Z]       \"samplingSettings\": {\r\n[2024-02-23T18:20:57.614Z]         \"isEnabled\": true,\r\n[2024-02-23T18:20:57.614Z]         \"excludedTypes\": \"Request\"\r\n[2024-02-23T18:20:57.614Z]       }\r\n[2024-02-23T18:20:57.614Z]     }\r\n[2024-02-23T18:20:57.615Z]   },\r\n[2024-02-23T18:20:57.615Z]   \"extensionBundle\": {\r\n[2024-02-23T18:20:57.615Z]     \"id\": \"Microsoft.Azure.Functions.ExtensionBundle\",\r\n[2024-02-23T18:20:57.615Z]     \"version\": \"[4.*, 5.0.0)\"\r\n[2024-02-23T18:20:57.615Z]   }\r\n[2024-02-23T18:20:57.615Z] }\r\n[2024-02-23T18:20:57.654Z] FUNCTIONS_WORKER_RUNTIME set to python. Skipping WorkerConfig for language: powershell\r\n[2024-02-23T18:20:57.665Z] FUNCTIONS_WORKER_RUNTIME set to python. Skipping WorkerConfig for language: node\r\n[2024-02-23T18:20:57.686Z] FUNCTIONS_WORKER_RUNTIME set to python. Skipping WorkerConfig for language: java\r\n[2024-02-23T18:20:57.687Z] Looking for extension bundle Microsoft.Azure.Functions.ExtensionBundle at /FuncExtensionBundles/Microsoft.Azure.Functions.ExtensionBundle\r\n[2024-02-23T18:20:57.687Z] Looking for extension bundle Microsoft.Azure.Functions.ExtensionBundle at /root/site/wwwroot/.azurefunctions/ExtensionBundles/Microsoft.Azure.Functions.ExtensionBundle\r\n[2024-02-23T18:20:57.687Z] Looking for extension bundle Microsoft.Azure.Functions.ExtensionBundle at /root/data/Functions/ExtensionBundles/Microsoft.Azure.Functions.ExtensionBundle\r\n[2024-02-23T18:20:57.688Z] Found a matching extension bundle at /root/data/Functions/ExtensionBundles/Microsoft.Azure.Functions.ExtensionBundle/4.12.0\r\n[2024-02-23T18:20:57.703Z] Loading functions metadata\r\n[2024-02-23T18:20:57.705Z] Worker indexing is enabled\r\n[2024-02-23T18:20:57.712Z] Fetching metadata for workerRuntime: python\r\n[2024-02-23T18:20:57.712Z] Reading functions metadata (Worker)\r\n[2024-02-23T18:20:58.383Z] Language Worker Process exited. Pid=2686.\r\n[2024-02-23T18:20:58.383Z] python3 exited with code 1 (0x1). ConnectionRefusedError: [Errno 111] Connection refused,ConnectionRefusedError: [Errno 111] Connection refused.\r\n[2024-02-23T18:21:02.566Z] Posting health event {\"EventTime\":\"2024-02-23T18:21:02.5542407Z\",\"EventType\":0,\"Source\":\"Microsoft.Azure.WebJobs.Script.WebHost.ContainerManagement.LinuxContainerActivityPublisher\",\"Details\":\"SpecializationCompleted\"}\r\n[2024-02-23T18:21:02.578Z] PublishSpecializationCompleteEvent failed with System.InvalidOperationException: An invalid request URI was provided. Either the request URI must be an absolute URI or BaseAddress must be set.\r\n[2024-02-23T18:21:02.579Z]    at System.Net.Http.HttpClient.PrepareRequestMessage(HttpRequestMessage request)\r\n[2024-02-23T18:21:02.579Z]    at System.Net.Http.HttpClient.CheckRequestBeforeSend(HttpRequestMessage request)\r\n[2024-02-23T18:21:02.579Z]    at System.Net.Http.HttpClient.SendAsync(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationToken cancellationToken)\r\n[2024-02-23T18:21:02.579Z]    at System.Net.Http.HttpClient.SendAsync(HttpRequestMessage request)\r\n[2024-02-23T18:21:02.579Z]    at Microsoft.Azure.WebJobs.Script.WebHost.Management.MeshServiceClient.SendAsync(IEnumerable`1 formData) in /_/src/WebJobs.Script.WebHost/Management/MeshServiceClient.cs:line 154\r\n[2024-02-23T18:21:02.579Z]    at Microsoft.Azure.WebJobs.Script.WebHost.Management.MeshServiceClient.NotifyHealthEvent(ContainerHealthEventType healthEventType, Type source, String details) in /_/src/WebJobs.Script.WebHost/Management/MeshServiceClient.cs:line 104\r\n[2024-02-23T18:21:02.579Z]    at Microsoft.Azure.WebJobs.Script.WebHost.ContainerManagement.LinuxContainerActivityPublisher.PublishSpecializationCompleteEvent() in /_/src/WebJobs.Script.WebHost/ContainerManagement/LinuxContainerActivityPublisher.cs:line 122\r\nMS_FUNCTION_METRICS ,,,hostjsonfileconfigurationsource.loadhostconfigurationsource.initializehostconfig,0,0,0,1,4.27.5.21554,2024-02-23T18:21:27.4964945Z,\"{'IsStopwatchHighResolution': True}\",WSL,,,,\r\nMS_FUNCTION_METRICS ,,,hostjsonfileconfigurationsource.loadhostconfigurationsource.loadhostconfig,0,0,0,1,4.27.5.21554,2024-02-23T18:21:27.4964945Z,\"{'IsStopwatchHighResolution': True}\",WSL,,,,\r\nMS_FUNCTION_METRICS ,,,workerconfigfactory.getconfigs.buildworkerproviderdictionary.addprovider./usr/lib/azure-functions-core-tools-4/workers/powershell,15,15,15,1,4.27.5.21554,2024-02-23T18:21:27.4964945Z,\"{'IsStopwatchHighResolution': True}\",WSL,,,,\r\nMS_FUNCTION_METRICS ,,,workerconfigfactory.getconfigs.buildworkerproviderdictionary.addprovider./usr/lib/azure-functions-core-tools-4/workers/node,0,0,0,1,4.27.5.21554,2024-02-23T18:21:27.4964945Z,\"{'IsStopwatchHighResolution': True}\",WSL,,,,\r\nMS_FUNCTION_METRICS ,,,workerconfigfactory.getconfigs.buildworkerproviderdictionary.addprovider./usr/lib/azure-functions-core-tools-4/workers/java,20,20,20,1,4.27.5.21554,2024-02-23T18:21:27.4964945Z,\"{'IsStopwatchHighResolution': True}\",WSL,,,,\r\nMS_FUNCTION_METRICS ,,,workerconfigfactory.getconfigs.buildworkerproviderdictionary.addprovider./usr/lib/azure-functions-core-tools-4/workers/python,10,10,10,1,4.27.5.21554,2024-02-23T18:21:27.4964945Z,\"{'IsStopwatchHighResolution': True}\",WSL,,,,\r\nMS_FUNCTION_METRICS ,,,hostjsonfileconfigurationsource.loadhostconfigurationsource,5,5,5,1,4.27.5.21554,2024-02-23T18:21:27.4964945Z,\"{'IsStopwatchHighResolution': True}\",WSL,,,,\r\nMS_FUNCTION_METRICS ,,,workerprocess.start,5,5,5,1,4.27.5.21554,2024-02-23T18:21:27.4964945Z,\"{'IsStopwatchHighResolution': True}\",WSL,,,,\r\nMS_FUNCTION_METRICS ,,,workerconfigfactory.getconfigs,49,49,49,1,4.27.5.21554,2024-02-23T18:21:27.4964945Z,\"{'IsStopwatchHighResolution': True}\",WSL,,,,\r\n[2024-02-23T18:21:57.757Z] Starting worker process failed\r\n[2024-02-23T18:21:57.757Z] Microsoft.Azure.WebJobs.Script.Grpc: The operation has timed out.\r\n[2024-02-23T18:21:57.759Z] Failed to start language worker process for runtime: (null). workerId:c8db8ef9-b555-4ed0-bf41-9ae967be7b64\r\n[2024-02-23T18:21:57.761Z] Removing errored webhost language worker channel for runtime: python workerId:c8db8ef9-b555-4ed0-bf41-9ae967be7b64\r\n[2024-02-23T18:21:57.761Z] Microsoft.Azure.WebJobs.Script.Grpc: The operation has timed out.\r\n[2024-02-23T18:21:57.786Z] 0 functions loaded\r\n[2024-02-23T18:21:57.789Z] Looking for extension bundle Microsoft.Azure.Functions.ExtensionBundle at /FuncExtensionBundles/Microsoft.Azure.Functions.ExtensionBundle\r\n[2024-02-23T18:21:57.789Z] Looking for extension bundle Microsoft.Azure.Functions.ExtensionBundle at /root/site/wwwroot/.azurefunctions/ExtensionBundles/Microsoft.Azure.Functions.ExtensionBundle\r\n[2024-02-23T18:21:57.789Z] Looking for extension bundle Microsoft.Azure.Functions.ExtensionBundle at /root/data/Functions/ExtensionBundles/Microsoft.Azure.Functions.ExtensionBundle\r\n[2024-02-23T18:21:57.789Z] Found a matching extension bundle at /root/data/Functions/ExtensionBundles/Microsoft.Azure.Functions.ExtensionBundle/4.12.0\r\n[2024-02-23T18:21:57.790Z] Fetching information on versions of extension bundle Microsoft.Azure.Functions.ExtensionBundle available on https://functionscdn.azureedge.net/public/ExtensionBundles/Microsoft.Azure.Functions.ExtensionBundle/index.json\r\n[2024-02-23T18:21:57.827Z] Skipping bundle download since it already exists at path /root/data/Functions/ExtensionBundles/Microsoft.Azure.Functions.ExtensionBundle/4.12.0\r\n[2024-02-23T18:21:57.828Z] Loading extension bundle from /root/data/Functions/ExtensionBundles/Microsoft.Azure.Functions.ExtensionBundle/4.12.0/bin_v3/linux-x64\r\n[2024-02-23T18:21:57.829Z] Script Startup resetting load context with base path: '/root/data/Functions/ExtensionBundles/Microsoft.Azure.Functions.ExtensionBundle/4.12.0/bin_v3/linux-x64'.\r\n[2024-02-23T18:21:57.837Z] Reading host configuration file '/workspaces/functionApp/host.json'\r\n[2024-02-23T18:21:57.837Z] Host configuration file read:\r\n[2024-02-23T18:21:57.837Z] {\r\n[2024-02-23T18:21:57.837Z]   \"version\": \"2.0\",\r\n[2024-02-23T18:21:57.837Z]   \"logging\": {\r\n[2024-02-23T18:21:57.837Z]     \"applicationInsights\": {\r\n[2024-02-23T18:21:57.837Z]       \"samplingSettings\": {\r\n[2024-02-23T18:21:57.837Z]         \"isEnabled\": true,\r\n[2024-02-23T18:21:57.837Z]         \"excludedTypes\": \"Request\"\r\n[2024-02-23T18:21:57.837Z]       }\r\n[2024-02-23T18:21:57.837Z]     }\r\n[2024-02-23T18:21:57.837Z]   },\r\n[2024-02-23T18:21:57.837Z]   \"extensionBundle\": {\r\n[2024-02-23T18:21:57.837Z]     \"id\": \"Microsoft.Azure.Functions.ExtensionBundle\",\r\n[2024-02-23T18:21:57.837Z]     \"version\": \"[4.*, 5.0.0)\"\r\n[2024-02-23T18:21:57.837Z]   }\r\n[2024-02-23T18:21:57.837Z] }\r\nMS_FUNCTION_LOGS 5,,,,,Host.LanguageWorkerConfig,\"\",\"Workers Directory set to: /usr/lib/azure-functions-core-tools-4/workers\",4.27.5.21554,2024-02-23T18:21:57.9843144Z,,\"\",,7719dbaf-0319-45f8-a0be-6dacebbe12c4,,WSL,,,,\r\nMS_FUNCTION_LOGS 5,,,,,Host.LanguageWorkerConfig,\"\",\"Found worker config: /usr/lib/azure-functions-core-tools-4/workers/powershell/worker.config.json\",4.27.5.21554,2024-02-23T18:21:57.9845090Z,,\"\",,7719dbaf-0319-45f8-a0be-6dacebbe12c4,,WSL,,,,\r\nMS_FUNCTION_LOGS 5,,,,,Host.LanguageWorkerConfig,\"\",\"EnvironmentVariable FUNCTIONS_WORKER_RUNTIME: python\",4.27.5.21554,2024-02-23T18:21:57.9846553Z,,\"\",,7719dbaf-0319-45f8-a0be-6dacebbe12c4,,WSL,,,,\r\nMS_FUNCTION_LOGS 4,,,,,Host.LanguageWorkerConfig,\"\",\"FUNCTIONS_WORKER_RUNTIME set to python. Skipping WorkerConfig for language: powershell\",4.27.5.21554,2024-02-23T18:21:57.9855122Z,,\"\",,7719dbaf-0319-45f8-a0be-6dacebbe12c4,,WSL,,,,\r\n[2024-02-23T18:21:57.992Z] MS_FUNCTION_AZURE_MONITOR_EVENT 4,localhost:7071,Microsoft.Web/sites/functions/log,FunctionAppLogs,,\"{'appName':'','roleInstance':'wsl','message':'FUNCTIONS_WORKER_RUNTIME set to python. Skipping WorkerConfig for language: powershell','category':'Host.LanguageWorkerConfig','hostVersion':'4.27.5.21554','hostInstanceId':'7719dbaf-0319-45f8-a0be-6dacebbe12c4','level':'Information','levelId':2,'processId':2651}\",WSL,,02/23/2024 18:21:57\r\nFUNCTIONS_WORKER_RUNTIME set to python. Skipping WorkerConfig for language: powershell\r\nMS_FUNCTION_LOGS 5,,,,,Host.LanguageWorkerConfig,\"\",\"Found worker config: /usr/lib/azure-functions-core-tools-4/workers/python/worker.config.json\",4.27.5.21554,2024-02-23T18:21:57.9927588Z,,\"\",,7719dbaf-0319-45f8-a0be-6dacebbe12c4,,WSL,,,,\r\nMS_FUNCTION_LOGS 5,,,,,Host.LanguageWorkerConfig,\"\",\"EnvironmentVariable FUNCTIONS_WORKER_RUNTIME: python\",4.27.5.21554,2024-02-23T18:21:57.9930990Z,,\"\",,7719dbaf-0319-45f8-a0be-6dacebbe12c4,,WSL,,,,\r\nMS_FUNCTION_LOGS 5,,,,,Host.LanguageWorkerConfig,\"\",\"EnvironmentVariable FUNCTIONS_WORKER_RUNTIME_VERSION: 3.10\",4.27.5.21554,2024-02-23T18:21:57.9931523Z,,\"\",,7719dbaf-0319-45f8-a0be-6dacebbe12c4,,WSL,,,,\r\nMS_FUNCTION_LOGS 5,,,,,Host.LanguageWorkerConfig,\"\",\"Added WorkerConfig for language: python\",4.27.5.21554,2024-02-23T18:21:57.9932030Z,,\"\",,7719dbaf-0319-45f8-a0be-6dacebbe12c4,,WSL,,,,\r\nMS_FUNCTION_LOGS 5,,,,,Host.LanguageWorkerConfig,\"\",\"Found worker config: /usr/lib/azure-functions-core-tools-4/workers/node/worker.config.json\",4.27.5.21554,2024-02-23T18:21:57.9932423Z,,\"\",,7719dbaf-0319-45f8-a0be-6dacebbe12c4,,WSL,,,,\r\nMS_FUNCTION_LOGS 5,,,,,Host.LanguageWorkerConfig,\"\",\"EnvironmentVariable FUNCTIONS_WORKER_RUNTIME: python\",4.27.5.21554,2024-02-23T18:21:57.9933990Z,,\"\",,7719dbaf-0319-45f8-a0be-6dacebbe12c4,,WSL,,,,\r\nMS_FUNCTION_LOGS 4,,,,,Host.LanguageWorkerConfig,\"\",\"FUNCTIONS_WORKER_RUNTIME set to python. Skipping WorkerConfig for language: node\",4.27.5.21554,2024-02-23T18:21:57.9934933Z,,\"\",,7719dbaf-0319-45f8-a0be-6dacebbe12c4,,WSL,,,,\r\n[2024-02-23T18:21:57.993Z] FUNCTIONS_WORKER_RUNTIME set to python. Skipping WorkerConfig for language: nodeMS_FUNCTION_AZURE_MONITOR_EVENT 4,localhost:7071,Microsoft.Web/sites/functions/log,FunctionAppLogs,,\"{'appName':'','roleInstance':'wsl','message':'FUNCTIONS_WORKER_RUNTIME set to python. Skipping WorkerConfig for language: node','category':'Host.LanguageWorkerConfig','hostVersion':'4.27.5.21554','hostInstanceId':'7719dbaf-0319-45f8-a0be-6dacebbe12c4','level':'Information','levelId':2,'processId':2651}\",WSL,,02/23/2024 18:21:57\r\n...",
      "solution": "Hi @qup9, is the issue only happening when trying to debug? Running the function with `func host start` works correctly?\r\n\r\nCan you share all the steps for repro-ing? I'm able to debug and run using WSL without any errors. Here's the documentation references I used to set it up:\r\n\t- [Developing Azure Functions Locally](https://learn.microsoft.com/en-us/azure/azure-functions/functions-run-local?tabs=linux%2Cisolated-process%2Cnode-v4%2Cpython-v2%2Chttp-trigger%2Ccontainer-apps&pivots=programming-language-python)\r\n\t- [Steps to install Azure Functions locally using WSL/Ubuntu](https://github.com/Azure/azure-functions-core-tools/issues/941)\r\n",
      "labels": [
        "needs-author feedback"
      ],
      "created_at": "2024-02-23T18:37:28Z",
      "closed_at": "2024-04-08T15:16:08Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1436",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1556,
      "title": "ERROR: cannot install cffi-1.16.0 dependency: binary dependencies without wheels are not supported when building locally.",
      "problem": "### Version\r\n\r\n4.0.5801\r\n\r\n### Description\r\n\r\nBuilding Azure Functions packages fails when using packages that rely on cffi (e.g. azure-identity).\r\n\r\nI am trying to deploy code to function apps through Bicep (URL deployment) and a storage account that contains the zip package. I create the .zip by running func pack in the function app but keep getting this error:\r\n\r\nERROR: cannot install cffi-1.16.0 dependency: binary dependencies without wheels are not supported when building locally. Use the \"--build remote\" option to build dependencies on the Azure Functions build server, or \"--build-native-deps\" option to automatically build and configure the dependencies using a Docker container. More information at https://aka.ms/func-python-publish\r\n\r\nI tried building with the following steps:\r\nWindows Python 3.11\r\nWindows Python 3.9\r\nMacbook Python 10\r\nDocker (through --build-native-deps) Python 3.11\r\nDocker (through --build-native-deps) Python 3.9\r\n\r\nI already figured out that this specifically happens when trying to use azure-identity so the steps to reproduce are really easy.\r\n\r\nIf there are better ways to automate deployment (Python to consumption plan func apps) I would like to hear them because this has been causing quite the frustration. \r\n\r\n### Steps to reproduce\r\n\r\n1. Create function app (I have Python V1 model)\r\n2. Run func pack to make sure it works\r\n3. Add azure-identity to requirements.txt\r\n4. Run func pack to get the error",
      "solution": "@tganwani I fixed this by installing my requirements through DevOps pipelines steps in my CI/CD pipeline which fortunately works and takes care of the whole packaging process now.\r\n\r\nSomething that has to be considered what I noticed is that running your pip install locally has to have the same python version as the function app runtime you're pushing to. Might be worth checking in your case.",
      "labels": [
        "Needs: Attention :wave:"
      ],
      "created_at": "2024-07-24T12:02:55Z",
      "closed_at": "2025-01-07T16:45:47Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1556",
      "comments_count": 3
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 852,
      "title": "Function apps with headless chrome works in consumption plan but not in premium plan",
      "problem": "We can't run headless Chrome in a function app hosted in a premium plan, but it works in consumption plan.\r\n\r\nWe have two function apps running on an elastic premium plan (EP1:1). One is using dotnet and **Puppeteer Sharp** library, and the other one Python and **Pyppeteer** library. Both are located in **West Europe**.\r\n\r\n**- C# dotnet function app**\r\n\r\nThrow the following error:\r\n_2021-05-19T07:26:42.342176771Z       Executed (Failed, Id=5687ac18-143f-4faf-a4e7-160b567a9a0c, Duration=103ms)\r\n2021-05-19T07:26:42.342947961Z  ---> PuppeteerSharp.ProcessException: Failed to launch Base! [0519/072642.021600:ERROR:zygote_host_impl_linux.cc(89)] Running as root without --no-sandbox is not supported. See https://crbug.com/638180._\r\n\r\n**- Python function app**\r\n\r\nThrows the following error: \r\n_2021-05-19T07:16:10.624 [Error] Executed (Failed, Id=9f65d621-67bd-4529-a877-059ebb87f1b9, Duration=30046ms)Result: FailureException: BrowserError: Browser closed unexpectedly_\r\n\r\nWe learned that the base images were not updated with the right dependencies for launching headless Chrome and tried to change the property linusFxVersion in the function apps to these base images, which are supposed to have the dependencies needed, using az CLI:\r\n\r\n- Dotnet: mcr.microsoft.com/azure-functions/python:3.7\r\n- Python: mcr.microsoft.com/azure-functions/python:3.0-python3.7\r\n\r\nWe are still getting the same error as shown above.\r\n\r\nWe also tried running the **dotnet** function app as a **custom container** and adding the dependencies manually there but still got issues. These are the steps we tried and their outcome:\r\n\r\n#####################################################################\r\n\r\n**When running with the Visual Studio auto generated Dockerfile + adding installed dependencies, function app itself is running but the function throws this error:**\r\n\r\n2021-05-06T16:34:11.404380645Z  ---> PuppeteerSharp.ProcessException: Failed to launch Base! \r\n[0506/163411.280771:ERROR:zygote_host_impl_linux.cc(89)] Running as root without --no-sandbox is not supported. \r\nSee https://crbug.com/638180.\r\n\r\n#####################################################################\r\n\r\n**When adding a new non-root user:**\r\n\r\n\"Failed to launch Base! [0506/181428.176134:FATAL:zygote_host_impl_linux.cc(116)] No usable sandbox! \r\nUpdate your kernel or see https://chromium.googlesource.com/chromium/src/+/master/docs/linux_suid_sandbox_development.md \r\nfor more information on developing with the SUID sandbox.\"\r\n\r\n####################################################################\r\n\r\n**When adding this line at the end of the Dockerfile to enable namespace cloning as per suggested in the link above:**\r\n\r\nCMD[\"sudo sysctl -w kernel.unprivileged_userns_clone=1\"]\r\n\r\nThe container logs shows this error:\r\n\r\n\"Docker API responded with status code=BadRequest, response={\"message\":\"OCI runtime create failed: \r\ncontainer_linux.go:370: starting container process caused:\r\nexec: \\\"sudo sysctl -w kernel.unprivileged_userns_clone=1\\\": executable file not found in $PATH: unknown\"}\"\r\n\r\nFound this in a Stackoverflow thread related to this command:\r\n\r\n\"Since Docker containers share the host system's kernel and its settings, a Docker container usually can't run sysctl at all.\"\r\n\r\nWe have an open ticket with Microsoft with **TrackingID#2104220050002234** and they suggested that we open a public issue here on GitHub.",
      "solution": "I'm cleaning up issues - sorry we never got to this, but hopefully you've either figured out your issue or moved on. If you're still facing this issue or haven't found a workaround for your scenario, please open a new issue with updated information.",
      "labels": [
        "needs-investigation"
      ],
      "created_at": "2021-05-19T07:39:35Z",
      "closed_at": "2025-01-07T16:24:13Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/852",
      "comments_count": 4
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1172,
      "title": "Converge azure.functions.ServiceBusMessage with azure.servicebus.ServiceBusMessage",
      "problem": "This is copied over from https://github.com/Azure/azure-sdk-for-python/issues/26827 as it was suggested I should post it in here.\r\n\r\nI deal with a lot of code in azure functions that requires me to process messages in a ServiceBus queue, and then pass that message on untouched. However, despite the fact that an Azure Functions ServiceBus Queue Trigger passes in an `azure.functions.ServiceBusMessage`,  `azure.servicebus.ServiceBusSender` does not accept that kind of message, preferring to throw the rather cryptic error: `Exception: TypeError: Only AmqpAnnotatedMessage, ServiceBusMessage instances or Mappings representing messages are supported. Received instead: ServiceBusMessage`.\r\n\r\nAnd as such, my code is peppered with this boilerplate:\r\n\r\n```python\r\n# msg is my azure.functions.ServiceBusMessage passed in at the start\r\nwith azure.servicebus.ServiceBusClient.from_connection_string(\r\n    os.environ[\"SERVICEBUS\"]\r\n) as sb:\r\n    sender = sb.get_queue_sender(\"next-step\")\r\n    message = azure.servicebus.ServiceBusMessage(\r\n        body=msg.get_body(),\r\n        application_properties=msg.user_properties,\r\n        message_id=msg.message_id,\r\n        content_type=msg.content_type,\r\n    )\r\n    sender.send_messages(message)\r\n```\r\n\r\nAlso, knowing when to use `application_properties` or `user_properties` drives me a little crazy, and means I can't just do something like `message = azure.servicebus.ServiceBusMessage(**msg.__dict__)` or somesuch.\r\n\r\n**Describe the solution you'd like**\r\nIdeally, some sort of convergence, in which `azure.functions.ServiceBusMessage` is a subclass of `azure.servicebus.ServiceBusMessage`, but implementing the old API as backwards-compatible aliases, and eventually deprecating the APIs that are not in  `azure.servicebus.ServiceBusMessage`. I can see no reason why they need to be separate classes.\r\n\r\n**Describe alternatives you've considered**\r\nSomewhat messier alternatives:\r\n * Allow `azure.servicebus.ServiceBusSender.send_messages()` to accept `azure.functions.ServiceBusMessage` instances\r\n * Make an `azure.servicebus.ServiceBusMessage.from_azure_functions_message()` constructor that creates one from the other\r\n",
      "solution": "@metamoof thanks for reporting the issue, can you try build the azure.servicebus.ServiceBusMessage from azure.functions.ServiceBusMessage which contains all attributes of azure.servicebus.ServiceBusMessage ( ref of azure.functions.ServiceBusMessage: https://github.com/Azure/azure-functions-python-library/blob/bd11d48b19dd226876ae96f7ca26a91ffa8beff6/azure/functions/servicebus.py#L8 ). Servicebus and functions package does not have dependency on each other and it is not a good idea for us to do so. \n\n---\n\nI can understand why you do not wish to depend on the servicebus package, but it would be nice if you both had at the very least the same Abstract Base Classes.\r\n\r\nThat being said, and being pragmatic, here's a quick survey of what is in both classes (not including the deprecated or not implemented properties):\r\n\r\nproperty | Functions | ServiceBus\r\n-- | -- | --\r\n`application_properties` | \u00a0 | :white_check_mark:\r\n`session_id` | :white_check_mark: | :white_check_mark:\r\n`message_id` | :white_check_mark: | :white_check_mark:\r\n`content_type` | :white_check_mark: | :white_check_mark:\r\n`correlation_id` | :white_check_mark: | :white_check_mark:\r\n`to` | :white_check_mark: | :white_check_mark:\r\n`reply_to` | :white_check_mark: | :white_check_mark:\r\n`reply_to_session_id` | :white_check_mark: | :white_check_mark:\r\n`subject` | \u00a0 | :white_check_mark:\r\n`scheduled_enqueue_time_utc` | :white_check_mark: | :white_check_mark:\r\n`time_to_live` | :white_check_mark: | :white_check_mark:\r\n`partition_key` | :white_check_mark: | :white_check_mark:\r\n`__str__` | \u00a0 | :white_check_mark:\r\n`__repr__` | \u00a0 | :white_check_mark:\r\n`_build_message` | \u00a0 | :white_check_mark:\r\n`_set_message_annotations` | \u00a0 | :white_check_mark:\r\n`_to_outgoing_message` | \u00a0 | :white_check_mark:\r\n`raw_amqp_message` | \u00a0 | :white_check_mark:\r\n`body` | \u00a0 | :white_check_mark:\r\n`body_type` | \u00a0 | :white_check_mark:\r\n`get_body` | :white_check_mark: | \u00a0\r\n`dead_letter_source` | :white_check_mark: | \u00a0\r\n`delivery_count` | :white_check_mark: | \u00a0\r\n`enqueued_time_utc` | :white_check_mark: | \u00a0\r\n`expires_at_utc` | :white_check_mark: | \u00a0\r\n`label` | :white_check_mark: | \u00a0\r\n`lock_token` | :white_check_mark: | \u00a0\r\n`sequence_number` | :white_check_mark: | \u00a0\r\n`user_properties` | :white_check_mark: | \u00a0\r\n`metadata` | :white_check_mark: | \u00a0\r\n\r\nSo, at first glance, to get API compatible, it seems all I need to do is alias `application_properties` and `user_properties`, and `body` to `get_body`. I also suspect that `subject` and `label` are the same thing - I'll write a quick script to test that out. I am not quite sure what to do with `body_type` - maybe raise a `NotImplementedError`?\r\n\r\nThe more difficult part is to make it so that the servicebus SDK will accept a Functions `ServiceBusMessage` - and that sems to hinge somewhat on the `_to_outgoing_message` method of the servicebus class, which creates an AMQP message. @YunchuWang I assume you're not particularly interested in depending on the AMQP library either?\r\n\r\nSo the solution that comes to me is to take advantage of the fact that `send_messages` will accept a `Mapping` type. I could either get `ServiceBusMessage` to implement `collections.abc.Mapping`, which is my preferred option, or as a secondary option add an `as_mapping()` method to `ServiceBusMessage` that I could then use the output of to feed into the `send_messages` method of the `ServiceBusClient`. As a bonus, both of these approaches should feed into a `ServiceBusMessageBatch` just fine. @YunchuWang which approach would you prefer?\r\n\r\nFinally, whilst I am going to create some self-contained unit tests for this, I'd appreciate guidance on how to include integration tests that will run against the servicebus SDK. I'd like to ensure that the libraries remain compatible over time.\n\n---\n\n@gavin-aguiar @bhagyshricompany, any updates for either metamoof's proposal or the SDK client binding Gavin mentioned?\n\nAs far as I can tell there is still no solution provided - not sure why it was marked completed.",
      "labels": [
        "needs-attention :wave:",
        "Needs: Triage :mag:"
      ],
      "created_at": "2023-02-03T15:58:18Z",
      "closed_at": "2023-06-22T20:01:59Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1172",
      "comments_count": 9
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1042,
      "title": "Important delay between invocation post and function execution",
      "problem": "**Stack: Python 3.7\r\nRuntime: 4.0\r\nService Plan: B3:3**\r\n\r\nFUNCTIONS_WORKER_PROCESS_COUNT=3\r\nPYTHON_THREADPOOL_THREAD_COUNT=32\r\n\r\n\r\nHi,\r\n\r\nI am encountering an issue with a HTTP triggered function.\r\n\r\nAzure log appearing at time T (just after log telling that \"Request successfully matched the route...\"):\r\n**_Verbose log at time T is: Posting invocation id:xyz... on workerId:zyx..._**\r\n\r\nPersonal python function log (first line of the function when triggered) appears in the logs at T + someTime.\r\nHere, someTime is random, but often  is greater than 1 minute.\r\n\r\nFor that specific transaction/operation, there isn't anything between the two logs mentioned above.\r\n\r\nThat issue happens a lot (relatively), and **randomly**, resulting in many requests that take more than 1 minute, whereas it is supposed to be run in some ms.\r\n\r\nNot any failure has been recorded inside the metrics. \r\nFurthermore, memory and CPU usage are OK for the three workers. No need to scale up/down.\r\nNo other function is running on the function App, and no other app is running on the plan.\r\n\r\nThe function is often called and works well when that issue does not appear. Function is running asynchronously.\r\n\r\nPlease help. \r\nThank you in advance.",
      "solution": "I see the same behavior. What was the resolution at the time?",
      "labels": [
        "bug",
        "needs-triage (functions)",
        "needs-author feedback"
      ],
      "created_at": "2022-05-07T23:10:51Z",
      "closed_at": "2022-06-14T21:02:42Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1042",
      "comments_count": 6
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1499,
      "title": "[Bug] Python Function V1 apps - Exception: ModuleNotFoundError: No module named '__app__.XXX'. Cannot find module.",
      "problem": "### Expected Behavior\n\nPython Function Apps using V1 programming model that are:\r\n* Import modules from right paths following https://learn.microsoft.com/en-us/azure/azure-functions/functions-reference-python?tabs=asgi%2Capplication-level&pivots=python-mode-configuration#import-behavior\r\n* Not defining __app__ as a module explicitly in your function app or importing __app__(.xxx.yy) module from dependency packages.\r\nshould run without seeing this issue in production.\n\n### Actual Behavior\n\nIt is reported from customers Exception: ModuleNotFoundError: No module named '__app__.XXX'. Cannot find module. gets raised during customers' v1 python apps function loading time intermittently and restarting the app will resolve the error. \r\nWe have trouble reproducing it and can't confirm at this moment if this is a customer code issue or platform issue. \n\n### Steps to Reproduce\n\n_No response_\n\n### Relevant code being tried\n\n_No response_\n\n### Relevant log output\n\n_No response_\n\n### requirements.txt file\n\n_No response_\n\n### Where are you facing this problem?\n\nProduction Environment (explain below)\n\n### Function app name\n\n_No response_\n\n### Additional Information\n\nPlease let us know if you encountered this issue in your python function v1 apps and would really appreciate if you can share your experience and code snippet under this announcement which helps a lot with python function team's investigation.",
      "solution": "[YunchuWang](https://github.com/YunchuWang) We have started facing the same issue from past few days intermittently and we are seeing this issue in multiple Azure Functions, `ModuleNotFoundError: No module named '__app__.XXX'`. \r\nIs there any solution for the above issue or if you could please suggest any actions here?",
      "labels": [
        "bug",
        "announcement",
        "python"
      ],
      "created_at": "2024-05-17T16:24:43Z",
      "closed_at": "2024-10-22T17:08:03Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1499",
      "comments_count": 8
    },
    {
      "tech": "azure",
      "repo": "Azure/azure-functions-python-worker",
      "issue_number": 1453,
      "title": "[BUG] Blob triggers log \"Blob Size: None\" when triggered",
      "problem": "### Investigative information\r\nFunc version: 4.0.5390\r\nPython version: 3.10.11\r\nExtension bundle: v4\r\nRepros with both programming model V1 & V2\r\n\r\n### Repro steps\r\n1. Create a Python Functions project\r\n2. Create a blob trigger function (use default template), listening to blobs on the `samples-workitems` container in the local emulator\r\n4. Execute your function using F5 on VSCode or running `func start`\r\n5. Trigger your function by uploading any blob to the `samples-workitems` container in the emulator\r\n6. Check output log\r\n\r\n### Expected behavior\r\nShow the correct blob size in the output log:\r\n![image](https://github.com/Azure/azure-functions-python-worker/assets/31644556/0f95902f-cc75-433c-a4e8-2c11c8af9ad1)\r\n\r\n### Actual behavior\r\nThe blob size is \"None bytes\" in the output log:\r\n\r\n![image](https://github.com/Azure/azure-functions-python-worker/assets/31644556/2ce0b09f-b8d2-4ba9-9451-da2774755e3a)\r\n\r\n\r\n### Known workarounds\r\nThe default template for blob triggers logs the size of the blob using `myblob.length`. I tried manually debugging the function, and saw that in my one example, using instead `myblob.blob_properties['ContentLength']` to log the blob length worked. I'm not sure if that's always set or a reliable property though. Also not sure if this is a Python worker issue that it doesn't properly set the `myblob.length` property, or a templates issue that it shouldn't rely on the `myblob.length` property to begin with.\r\n\r\n### Contents of the requirements.txt file:\r\n\r\n```\r\nazure-functions\r\n```\r\n\r\n### Related information\r\nFrom https://github.com/microsoft/vscode-azurefunctions/issues/4051\r\n",
      "solution": "This has been fixed! Please make sure to update to `azure-functions >= 1.22.0b4` and add `\"PYTHON_ISOLATE_WORKER_DEPENDENCIES\": \"1\"`.",
      "labels": [
        "Needs: Triage (Functions)"
      ],
      "created_at": "2024-03-20T20:15:34Z",
      "closed_at": "2024-10-17T20:29:42Z",
      "url": "https://github.com/Azure/azure-functions-python-worker/issues/1453",
      "comments_count": 3
    }
  ]
}